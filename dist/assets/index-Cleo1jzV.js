const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/basic-BEPEehjQ.js","assets/index-C5kX7ANf.js","assets/w3m-modal-BO978Jc9.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const xv={MISSING_PARAMETER:"missing_parameter",REMOTE_SERVICE_ERROR:"remote_service_error",INVALID_STATE:"invalid_state",NO_SESSION_DATA:"no_session_data",DOES_NOT_EXIST:"does_not_exist",FAILED_DECRYPTION_ERROR:"failed_decryption_error",INVALID_DID_ERROR:"invalid_did_error",NOT_ENOUGH_FUNDS_ERROR:"not_enough_error",INVALID_AMOUNT_ERROR:"invalid_amount_error",LOGIN_FAILED_ERROR:"login_failed",SIGNATURE_VERIFICATION_ERROR:"signature_verification_failure",CONFLICT_ERROR:"conflict_error",NOT_ENOUGH_PROOF_ERROR:"not_enough_proof_error",BAD_PATH_ERROR:"bad_path_error",VALIDATION_ERROR:"validation_error",PAYLOAD_TOO_LARGE_ERROR:"payload_too_large_error",PRECONDITION_FAILED_ERROR:"precondition_failed_error",UNKNOWN:"unknown"};Object.freeze(xv);class DI extends Error{constructor(t){super();let n=t.message,r=`Error Code: ${t.code}`,s=this.stack;if(s)r+=`Stack Trace:
${s}`;else try{throw new Error}catch(i){s=i.stack}n+=`
If you believe this exception is caused by a bug in stacks.js,
      please file a bug report: https://github.com/blockstack/stacks.js/issues

${r}`,this.message=n,this.code=t.code,this.parameter=t.parameter?t.parameter:void 0}toString(){return`${super.toString()}
    code: ${this.code} param: ${this.parameter?this.parameter:"n/a"}`}}class Hp extends DI{constructor(t){super({code:xv.INVALID_STATE,message:t}),this.message=t,this.name="NoSessionDataError"}}function Us(e,t){return qp(Vt(e),t)}function Vt(e){if(typeof e=="bigint")return e;if(typeof e=="string")return BigInt(e);if(typeof e=="number"){if(!Number.isInteger(e))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");if(e>Number.MAX_SAFE_INTEGER)throw new RangeError(`Invalid value. Values of type 'number' must be less than or equal to ${Number.MAX_SAFE_INTEGER}. For larger values, try using a BigInt instead.`);return BigInt(e)}if(un(e,Uint8Array))return BigInt(`0x${we(e)}`);throw new TypeError("intToBigInt: Invalid value type. Must be a number, bigint, BigInt-compatible string, or Uint8Array.")}function PI(e){return/^0x/i.test(e)?e.slice(2):e}function Sw(e){if(typeof e!="string")throw new TypeError(`hexToBigInt: expected string, got ${typeof e}`);return BigInt(`0x${e}`)}function Kc(e,t=8){return(typeof e=="bigint"?e:Vt(e)).toString(16).padStart(t*2,"0")}function Xu(e){return parseInt(e,16)}function qp(e,t=16){const n=Kc(e,t);return Ve(n)}function $I(e,t){if(e<-(BigInt(1)<<t-BigInt(1))||(BigInt(1)<<t-BigInt(1))-BigInt(1)<e)throw`Unable to represent integer in width: ${t}`;return e>=BigInt(0)?BigInt(e):e+(BigInt(1)<<t)}function kI(e,t){return e&BigInt(1)<<t}function lf(e){return UI(BigInt(`0x${we(e)}`),BigInt(e.byteLength*8))}function UI(e,t){return kI(e,t-BigInt(1))?e-(BigInt(1)<<t):e}const RI=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function we(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(const n of e)t+=RI[n];return t}function Ve(e){if(typeof e!="string")throw new TypeError(`hexToBytes: expected string, got ${typeof e}`);e=PI(e),e=e.length%2?`0${e}`:e;const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=n*2,s=e.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function Zo(e){return new TextEncoder().encode(e)}function Qu(e){return new TextDecoder().decode(e)}function MI(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return new Uint8Array(t)}function LI(e){return String.fromCharCode.apply(null,e)}function BI(e){return!Number.isInteger(e)||e<0||e>255}function Nw(e){if(e.some(BI))throw new Error("Some values are invalid bytes.");return new Uint8Array(e)}function ed(...e){if(!e.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];const t=e.reduce((r,s)=>r+s.length,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}function at(e){return ed(...e.map(t=>typeof t=="number"?Nw([t]):t instanceof Array?Nw(t):t))}function un(e,t){return e instanceof t||e?.constructor?.name?.toLowerCase()===t.name}const jI="https://api.mainnet.hiro.so",FI="https://api.testnet.hiro.so",zI="http://localhost:3999",HI=33,Fd=32;function qI(e){if(e.length<Fd*2*2+1)throw new Error("Invalid signature");const t=e.slice(0,2),n=e.slice(2,2+Fd*2),r=e.slice(2+Fd*2);return{recoveryId:Xu(t),r:n,s:r}}function _v(e){const t=typeof e=="string"?Ve(e):e;if(t.length!=32&&t.length!=33)throw new Error(`Improperly formatted private-key. Private-key byte length should be 32 or 33. Length provided: ${t.length}`);if(t.length==33&&t[32]!==1)throw new Error("Improperly formatted private-key. 33 bytes indicate compressed key, but the last byte must be == 01");return t}function WI(e,t){return(e[t+0]<<8|e[t+1])>>>0}function VI(e,t,n=0){return e[n+0]=t>>>8,e[n+1]=t>>>0,e}function KI(e,t){return e[t]}function GI(e,t,n=0){return e[n]=t,e}function YI(e,t){return e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3]}function Ii(e,t,n=0){return e[n+3]=t,t>>>=8,e[n+2]=t,t>>>=8,e[n+1]=t,t>>>=8,e[n]=t,e}function Tv(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ZI(e,...t){if(!Tv(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Ov(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function sc(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Wp(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function uf(e){if(!Array.isArray(e))throw new Error("array expected")}function Au(e,t){if(!Ov(!0,t))throw new Error(`${e}: array of strings expected`)}function JI(e,t){if(!Ov(!1,t))throw new Error(`${e}: array of numbers expected`)}function Dv(...e){const t=i=>i,n=(i,o)=>a=>i(o(a)),r=e.map(i=>i.encode).reduceRight(n,t),s=e.map(i=>i.decode).reduce(n,t);return{encode:r,decode:s}}function Pv(e){const t=typeof e=="string"?e.split(""):e,n=t.length;Au("alphabet",t);const r=new Map(t.map((s,i)=>[s,i]));return{encode:s=>(uf(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:s=>(uf(s),s.map(i=>{sc("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${e}`);return o}))}}function $v(e=""){return sc("join",e),{encode:t=>(Au("join.decode",t),t.join(e)),decode:t=>(sc("join.decode",t),t.split(e))}}function kv(e,t="="){return Wp(e),sc("padding",t),{encode(n){for(Au("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){Au("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const Uv=(e,t)=>t===0?e:Uv(t,e%t),Iu=(e,t)=>e+(t-Uv(e,t)),zd=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function xw(e,t,n,r){if(uf(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Iu(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Iu(t,n)}`);let s=0,i=0;const o=zd[t],a=zd[n]-1,c=[];for(const l of e){if(Wp(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(s=s<<t|l,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)c.push((s>>i-n&a)>>>0);const u=zd[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function Rv(e,t=!1){if(Wp(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Iu(8,e)>32||Iu(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Tv(n))throw new Error("radix2.encode input should be Uint8Array");return xw(Array.from(n),8,e,!t)},decode:n=>(JI("radix2.decode",n),Uint8Array.from(xw(n,e,8,t)))}}const XI=Dv(Rv(5),Pv("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),kv(5),$v("")),QI=typeof Uint8Array.from([]).toBase64=="function"&&typeof Uint8Array.fromBase64=="function",eS=(e,t)=>{sc("base64",e);const n=/^[A-Za-z0-9=+/]+$/,r="base64";if(e.length>0&&!n.test(e))throw new Error("invalid base64");return Uint8Array.fromBase64(e,{alphabet:r,lastChunkHandling:"strict"})},Mv=QI?{encode(e){return ZI(e),e.toBase64()},decode(e){return eS(e)}}:Dv(Rv(6),Pv("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),kv(6),$v("")),Vp="STX_PROVIDER",Lv=()=>typeof window>"u"?null:window.localStorage.getItem(Vp),tS=e=>{typeof window<"u"&&window.localStorage.setItem(Vp,e)},nS=()=>{typeof window<"u"&&window.localStorage.removeItem(Vp)},rS=()=>{if(typeof window>"u")return[];const e=window.webbtc_stx_providers||[],t=window.wbip_providers||[];return[...e,...t]},sS=(e=[])=>{if(typeof window>"u")return[];const n=rS().filter(r=>e.find(i=>i.id===r.id)?!1:!!td(r.id));return e.concat(n)},Bv=()=>{const e=Lv();return td(e)},td=e=>e?.split(".").reduce((t,n)=>t?.[n],window),iS="modulepreload",oS=function(e){return"/"+e},_w={},ic=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=c(n.map(l=>{if(l=oS(l),l in _w)return;_w[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":iS,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((p,f)=>{h.addEventListener("load",p),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})},aS="connect-ui",Su={hydratedSelectorName:"hydrated",lazyLoad:!0,updatable:!0,watchCallback:!1};var cS=Object.defineProperty,lS=(e,t)=>{for(var n in t)cS(e,n,{get:t[n],enumerable:!0})},uS="http://www.w3.org/2000/svg",dS="http://www.w3.org/1999/xhtml",ar=e=>{if(e.__stencil__getHostRef)return e.__stencil__getHostRef()},lq=(e,t)=>{e.__stencil__getHostRef=()=>t,t.$lazyInstance$=e},hS=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};n.$onReadyPromise$=new Promise(s=>n.$onReadyResolve$=s),e["s-p"]=[],e["s-rc"]=[];const r=n;return e.__stencil__getHostRef=()=>r,r},Tw=(e,t)=>t in e,Uo=(e,t)=>(0,console.error)(e,t),Hd=new Map,fS=(e,t,n)=>{const r=e.$tagName$.replace(/-/g,"_"),s=e.$lazyBundleId$;if(!s)return;const i=Hd.get(s);if(i)return i[r];{const o=a=>(Hd.set(s,a),a[r]);switch(s){case"connect-modal":return ic(()=>import("./connect-modal.entry-C7b6R5Bn.js"),[]).then(o,Uo)}}return ic(()=>import(`./${s}.entry.js`),[]).then(o=>(Hd.set(s,o),o[r]),o=>{Uo(o,t.$hostElement$)})},Nu=new Map,pS="{visibility:hidden}.hydrated{visibility:inherit}",jv="slot-fb{display:contents}slot-fb[hidden]{display:none}",Dt=typeof window<"u"?window:{},_t={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,r)=>e.addEventListener(t,n,r),rel:(e,t,n,r)=>e.removeEventListener(t,n,r),ce:(e,t)=>new CustomEvent(e,t)},gS=e=>Promise.resolve(e),Kp=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),df=Kp?!!Dt.document&&Object.getOwnPropertyDescriptor(Dt.document.adoptedStyleSheets,"length").writable:!1,hf=!1,Ow=[],Fv=[],wS=(e,t)=>n=>{e.push(n),hf||(hf=!0,_t.$flags$&4?Gp(ff):_t.raf(ff))},Dw=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(n){Uo(n)}e.length=0},ff=()=>{Dw(Ow),Dw(Fv),(hf=Ow.length>0)&&_t.raf(ff)},Gp=e=>gS().then(e),mS=wS(Fv),Yp=e=>(e=typeof e,e==="object"||e==="function");function zv(e){var t,n,r;return(r=(n=(t=e.head)==null?void 0:t.querySelector('meta[name="csp-nonce"]'))==null?void 0:n.getAttribute("content"))!=null?r:void 0}var yS=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),bS={};lS(bS,{err:()=>Hv,map:()=>vS,ok:()=>pf,unwrap:()=>ES,unwrapErr:()=>CS});var pf=e=>({isOk:!0,isErr:!1,value:e}),Hv=e=>({isOk:!1,isErr:!0,value:e});function vS(e,t){if(e.isOk){const n=t(e.value);return n instanceof Promise?n.then(r=>pf(r)):pf(n)}if(e.isErr){const n=e.value;return Hv(n)}throw"should never get here"}var ES=e=>{if(e.isOk)return e.value;throw e.value},CS=e=>{if(e.isErr)return e.value;throw e.value};var fa;function AS(e){var t;const n=this.attachShadow({mode:"open"});fa===void 0&&(fa=(t=void 0)!=null?t:null),fa&&(df?n.adoptedStyleSheets.push(fa):n.adoptedStyleSheets=[...n.adoptedStyleSheets,fa])}var Qr=(e,t="")=>()=>{},IS=(e,t)=>()=>{},Ao=new WeakMap,SS=(e,t,n)=>{let r=Nu.get(e);Kp&&n?(r=r||new CSSStyleSheet,typeof r=="string"?r=t:r.replaceSync(t)):r=t,Nu.set(e,r)},NS=(e,t,n)=>{var r;const s=qv(t),i=Nu.get(s);if(!Dt.document)return s;if(e=e.nodeType===11?e:Dt.document,i)if(typeof i=="string"){e=e.head||e;let o=Ao.get(e),a;if(o||Ao.set(e,o=new Set),!o.has(s)){{a=Dt.document.createElement("style"),a.innerHTML=i;const c=(r=_t.$nonce$)!=null?r:zv(Dt.document);if(c!=null&&a.setAttribute("nonce",c),!(t.$flags$&1))if(e.nodeName==="HEAD"){const l=e.querySelectorAll("link[rel=preconnect]"),u=l.length>0?l[l.length-1].nextSibling:e.querySelector("style");e.insertBefore(a,u?.parentNode===e?u:null)}else if("host"in e)if(Kp){const l=new CSSStyleSheet;l.replaceSync(i),df?e.adoptedStyleSheets.unshift(l):e.adoptedStyleSheets=[l,...e.adoptedStyleSheets]}else{const l=e.querySelector("style");l?l.innerHTML=i+l.innerHTML:e.prepend(a)}else e.append(a);t.$flags$&1&&e.insertBefore(a,null)}t.$flags$&4&&(a.innerHTML+=jv),o&&o.add(s)}}else e.adoptedStyleSheets.includes(i)||(df?e.adoptedStyleSheets.push(i):e.adoptedStyleSheets=[...e.adoptedStyleSheets,i]);return s},xS=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,s=Qr("attachStyles",t.$tagName$),i=NS(n.shadowRoot?n.shadowRoot:n.getRootNode(),t);r&10&&(n["s-sc"]=i,n.classList.add(i+"-h")),s()},qv=(e,t)=>"sc-"+e.$tagName$,_S=(e,t,...n)=>{let r=null,s=null,i=!1,o=!1;const a=[],c=u=>{for(let d=0;d<u.length;d++)r=u[d],Array.isArray(r)?c(r):r!=null&&typeof r!="boolean"&&((i=typeof e!="function"&&!Yp(r))&&(r=String(r)),i&&o?a[a.length-1].$text$+=r:a.push(i?gf(null,r):r),o=i)};if(c(n),t){t.key&&(s=t.key);{const u=t.className||t.class;u&&(t.class=typeof u!="object"?u:Object.keys(u).filter(d=>u[d]).join(" "))}}const l=gf(e,null);return l.$attrs$=t,a.length>0&&(l.$children$=a),l.$key$=s,l},gf=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return n.$attrs$=null,n.$key$=null,n},TS={},OS=e=>e&&e.$tag$===TS,Zp=e=>{const t=yS(e);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${t}))(${t}\\b)`,"g")};Zp("::slotted");Zp(":host");Zp(":host-context");var wf=(e,t,n)=>{if(typeof e=="string"&&(t&16||t&8)&&(e.startsWith("{")&&e.endsWith("}")||e.startsWith("[")&&e.endsWith("]")))try{return JSON.parse(e)}catch{}return e!=null&&!Yp(e),e},uq=e=>{var t;return(t=ar(e))==null?void 0:t.$hostElement$},DS=(e,t,n)=>{const r=_t.ce(t,n);return e.dispatchEvent(r),r},Pw=(e,t,n,r,s,i,o)=>{if(n===r)return;let a=Tw(e,t),c=t.toLowerCase();if(t==="class"){const l=e.classList,u=$w(n);let d=$w(r);l.remove(...u.filter(h=>h&&!d.includes(h))),l.add(...d.filter(h=>h&&!u.includes(h)))}else if(t!=="key")if(!a&&t[0]==="o"&&t[1]==="n"){if(t[2]==="-"?t=t.slice(3):Tw(Dt,c)?t=c.slice(2):t=c[2]+t.slice(3),n||r){const l=t.endsWith(Wv);t=t.replace($S,""),n&&_t.rel(e,t,n,l),r&&_t.ael(e,t,r,l)}}else{const l=Yp(r);if((a||l&&r!==null)&&!s)try{if(e.tagName.includes("-"))e[t]!==r&&(e[t]=r);else{const u=r??"";t==="list"?a=!1:(n==null||e[t]!=u)&&(typeof e.__lookupSetter__(t)=="function"?e[t]=u:e.setAttribute(t,u))}}catch{}r==null||r===!1?(r!==!1||e.getAttribute(t)==="")&&e.removeAttribute(t):(!a||i&4||s)&&!l&&e.nodeType===1&&(r=r===!0?"":r,e.setAttribute(t,r))}},PS=/\s/,$w=e=>(typeof e=="object"&&e&&"baseVal"in e&&(e=e.baseVal),!e||typeof e!="string"?[]:e.split(PS)),Wv="Capture",$S=new RegExp(Wv+"$"),Vv=(e,t,n,r)=>{const s=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,i=e&&e.$attrs$||{},o=t.$attrs$||{};for(const a of kw(Object.keys(i)))a in o||Pw(s,a,i[a],void 0,n,t.$flags$);for(const a of kw(Object.keys(o)))Pw(s,a,i[a],o[a],n,t.$flags$)};function kw(e){return e.includes("ref")?[...e.filter(t=>t!=="ref"),"ref"]:e}var Jp,bn=!1,xu=(e,t,n)=>{const r=t.$children$[n];let s=0,i,o;if(r.$text$!==null)i=r.$elm$=Dt.document.createTextNode(r.$text$);else{if(bn||(bn=r.$tag$==="svg"),!Dt.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(i=r.$elm$=Dt.document.createElementNS(bn?uS:dS,r.$tag$),bn&&r.$tag$==="foreignObject"&&(bn=!1),Vv(null,r,bn),r.$children$)for(s=0;s<r.$children$.length;++s)o=xu(e,r,s),o&&i.appendChild(o);r.$tag$==="svg"?bn=!1:i.tagName==="foreignObject"&&(bn=!0)}return i["s-hn"]=Jp,i},Kv=(e,t,n,r,s,i)=>{let o=e,a;for(o.shadowRoot&&o.tagName===Jp&&(o=o.shadowRoot);s<=i;++s)r[s]&&(a=xu(null,n,s),a&&(r[s].$elm$=a,lu(o,a,t)))},Gv=(e,t,n)=>{for(let r=t;r<=n;++r){const s=e[r];if(s){const i=s.$elm$;i&&i.remove()}}},kS=(e,t,n,r,s=!1)=>{let i=0,o=0,a=0,c=0,l=t.length-1,u=t[0],d=t[l],h=r.length-1,p=r[0],f=r[h],g,w;for(;i<=l&&o<=h;)if(u==null)u=t[++i];else if(d==null)d=t[--l];else if(p==null)p=r[++o];else if(f==null)f=r[--h];else if(Il(u,p,s))mo(u,p,s),u=t[++i],p=r[++o];else if(Il(d,f,s))mo(d,f,s),d=t[--l],f=r[--h];else if(Il(u,f,s))mo(u,f,s),lu(e,u.$elm$,d.$elm$.nextSibling),u=t[++i],f=r[--h];else if(Il(d,p,s))mo(d,p,s),lu(e,d.$elm$,u.$elm$),d=t[--l],p=r[++o];else{for(a=-1,c=i;c<=l;++c)if(t[c]&&t[c].$key$!==null&&t[c].$key$===p.$key$){a=c;break}a>=0?(w=t[a],w.$tag$!==p.$tag$?g=xu(t&&t[o],n,a):(mo(w,p,s),t[a]=void 0,g=w.$elm$),p=r[++o]):(g=xu(t&&t[o],n,o),p=r[++o]),g&&lu(u.$elm$.parentNode,g,u.$elm$)}i>l?Kv(e,r[h+1]==null?null:r[h+1].$elm$,n,r,o,h):o>h&&Gv(t,i,l)},Il=(e,t,n=!1)=>e.$tag$===t.$tag$?n?(n&&!e.$key$&&t.$key$&&(e.$key$=t.$key$),!0):e.$key$===t.$key$:!1,mo=(e,t,n=!1)=>{const r=t.$elm$=e.$elm$,s=e.$children$,i=t.$children$,o=t.$tag$,a=t.$text$;a===null?(bn=o==="svg"?!0:o==="foreignObject"?!1:bn,Vv(e,t,bn),s!==null&&i!==null?kS(r,s,t,i,n):i!==null?(e.$text$!==null&&(r.textContent=""),Kv(r,null,t,i,0,i.length-1)):!n&&Su.updatable&&s!==null&&Gv(s,0,s.length-1),bn&&o==="svg"&&(bn=!1)):e.$text$!==a&&(r.data=a)},lu=(e,t,n)=>e?.insertBefore(t,n),US=(e,t,n=!1)=>{const r=e.$hostElement$,s=e.$vnode$||gf(null,null),o=OS(t)?t:_S(null,null,t);if(Jp=r.tagName,n&&o.$attrs$)for(const a of Object.keys(o.$attrs$))r.hasAttribute(a)&&!["key","ref","style","class"].includes(a)&&(o.$attrs$[a]=r[a]);o.$tag$=null,o.$flags$|=4,e.$vnode$=o,o.$elm$=s.$elm$=r.shadowRoot||r,mo(s,o,n)},Yv=(e,t)=>{if(t&&!e.$onRenderResolve$&&t["s-p"]){const n=t["s-p"].push(new Promise(r=>e.$onRenderResolve$=()=>{t["s-p"].splice(n-1,1),r()}))}},Xp=(e,t)=>{if(e.$flags$|=16,e.$flags$&4){e.$flags$|=512;return}Yv(e,e.$ancestorComponent$);const n=()=>RS(e,t);if(t){queueMicrotask(()=>{n()});return}return mS(n)},RS=(e,t)=>{const n=e.$hostElement$,r=Qr("scheduleUpdate",e.$cmpMeta$.$tagName$),s=e.$lazyInstance$;if(!s)throw new Error(`Can't render component <${n.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let i;return t?i=Os(s,"componentWillLoad",void 0,n):i=Os(s,"componentWillUpdate",void 0,n),i=Uw(i,()=>Os(s,"componentWillRender",void 0,n)),r(),Uw(i,()=>LS(e,s,t))},Uw=(e,t)=>MS(e)?e.then(t).catch(n=>{console.error(n),t()}):t(),MS=e=>e instanceof Promise||e&&e.then&&typeof e.then=="function",LS=async(e,t,n)=>{var r;const s=e.$hostElement$,i=Qr("update",e.$cmpMeta$.$tagName$),o=s["s-rc"];n&&xS(e);const a=Qr("render",e.$cmpMeta$.$tagName$);BS(e,t,s,n),o&&(o.map(c=>c()),s["s-rc"]=void 0),a(),i();{const c=(r=s["s-p"])!=null?r:[],l=()=>jS(e);c.length===0?l():(Promise.all(c).then(l),e.$flags$|=4,c.length=0)}},BS=(e,t,n,r)=>{try{t=t.render(),e.$flags$&=-17,e.$flags$|=2,US(e,t,r)}catch(s){Uo(s,e.$hostElement$)}return null},jS=e=>{const t=e.$cmpMeta$.$tagName$,n=e.$hostElement$,r=Qr("postUpdate",t),s=e.$lazyInstance$,i=e.$ancestorComponent$;Os(s,"componentDidRender",void 0,n),e.$flags$&64?(Os(s,"componentDidUpdate",void 0,n),r()):(e.$flags$|=64,FS(n),Os(s,"componentDidLoad",void 0,n),r(),e.$onReadyResolve$(n),i||Zv()),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),e.$flags$&512&&Gp(()=>Xp(e,!1)),e.$flags$&=-517},Zv=e=>{Gp(()=>DS(Dt,"appload",{detail:{namespace:aS}}))},Os=(e,t,n,r)=>{if(e&&e[t])try{return e[t](n)}catch(s){Uo(s,r)}},FS=e=>{var t;return e.classList.add((t=Su.hydratedSelectorName)!=null?t:"hydrated")},zS=(e,t)=>ar(e).$instanceValues$.get(t),qd=(e,t,n,r)=>{const s=ar(e);if(!s)return;if(!s)throw new Error(`Couldn't find host element for "${r.$tagName$}" as it is unknown to this Stencil runtime. This usually happens when integrating a 3rd party Stencil component with another Stencil component or application. Please reach out to the maintainers of the 3rd party Stencil component or report this on the Stencil Discord server (https://chat.stenciljs.com) or comment on this similar [GitHub issue](https://github.com/stenciljs/core/issues/5457).`);const i=s.$instanceValues$.get(t),o=s.$flags$,a=s.$lazyInstance$;n=wf(n,r.$members$[t][0]);const c=Number.isNaN(i)&&Number.isNaN(n),l=n!==i&&!c;if((!(o&8)||i===void 0)&&l&&(s.$instanceValues$.set(t,n),a&&(o&18)===2)){if(a.componentShouldUpdate&&a.componentShouldUpdate(n,i,t)===!1)return;Xp(s,!1)}},Jv=(e,t,n)=>{var r,s;const i=e.prototype;if(t.$members$||Su.watchCallback){const o=Object.entries((r=t.$members$)!=null?r:{});if(o.map(([a,[c]])=>{if(c&31||n&2&&c&32){const{get:l,set:u}=Object.getOwnPropertyDescriptor(i,a)||{};l&&(t.$members$[a][0]|=2048),u&&(t.$members$[a][0]|=4096),(n&1||!l)&&Object.defineProperty(i,a,{get(){{if((t.$members$[a][0]&2048)===0)return zS(this,a);const d=ar(this),h=d?d.$lazyInstance$:i;return h?h[a]:void 0}},configurable:!0,enumerable:!0}),Object.defineProperty(i,a,{set(d){const h=ar(this);if(h){if(u){const p=c&32?this[a]:h.$hostElement$[a];typeof p>"u"&&h.$instanceValues$.get(a)?d=h.$instanceValues$.get(a):!h.$instanceValues$.get(a)&&p&&h.$instanceValues$.set(a,p),u.apply(this,[wf(d,c)]),d=c&32?this[a]:h.$hostElement$[a],qd(this,a,d,t);return}{if((n&1)===0||(t.$members$[a][0]&4096)===0){qd(this,a,d,t),n&1&&!h.$lazyInstance$&&h.$onReadyPromise$.then(()=>{t.$members$[a][0]&4096&&h.$lazyInstance$[a]!==h.$instanceValues$.get(a)&&(h.$lazyInstance$[a]=d)});return}const p=()=>{const f=h.$lazyInstance$[a];!h.$instanceValues$.get(a)&&f&&h.$instanceValues$.set(a,f),h.$lazyInstance$[a]=wf(d,c),qd(this,a,h.$lazyInstance$[a],t)};h.$lazyInstance$?p():h.$onReadyPromise$.then(()=>p())}}}})}}),n&1){const a=new Map;i.attributeChangedCallback=function(c,l,u){_t.jmp(()=>{var d;const h=a.get(c);if(this.hasOwnProperty(h)&&Su.lazyLoad)u=this[h],delete this[h];else{if(i.hasOwnProperty(h)&&typeof this[h]=="number"&&this[h]==u)return;if(h==null){const f=ar(this),g=f?.$flags$;if(f&&g&&!(g&8)&&g&128&&u!==l){const w=f.$lazyInstance$,b=(d=t.$watchers$)==null?void 0:d[c];b?.forEach(I=>{w[I]!=null&&w[I].call(w,u,l,c)})}return}}const p=Object.getOwnPropertyDescriptor(i,h);u=u===null&&typeof this[h]=="boolean"?!1:u,u!==this[h]&&(!p.get||p.set)&&(this[h]=u)})},e.observedAttributes=Array.from(new Set([...Object.keys((s=t.$watchers$)!=null?s:{}),...o.filter(([c,l])=>l[0]&31).map(([c,l])=>{const u=l[1]||c;return a.set(u,c),u})]))}}return e},HS=async(e,t,n,r)=>{let s;if((t.$flags$&32)===0){if(t.$flags$|=32,n.$lazyBundleId$){const c=fS(n,t);if(c&&"then"in c){const u=IS();s=await c,u()}else s=c;if(!s)throw new Error(`Constructor for "${n.$tagName$}#${t.$modeName$}" was not found`);s.isProxied||(Jv(s,n,2),s.isProxied=!0);const l=Qr("createInstance",n.$tagName$);t.$flags$|=8;try{new s(t)}catch(u){Uo(u,e)}t.$flags$&=-9,l(),mf(t.$lazyInstance$,e)}else{s=e.constructor;const c=e.localName;customElements.whenDefined(c).then(()=>t.$flags$|=128)}if(s&&s.style){let c;typeof s.style=="string"&&(c=s.style);const l=qv(n);if(!Nu.has(l)){const u=Qr("registerStyles",n.$tagName$);SS(l,c,!!(n.$flags$&1)),u()}}}const i=t.$ancestorComponent$,o=()=>Xp(t,!0);i&&i["s-rc"]?i["s-rc"].push(o):o()},mf=(e,t)=>{Os(e,"connectedCallback",void 0,t)},qS=e=>{if((_t.$flags$&1)===0){const t=ar(e);if(!t)return;const n=t.$cmpMeta$,r=Qr("connectedCallback",n.$tagName$);if(t.$flags$&1)t?.$lazyInstance$?mf(t.$lazyInstance$,e):t?.$onReadyPromise$&&t.$onReadyPromise$.then(()=>mf(t.$lazyInstance$,e));else{t.$flags$|=1;{let s=e;for(;s=s.parentNode||s.host;)if(s["s-p"]){Yv(t,t.$ancestorComponent$=s);break}}n.$members$&&Object.entries(n.$members$).map(([s,[i]])=>{if(i&31&&e.hasOwnProperty(s)){const o=e[s];delete e[s],e[s]=o}}),HS(e,t,n)}r()}},Rw=(e,t)=>{Os(e,"disconnectedCallback",void 0,t||e)},WS=async e=>{if((_t.$flags$&1)===0){const t=ar(e);t?.$lazyInstance$?Rw(t.$lazyInstance$,e):t?.$onReadyPromise$&&t.$onReadyPromise$.then(()=>Rw(t.$lazyInstance$,e))}Ao.has(e)&&Ao.delete(e),e.shadowRoot&&Ao.has(e.shadowRoot)&&Ao.delete(e.shadowRoot)},VS=(e,t={})=>{var n;if(!Dt.document){console.warn("Stencil: No document found. Skipping bootstrapping lazy components.");return}const r=Qr(),s=[],i=t.exclude||[],o=Dt.customElements,a=Dt.document.head,c=a.querySelector("meta[charset]"),l=Dt.document.createElement("style"),u=[];let d,h=!0;Object.assign(_t,t),_t.$resourcesUrl$=new URL(t.resourcesUrl||"./",Dt.document.baseURI).href;let p=!1;if(e.map(f=>{f[1].map(g=>{const w={$flags$:g[0],$tagName$:g[1],$members$:g[2],$listeners$:g[3]};w.$flags$&4&&(p=!0),w.$members$=g[2];const b=w.$tagName$,I=class extends HTMLElement{constructor(y){if(super(y),this.hasRegisteredEventListeners=!1,y=this,hS(y,w),w.$flags$&1){if(!y.shadowRoot)AS.call(y,w);else if(y.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${w.$tagName$}! Mode is set to ${y.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}connectedCallback(){ar(this)&&(this.hasRegisteredEventListeners||(this.hasRegisteredEventListeners=!0),d&&(clearTimeout(d),d=null),h?u.push(this):_t.jmp(()=>qS(this)))}disconnectedCallback(){_t.jmp(()=>WS(this)),_t.raf(()=>{var y;const m=ar(this);if(!m)return;const v=u.findIndex(C=>C===this);v>-1&&u.splice(v,1),((y=m?.$vnode$)==null?void 0:y.$elm$)instanceof Node&&!m.$vnode$.$elm$.isConnected&&delete m.$vnode$.$elm$})}componentOnReady(){var y;return(y=ar(this))==null?void 0:y.$onReadyPromise$}};w.$lazyBundleId$=f[0],!i.includes(b)&&!o.get(b)&&(s.push(b),o.define(b,Jv(I,w,1)))})}),s.length>0&&(p&&(l.textContent+=jv),l.textContent+=s.sort()+pS,l.innerHTML.length)){l.setAttribute("data-styles","");const f=(n=_t.$nonce$)!=null?n:zv(Dt.document);f!=null&&l.setAttribute("nonce",f),a.insertBefore(l,c?c.nextSibling:a.firstChild)}h=!1,u.length?u.map(f=>f.connectedCallback()):_t.jmp(()=>d=setTimeout(Zv,30)),r()};const KS=()=>{},GS=async(e,t)=>{if(!(typeof window>"u"))return await KS(),VS([["connect-modal",[[257,"connect-modal",{defaultProviders:[16,"default-providers"],installedProviders:[16,"installed-providers"],callback:[16],cancelCallback:[16,"cancel-callback"]}]]]],t)};(function(){if(typeof window<"u"&&window.Reflect!==void 0&&window.customElements!==void 0){var e=HTMLElement;window.HTMLElement=function(){return Reflect.construct(e,[],this.constructor)},HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}})();function YS(e){const t=Object.values(e).filter(r=>typeof r=="number"),n=new Set(t);return r=>n.has(r)}const Mw=new Map;function Xv(e,t){const n=Mw.get(e);if(n!==void 0)return n(t);const r=YS(e);return Mw.set(e,r),Xv(e,t)}class Ye{constructor(t){this.consumed=0,this.source=typeof t=="string"?Ve(t):t}readBytes(t){const n=this.source.subarray(this.consumed,this.consumed+t);return this.consumed+=t,n}readUInt32BE(){return YI(this.readBytes(4),0)}readUInt8(){return KI(this.readBytes(1),0)}readUInt16BE(){return WI(this.readBytes(2),0)}readBigUIntLE(t){const n=this.readBytes(t).slice().reverse(),r=we(n);return BigInt(`0x${r}`)}readBigUIntBE(t){const n=this.readBytes(t),r=we(n);return BigInt(`0x${r}`)}get readOffset(){return this.consumed}set readOffset(t){this.consumed=t}get internalBytes(){return this.source}readUInt8Enum(t,n){const r=this.readUInt8();if(Xv(t,r))return r;throw n(r)}}var oc;(function(e){e[e.Mainnet=1]="Mainnet",e[e.Testnet=2147483648]="Testnet"})(oc||(oc={}));var _u;(function(e){e[e.Mainnet=385875968]="Mainnet",e[e.Testnet=4278190080]="Testnet"})(_u||(_u={}));oc.Mainnet;var Si;(function(e){e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet"})(Si||(Si={}));var Ni;(function(e){e[e.MainnetSingleSig=22]="MainnetSingleSig",e[e.MainnetMultiSig=20]="MainnetMultiSig",e[e.TestnetSingleSig=26]="TestnetSingleSig",e[e.TestnetMultiSig=21]="TestnetMultiSig"})(Ni||(Ni={}));Si.Mainnet;const Qv={chainId:oc.Mainnet,transactionVersion:Si.Mainnet,peerNetworkId:_u.Mainnet,magicBytes:"X2",bootAddress:"SP000000000000000000002Q6VF78",addressVersion:{singleSig:Ni.MainnetSingleSig,multiSig:Ni.MainnetMultiSig},client:{baseUrl:jI}},yf={chainId:oc.Testnet,transactionVersion:Si.Testnet,peerNetworkId:_u.Testnet,magicBytes:"T2",bootAddress:"ST000000000000000000002AMW42H",addressVersion:{singleSig:Ni.TestnetSingleSig,multiSig:Ni.TestnetMultiSig},client:{baseUrl:FI}},uu={...yf,addressVersion:{...yf.addressVersion},magicBytes:"id",client:{baseUrl:zI}},ZS={...uu,addressVersion:{...uu.addressVersion},client:{...uu.client}};function JS(e){switch(e){case"mainnet":return Qv;case"testnet":return yf;case"devnet":return uu;case"mocknet":return ZS;default:throw new Error(`Unknown network name: ${e}`)}}function XS(e){return typeof e=="string"?JS(e):e}const QS=128,eN=128,e1=16,bi=32,bf=80,nd=65,tN=32,nN=64,Tu=34,rN=1+16*1024*1024,sN=165,iN=16,oN=16,aN=20,cN=oN+2+aN,lN=cN+4,uN=rN+(sN+iN*lN);var Me;(function(e){e[e.TokenTransfer=0]="TokenTransfer",e[e.SmartContract=1]="SmartContract",e[e.VersionedSmartContract=6]="VersionedSmartContract",e[e.ContractCall=2]="ContractCall",e[e.PoisonMicroblock=3]="PoisonMicroblock",e[e.Coinbase=4]="Coinbase",e[e.CoinbaseToAltRecipient=5]="CoinbaseToAltRecipient",e[e.TenureChange=7]="TenureChange",e[e.NakamotoCoinbase=8]="NakamotoCoinbase"})(Me||(Me={}));var vf;(function(e){e[e.Clarity1=1]="Clarity1",e[e.Clarity2=2]="Clarity2",e[e.Clarity3=3]="Clarity3",e[e.Clarity4=4]="Clarity4"})(vf||(vf={}));var mn;(function(e){e[e.OnChainOnly=1]="OnChainOnly",e[e.OffChainOnly=2]="OffChainOnly",e[e.Any=3]="Any"})(mn||(mn={}));const Wd=["onChainOnly","offChainOnly","any"];Wd[0]+"",mn.OnChainOnly,Wd[1]+"",mn.OffChainOnly,Wd[2]+"",mn.Any,mn.OnChainOnly+"",mn.OnChainOnly,mn.OffChainOnly+"",mn.OffChainOnly,mn.Any+"",mn.Any;var xi;(function(e){e[e.Allow=1]="Allow",e[e.Deny=2]="Deny"})(xi||(xi={}));var Tt;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(Tt||(Tt={}));var st;(function(e){e[e.Standard=4]="Standard",e[e.Sponsored=5]="Sponsored"})(st||(st={}));var We;(function(e){e[e.P2PKH=0]="P2PKH",e[e.P2SH=1]="P2SH",e[e.P2WPKH=2]="P2WPKH",e[e.P2WSH=3]="P2WSH",e[e.P2SHNonSequential=5]="P2SHNonSequential",e[e.P2WSHNonSequential=7]="P2WSHNonSequential"})(We||(We={}));var rt;(function(e){e[e.Compressed=0]="Compressed",e[e.Uncompressed=1]="Uncompressed"})(rt||(rt={}));var Ou;(function(e){e[e.Equal=1]="Equal",e[e.Greater=2]="Greater",e[e.GreaterEqual=3]="GreaterEqual",e[e.Less=4]="Less",e[e.LessEqual=5]="LessEqual"})(Ou||(Ou={}));var Ef;(function(e){e[e.Sends=16]="Sends",e[e.DoesNotSend=17]="DoesNotSend"})(Ef||(Ef={}));var Sn;(function(e){e[e.Origin=1]="Origin",e[e.Standard=2]="Standard",e[e.Contract=3]="Contract"})(Sn||(Sn={}));var Lw;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(Lw||(Lw={}));var Cf;(function(e){e[e.BlockFound=0]="BlockFound",e[e.Extended=1]="Extended"})(Cf||(Cf={}));var tr;(function(e){e[e.PublicKeyCompressed=0]="PublicKeyCompressed",e[e.PublicKeyUncompressed=1]="PublicKeyUncompressed",e[e.SignatureCompressed=2]="SignatureCompressed",e[e.SignatureUncompressed=3]="SignatureUncompressed"})(tr||(tr={}));var Bw;(function(e){e.Serialization="Serialization",e.Deserialization="Deserialization",e.SignatureValidation="SignatureValidation",e.FeeTooLow="FeeTooLow",e.BadNonce="BadNonce",e.NotEnoughFunds="NotEnoughFunds",e.NoSuchContract="NoSuchContract",e.NoSuchPublicFunction="NoSuchPublicFunction",e.BadFunctionArgument="BadFunctionArgument",e.ContractAlreadyExists="ContractAlreadyExists",e.PoisonMicroblocksDoNotConflict="PoisonMicroblocksDoNotConflict",e.PoisonMicroblockHasUnknownPubKeyHash="PoisonMicroblockHasUnknownPubKeyHash",e.PoisonMicroblockIsInvalid="PoisonMicroblockIsInvalid",e.BadAddressVersionByte="BadAddressVersionByte",e.NoCoinbaseViaMempool="NoCoinbaseViaMempool",e.ServerFailureNoSuchChainTip="ServerFailureNoSuchChainTip",e.ServerFailureDatabase="ServerFailureDatabase",e.ServerFailureOther="ServerFailureOther"})(Bw||(Bw={}));let rd=class extends Error{constructor(t){super(t),this.message=t,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},Io=class extends rd{constructor(t){super(t)}};class An extends rd{constructor(t){super(t)}}class Du extends rd{constructor(t){super(t)}}class ui extends rd{constructor(t){super(t)}}function Af(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function dN(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function t1(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function hN(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Af(e.outputLen),Af(e.blockLen)}function fN(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function pN(e,t){t1(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const di={number:Af,bool:dN,bytes:t1,hash:hN,exists:fN,output:pN};const Vd=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),dr=(e,t)=>e<<32-t|e>>>t,gN=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!gN)throw new Error("Non little-endian hardware is not supported");Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function wN(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function Qp(e){if(typeof e=="string"&&(e=wN(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}let n1=class{clone(){return this._cloneInto()}};function Ui(e){const t=r=>e().update(Qp(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class r1 extends n1{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,di.hash(t);const r=Qp(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?t.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(t){return di.exists(this),this.iHash.update(t),this}digestInto(t){di.exists(this),di.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const s1=(e,t,n)=>new r1(e,t).update(n).digest();s1.create=(e,t)=>new r1(e,t);function mN(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}class eg extends n1{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Vd(this.buffer)}update(t){di.exists(this);const{view:n,buffer:r,blockLen:s}=this;t=Qp(t);const i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Vd(t);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){di.exists(this),di.output(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;mN(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Vd(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.length=s,t.pos=a,t.finished=i,t.destroyed=o,s%n&&t.buffer.set(r),t}}const yN=(e,t,n)=>e&t^~e&n,bN=(e,t,n)=>e&t^e&n^t&n,vN=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ss=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),is=new Uint32Array(64);class i1 extends eg{constructor(){super(64,32,8,!1),this.A=ss[0]|0,this.B=ss[1]|0,this.C=ss[2]|0,this.D=ss[3]|0,this.E=ss[4]|0,this.F=ss[5]|0,this.G=ss[6]|0,this.H=ss[7]|0}get(){const{A:t,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[t,n,r,s,i,o,a,c]}set(t,n,r,s,i,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)is[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=is[d-15],p=is[d-2],f=dr(h,7)^dr(h,18)^h>>>3,g=dr(p,17)^dr(p,19)^p>>>10;is[d]=g+is[d-7]+f+is[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=dr(a,6)^dr(a,11)^dr(a,25),p=u+h+yN(a,c,l)+vN[d]+is[d]|0,g=(dr(r,2)^dr(r,13)^dr(r,22))+bN(r,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=r,r=p+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){is.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class EN extends i1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const tg=Ui(()=>new i1);Ui(()=>new EN);const CN={},AN=Object.freeze(Object.defineProperty({__proto__:null,default:CN},Symbol.toStringTag,{value:"Module"}));const xe=BigInt(0),tt=BigInt(1),Ss=BigInt(2),za=BigInt(3),jw=BigInt(8),ct=Object.freeze({a:xe,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:tt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Fw=(e,t)=>(e+t/Ss)/t,Sl={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){const{n:t}=ct,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-tt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=Fw(i*e,t),c=Fw(-r*e,t);let l=re(e-a*n-c*s,t),u=re(-a*r-c*i,t);const d=l>o,h=u>o;if(d&&(l=t-l),h&&(u=t-u),l>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:d,k1:l,k2neg:h,k2:u}}},sr=32,Ro=32,IN=32,zw=sr+1,Hw=2*sr+1;function qw(e){const{a:t,b:n}=ct,r=re(e*e),s=re(r*e);return re(s+t*e+n)}const Nl=ct.a===xe;class o1 extends Error{constructor(t){super(t)}}function Ww(e){if(!(e instanceof Ue))throw new TypeError("JacobianPoint expected")}class Ue{constructor(t,n,r){this.x=t,this.y=n,this.z=r}static fromAffine(t){if(!(t instanceof Ge))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(Ge.ZERO)?Ue.ZERO:new Ue(t.x,t.y,tt)}static toAffineBatch(t){const n=TN(t.map(r=>r.z));return t.map((r,s)=>r.toAffine(n[s]))}static normalizeZ(t){return Ue.toAffineBatch(t).map(Ue.fromAffine)}equals(t){Ww(t);const{x:n,y:r,z:s}=this,{x:i,y:o,z:a}=t,c=re(s*s),l=re(a*a),u=re(n*l),d=re(i*c),h=re(re(r*a)*l),p=re(re(o*s)*c);return u===d&&h===p}negate(){return new Ue(this.x,re(-this.y),this.z)}double(){const{x:t,y:n,z:r}=this,s=re(t*t),i=re(n*n),o=re(i*i),a=t+i,c=re(Ss*(re(a*a)-s-o)),l=re(za*s),u=re(l*l),d=re(u-Ss*c),h=re(l*(c-d)-jw*o),p=re(Ss*n*r);return new Ue(d,h,p)}add(t){Ww(t);const{x:n,y:r,z:s}=this,{x:i,y:o,z:a}=t;if(i===xe||o===xe)return this;if(n===xe||r===xe)return t;const c=re(s*s),l=re(a*a),u=re(n*l),d=re(i*c),h=re(re(r*a)*l),p=re(re(o*s)*c),f=re(d-u),g=re(p-h);if(f===xe)return g===xe?this.double():Ue.ZERO;const w=re(f*f),b=re(f*w),I=re(u*w),y=re(g*g-b-Ss*I),m=re(g*(I-y)-h*b),v=re(s*a*f);return new Ue(y,m,v)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){const n=Ue.ZERO;if(typeof t=="bigint"&&t===xe)return n;let r=Gw(t);if(r===tt)return this;if(!Nl){let d=n,h=this;for(;r>xe;)r&tt&&(d=d.add(h)),h=h.double(),r>>=tt;return d}let{k1neg:s,k1:i,k2neg:o,k2:a}=Sl.splitScalar(r),c=n,l=n,u=this;for(;i>xe||a>xe;)i&tt&&(c=c.add(u)),a&tt&&(l=l.add(u)),u=u.double(),i>>=tt,a>>=tt;return s&&(c=c.negate()),o&&(l=l.negate()),l=new Ue(re(l.x*Sl.beta),l.y,l.z),c.add(l)}precomputeWindow(t){const n=Nl?128/t+1:256/t+1,r=[];let s=this,i=s;for(let o=0;o<n;o++){i=s,r.push(i);for(let a=1;a<2**(t-1);a++)i=i.add(s),r.push(i);s=i.double()}return r}wNAF(t,n){!n&&this.equals(Ue.BASE)&&(n=Ge.BASE);const r=n&&n._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=n&&If.get(n);s||(s=this.precomputeWindow(r),n&&r!==1&&(s=Ue.normalizeZ(s),If.set(n,s)));let i=Ue.ZERO,o=Ue.BASE;const a=1+(Nl?128/r:256/r),c=2**(r-1),l=BigInt(2**r-1),u=2**r,d=BigInt(r);for(let h=0;h<a;h++){const p=h*c;let f=Number(t&l);t>>=d,f>c&&(f-=u,t+=tt);const g=p,w=p+Math.abs(f)-1,b=h%2!==0,I=f<0;f===0?o=o.add(xl(b,s[g])):i=i.add(xl(I,s[w]))}return{p:i,f:o}}multiply(t,n){let r=Gw(t),s,i;if(Nl){const{k1neg:o,k1:a,k2neg:c,k2:l}=Sl.splitScalar(r);let{p:u,f:d}=this.wNAF(a,n),{p:h,f:p}=this.wNAF(l,n);u=xl(o,u),h=xl(c,h),h=new Ue(re(h.x*Sl.beta),h.y,h.z),s=u.add(h),i=d.add(p)}else{const{p:o,f:a}=this.wNAF(r,n);s=o,i=a}return Ue.normalizeZ([s,i])[0]}toAffine(t){const{x:n,y:r,z:s}=this,i=this.equals(Ue.ZERO);t==null&&(t=i?jw:Gc(s));const o=t,a=re(o*o),c=re(a*o),l=re(n*a),u=re(r*c),d=re(s*o);if(i)return Ge.ZERO;if(d!==tt)throw new Error("invZ was invalid");return new Ge(l,u)}}Ue.BASE=new Ue(ct.Gx,ct.Gy,tt);Ue.ZERO=new Ue(xe,tt,xe);function xl(e,t){const n=t.negate();return e?n:t}const If=new WeakMap;class Ge{constructor(t,n){this.x=t,this.y=n}_setWindowSize(t){this._WINDOW_SIZE=t,If.delete(this)}hasEvenY(){return this.y%Ss===xe}static fromCompressedHex(t){const n=t.length===32,r=Ds(n?t:t.subarray(1));if(!Kd(r))throw new Error("Point is not on curve");const s=qw(r);let i=_N(s);const o=(i&tt)===tt;n?o&&(i=re(-i)):(t[0]&1)===1!==o&&(i=re(-i));const a=new Ge(r,i);return a.assertValidity(),a}static fromUncompressedHex(t){const n=Ds(t.subarray(1,sr+1)),r=Ds(t.subarray(sr+1,sr*2+1)),s=new Ge(n,r);return s.assertValidity(),s}static fromHex(t){const n=ac(t),r=n.length,s=n[0];if(r===sr)return this.fromCompressedHex(n);if(r===zw&&(s===2||s===3))return this.fromCompressedHex(n);if(r===Hw&&s===4)return this.fromUncompressedHex(n);throw new Error(`Point.fromHex: received invalid point. Expected 32-${zw} compressed bytes or ${Hw} uncompressed bytes, not ${r}`)}static fromPrivateKey(t){return Ge.BASE.multiply($u(t))}static fromSignature(t,n,r){const{r:s,s:i}=$N(n);if(![0,1,2,3].includes(r))throw new Error("Cannot recover: invalid recovery bit");const o=a1(ac(t)),{n:a}=ct,c=r===2||r===3?s+a:s,l=Gc(c,a),u=re(-o*l,a),d=re(i*l,a),h=r&1?"03":"02",p=Ge.fromHex(h+Oo(c)),f=Ge.BASE.multiplyAndAddUnsafe(p,u,d);if(!f)throw new Error("Cannot recover signature: point at infinify");return f.assertValidity(),f}toRawBytes(t=!1){return vi(this.toHex(t))}toHex(t=!1){const n=Oo(this.x);return t?`${this.hasEvenY()?"02":"03"}${n}`:`04${n}${Oo(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const t="Point is not on elliptic curve",{x:n,y:r}=this;if(!Kd(n)||!Kd(r))throw new Error(t);const s=re(r*r),i=qw(n);if(re(s-i)!==xe)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new Ge(this.x,re(-this.y))}double(){return Ue.fromAffine(this).double().toAffine()}add(t){return Ue.fromAffine(this).add(Ue.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return Ue.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,n,r){const s=Ue.fromAffine(this),i=n===xe||n===tt||this!==Ge.BASE?s.multiplyUnsafe(n):s.multiply(n),o=Ue.fromAffine(t).multiplyUnsafe(r),a=i.add(o);return a.equals(Ue.ZERO)?void 0:a.toAffine()}}Ge.BASE=new Ge(ct.Gx,ct.Gy);Ge.ZERO=new Ge(xe,xe);function Vw(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Kw(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${Mo(e)}`);const t=e[1],n=e.subarray(2,t+2);if(!t||n.length!==t)throw new Error("Invalid signature integer: wrong length");if(n[0]===0&&n[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ds(n),left:e.subarray(t+2)}}function SN(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${Mo(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:n}=Kw(e.subarray(2)),{data:r,left:s}=Kw(n);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${Mo(s)}`);return{r:t,s:r}}class Sr{constructor(t,n){this.r=t,this.s=n,this.assertValidity()}static fromCompact(t){const n=t instanceof Uint8Array,r="Signature.fromCompact";if(typeof t!="string"&&!n)throw new TypeError(`${r}: Expected string or Uint8Array`);const s=n?Mo(t):t;if(s.length!==128)throw new Error(`${r}: Expected 64-byte hex`);return new Sr(Pu(s.slice(0,64)),Pu(s.slice(64,128)))}static fromDER(t){const n=t instanceof Uint8Array;if(typeof t!="string"&&!n)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r,s}=SN(n?t:vi(t));return new Sr(r,s)}static fromHex(t){return this.fromDER(t)}assertValidity(){const{r:t,s:n}=this;if(!cc(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!cc(n))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const t=ct.n>>tt;return this.s>t}normalizeS(){return this.hasHighS()?new Sr(this.r,re(-this.s,ct.n)):this}toDERRawBytes(){return vi(this.toDERHex())}toDERHex(){const t=Vw(pa(this.s)),n=Vw(pa(this.r)),r=t.length/2,s=n.length/2,i=pa(r),o=pa(s);return`30${pa(s+r+4)}02${o}${n}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return vi(this.toCompactHex())}toCompactHex(){return Oo(this.r)+Oo(this.s)}}function Cs(...e){if(!e.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];const t=e.reduce((r,s)=>r+s.length,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}const NN=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Mo(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let n=0;n<e.length;n++)t+=NN[e[n]];return t}const xN=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Oo(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(xe<=e&&e<xN))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function Sf(e){const t=vi(Oo(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function pa(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function Pu(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function vi(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=n*2,s=e.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function Ds(e){return Pu(Mo(e))}function ac(e){return e instanceof Uint8Array?Uint8Array.from(e):vi(e)}function Gw(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&cc(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function re(e,t=ct.P){const n=e%t;return n>=xe?n:t+n}function On(e,t){const{P:n}=ct;let r=e;for(;t-- >xe;)r*=r,r%=n;return r}function _N(e){const{P:t}=ct,n=BigInt(6),r=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),c=e*e*e%t,l=c*c*e%t,u=On(l,za)*l%t,d=On(u,za)*l%t,h=On(d,Ss)*c%t,p=On(h,r)*h%t,f=On(p,s)*p%t,g=On(f,o)*f%t,w=On(g,a)*g%t,b=On(w,o)*f%t,I=On(b,za)*l%t,y=On(I,i)*p%t,m=On(y,n)*c%t,v=On(m,Ss);if(v*v%t!==e)throw new Error("Cannot find square root");return v}function Gc(e,t=ct.P){if(e===xe||t<=xe)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=re(e,t),r=t,s=xe,i=tt;for(;n!==xe;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==tt)throw new Error("invert: does not exist");return re(s,t)}function TN(e,t=ct.P){const n=new Array(e.length),r=e.reduce((i,o,a)=>o===xe?i:(n[a]=i,re(i*o,t)),tt),s=Gc(r,t);return e.reduceRight((i,o,a)=>o===xe?i:(n[a]=re(i*n[a],t),re(i*o,t)),s),n}function ON(e){const t=e.length*8-Ro*8,n=Ds(e);return t>0?n>>BigInt(t):n}function a1(e,t=!1){const n=ON(e);if(t)return n;const{n:r}=ct;return n>=r?n-r:n}let Do,Ha;class DN{constructor(t,n){if(this.hashLen=t,this.qByteLen=n,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof n!="number"||n<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return Ns.hmacSha256(this.k,...t)}hmacSync(...t){return Ha(this.k,...t)}checkSync(){if(typeof Ha!="function")throw new o1("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0;const n=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);const r=this.v.slice();n.push(r),t+=this.v.length}return Cs(...n)}generateSync(){this.checkSync(),this.incr();let t=0;const n=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);const r=this.v.slice();n.push(r),t+=this.v.length}return Cs(...n)}}function cc(e){return xe<e&&e<ct.n}function Kd(e){return xe<e&&e<ct.P}function PN(e,t,n,r=!0){const{n:s}=ct,i=a1(e,!0);if(!cc(i))return;const o=Gc(i,s),a=Ge.BASE.multiply(i),c=re(a.x,s);if(c===xe)return;const l=re(o*re(t+n*c,s),s);if(l===xe)return;let u=new Sr(c,l),d=(a.x===u.r?0:2)|Number(a.y&tt);return r&&u.hasHighS()&&(u=u.normalizeS(),d^=1),{sig:u,recovery:d}}function $u(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*Ro)throw new Error("Expected 32 bytes of private key");t=Pu(e)}else if(e instanceof Uint8Array){if(e.length!==Ro)throw new Error("Expected 32 bytes of private key");t=Ds(e)}else throw new TypeError("Expected valid private key");if(!cc(t))throw new Error("Expected private key: 0 < key < n");return t}function $N(e){if(e instanceof Sr)return e.assertValidity(),e;try{return Sr.fromDER(e)}catch{return Sr.fromCompact(e)}}function kN(e,t=!1){return Ge.fromPrivateKey(e).toRawBytes(t)}function c1(e){const t=e.length>sr?e.slice(0,sr):e;return Ds(t)}function UN(e){const t=c1(e),n=re(t,ct.n);return l1(n<xe?t:n)}function l1(e){return Sf(e)}function RN(e,t,n){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);const r=ac(e),s=$u(t),i=[l1(s),UN(r)];if(n!=null){n===!0&&(n=Ns.randomBytes(sr));const c=ac(n);if(c.length!==sr)throw new Error(`sign: Expected ${sr} bytes of extra data`);i.push(c)}const o=Cs(...i),a=c1(r);return{seed:o,m:a,d:s}}function MN(e,t){const{sig:n,recovery:r}=e,{der:s,recovered:i}=Object.assign({canonical:!0,der:!0},t),o=s?n.toDERRawBytes():n.toCompactRawBytes();return i?[o,r]:o}function LN(e,t,n={}){const{seed:r,m:s,d:i}=RN(e,t,n.extraEntropy),o=new DN(IN,Ro);o.reseedSync(r);let a;for(;!(a=PN(o.generateSync(),s,i,n.canonical));)o.reseedSync();return MN(a,n)}Ge.BASE._setWindowSize(8);const fn={node:AN,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},_l={},Ns={bytesToHex:Mo,hexToBytes:vi,concatBytes:Cs,mod:re,invert:Gc,isValidPrivateKey(e){try{return $u(e),!0}catch{return!1}},_bigintTo32Bytes:Sf,_normalizePrivateKey:$u,hashToPrivateKey:e=>{e=ac(e);const t=Ro+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");const n=re(Ds(e),ct.n-tt)+tt;return Sf(n)},randomBytes:(e=32)=>{if(fn.web)return fn.web.getRandomValues(new Uint8Array(e));if(fn.node){const{randomBytes:t}=fn.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Ns.hashToPrivateKey(Ns.randomBytes(Ro+8)),precompute(e=8,t=Ge.BASE){const n=t===Ge.BASE?t:new Ge(t.x,t.y);return n._setWindowSize(e),n.multiply(za),n},sha256:async(...e)=>{if(fn.web){const t=await fn.web.subtle.digest("SHA-256",Cs(...e));return new Uint8Array(t)}else if(fn.node){const{createHash:t}=fn.node,n=t("sha256");return e.forEach(r=>n.update(r)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(fn.web){const n=await fn.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=Cs(...t),s=await fn.web.subtle.sign("HMAC",n,r);return new Uint8Array(s)}else if(fn.node){const{createHmac:n}=fn.node,r=n("sha256",e);return t.forEach(s=>r.update(s)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let n=_l[e];if(n===void 0){const r=await Ns.sha256(Uint8Array.from(e,s=>s.charCodeAt(0)));n=Cs(r,r),_l[e]=n}return Ns.sha256(n,...t)},taggedHashSync:(e,...t)=>{if(typeof Do!="function")throw new o1("sha256Sync is undefined, you need to set it");let n=_l[e];if(n===void 0){const r=Do(Uint8Array.from(e,s=>s.charCodeAt(0)));n=Cs(r,r),_l[e]=n}return Do(n,...t)},_JacobianPoint:Ue};Object.defineProperties(Ns,{sha256Sync:{configurable:!1,get(){return Do},set(e){Do||(Do=e)}},hmacSha256Sync:{configurable:!1,get(){return Ha},set(e){Ha||(Ha=e)}}});var zt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function BN(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var Gd={},Yd={},Zd={},ga={},Yw;function jN(){return Yw||(Yw=1,Object.defineProperty(ga,"__esModule",{value:!0}),ga.crypto=void 0,ga.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0}),ga}var Zw;function Jo(){return Zw||(Zw=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=jN(),n=m=>new Uint8Array(m.buffer,m.byteOffset,m.byteLength);e.u8=n;const r=m=>new Uint32Array(m.buffer,m.byteOffset,Math.floor(m.byteLength/4));e.u32=r;const s=m=>new DataView(m.buffer,m.byteOffset,m.byteLength);e.createView=s;const i=(m,v)=>m<<32-v|m>>>v;if(e.rotr=i,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const o=Array.from({length:256},(m,v)=>v.toString(16).padStart(2,"0"));function a(m){if(!(m instanceof Uint8Array))throw new Error("Uint8Array expected");let v="";for(let C=0;C<m.length;C++)v+=o[m[C]];return v}e.bytesToHex=a;function c(m){if(typeof m!="string")throw new TypeError("hexToBytes: expected string, got "+typeof m);if(m.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const v=new Uint8Array(m.length/2);for(let C=0;C<v.length;C++){const O=C*2,D=m.slice(O,O+2),S=Number.parseInt(D,16);if(Number.isNaN(S)||S<0)throw new Error("Invalid byte sequence");v[C]=S}return v}e.hexToBytes=c;const l=async()=>{};e.nextTick=l;async function u(m,v,C){let O=Date.now();for(let D=0;D<m;D++){C(D);const S=Date.now()-O;S>=0&&S<v||(await(0,e.nextTick)(),O+=S)}}e.asyncLoop=u;function d(m){if(typeof m!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof m}`);return new TextEncoder().encode(m)}e.utf8ToBytes=d;function h(m){if(typeof m=="string"&&(m=d(m)),!(m instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof m})`);return m}e.toBytes=h;function p(...m){if(!m.every(O=>O instanceof Uint8Array))throw new Error("Uint8Array list expected");if(m.length===1)return m[0];const v=m.reduce((O,D)=>O+D.length,0),C=new Uint8Array(v);for(let O=0,D=0;O<m.length;O++){const S=m[O];C.set(S,D),D+=S.length}return C}e.concatBytes=p;class f{clone(){return this._cloneInto()}}e.Hash=f;const g=m=>Object.prototype.toString.call(m)==="[object Object]"&&m.constructor===Object;function w(m,v){if(v!==void 0&&(typeof v!="object"||!g(v)))throw new TypeError("Options should be object or undefined");return Object.assign(m,v)}e.checkOpts=w;function b(m){const v=O=>m().update(h(O)).digest(),C=m();return v.outputLen=C.outputLen,v.blockLen=C.blockLen,v.create=()=>m(),v}e.wrapConstructor=b;function I(m){const v=(O,D)=>m(D).update(h(O)).digest(),C=m({});return v.outputLen=C.outputLen,v.blockLen=C.blockLen,v.create=O=>m(O),v}e.wrapConstructorWithOpts=I;function y(m=32){if(t.crypto.web)return t.crypto.web.getRandomValues(new Uint8Array(m));if(t.crypto.node)return new Uint8Array(t.crypto.node.randomBytes(m).buffer);throw new Error("The environment doesn't have randomBytes function")}e.randomBytes=y})(Zd)),Zd}var Jw;function u1(){return Jw||(Jw=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.c32decode=e.c32normalize=e.c32encode=e.c32=void 0;const t=Jo();e.c32="0123456789ABCDEFGHJKMNPQRSTVWXYZ";const n="0123456789abcdef";function r(o,a){if(!o.match(/^[0-9a-fA-F]*$/))throw new Error("Not a hex-encoded string");o.length%2!==0&&(o=`0${o}`),o=o.toLowerCase();let c=[],l=0;for(let p=o.length-1;p>=0;p--)if(l<4){const f=n.indexOf(o[p])>>l;let g=0;p!==0&&(g=n.indexOf(o[p-1]));const w=1+l,b=g%(1<<w)<<5-w,I=e.c32[f+b];l=w,c.unshift(I)}else l=0;let u=0;for(let p=0;p<c.length&&c[p]==="0";p++)u++;c=c.slice(u);const d=new TextDecoder().decode((0,t.hexToBytes)(o)).match(/^\u0000*/),h=d?d[0].length:0;for(let p=0;p<h;p++)c.unshift(e.c32[0]);if(a){const p=a-c.length;for(let f=0;f<p;f++)c.unshift(e.c32[0])}return c.join("")}e.c32encode=r;function s(o){return o.toUpperCase().replace(/O/g,"0").replace(/L|I/g,"1")}e.c32normalize=s;function i(o,a){if(o=s(o),!o.match(`^[${e.c32}]*$`))throw new Error("Not a c32-encoded string");const c=o.match(`^${e.c32[0]}*`),l=c?c[0].length:0;let u=[],d=0,h=0;for(let g=o.length-1;g>=0;g--){h===4&&(u.unshift(n[d]),h=0,d=0);const b=(e.c32.indexOf(o[g])<<h)+d,I=n[b%16];if(h+=1,d=b>>4,d>1<<h)throw new Error("Panic error in decoding.");u.unshift(I)}u.unshift(n[d]),u.length%2===1&&u.unshift("0");let p=0;for(let g=0;g<u.length&&u[g]==="0";g++)p++;u=u.slice(p-p%2);let f=u.join("");for(let g=0;g<l;g++)f=`00${f}`;if(a){const g=a*2-f.length;for(let w=0;w<g;w+=2)f=`00${f}`}return f}e.c32decode=i})(Yd)),Yd}var Vs={},Ks={},wa={},Rt={},Xw;function FN(){if(Xw)return Rt;Xw=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.output=Rt.exists=Rt.hash=Rt.bytes=Rt.bool=Rt.number=void 0;function e(a){if(!Number.isSafeInteger(a)||a<0)throw new Error(`Wrong positive integer: ${a}`)}Rt.number=e;function t(a){if(typeof a!="boolean")throw new Error(`Expected boolean, not ${a}`)}Rt.bool=t;function n(a,...c){if(!(a instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(c.length>0&&!c.includes(a.length))throw new TypeError(`Expected Uint8Array of length ${c}, not of length=${a.length}`)}Rt.bytes=n;function r(a){if(typeof a!="function"||typeof a.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");e(a.outputLen),e(a.blockLen)}Rt.hash=r;function s(a,c=!0){if(a.destroyed)throw new Error("Hash instance has been destroyed");if(c&&a.finished)throw new Error("Hash#digest() has already been called")}Rt.exists=s;function i(a,c){n(a);const l=c.outputLen;if(a.length<l)throw new Error(`digestInto() expects output buffer of length at least ${l}`)}Rt.output=i;const o={number:e,bool:t,bytes:n,hash:r,exists:s,output:i};return Rt.default=o,Rt}var Qw;function zN(){if(Qw)return wa;Qw=1,Object.defineProperty(wa,"__esModule",{value:!0}),wa.SHA2=void 0;const e=FN(),t=Jo();function n(s,i,o,a){if(typeof s.setBigUint64=="function")return s.setBigUint64(i,o,a);const c=BigInt(32),l=BigInt(4294967295),u=Number(o>>c&l),d=Number(o&l),h=a?4:0,p=a?0:4;s.setUint32(i+h,u,a),s.setUint32(i+p,d,a)}class r extends t.Hash{constructor(i,o,a,c){super(),this.blockLen=i,this.outputLen=o,this.padOffset=a,this.isLE=c,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(i),this.view=(0,t.createView)(this.buffer)}update(i){e.default.exists(this);const{view:o,buffer:a,blockLen:c}=this;i=(0,t.toBytes)(i);const l=i.length;for(let u=0;u<l;){const d=Math.min(c-this.pos,l-u);if(d===c){const h=(0,t.createView)(i);for(;c<=l-u;u+=c)this.process(h,u);continue}a.set(i.subarray(u,u+d),this.pos),this.pos+=d,u+=d,this.pos===c&&(this.process(o,0),this.pos=0)}return this.length+=i.length,this.roundClean(),this}digestInto(i){e.default.exists(this),e.default.output(i,this),this.finished=!0;const{buffer:o,view:a,blockLen:c,isLE:l}=this;let{pos:u}=this;o[u++]=128,this.buffer.subarray(u).fill(0),this.padOffset>c-u&&(this.process(a,0),u=0);for(let g=u;g<c;g++)o[g]=0;n(a,c-8,BigInt(this.length*8),l),this.process(a,0);const d=(0,t.createView)(i),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const p=h/4,f=this.get();if(p>f.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<p;g++)d.setUint32(4*g,f[g],l)}digest(){const{buffer:i,outputLen:o}=this;this.digestInto(i);const a=i.slice(0,o);return this.destroy(),a}_cloneInto(i){i||(i=new this.constructor),i.set(...this.get());const{blockLen:o,buffer:a,length:c,finished:l,destroyed:u,pos:d}=this;return i.length=c,i.pos=d,i.finished=l,i.destroyed=u,c%o&&i.buffer.set(a),i}}return wa.SHA2=r,wa}var e0;function d1(){if(e0)return Ks;e0=1,Object.defineProperty(Ks,"__esModule",{value:!0}),Ks.sha224=Ks.sha256=void 0;const e=zN(),t=Jo(),n=(l,u,d)=>l&u^~l&d,r=(l,u,d)=>l&u^l&d^u&d,s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),i=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),o=new Uint32Array(64);class a extends e.SHA2{constructor(){super(64,32,8,!1),this.A=i[0]|0,this.B=i[1]|0,this.C=i[2]|0,this.D=i[3]|0,this.E=i[4]|0,this.F=i[5]|0,this.G=i[6]|0,this.H=i[7]|0}get(){const{A:u,B:d,C:h,D:p,E:f,F:g,G:w,H:b}=this;return[u,d,h,p,f,g,w,b]}set(u,d,h,p,f,g,w,b){this.A=u|0,this.B=d|0,this.C=h|0,this.D=p|0,this.E=f|0,this.F=g|0,this.G=w|0,this.H=b|0}process(u,d){for(let m=0;m<16;m++,d+=4)o[m]=u.getUint32(d,!1);for(let m=16;m<64;m++){const v=o[m-15],C=o[m-2],O=(0,t.rotr)(v,7)^(0,t.rotr)(v,18)^v>>>3,D=(0,t.rotr)(C,17)^(0,t.rotr)(C,19)^C>>>10;o[m]=D+o[m-7]+O+o[m-16]|0}let{A:h,B:p,C:f,D:g,E:w,F:b,G:I,H:y}=this;for(let m=0;m<64;m++){const v=(0,t.rotr)(w,6)^(0,t.rotr)(w,11)^(0,t.rotr)(w,25),C=y+v+n(w,b,I)+s[m]+o[m]|0,D=((0,t.rotr)(h,2)^(0,t.rotr)(h,13)^(0,t.rotr)(h,22))+r(h,p,f)|0;y=I,I=b,b=w,w=g+C|0,g=f,f=p,p=h,h=C+D|0}h=h+this.A|0,p=p+this.B|0,f=f+this.C|0,g=g+this.D|0,w=w+this.E|0,b=b+this.F|0,I=I+this.G|0,y=y+this.H|0,this.set(h,p,f,g,w,b,I,y)}roundClean(){o.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class c extends a{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}return Ks.sha256=(0,t.wrapConstructor)(()=>new a),Ks.sha224=(0,t.wrapConstructor)(()=>new c),Ks}var t0;function h1(){if(t0)return Vs;t0=1,Object.defineProperty(Vs,"__esModule",{value:!0}),Vs.c32checkDecode=Vs.c32checkEncode=void 0;const e=d1(),t=Jo(),n=u1();function r(o){const a=(0,e.sha256)((0,e.sha256)((0,t.hexToBytes)(o)));return(0,t.bytesToHex)(a.slice(0,4))}function s(o,a){if(o<0||o>=32)throw new Error("Invalid version (must be between 0 and 31)");if(!a.match(/^[0-9a-fA-F]*$/))throw new Error("Invalid data (not a hex string)");a=a.toLowerCase(),a.length%2!==0&&(a=`0${a}`);let c=o.toString(16);c.length===1&&(c=`0${c}`);const l=r(`${c}${a}`),u=(0,n.c32encode)(`${a}${l}`);return`${n.c32[o]}${u}`}Vs.c32checkEncode=s;function i(o){o=(0,n.c32normalize)(o);const a=(0,n.c32decode)(o.slice(1)),c=o[0],l=n.c32.indexOf(c),u=a.slice(-8);let d=l.toString(16);if(d.length===1&&(d=`0${d}`),r(`${d}${a.substring(0,a.length-8)}`)!==u)throw new Error("Invalid c32check string: checksum mismatch");return[l,a.substring(0,a.length-8)]}return Vs.c32checkDecode=i,Vs}var Jd={},Gs={},Xd,n0;function HN(){if(n0)return Xd;n0=1;function e(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=t.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;for(var g=0,w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=f.charCodeAt(g);if(m>255)return;var v=n[m];if(v===255)return;for(var C=0,O=I-1;(v!==0||C<b)&&O!==-1;O--,C++)v+=a*y[O]>>>0,y[O]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");b=C,g++}for(var D=I-b;D!==I&&y[D]===0;)D++;for(var S=new Uint8Array(w+(I-D)),E=w;D!==I;)S[E++]=y[D++];return S}function p(f){var g=h(f);if(g)return g;throw new Error("Non-base"+a+" character")}return{encode:d,decodeUnsafe:h,decode:p}}return Xd=e,Xd}var r0;function qN(){if(r0)return Gs;r0=1,Object.defineProperty(Gs,"__esModule",{value:!0}),Gs.decode=Gs.encode=void 0;const e=d1(),t=Jo(),n=HN(),r="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function s(o,a="00"){const c=typeof o=="string"?(0,t.hexToBytes)(o):o,l=typeof a=="string"?(0,t.hexToBytes)(a):o;if(!(c instanceof Uint8Array)||!(l instanceof Uint8Array))throw new TypeError("Argument must be of type Uint8Array or string");const u=(0,e.sha256)((0,e.sha256)(new Uint8Array([...l,...c])));return n(r).encode([...l,...c,...u.slice(0,4)])}Gs.encode=s;function i(o){const a=n(r).decode(o),c=a.slice(0,1),l=a.slice(1,-4),u=(0,e.sha256)((0,e.sha256)(new Uint8Array([...c,...l])));return a.slice(-4).forEach((d,h)=>{if(d!==u[h])throw new Error("Invalid checksum")}),{prefix:c,data:l}}return Gs.decode=i,Gs}var s0;function WN(){return s0||(s0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.c32ToB58=e.b58ToC32=e.c32addressDecode=e.c32address=e.versions=void 0;const t=h1(),n=qN(),r=Jo();e.versions={mainnet:{p2pkh:22,p2sh:20},testnet:{p2pkh:26,p2sh:21}};const s={};s[0]=e.versions.mainnet.p2pkh,s[5]=e.versions.mainnet.p2sh,s[111]=e.versions.testnet.p2pkh,s[196]=e.versions.testnet.p2sh;const i={};i[e.versions.mainnet.p2pkh]=0,i[e.versions.mainnet.p2sh]=5,i[e.versions.testnet.p2pkh]=111,i[e.versions.testnet.p2sh]=196;function o(u,d){if(!d.match(/^[0-9a-fA-F]{40}$/))throw new Error("Invalid argument: not a hash160 hex string");return`S${(0,t.c32checkEncode)(u,d)}`}e.c32address=o;function a(u){if(u.length<=5)throw new Error("Invalid c32 address: invalid length");if(u[0]!="S")throw new Error('Invalid c32 address: must start with "S"');return(0,t.c32checkDecode)(u.slice(1))}e.c32addressDecode=a;function c(u,d=-1){const h=n.decode(u),p=(0,r.bytesToHex)(h.data),f=parseInt((0,r.bytesToHex)(h.prefix),16);let g;return d<0?(g=f,s[f]!==void 0&&(g=s[f])):g=d,o(g,p)}e.b58ToC32=c;function l(u,d=-1){const h=a(u),p=h[0],f=h[1];let g;d<0?(g=p,i[p]!==void 0&&(g=i[p])):g=d;let w=g.toString(16);return w.length===1&&(w=`0${w}`),n.encode(f,w)}e.c32ToB58=l})(Jd)),Jd}var i0;function VN(){return i0||(i0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.b58ToC32=e.c32ToB58=e.versions=e.c32normalize=e.c32addressDecode=e.c32address=e.c32checkDecode=e.c32checkEncode=e.c32decode=e.c32encode=void 0;const t=u1();Object.defineProperty(e,"c32encode",{enumerable:!0,get:function(){return t.c32encode}}),Object.defineProperty(e,"c32decode",{enumerable:!0,get:function(){return t.c32decode}}),Object.defineProperty(e,"c32normalize",{enumerable:!0,get:function(){return t.c32normalize}});const n=h1();Object.defineProperty(e,"c32checkEncode",{enumerable:!0,get:function(){return n.c32checkEncode}}),Object.defineProperty(e,"c32checkDecode",{enumerable:!0,get:function(){return n.c32checkDecode}});const r=WN();Object.defineProperty(e,"c32address",{enumerable:!0,get:function(){return r.c32address}}),Object.defineProperty(e,"c32addressDecode",{enumerable:!0,get:function(){return r.c32addressDecode}}),Object.defineProperty(e,"c32ToB58",{enumerable:!0,get:function(){return r.c32ToB58}}),Object.defineProperty(e,"b58ToC32",{enumerable:!0,get:function(){return r.b58ToC32}}),Object.defineProperty(e,"versions",{enumerable:!0,get:function(){return r.versions}})})(Gd)),Gd}var ng=VN();const KN=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),f1=Uint8Array.from({length:16},(e,t)=>t),GN=f1.map(e=>(9*e+5)%16);let rg=[f1],sg=[GN];for(let e=0;e<4;e++)for(let t of[rg,sg])t.push(t[e].map(n=>KN[n]));const p1=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),YN=rg.map((e,t)=>e.map(n=>p1[t][n])),ZN=sg.map((e,t)=>e.map(n=>p1[t][n])),JN=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),XN=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Tl=(e,t)=>e<<t|e>>>32-t;function o0(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}const Ol=new Uint32Array(16);class QN extends eg{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:n,h2:r,h3:s,h4:i}=this;return[t,n,r,s,i]}set(t,n,r,s,i){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=s|0,this.h4=i|0}process(t,n){for(let p=0;p<16;p++,n+=4)Ol[p]=t.getUint32(n,!0);let r=this.h0|0,s=r,i=this.h1|0,o=i,a=this.h2|0,c=a,l=this.h3|0,u=l,d=this.h4|0,h=d;for(let p=0;p<5;p++){const f=4-p,g=JN[p],w=XN[p],b=rg[p],I=sg[p],y=YN[p],m=ZN[p];for(let v=0;v<16;v++){const C=Tl(r+o0(p,i,a,l)+Ol[b[v]]+g,y[v])+d|0;r=d,d=l,l=Tl(a,10)|0,a=i,i=C}for(let v=0;v<16;v++){const C=Tl(s+o0(f,o,c,u)+Ol[I[v]]+w,m[v])+h|0;s=h,h=u,u=Tl(c,10)|0,c=o,o=C}}this.set(this.h1+a+u|0,this.h2+l+h|0,this.h3+d+s|0,this.h4+r+o|0,this.h0+i+c|0)}roundClean(){Ol.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const ex=Ui(()=>new QN),Dl=BigInt(2**32-1),Nf=BigInt(32);function g1(e,t=!1){return t?{h:Number(e&Dl),l:Number(e>>Nf&Dl)}:{h:Number(e>>Nf&Dl)|0,l:Number(e&Dl)|0}}function tx(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:i,l:o}=g1(e[s],t);[n[s],r[s]]=[i,o]}return[n,r]}const nx=(e,t)=>BigInt(e>>>0)<<Nf|BigInt(t>>>0),rx=(e,t,n)=>e>>>n,sx=(e,t,n)=>e<<32-n|t>>>n,ix=(e,t,n)=>e>>>n|t<<32-n,ox=(e,t,n)=>e<<32-n|t>>>n,ax=(e,t,n)=>e<<64-n|t>>>n-32,cx=(e,t,n)=>e>>>n-32|t<<64-n,lx=(e,t)=>t,ux=(e,t)=>e,dx=(e,t,n)=>e<<n|t>>>32-n,hx=(e,t,n)=>t<<n|e>>>32-n,fx=(e,t,n)=>t<<n-32|e>>>64-n,px=(e,t,n)=>e<<n-32|t>>>64-n;function gx(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const wx=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),mx=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,yx=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),bx=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,vx=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),Ex=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,me={fromBig:g1,split:tx,toBig:nx,shrSH:rx,shrSL:sx,rotrSH:ix,rotrSL:ox,rotrBH:ax,rotrBL:cx,rotr32H:lx,rotr32L:ux,rotlSH:dx,rotlSL:hx,rotlBH:fx,rotlBL:px,add:gx,add3L:wx,add3H:mx,add4L:yx,add4H:bx,add5H:Ex,add5L:vx},[Cx,Ax]=me.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),os=new Uint32Array(80),as=new Uint32Array(80);class id extends eg{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:f,Hh:g,Hl:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=f|0,this.Hh=g|0,this.Hl=w|0}process(t,n){for(let y=0;y<16;y++,n+=4)os[y]=t.getUint32(n),as[y]=t.getUint32(n+=4);for(let y=16;y<80;y++){const m=os[y-15]|0,v=as[y-15]|0,C=me.rotrSH(m,v,1)^me.rotrSH(m,v,8)^me.shrSH(m,v,7),O=me.rotrSL(m,v,1)^me.rotrSL(m,v,8)^me.shrSL(m,v,7),D=os[y-2]|0,S=as[y-2]|0,E=me.rotrSH(D,S,19)^me.rotrBH(D,S,61)^me.shrSH(D,S,6),x=me.rotrSL(D,S,19)^me.rotrBL(D,S,61)^me.shrSL(D,S,6),P=me.add4L(O,x,as[y-7],as[y-16]),M=me.add4H(P,C,E,os[y-7],os[y-16]);os[y]=M|0,as[y]=P|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:f,Gh:g,Gl:w,Hh:b,Hl:I}=this;for(let y=0;y<80;y++){const m=me.rotrSH(d,h,14)^me.rotrSH(d,h,18)^me.rotrBH(d,h,41),v=me.rotrSL(d,h,14)^me.rotrSL(d,h,18)^me.rotrBL(d,h,41),C=d&p^~d&g,O=h&f^~h&w,D=me.add5L(I,v,O,Ax[y],as[y]),S=me.add5H(D,b,m,C,Cx[y],os[y]),E=D|0,x=me.rotrSH(r,s,28)^me.rotrBH(r,s,34)^me.rotrBH(r,s,39),P=me.rotrSL(r,s,28)^me.rotrBL(r,s,34)^me.rotrBL(r,s,39),M=r&i^r&a^i&a,R=s&o^s&c^o&c;b=g|0,I=w|0,g=p|0,w=f|0,p=d|0,f=h|0,{h:d,l:h}=me.add(l|0,u|0,S|0,E|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=me.add3L(E,P,R);r=me.add3H(A,S,x,M),s=A|0}({h:r,l:s}=me.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=me.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=me.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=me.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=me.add(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:f}=me.add(this.Fh|0,this.Fl|0,p|0,f|0),{h:g,l:w}=me.add(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:I}=me.add(this.Hh|0,this.Hl|0,b|0,I|0),this.set(r,s,i,o,a,c,l,u,d,h,p,f,g,w,b,I)}roundClean(){os.fill(0),as.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class Ix extends id{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class Sx extends id{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class Nx extends id{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}Ui(()=>new id);Ui(()=>new Ix);const xx=Ui(()=>new Sx);Ui(()=>new Nx);var Ua={exports:{}};Ua.exports;var a0;function _x(){return a0||(a0=1,(function(e,t){var n=200,r="__lodash_hash_undefined__",s=9007199254740991,i="[object Arguments]",o="[object Array]",a="[object Boolean]",c="[object Date]",l="[object Error]",u="[object Function]",d="[object GeneratorFunction]",h="[object Map]",p="[object Number]",f="[object Object]",g="[object Promise]",w="[object RegExp]",b="[object Set]",I="[object String]",y="[object Symbol]",m="[object WeakMap]",v="[object ArrayBuffer]",C="[object DataView]",O="[object Float32Array]",D="[object Float64Array]",S="[object Int8Array]",E="[object Int16Array]",x="[object Int32Array]",P="[object Uint8Array]",M="[object Uint8ClampedArray]",R="[object Uint16Array]",A="[object Uint32Array]",_=/[\\^$.*+?()[\]{}|]/g,k=/\w*$/,L=/^\[object .+?Constructor\]$/,U=/^(?:0|[1-9]\d*)$/,$={};$[i]=$[o]=$[v]=$[C]=$[a]=$[c]=$[O]=$[D]=$[S]=$[E]=$[x]=$[h]=$[p]=$[f]=$[w]=$[b]=$[I]=$[y]=$[P]=$[M]=$[R]=$[A]=!0,$[l]=$[u]=$[m]=!1;var F=typeof zt=="object"&&zt&&zt.Object===Object&&zt,G=typeof self=="object"&&self&&self.Object===Object&&self,Z=F||G||Function("return this")(),V=t&&!t.nodeType&&t,ne=V&&!0&&e&&!e.nodeType&&e,ue=ne&&ne.exports===V;function _e(N,B){return N.set(B[0],B[1]),N}function Ie(N,B){return N.add(B),N}function be(N,B){for(var j=-1,oe=N?N.length:0;++j<oe&&B(N[j],j,N)!==!1;);return N}function nt(N,B){for(var j=-1,oe=B.length,It=N.length;++j<oe;)N[It+j]=B[j];return N}function lt(N,B,j,oe){for(var It=-1,Gt=N?N.length:0;++It<Gt;)j=B(j,N[It],It,N);return j}function $r(N,B){for(var j=-1,oe=Array(N);++j<N;)oe[j]=B(j);return oe}function qi(N,B){return N?.[B]}function kr(N){var B=!1;if(N!=null&&typeof N.toString!="function")try{B=!!(N+"")}catch{}return B}function Wi(N){var B=-1,j=Array(N.size);return N.forEach(function(oe,It){j[++B]=[It,oe]}),j}function ca(N,B){return function(j){return N(B(j))}}function pl(N){var B=-1,j=Array(N.size);return N.forEach(function(oe){j[++B]=oe}),j}var Od=Array.prototype,gl=Function.prototype,js=Object.prototype,Fs=Z["__core-js_shared__"],la=(function(){var N=/[^.]+$/.exec(Fs&&Fs.keys&&Fs.keys.IE_PROTO||"");return N?"Symbol(src)_1."+N:""})(),ua=gl.toString,Vn=js.hasOwnProperty,zs=js.toString,wl=RegExp("^"+ua.call(Vn).replace(_,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ml=ue?Z.Buffer:void 0,yl=Z.Symbol,bl=Z.Uint8Array,Dd=ca(Object.getPrototypeOf,Object),IA=Object.create,SA=js.propertyIsEnumerable,NA=Od.splice,dw=Object.getOwnPropertySymbols,xA=ml?ml.isBuffer:void 0,_A=ca(Object.keys,Object),Pd=Gi(Z,"DataView"),da=Gi(Z,"Map"),$d=Gi(Z,"Promise"),kd=Gi(Z,"Set"),Ud=Gi(Z,"WeakMap"),ha=Gi(Object,"create"),TA=Ws(Pd),OA=Ws(da),DA=Ws($d),PA=Ws(kd),$A=Ws(Ud),hw=yl?yl.prototype:void 0,fw=hw?hw.valueOf:void 0;function Hs(N){var B=-1,j=N?N.length:0;for(this.clear();++B<j;){var oe=N[B];this.set(oe[0],oe[1])}}function kA(){this.__data__=ha?ha(null):{}}function UA(N){return this.has(N)&&delete this.__data__[N]}function RA(N){var B=this.__data__;if(ha){var j=B[N];return j===r?void 0:j}return Vn.call(B,N)?B[N]:void 0}function MA(N){var B=this.__data__;return ha?B[N]!==void 0:Vn.call(B,N)}function LA(N,B){var j=this.__data__;return j[N]=ha&&B===void 0?r:B,this}Hs.prototype.clear=kA,Hs.prototype.delete=UA,Hs.prototype.get=RA,Hs.prototype.has=MA,Hs.prototype.set=LA;function Ur(N){var B=-1,j=N?N.length:0;for(this.clear();++B<j;){var oe=N[B];this.set(oe[0],oe[1])}}function BA(){this.__data__=[]}function jA(N){var B=this.__data__,j=vl(B,N);if(j<0)return!1;var oe=B.length-1;return j==oe?B.pop():NA.call(B,j,1),!0}function FA(N){var B=this.__data__,j=vl(B,N);return j<0?void 0:B[j][1]}function zA(N){return vl(this.__data__,N)>-1}function HA(N,B){var j=this.__data__,oe=vl(j,N);return oe<0?j.push([N,B]):j[oe][1]=B,this}Ur.prototype.clear=BA,Ur.prototype.delete=jA,Ur.prototype.get=FA,Ur.prototype.has=zA,Ur.prototype.set=HA;function Vi(N){var B=-1,j=N?N.length:0;for(this.clear();++B<j;){var oe=N[B];this.set(oe[0],oe[1])}}function qA(){this.__data__={hash:new Hs,map:new(da||Ur),string:new Hs}}function WA(N){return El(this,N).delete(N)}function VA(N){return El(this,N).get(N)}function KA(N){return El(this,N).has(N)}function GA(N,B){return El(this,N).set(N,B),this}Vi.prototype.clear=qA,Vi.prototype.delete=WA,Vi.prototype.get=VA,Vi.prototype.has=KA,Vi.prototype.set=GA;function Ki(N){this.__data__=new Ur(N)}function YA(){this.__data__=new Ur}function ZA(N){return this.__data__.delete(N)}function JA(N){return this.__data__.get(N)}function XA(N){return this.__data__.has(N)}function QA(N,B){var j=this.__data__;if(j instanceof Ur){var oe=j.__data__;if(!da||oe.length<n-1)return oe.push([N,B]),this;j=this.__data__=new Vi(oe)}return j.set(N,B),this}Ki.prototype.clear=YA,Ki.prototype.delete=ZA,Ki.prototype.get=JA,Ki.prototype.has=XA,Ki.prototype.set=QA;function eI(N,B){var j=Ld(N)||II(N)?$r(N.length,String):[],oe=j.length,It=!!oe;for(var Gt in N)Vn.call(N,Gt)&&!(It&&(Gt=="length"||vI(Gt,oe)))&&j.push(Gt);return j}function pw(N,B,j){var oe=N[B];(!(Vn.call(N,B)&&yw(oe,j))||j===void 0&&!(B in N))&&(N[B]=j)}function vl(N,B){for(var j=N.length;j--;)if(yw(N[j][0],B))return j;return-1}function tI(N,B){return N&&gw(B,Bd(B),N)}function Rd(N,B,j,oe,It,Gt,Rr){var Yt;if(oe&&(Yt=Gt?oe(N,It,Gt,Rr):oe(N)),Yt!==void 0)return Yt;if(!Cl(N))return N;var Ew=Ld(N);if(Ew){if(Yt=mI(N),!B)return pI(N,Yt)}else{var Yi=qs(N),Cw=Yi==u||Yi==d;if(NI(N))return aI(N,B);if(Yi==f||Yi==i||Cw&&!Gt){if(kr(N))return Gt?N:{};if(Yt=yI(Cw?{}:N),!B)return gI(N,tI(Yt,N))}else{if(!$[Yi])return Gt?N:{};Yt=bI(N,Yi,Rd,B)}}Rr||(Rr=new Ki);var Aw=Rr.get(N);if(Aw)return Aw;if(Rr.set(N,Yt),!Ew)var Iw=j?wI(N):Bd(N);return be(Iw||N,function(jd,Al){Iw&&(Al=jd,jd=N[Al]),pw(Yt,Al,Rd(jd,B,j,oe,Al,N,Rr))}),Yt}function nI(N){return Cl(N)?IA(N):{}}function rI(N,B,j){var oe=B(N);return Ld(N)?oe:nt(oe,j(N))}function sI(N){return zs.call(N)}function iI(N){if(!Cl(N)||CI(N))return!1;var B=vw(N)||kr(N)?wl:L;return B.test(Ws(N))}function oI(N){if(!mw(N))return _A(N);var B=[];for(var j in Object(N))Vn.call(N,j)&&j!="constructor"&&B.push(j);return B}function aI(N,B){if(B)return N.slice();var j=new N.constructor(N.length);return N.copy(j),j}function Md(N){var B=new N.constructor(N.byteLength);return new bl(B).set(new bl(N)),B}function cI(N,B){var j=B?Md(N.buffer):N.buffer;return new N.constructor(j,N.byteOffset,N.byteLength)}function lI(N,B,j){var oe=B?j(Wi(N),!0):Wi(N);return lt(oe,_e,new N.constructor)}function uI(N){var B=new N.constructor(N.source,k.exec(N));return B.lastIndex=N.lastIndex,B}function dI(N,B,j){var oe=B?j(pl(N),!0):pl(N);return lt(oe,Ie,new N.constructor)}function hI(N){return fw?Object(fw.call(N)):{}}function fI(N,B){var j=B?Md(N.buffer):N.buffer;return new N.constructor(j,N.byteOffset,N.length)}function pI(N,B){var j=-1,oe=N.length;for(B||(B=Array(oe));++j<oe;)B[j]=N[j];return B}function gw(N,B,j,oe){j||(j={});for(var It=-1,Gt=B.length;++It<Gt;){var Rr=B[It],Yt=void 0;pw(j,Rr,Yt===void 0?N[Rr]:Yt)}return j}function gI(N,B){return gw(N,ww(N),B)}function wI(N){return rI(N,Bd,ww)}function El(N,B){var j=N.__data__;return EI(B)?j[typeof B=="string"?"string":"hash"]:j.map}function Gi(N,B){var j=qi(N,B);return iI(j)?j:void 0}var ww=dw?ca(dw,Object):TI,qs=sI;(Pd&&qs(new Pd(new ArrayBuffer(1)))!=C||da&&qs(new da)!=h||$d&&qs($d.resolve())!=g||kd&&qs(new kd)!=b||Ud&&qs(new Ud)!=m)&&(qs=function(N){var B=zs.call(N),j=B==f?N.constructor:void 0,oe=j?Ws(j):void 0;if(oe)switch(oe){case TA:return C;case OA:return h;case DA:return g;case PA:return b;case $A:return m}return B});function mI(N){var B=N.length,j=N.constructor(B);return B&&typeof N[0]=="string"&&Vn.call(N,"index")&&(j.index=N.index,j.input=N.input),j}function yI(N){return typeof N.constructor=="function"&&!mw(N)?nI(Dd(N)):{}}function bI(N,B,j,oe){var It=N.constructor;switch(B){case v:return Md(N);case a:case c:return new It(+N);case C:return cI(N,oe);case O:case D:case S:case E:case x:case P:case M:case R:case A:return fI(N,oe);case h:return lI(N,oe,j);case p:case I:return new It(N);case w:return uI(N);case b:return dI(N,oe,j);case y:return hI(N)}}function vI(N,B){return B=B??s,!!B&&(typeof N=="number"||U.test(N))&&N>-1&&N%1==0&&N<B}function EI(N){var B=typeof N;return B=="string"||B=="number"||B=="symbol"||B=="boolean"?N!=="__proto__":N===null}function CI(N){return!!la&&la in N}function mw(N){var B=N&&N.constructor,j=typeof B=="function"&&B.prototype||js;return N===j}function Ws(N){if(N!=null){try{return ua.call(N)}catch{}try{return N+""}catch{}}return""}function AI(N){return Rd(N,!0,!0)}function yw(N,B){return N===B||N!==N&&B!==B}function II(N){return SI(N)&&Vn.call(N,"callee")&&(!SA.call(N,"callee")||zs.call(N)==i)}var Ld=Array.isArray;function bw(N){return N!=null&&xI(N.length)&&!vw(N)}function SI(N){return _I(N)&&bw(N)}var NI=xA||OI;function vw(N){var B=Cl(N)?zs.call(N):"";return B==u||B==d}function xI(N){return typeof N=="number"&&N>-1&&N%1==0&&N<=s}function Cl(N){var B=typeof N;return!!N&&(B=="object"||B=="function")}function _I(N){return!!N&&typeof N=="object"}function Bd(N){return bw(N)?eI(N):oI(N)}function TI(){return[]}function OI(){return!1}e.exports=AI})(Ua,Ua.exports)),Ua.exports}var Tx=_x();const Ox=sd(Tx);var Ce;(function(e){e.Int="int",e.UInt="uint",e.Buffer="buffer",e.BoolTrue="true",e.BoolFalse="false",e.PrincipalStandard="address",e.PrincipalContract="contract",e.ResponseOk="ok",e.ResponseErr="err",e.OptionalNone="none",e.OptionalSome="some",e.List="list",e.Tuple="tuple",e.StringASCII="ascii",e.StringUTF8="utf8"})(Ce||(Ce={}));var pt;(function(e){e[e.int=0]="int",e[e.uint=1]="uint",e[e.buffer=2]="buffer",e[e.true=3]="true",e[e.false=4]="false",e[e.address=5]="address",e[e.contract=6]="contract",e[e.ok=7]="ok",e[e.err=8]="err",e[e.none=9]="none",e[e.some=10]="some",e[e.list=11]="list",e[e.tuple=12]="tuple",e[e.ascii=13]="ascii",e[e.utf8=14]="utf8"})(pt||(pt={}));function ig(e){return pt[e]}const w1=()=>({type:Ce.BoolTrue}),m1=()=>({type:Ce.BoolFalse}),Dx=e=>e?w1():m1(),y1=e=>{if(e.byteLength>1048576)throw new Error("Cannot construct clarity buffer that is greater than 1MB");return{type:Ce.Buffer,value:we(e)}},c0=BigInt("0xffffffffffffffffffffffffffffffff"),Px=BigInt(0),l0=BigInt("0x7fffffffffffffffffffffffffffffff"),u0=BigInt("-170141183460469231731687303715884105728"),b1=e=>{typeof e=="string"&&e.toLowerCase().startsWith("0x")&&(e=lf(Ve(e))),un(e,Uint8Array)&&(e=lf(e));const t=Vt(e);if(t>l0)throw new RangeError(`Cannot construct clarity integer from value greater than ${l0}`);if(t<u0)throw new RangeError(`Cannot construct clarity integer form value less than ${u0}`);return{type:Ce.Int,value:t}},v1=e=>{const t=Vt(e);if(t<Px)throw new RangeError("Cannot construct unsigned clarity integer from negative value");if(t>c0)throw new RangeError(`Cannot construct unsigned clarity integer greater than ${c0}`);return{type:Ce.UInt,value:t}};function E1(e){return{type:Ce.List,value:e}}function og(){return{type:Ce.OptionalNone}}function ag(e){return{type:Ce.OptionalSome,value:e}}var se;(function(e){e[e.Address=0]="Address",e[e.Principal=1]="Principal",e[e.LengthPrefixedString=2]="LengthPrefixedString",e[e.MemoString=3]="MemoString",e[e.Asset=4]="Asset",e[e.PostCondition=5]="PostCondition",e[e.PublicKey=6]="PublicKey",e[e.LengthPrefixedList=7]="LengthPrefixedList",e[e.Payload=8]="Payload",e[e.MessageSignature=9]="MessageSignature",e[e.StructuredDataSignature=10]="StructuredDataSignature",e[e.TransactionAuthField=11]="TransactionAuthField"})(se||(se={}));function $x(){return{type:se.Address,version:Ni.MainnetSingleSig,hash160:"0".repeat(40)}}function d0(e){if(e&&R1(e,Tu))throw new Error(`Memo exceeds maximum length of ${Tu} bytes`);return{type:se.MemoString,content:e}}function cg(e,t){return{type:se.LengthPrefixedList,lengthPrefixBytes:t||4,values:e}}function xf(e){if(Ve(e).byteLength!=nd)throw Error("Invalid signature");return{type:se.MessageSignature,data:e}}function kx(e,t,n){return typeof e=="string"&&(e=Zx(e)),typeof n=="string"&&(n=d0(n)),{type:se.Payload,payloadType:Me.TokenTransfer,recipient:e,amount:Vt(t),memo:n??d0("")}}function Ux(e,t,n,r){return typeof t=="string"&&(t=lr(t)),typeof n=="string"&&(n=lr(n)),{type:se.Payload,payloadType:Me.ContractCall,contractAddress:typeof e=="string"?Ls(e):e,contractName:t,functionName:n,functionArgs:r}}function Rx(e){return lr(e,4,1e5)}function h0(e,t,n){return typeof e=="string"&&(e=lr(e)),typeof t=="string"&&(t=Rx(t)),typeof n=="number"?{type:se.Payload,payloadType:Me.VersionedSmartContract,clarityVersion:n,contractName:e,codeBody:t}:{type:se.Payload,payloadType:Me.SmartContract,contractName:e,codeBody:t}}function Mx(){return{type:se.Payload,payloadType:Me.PoisonMicroblock}}function f0(e,t){if(e.byteLength!=bi)throw Error(`Coinbase buffer size must be ${bi} bytes`);return t!=null?{type:se.Payload,payloadType:Me.CoinbaseToAltRecipient,coinbaseBytes:e,recipient:t}:{type:se.Payload,payloadType:Me.Coinbase,coinbaseBytes:e}}function Lx(e,t,n){if(e.byteLength!=bi)throw Error(`Coinbase buffer size must be ${bi} bytes`);if(n.byteLength!=bf)throw Error(`VRF proof buffer size must be ${bf} bytes`);return{type:se.Payload,payloadType:Me.NakamotoCoinbase,coinbaseBytes:e,recipient:t.type===Ce.OptionalSome?t.value:void 0,vrfProof:n}}function Bx(e,t,n,r,s,i,o){return{type:se.Payload,payloadType:Me.TenureChange,tenureHash:e,previousTenureHash:t,burnViewHash:n,previousTenureEnd:r,previousTenureBlocks:s,cause:i,publicKeyHash:o}}function lr(e,t,n){const r=t||1,s=n||QS;if(R1(e,s))throw new Error(`String length exceeds maximum bytes ${s}`);return{type:se.LengthPrefixedString,content:e,lengthPrefixBytes:r,maxLengthBytes:s}}function jx(e,t,n){return{type:se.Asset,address:Ls(e),contractName:lr(t),assetName:lr(n)}}function Ls(e){const t=ng.c32addressDecode(e);return{type:se.Address,version:t[0],hash160:t[1]}}function Fx(e,t){const n=Ls(e),r=lr(t);return{type:se.Principal,prefix:Sn.Contract,address:n,contractName:r}}function zx(e){const t=Ls(e);return{type:se.Principal,prefix:Sn.Standard,address:t}}function So(e,t){return{pubKeyEncoding:e,type:se.TransactionAuthField,contents:t}}function Wr(e){switch(e.type){case se.Address:return Yc(e);case se.Principal:return C1(e);case se.LengthPrefixedString:return Bo(e);case se.MemoString:return qx(e);case se.Asset:return I1(e);case se.PostCondition:return N1(e);case se.PublicKey:return Of(e);case se.LengthPrefixedList:return lg(e);case se.Payload:return x1(e);case se.TransactionAuthField:return Yx(e);case se.MessageSignature:return ug(e)}}function Yc(e){const t=[];return t.push(Ve(Kc(e.version,1))),t.push(Ve(e.hash160)),at(t)}function Lo(e){const t=un(e,Ye)?e:new Ye(e),n=Xu(we(t.readBytes(1))),r=we(t.readBytes(20));return{type:se.Address,version:n,hash160:r}}function C1(e){const t=[];return t.push(e.prefix),(e.prefix===Sn.Standard||e.prefix===Sn.Contract)&&t.push(Yc(e.address)),e.prefix===Sn.Contract&&t.push(Bo(e.contractName)),at(t)}function Hx(e){const t=un(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(Sn,i=>{throw new An(`Unexpected Principal payload type: ${i}`)});if(n===Sn.Origin)return{type:se.Principal,prefix:n};const r=Lo(t);if(n===Sn.Standard)return{type:se.Principal,prefix:n,address:r};const s=Bn(t);return{type:se.Principal,prefix:n,address:r,contractName:s}}function Bo(e){const t=[],n=Zo(e.content),r=n.byteLength;return t.push(Ve(Kc(r,e.lengthPrefixBytes))),t.push(n),at(t)}function Bn(e,t,n){t=t||1;const r=un(e,Ye)?e:new Ye(e),s=Xu(we(r.readBytes(t))),i=Qu(r.readBytes(s));return lr(i,t,n??128)}function qx(e){const t=[],n=Zo(e.content),r=h_(we(n),Tu*2);return t.push(Ve(r)),at(t)}function A1(e){const t=un(e,Ye)?e:new Ye(e);let n=Qu(t.readBytes(Tu));return n=n.replace(/\u0000*$/,""),{type:se.MemoString,content:n}}function I1(e){const t=[];return t.push(Yc(e.address)),t.push(Bo(e.contractName)),t.push(Bo(e.assetName)),at(t)}function _f(e){const t=un(e,Ye)?e:new Ye(e);return{type:se.Asset,address:Lo(t),contractName:Bn(t),assetName:Bn(t)}}function lg(e){const t=e.values,n=[];n.push(Ve(Kc(t.length,e.lengthPrefixBytes)));for(const r of t)n.push(Wr(r));return at(n)}function S1(e,t,n){const r=un(e,Ye)?e:new Ye(e),s=Xu(we(r.readBytes(4))),i=[];for(let o=0;o<s;o++)switch(t){case se.Address:i.push(Lo(r));break;case se.LengthPrefixedString:i.push(Bn(r));break;case se.MemoString:i.push(A1(r));break;case se.Asset:i.push(_f(r));break;case se.PostCondition:i.push(Vx(r));break;case se.PublicKey:i.push(Df(r));break;case se.TransactionAuthField:i.push(Gx(r));break}return cg(i,n)}function Wx(e){return we(N1(e))}function N1(e){const t=[];if(t.push(e.conditionType),t.push(C1(e.principal)),(e.conditionType===Tt.Fungible||e.conditionType===Tt.NonFungible)&&t.push(I1(e.asset)),e.conditionType===Tt.NonFungible&&t.push(Ar(e.assetName)),t.push(e.conditionCode),e.conditionType===Tt.STX||e.conditionType===Tt.Fungible){if(e.amount>BigInt("0xffffffffffffffff"))throw new Io("The post-condition amount may not be larger than 8 bytes");t.push(Us(e.amount,8))}return at(t)}function Vx(e){const t=un(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(Tt,a=>{throw new An(`Could not read ${a} as PostConditionType`)}),r=Hx(t);let s,i,o;switch(n){case Tt.STX:return s=t.readUInt8Enum(Ou,c=>{throw new An(`Could not read ${c} as FungibleConditionCode`)}),o=BigInt(`0x${we(t.readBytes(8))}`),{type:se.PostCondition,conditionType:Tt.STX,principal:r,conditionCode:s,amount:o};case Tt.Fungible:return i=_f(t),s=t.readUInt8Enum(Ou,c=>{throw new An(`Could not read ${c} as FungibleConditionCode`)}),o=BigInt(`0x${we(t.readBytes(8))}`),{type:se.PostCondition,conditionType:Tt.Fungible,principal:r,conditionCode:s,amount:o,asset:i};case Tt.NonFungible:i=_f(t);const a=nr(t);return s=t.readUInt8Enum(Ef,c=>{throw new An(`Could not read ${c} as FungibleConditionCode`)}),{type:se.PostCondition,conditionType:Tt.NonFungible,principal:r,conditionCode:s,asset:i,assetName:a}}}function x1(e){const t=[];switch(t.push(e.payloadType),e.payloadType){case Me.TokenTransfer:t.push(Ar(e.recipient)),t.push(Us(e.amount,8)),t.push(Wr(e.memo));break;case Me.ContractCall:t.push(Wr(e.contractAddress)),t.push(Wr(e.contractName)),t.push(Wr(e.functionName));const n=new Uint8Array(4);Ii(n,e.functionArgs.length,0),t.push(n),e.functionArgs.forEach(r=>{t.push(Ar(r))});break;case Me.SmartContract:t.push(Wr(e.contractName)),t.push(Wr(e.codeBody));break;case Me.VersionedSmartContract:t.push(e.clarityVersion),t.push(Wr(e.contractName)),t.push(Wr(e.codeBody));break;case Me.PoisonMicroblock:break;case Me.Coinbase:t.push(e.coinbaseBytes);break;case Me.CoinbaseToAltRecipient:t.push(e.coinbaseBytes),t.push(Ar(e.recipient));break;case Me.NakamotoCoinbase:t.push(e.coinbaseBytes),t.push(Ar(e.recipient?ag(e.recipient):og())),t.push(e.vrfProof);break;case Me.TenureChange:t.push(Ve(e.tenureHash)),t.push(Ve(e.previousTenureHash)),t.push(Ve(e.burnViewHash)),t.push(Ve(e.previousTenureEnd)),t.push(Ii(new Uint8Array(4),e.previousTenureBlocks)),t.push(GI(new Uint8Array(1),e.cause)),t.push(Ve(e.publicKeyHash));break}return at(t)}function Kx(e){const t=un(e,Ye)?e:new Ye(e);switch(t.readUInt8Enum(Me,r=>{throw new Error(`Cannot recognize PayloadType: ${r}`)})){case Me.TokenTransfer:const r=nr(t),s=Vt(t.readBytes(8)),i=A1(t);return kx(r,s,i);case Me.ContractCall:const o=Lo(t),a=Bn(t),c=Bn(t),l=[],u=t.readUInt32BE();for(let m=0;m<u;m++){const v=nr(t);l.push(v)}return Ux(o,a,c,l);case Me.SmartContract:const d=Bn(t),h=Bn(t,4,1e5);return h0(d,h);case Me.VersionedSmartContract:{const m=t.readUInt8Enum(vf,O=>{throw new Error(`Cannot recognize ClarityVersion: ${O}`)}),v=Bn(t),C=Bn(t,4,uN);return h0(v,C,m)}case Me.PoisonMicroblock:return Mx();case Me.Coinbase:{const m=t.readBytes(bi);return f0(m)}case Me.CoinbaseToAltRecipient:{const m=t.readBytes(bi),v=nr(t);return f0(m,v)}case Me.NakamotoCoinbase:{const m=t.readBytes(bi),v=nr(t),C=t.readBytes(bf);return Lx(m,v,C)}case Me.TenureChange:const p=we(t.readBytes(20)),f=we(t.readBytes(20)),g=we(t.readBytes(20)),w=we(t.readBytes(32)),b=t.readUInt32BE(),I=t.readUInt8Enum(Cf,m=>{throw new Error(`Cannot recognize TenureChangeCause: ${m}`)}),y=we(t.readBytes(20));return Bx(p,f,g,w,b,I,y)}}function Tf(e){const t=un(e,Ye)?e:new Ye(e);return xf(we(t.readBytes(nd)))}function Gx(e){const t=un(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(tr,r=>{throw new An(`Could not read ${r} as AuthFieldType`)});switch(n){case tr.PublicKeyCompressed:return So(rt.Compressed,Df(t));case tr.PublicKeyUncompressed:return So(rt.Uncompressed,Xo(A_(Df(t).data)));case tr.SignatureCompressed:return So(rt.Compressed,Tf(t));case tr.SignatureUncompressed:return So(rt.Uncompressed,Tf(t));default:throw new Error(`Unknown auth field type: ${JSON.stringify(n)}`)}}function ug(e){return Ve(e.data)}function Yx(e){const t=[];switch(e.contents.type){case se.PublicKey:t.push(e.pubKeyEncoding===rt.Compressed?tr.PublicKeyCompressed:tr.PublicKeyUncompressed),t.push(Ve(C_(e.contents.data)));break;case se.MessageSignature:t.push(e.pubKeyEncoding===rt.Compressed?tr.SignatureCompressed:tr.SignatureUncompressed),t.push(ug(e.contents));break}return at(t)}function Of(e){return e.data.slice()}function Df(e){const t=un(e,Ye)?e:new Ye(e),n=t.readUInt8(),r=n===4?nN:tN;return Xo(at([n,t.readBytes(r)]))}function dg(e,t,n,r){if(r.length===0)throw Error("Invalid number of public keys");if((t===We.P2PKH||t===We.P2WPKH)&&(r.length!==1||n!==1))throw Error("Invalid number of public keys or signatures");if((t===We.P2WPKH||t===We.P2WSH||t===We.P2WSHNonSequential)&&!r.map(s=>s.data).every(Qo))throw Error("Public keys must be compressed for segwit");switch(t){case We.P2PKH:return Pl(e,f_(r[0].data));case We.P2WPKH:return Pl(e,p_(r[0].data));case We.P2SH:case We.P2SHNonSequential:return Pl(e,g_(n,r.map(Of)));case We.P2WSH:case We.P2WSHNonSequential:return Pl(e,w_(n,r.map(Of)))}}function Pl(e,t){return{type:se.Address,version:e,hash160:t}}function hg(e){return ng.c32address(e.version,e.hash160)}function p0(e){const[t,n,r]=e.split(/\.|::/);return jx(t,n,r)}function Qd(e){if(e.includes(".")){const[t,n]=e.split(".");return Fx(t,n)}else return zx(e)}function Zx(e){if(e.includes(".")){const[t,n]=e.split(".");return T1(t,n)}else return _1(e)}function _1(e){const t=Ls(e);return{type:Ce.PrincipalStandard,value:hg(t)}}function Jx(e){return{type:Ce.PrincipalStandard,value:hg(e)}}function T1(e,t){const n=Ls(e),r=lr(t);return O1(n,r)}function O1(e,t){if(Zo(t.content).byteLength>=128)throw new Error("Contract name must be less than 128 bytes");return{type:Ce.PrincipalContract,value:`${hg(e)}.${t.content}`}}function D1(e){return{type:Ce.ResponseErr,value:e}}function P1(e){return{type:Ce.ResponseOk,value:e}}const ku=e=>({type:Ce.StringASCII,value:e}),$1=e=>({type:Ce.StringUTF8,value:e});function k1(e){for(const t in e)if(!m_(t))throw new Error(`"${t}" is not a valid Clarity name`);return{type:Ce.Tuple,value:e}}function nr(e){let t;if(typeof e=="string"){const r=e.slice(0,2).toLowerCase()==="0x";t=new Ye(Ve(r?e.slice(2):e))}else e instanceof Uint8Array?t=new Ye(e):t=e;switch(t.readUInt8Enum(pt,r=>{throw new An(`Cannot recognize Clarity Type: ${r}`)})){case pt.int:return b1(lf(t.readBytes(16)));case pt.uint:return v1(t.readBytes(16));case pt.buffer:const r=t.readUInt32BE();return y1(t.readBytes(r));case pt.true:return w1();case pt.false:return m1();case pt.address:const s=Lo(t);return Jx(s);case pt.contract:const i=Lo(t),o=Bn(t);return O1(i,o);case pt.ok:return P1(nr(t));case pt.err:return D1(nr(t));case pt.none:return og();case pt.some:return ag(nr(t));case pt.list:const a=t.readUInt32BE(),c=[];for(let g=0;g<a;g++)c.push(nr(t));return E1(c);case pt.tuple:const l=t.readUInt32BE(),u={};for(let g=0;g<l;g++){const w=Bn(t).content;if(w===void 0)throw new An('"content" is undefined');u[w]=nr(t)}return k1(u);case pt.ascii:const d=t.readUInt32BE(),h=LI(t.readBytes(d));return ku(h);case pt.utf8:const p=t.readUInt32BE(),f=Qu(t.readBytes(p));return $1(f);default:throw new An("Unable to deserialize Clarity Value from Uint8Array. Could not find valid Clarity Type.")}}function Dr(e,t){return at([ig(e),t])}function Xx(e){return new Uint8Array([ig(e.type)])}function Qx(e){return e.type===Ce.OptionalNone?new Uint8Array([ig(e.type)]):Dr(e.type,Ar(e.value))}function e_(e){const t=new Uint8Array(4);return Ii(t,Math.ceil(e.value.length/2),0),Dr(e.type,ed(t,Ve(e.value)))}function t_(e){const t=qp($I(BigInt(e.value),BigInt(eN)),e1);return Dr(e.type,t)}function n_(e){const t=qp(BigInt(e.value),e1);return Dr(e.type,t)}function r_(e){return Dr(e.type,Yc(Ls(e.value)))}function s_(e){const[t,n]=y_(e.value);return Dr(e.type,ed(Yc(Ls(t)),Bo(lr(n))))}function i_(e){return Dr(e.type,Ar(e.value))}function o_(e){const t=[],n=new Uint8Array(4);Ii(n,e.value.length,0),t.push(n);for(const r of e.value){const s=Ar(r);t.push(s)}return Dr(e.type,at(t))}function a_(e){const t=[],n=new Uint8Array(4);Ii(n,Object.keys(e.value).length,0),t.push(n);const r=Object.keys(e.value).sort((s,i)=>s.localeCompare(i));for(const s of r){const i=lr(s);t.push(Bo(i));const o=Ar(e.value[s]);t.push(o)}return Dr(e.type,at(t))}function U1(e,t){const n=[],r=t=="ascii"?MI(e.value):Zo(e.value),s=new Uint8Array(4);return Ii(s,r.length,0),n.push(s),n.push(r),Dr(e.type,at(n))}function c_(e){return U1(e,"ascii")}function l_(e){return U1(e,"utf8")}function u_(e){return we(Ar(e))}function Ar(e){switch(e.type){case Ce.BoolTrue:case Ce.BoolFalse:return Xx(e);case Ce.OptionalNone:case Ce.OptionalSome:return Qx(e);case Ce.Buffer:return e_(e);case Ce.UInt:return n_(e);case Ce.Int:return t_(e);case Ce.PrincipalStandard:return r_(e);case Ce.PrincipalContract:return s_(e);case Ce.ResponseOk:case Ce.ResponseErr:return i_(e);case Ce.List:return o_(e);case Ce.Tuple:return a_(e);case Ce.StringASCII:return c_(e);case Ce.StringUTF8:return l_(e);default:throw new Io("Unable to serialize. Invalid Clarity Value.")}}const d_=e=>e.length%2?`0${e}`:e,h_=(e,t)=>e.padEnd(t,"0"),R1=(e,t)=>e?Zo(e).length>t:!1;function Pf(e){return Ox(e)}const lc=e=>ex(tg(e)),fg=e=>we(xx(e)),f_=e=>we(lc(e)),p_=e=>{const t=lc(e),n=ed(new Uint8Array([0]),new Uint8Array([t.length]),t),r=lc(n);return we(r)},g_=(e,t)=>{if(e>15||t.length>15)throw Error("P2SH multisig address can only contain up to 15 public keys");const n=[];n.push(80+e),t.forEach(i=>{n.push(i.length),n.push(i)}),n.push(80+t.length),n.push(174);const r=at(n),s=lc(r);return we(s)},w_=(e,t)=>{if(e>15||t.length>15)throw Error("P2WSH multisig address can only contain up to 15 public keys");const n=[];n.push(80+e),t.forEach(c=>{n.push(c.length),n.push(c)}),n.push(80+t.length),n.push(174);const r=at(n),s=tg(r),i=[];i.push(0),i.push(s.length),i.push(s);const o=at(i),a=lc(o);return we(a)};function m_(e){return/^[a-zA-Z]([a-zA-Z0-9]|[-_!?+<>=/*])*$|^[-+=/*]$|^[<>]=?$/.test(e)&&e.length<128}function y_(e){const[t,n]=e.split(".");if(!t||!n)throw new Error(`Invalid contract identifier: ${e}`);return[t,n]}Ns.hmacSha256Sync=(e,...t)=>{const n=s1.create(tg,e);return t.forEach(r=>n.update(r)),n.digest()};function Xo(e){return e=typeof e=="string"?Ve(e):e,{type:se.PublicKey,data:e}}function b_(e,t,n=rt.Compressed){const r=qI(t),s=new Sr(Sw(r.r),Sw(r.s)),i=Ge.fromSignature(e,s,r.recoveryId),o=n===rt.Compressed;return i.toHex(o)}function v_(e){return typeof e=="string"?e:we(e)}const pg=v_;function M1(e){return(typeof e=="string"?e.length/2:e.byteLength)===HI}function Qo(e){return!pg(e).startsWith("04")}function E_(e){e=_v(e);const t=M1(e);return we(kN(e.slice(0,32),t))}function C_(e){return Ge.fromHex(pg(e)).toHex(!0)}function A_(e){return Ge.fromHex(pg(e)).toHex(!1)}function I_(e,t){e=_v(e);const[n,r]=LN(t,e.slice(0,32),{canonical:!0,recovered:!0});if(r==null)throw new Error("No signature recoveryId received");return Kc(r,1)+Sr.fromHex(n).toCompactHex()}function gg(){return{type:se.MessageSignature,data:we(new Uint8Array(nd))}}function L1(e,t,n,r){const s=dg(0,e,1,[Xo(t)]).hash160,i=Qo(t)?rt.Compressed:rt.Uncompressed;return{hashMode:e,signer:s,nonce:Vt(n),fee:Vt(r),keyEncoding:i,signature:gg()}}function uc(e){return"signature"in e}function g0(e){return e===We.P2SH||e===We.P2WSH}function S_(e){return e===We.P2SHNonSequential||e===We.P2WSHNonSequential}function w0(e){const t=Pf(e);return t.nonce=0,t.fee=0,uc(t)?t.signature=gg():t.fields=[],{...t,nonce:BigInt(0),fee:BigInt(0)}}function N_(e){const t=[e.hashMode,Ve(e.signer),Us(e.nonce,8),Us(e.fee,8),e.keyEncoding,ug(e.signature)];return at(t)}function x_(e){const t=[e.hashMode,Ve(e.signer),Us(e.nonce,8),Us(e.fee,8)],n=cg(e.fields);t.push(lg(n));const r=new Uint8Array(2);return VI(r,e.signaturesRequired,0),t.push(r),at(t)}function __(e,t){const n=we(t.readBytes(20)),r=BigInt(`0x${we(t.readBytes(8))}`),s=BigInt(`0x${we(t.readBytes(8))}`),i=t.readUInt8Enum(rt,a=>{throw new An(`Could not parse ${a} as PubKeyEncoding`)});if(e===We.P2WPKH&&i!=rt.Compressed)throw new An("Failed to parse singlesig spending condition: incomaptible hash mode and key encoding");const o=Tf(t);return{hashMode:e,signer:n,nonce:r,fee:s,keyEncoding:i,signature:o}}function T_(e,t){const n=we(t.readBytes(20)),r=BigInt("0x"+we(t.readBytes(8))),s=BigInt("0x"+we(t.readBytes(8))),i=S1(t,se.TransactionAuthField).values;let o=!1,a=0;for(const l of i)switch(l.contents.type){case se.PublicKey:Qo(l.contents.data)||(o=!0);break;case se.MessageSignature:if(l.pubKeyEncoding===rt.Uncompressed&&(o=!0),a+=1,a===65536)throw new ui("Failed to parse multisig spending condition: too many signatures");break}const c=t.readUInt16BE();if(o&&(e===We.P2WSH||e===We.P2WSHNonSequential))throw new ui("Uncompressed keys are not allowed in this hash mode");return{hashMode:e,signer:n,nonce:r,fee:s,fields:i,signaturesRequired:c}}function eh(e){return uc(e)?N_(e):x_(e)}function th(e){const t=e.readUInt8Enum(We,n=>{throw new An(`Could not parse ${n} as AddressHashMode`)});return t===We.P2PKH||t===We.P2WPKH?__(t,e):T_(t,e)}function B1(e,t,n,r){const i=e+we(new Uint8Array([t]))+we(Us(n,8))+we(Us(r,8));if(Ve(i).byteLength!==49)throw Error("Invalid signature hash length");return fg(Ve(i))}function j1(e,t,n){const r=33+nd,s=Qo(t.data)?rt.Compressed:rt.Uncompressed,i=e+d_(s.toString(16))+n,o=Ve(i);if(o.byteLength>r)throw Error("Invalid signature hash length");return fg(o)}function O_(e,t,n,r,s){const i=B1(e,t,n,r),o=I_(s,i),a=Xo(E_(s)),c=j1(i,a,o);return{nextSig:o,nextSigHash:c}}function F1(e,t,n,r,s,i){const o=B1(e,t,n,r),a=Xo(b_(o,i,s)),c=j1(o,a,i);return{pubKey:a,nextSigHash:c}}function D_(){const e=L1(We.P2PKH,"",0,0);return e.signer=$x().hash160,e.keyEncoding=rt.Compressed,e.signature=gg(),e}function m0(e,t,n){return uc(e)?P_(e,t,n):$_(e,t,n)}function P_(e,t,n){const{pubKey:r,nextSigHash:s}=F1(t,n,e.fee,e.nonce,e.keyEncoding,e.signature.data),i=dg(0,e.hashMode,1,[r]).hash160;if(i!==e.signer)throw new ui(`Signer hash does not equal hash of public key(s): ${i} != ${e.signer}`);return s}function $_(e,t,n){const r=[];let s=t,i=!1,o=0;for(const c of e.fields)switch(c.contents.type){case se.PublicKey:Qo(c.contents.data)||(i=!0),r.push(c.contents);break;case se.MessageSignature:c.pubKeyEncoding===rt.Uncompressed&&(i=!0);const{pubKey:l,nextSigHash:u}=F1(s,n,e.fee,e.nonce,c.pubKeyEncoding,c.contents.data);if(g0(e.hashMode)&&(s=u),r.push(l),o+=1,o===65536)throw new ui("Too many signatures");break}if(g0(e.hashMode)&&o!==e.signaturesRequired||S_(e.hashMode)&&o<e.signaturesRequired)throw new ui("Incorrect number of signatures");if(i&&(e.hashMode===We.P2WSH||e.hashMode===We.P2WSHNonSequential))throw new ui("Uncompressed keys are not allowed in this hash mode");const a=dg(0,e.hashMode,e.signaturesRequired,r).hash160;if(a!==e.signer)throw new ui(`Signer hash does not equal hash of public key(s): ${a} != ${e.signer}`);return s}function z1(e){return{authType:st.Standard,spendingCondition:e}}function H1(e,t){return{authType:st.Sponsored,spendingCondition:e,sponsorSpendingCondition:t||L1(We.P2PKH,"0".repeat(66),0,0)}}function y0(e){if(e.spendingCondition)switch(e.authType){case st.Standard:return z1(w0(e.spendingCondition));case st.Sponsored:return H1(w0(e.spendingCondition),D_());default:throw new Du("Unexpected authorization type for signing")}throw new Error("Authorization missing SpendingCondition")}function k_(e,t){switch(e.authType){case st.Standard:return m0(e.spendingCondition,t,st.Standard);case st.Sponsored:return m0(e.spendingCondition,t,st.Standard);default:throw new Du("Invalid origin auth type")}}function U_(e,t){switch(e.authType){case st.Standard:const n={...e.spendingCondition,fee:Vt(t)};return{...e,spendingCondition:n};case st.Sponsored:const r={...e.sponsorSpendingCondition,fee:Vt(t)};return{...e,sponsorSpendingCondition:r}}}function R_(e,t){const n={...e.spendingCondition,nonce:Vt(t)};return{...e,spendingCondition:n}}function M_(e,t){const n={...e.sponsorSpendingCondition,nonce:Vt(t)};return{...e,sponsorSpendingCondition:n}}function L_(e,t){const n={...t,nonce:Vt(t.nonce),fee:Vt(t.fee)};return{...e,sponsorSpendingCondition:n}}function B_(e){const t=[];switch(t.push(e.authType),e.authType){case st.Standard:t.push(eh(e.spendingCondition));break;case st.Sponsored:t.push(eh(e.spendingCondition)),t.push(eh(e.sponsorSpendingCondition));break}return at(t)}function j_(e){const t=e.readUInt8Enum(st,r=>{throw new An(`Could not parse ${r} as AuthType`)});let n;switch(t){case st.Standard:return n=th(e),z1(n);case st.Sponsored:n=th(e);const r=th(e);return H1(n,r)}}class F_{constructor({auth:t,payload:n,postConditions:r=cg([]),postConditionMode:s=xi.Deny,transactionVersion:i,chainId:o,network:a="mainnet"}){a=XS(a),this.transactionVersion=i??a.transactionVersion,this.chainId=o??a.chainId,this.auth=t,"amount"in n?this.payload={...n,amount:Vt(n.amount)}:this.payload=n,this.postConditionMode=s,this.postConditions=r,this.anchorMode=mn.Any}signBegin(){const t=Pf(this);return t.auth=y0(t.auth),t.txid()}verifyBegin(){const t=Pf(this);return t.auth=y0(t.auth),t.txid()}verifyOrigin(){return k_(this.auth,this.verifyBegin())}signNextOrigin(t,n){if(this.auth.spendingCondition===void 0)throw new Error('"auth.spendingCondition" is undefined');if(this.auth.authType===void 0)throw new Error('"auth.authType" is undefined');return this.signAndAppend(this.auth.spendingCondition,t,st.Standard,n)}signNextSponsor(t,n){if(this.auth.authType===st.Sponsored)return this.signAndAppend(this.auth.sponsorSpendingCondition,t,st.Sponsored,n);throw new Error('"auth.sponsorSpendingCondition" is undefined')}appendPubkey(t){const n=typeof t=="object"&&"type"in t?t:Xo(t),r=this.auth.spendingCondition;if(r&&!uc(r)){const s=Qo(n.data);r.fields.push(So(s?rt.Compressed:rt.Uncompressed,n))}else throw new Error("Can't append public key to a singlesig condition")}signAndAppend(t,n,r,s){const{nextSig:i,nextSigHash:o}=O_(n,r,t.fee,t.nonce,s);if(uc(t))t.signature=xf(i);else{const a=M1(s);t.fields.push(So(a?rt.Compressed:rt.Uncompressed,xf(i)))}return o}txid(){const t=this.serializeBytes();return fg(t)}setSponsor(t){if(this.auth.authType!=st.Sponsored)throw new Du("Cannot sponsor sign a non-sponsored transaction");this.auth=L_(this.auth,t)}setFee(t){this.auth=U_(this.auth,t)}setNonce(t){this.auth=R_(this.auth,t)}setSponsorNonce(t){if(this.auth.authType!=st.Sponsored)throw new Du("Cannot sponsor sign a non-sponsored transaction");this.auth=M_(this.auth,t)}serialize(){return we(this.serializeBytes())}serializeBytes(){if(this.transactionVersion===void 0)throw new Io('"transactionVersion" is undefined');if(this.chainId===void 0)throw new Io('"chainId" is undefined');if(this.auth===void 0)throw new Io('"auth" is undefined');if(this.payload===void 0)throw new Io('"payload" is undefined');const t=[];t.push(this.transactionVersion);const n=new Uint8Array(4);return Ii(n,this.chainId,0),t.push(n),t.push(B_(this.auth)),t.push(this.anchorMode),t.push(this.postConditionMode),t.push(lg(this.postConditions)),t.push(x1(this.payload)),at(t)}}function z_(e){const t=un(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(Si,u=>{throw new Error(`Could not parse ${u} as TransactionVersion`)}),r=t.readUInt32BE(),s=j_(t),i=t.readUInt8Enum(mn,u=>{throw new Error(`Could not parse ${u} as AnchorMode`)}),o=t.readUInt8Enum(xi,u=>{throw new Error(`Could not parse ${u} as PostConditionMode`)}),a=S1(t,se.PostCondition),c=Kx(t),l=new F_({transactionVersion:n,chainId:r,auth:s,payload:c,postConditions:a,postConditionMode:o});return l.anchorMode=i,l}var $f;(function(e){e[e.eq=1]="eq",e[e.gt=2]="gt",e[e.lt=4]="lt",e[e.gte=3]="gte",e[e.lte=5]="lte",e[e.sent=16]="sent",e[e["not-sent"]=17]="not-sent"})($f||($f={}));function H_(e){switch(e.type){case"stx-postcondition":return{type:se.PostCondition,conditionType:Tt.STX,principal:e.address==="origin"?{type:se.Principal,prefix:Sn.Origin}:Qd(e.address),conditionCode:nh(e.condition),amount:BigInt(e.amount)};case"ft-postcondition":return{type:se.PostCondition,conditionType:Tt.Fungible,principal:e.address==="origin"?{type:se.Principal,prefix:Sn.Origin}:Qd(e.address),conditionCode:nh(e.condition),amount:BigInt(e.amount),asset:p0(e.asset)};case"nft-postcondition":return{type:se.PostCondition,conditionType:Tt.NonFungible,principal:e.address==="origin"?{type:se.Principal,prefix:Sn.Origin}:Qd(e.address),conditionCode:nh(e.condition),asset:p0(e.asset),assetName:e.assetId};default:throw new Error("Invalid post condition type")}}function nh(e){return $f[e]}function b0(e){const t=H_(e);return Wx(t)}const q_="0123456789ABCDEFGHJKMNPQRSTVWXYZ";function v0(e){const t="version"in e?e.version:q_.indexOf(e.versionChar.toUpperCase()),n=ng.c32address(t,e.hash160);return e.contractName?`${n}.${e.contractName}`:n}const E0=Dx,W_=b1,V_=v1,K_=T1,G_=_1,Y_=E1,Z_=ku,J_=$1,X_=y1,Q_=og,e3=ag,t3=P1,n3=D1,r3=k1,kf=u_,s3=nr;var rh={},C0;function i3(){return C0||(C0=1,(function(){(function(e){(function(t){var n=typeof globalThis<"u"&&globalThis||typeof e<"u"&&e||typeof zt<"u"&&zt||{},r={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function s(E){return E&&DataView.prototype.isPrototypeOf(E)}if(r.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(E){return E&&i.indexOf(Object.prototype.toString.call(E))>-1};function a(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(E)||E==="")throw new TypeError('Invalid character in header field name: "'+E+'"');return E.toLowerCase()}function c(E){return typeof E!="string"&&(E=String(E)),E}function l(E){var x={next:function(){var P=E.shift();return{done:P===void 0,value:P}}};return r.iterable&&(x[Symbol.iterator]=function(){return x}),x}function u(E){this.map={},E instanceof u?E.forEach(function(x,P){this.append(P,x)},this):Array.isArray(E)?E.forEach(function(x){if(x.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+x.length);this.append(x[0],x[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(x){this.append(x,E[x])},this)}u.prototype.append=function(E,x){E=a(E),x=c(x);var P=this.map[E];this.map[E]=P?P+", "+x:x},u.prototype.delete=function(E){delete this.map[a(E)]},u.prototype.get=function(E){return E=a(E),this.has(E)?this.map[E]:null},u.prototype.has=function(E){return this.map.hasOwnProperty(a(E))},u.prototype.set=function(E,x){this.map[a(E)]=c(x)},u.prototype.forEach=function(E,x){for(var P in this.map)this.map.hasOwnProperty(P)&&E.call(x,this.map[P],P,this)},u.prototype.keys=function(){var E=[];return this.forEach(function(x,P){E.push(P)}),l(E)},u.prototype.values=function(){var E=[];return this.forEach(function(x){E.push(x)}),l(E)},u.prototype.entries=function(){var E=[];return this.forEach(function(x,P){E.push([P,x])}),l(E)},r.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);function d(E){if(!E._noBody){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}}function h(E){return new Promise(function(x,P){E.onload=function(){x(E.result)},E.onerror=function(){P(E.error)}})}function p(E){var x=new FileReader,P=h(x);return x.readAsArrayBuffer(E),P}function f(E){var x=new FileReader,P=h(x),M=/charset=([A-Za-z0-9_-]+)/.exec(E.type),R=M?M[1]:"utf-8";return x.readAsText(E,R),P}function g(E){for(var x=new Uint8Array(E),P=new Array(x.length),M=0;M<x.length;M++)P[M]=String.fromCharCode(x[M]);return P.join("")}function w(E){if(E.slice)return E.slice(0);var x=new Uint8Array(E.byteLength);return x.set(new Uint8Array(E)),x.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(E){this.bodyUsed=this.bodyUsed,this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:r.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:r.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():r.arrayBuffer&&r.blob&&s(E)?(this._bodyArrayBuffer=w(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||o(E))?this._bodyArrayBuffer=w(E):this._bodyText=E=Object.prototype.toString.call(E):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var E=d(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var E=d(this);return E||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(r.blob)return this.blob().then(p);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var E=d(this);if(E)return E;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}var I=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function y(E){var x=E.toUpperCase();return I.indexOf(x)>-1?x:E}function m(E,x){if(!(this instanceof m))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');x=x||{};var P=x.body;if(E instanceof m){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,x.headers||(this.headers=new u(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!P&&E._bodyInit!=null&&(P=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=x.credentials||this.credentials||"same-origin",(x.headers||!this.headers)&&(this.headers=new u(x.headers)),this.method=y(x.method||this.method||"GET"),this.mode=x.mode||this.mode||null,this.signal=x.signal||this.signal||(function(){if("AbortController"in n){var A=new AbortController;return A.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&P)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(P),(this.method==="GET"||this.method==="HEAD")&&(x.cache==="no-store"||x.cache==="no-cache")){var M=/([?&])_=[^&]*/;if(M.test(this.url))this.url=this.url.replace(M,"$1_="+new Date().getTime());else{var R=/\?/;this.url+=(R.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function v(E){var x=new FormData;return E.trim().split("&").forEach(function(P){if(P){var M=P.split("="),R=M.shift().replace(/\+/g," "),A=M.join("=").replace(/\+/g," ");x.append(decodeURIComponent(R),decodeURIComponent(A))}}),x}function C(E){var x=new u,P=E.replace(/\r?\n[\t ]+/g," ");return P.split("\r").map(function(M){return M.indexOf(`
`)===0?M.substr(1,M.length):M}).forEach(function(M){var R=M.split(":"),A=R.shift().trim();if(A){var _=R.join(":").trim();try{x.append(A,_)}catch(k){console.warn("Response "+k.message)}}}),x}b.call(m.prototype);function O(E,x){if(!(this instanceof O))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(x||(x={}),this.type="default",this.status=x.status===void 0?200:x.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=x.statusText===void 0?"":""+x.statusText,this.headers=new u(x.headers),this.url=x.url||"",this._initBody(E)}b.call(O.prototype),O.prototype.clone=function(){return new O(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},O.error=function(){var E=new O(null,{status:200,statusText:""});return E.ok=!1,E.status=0,E.type="error",E};var D=[301,302,303,307,308];O.redirect=function(E,x){if(D.indexOf(x)===-1)throw new RangeError("Invalid status code");return new O(null,{status:x,headers:{location:E}})},t.DOMException=n.DOMException;try{new t.DOMException}catch{t.DOMException=function(x,P){this.message=x,this.name=P;var M=Error(x);this.stack=M.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function S(E,x){return new Promise(function(P,M){var R=new m(E,x);if(R.signal&&R.signal.aborted)return M(new t.DOMException("Aborted","AbortError"));var A=new XMLHttpRequest;function _(){A.abort()}A.onload=function(){var U={statusText:A.statusText,headers:C(A.getAllResponseHeaders()||"")};R.url.indexOf("file://")===0&&(A.status<200||A.status>599)?U.status=200:U.status=A.status,U.url="responseURL"in A?A.responseURL:U.headers.get("X-Request-URL");var $="response"in A?A.response:A.responseText;setTimeout(function(){P(new O($,U))},0)},A.onerror=function(){setTimeout(function(){M(new TypeError("Network request failed"))},0)},A.ontimeout=function(){setTimeout(function(){M(new TypeError("Network request timed out"))},0)},A.onabort=function(){setTimeout(function(){M(new t.DOMException("Aborted","AbortError"))},0)};function k(U){try{return U===""&&n.location.href?n.location.href:U}catch{return U}}if(A.open(R.method,k(R.url),!0),R.credentials==="include"?A.withCredentials=!0:R.credentials==="omit"&&(A.withCredentials=!1),"responseType"in A&&(r.blob?A.responseType="blob":r.arrayBuffer&&(A.responseType="arraybuffer")),x&&typeof x.headers=="object"&&!(x.headers instanceof u||n.Headers&&x.headers instanceof n.Headers)){var L=[];Object.getOwnPropertyNames(x.headers).forEach(function(U){L.push(a(U)),A.setRequestHeader(U,c(x.headers[U]))}),R.headers.forEach(function(U,$){L.indexOf($)===-1&&A.setRequestHeader($,U)})}else R.headers.forEach(function(U,$){A.setRequestHeader($,U)});R.signal&&(R.signal.addEventListener("abort",_),A.onreadystatechange=function(){A.readyState===4&&R.signal.removeEventListener("abort",_)}),A.send(typeof R._bodyInit>"u"?null:R._bodyInit)})}return S.polyfill=!0,n.fetch||(n.fetch=S,n.Headers=u,n.Request=m,n.Response=O),t.Headers=u,t.Request=m,t.Response=O,t.fetch=S,Object.defineProperty(t,"__esModule",{value:!0}),t})({})})(typeof self<"u"?self:rh)})()),rh}i3();const o3={referrerPolicy:"origin",headers:{"x-hiro-product":"stacksjs"}};async function a3(e,t){const n={};return Object.assign(n,o3,t),await fetch(e,n)}function c3(e){let t=a3,n=[];return e.length>0&&typeof e[0]=="function"&&(t=e.shift()),e.length>0&&(n=e),{fetchLib:t,middlewares:n}}function l3(...e){const{fetchLib:t,middlewares:n}=c3(e);return async(s,i)=>{let o={url:s,init:i??{}};for(const c of n)typeof c.pre=="function"&&(o=await Promise.resolve(c.pre({fetch:t,...o}))??o);let a=await t(o.url,o.init);for(const c of n)typeof c.post=="function"&&(a=await Promise.resolve(c.post({fetch:t,url:o.url,init:o.init,response:a?.clone()??a}))??a);return a}}var jo;(function(e){e[e.Testnet=2147483648]="Testnet",e[e.Mainnet=1]="Mainnet"})(jo||(jo={}));var _i;(function(e){e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet"})(_i||(_i={}));var A0;(function(e){e[e.Mainnet=385875968]="Mainnet",e[e.Testnet=4278190080]="Testnet"})(A0||(A0={}));const u3="https://api.mainnet.hiro.so",d3="https://api.testnet.hiro.so",h3="http://localhost:3999",f3=["mainnet","testnet","devnet","mocknet"];class Fo{constructor(t){this.version=_i.Mainnet,this.chainId=jo.Mainnet,this.bnsLookupUrl="https://api.mainnet.hiro.so",this.broadcastEndpoint="/v2/transactions",this.transferFeeEstimateEndpoint="/v2/fees/transfer",this.transactionFeeEstimateEndpoint="/v2/fees/transaction",this.accountEndpoint="/v2/accounts",this.contractAbiEndpoint="/v2/contracts/interface",this.readOnlyFunctionCallEndpoint="/v2/contracts/call-read",this.isMainnet=()=>this.version===_i.Mainnet,this.getBroadcastApiUrl=()=>`${this.coreApiUrl}${this.broadcastEndpoint}`,this.getTransferFeeEstimateApiUrl=()=>`${this.coreApiUrl}${this.transferFeeEstimateEndpoint}`,this.getTransactionFeeEstimateApiUrl=()=>`${this.coreApiUrl}${this.transactionFeeEstimateEndpoint}`,this.getAccountApiUrl=n=>`${this.coreApiUrl}${this.accountEndpoint}/${n}?proof=0`,this.getAccountExtendedBalancesApiUrl=n=>`${this.coreApiUrl}/extended/v1/address/${n}/balances`,this.getAbiApiUrl=(n,r)=>`${this.coreApiUrl}${this.contractAbiEndpoint}/${n}/${r}`,this.getReadOnlyFunctionCallApiUrl=(n,r,s)=>`${this.coreApiUrl}${this.readOnlyFunctionCallEndpoint}/${n}/${r}/${encodeURIComponent(s)}`,this.getInfoUrl=()=>`${this.coreApiUrl}/v2/info`,this.getBlockTimeInfoUrl=()=>`${this.coreApiUrl}/extended/v1/info/network_block_times`,this.getPoxInfoUrl=()=>`${this.coreApiUrl}/v2/pox`,this.getRewardsUrl=(n,r)=>{let s=`${this.coreApiUrl}/extended/v1/burnchain/rewards/${n}`;return r&&(s=`${s}?limit=${r.limit}&offset=${r.offset}`),s},this.getRewardsTotalUrl=n=>`${this.coreApiUrl}/extended/v1/burnchain/rewards/${n}/total`,this.getRewardHoldersUrl=(n,r)=>{let s=`${this.coreApiUrl}/extended/v1/burnchain/reward_slot_holders/${n}`;return r&&(s=`${s}?limit=${r.limit}&offset=${r.offset}`),s},this.getStackerInfoUrl=(n,r)=>`${this.coreApiUrl}${this.readOnlyFunctionCallEndpoint}
    ${n}/${r}/get-stacker-info`,this.getDataVarUrl=(n,r,s)=>`${this.coreApiUrl}/v2/data_var/${n}/${r}/${s}?proof=0`,this.getMapEntryUrl=(n,r,s)=>`${this.coreApiUrl}/v2/map_entry/${n}/${r}/${s}?proof=0`,this.coreApiUrl=t.url,this.fetchFn=t.fetchFn??l3()}getNameInfo(t){const n=`${this.bnsLookupUrl}/v1/names/${t}`;return this.fetchFn(n).then(r=>{if(r.status===404)throw new Error("Name not found");if(r.status!==200)throw new Error(`Bad response status: ${r.status}`);return r.json()}).then(r=>r.address?Object.assign({},r,{address:r.address}):r)}}Fo.fromName=e=>{switch(e){case"mainnet":return new q1;case"testnet":return new W1;case"devnet":return new V1;case"mocknet":return new wg;default:throw new Error(`Invalid network name provided. Must be one of the following: ${f3.join(", ")}`)}};Fo.fromNameOrNetwork=e=>typeof e!="string"&&"version"in e?e:Fo.fromName(e);class q1 extends Fo{constructor(t){super({url:t?.url??u3,fetchFn:t?.fetchFn}),this.version=_i.Mainnet,this.chainId=jo.Mainnet}}class W1 extends Fo{constructor(t){super({url:t?.url??d3,fetchFn:t?.fetchFn}),this.version=_i.Testnet,this.chainId=jo.Testnet}}class wg extends Fo{constructor(t){super({url:t?.url??h3,fetchFn:t?.fetchFn}),this.version=_i.Testnet,this.chainId=jo.Testnet}}const V1=wg;function p3(e,t,n){return yg(K1(e),n)}function K1(e,t){let n=e;if(typeof n=="number"){if(!Number.isInteger(n))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");if(n>Number.MAX_SAFE_INTEGER)throw new RangeError(`Invalid value. Values of type 'number' must be less than or equal to ${Number.MAX_SAFE_INTEGER}. For larger values, try using a BigInt instead.`);return BigInt(n)}if(typeof n=="string")if(n.toLowerCase().startsWith("0x")){let r=n.slice(2);r=r.padStart(r.length+r.length%2,"0"),n=dc(r)}else try{return BigInt(n)}catch(r){if(r instanceof SyntaxError)throw new RangeError(`Invalid value. String integer '${n}' is not finite.`)}if(typeof n=="bigint")return n;if(n instanceof Uint8Array)return BigInt(`0x${m3(n)}`);if(n!=null&&typeof n=="object"&&n.constructor.name==="BN")return BigInt(n.toString());throw new TypeError("Invalid value type. Must be a number, bigint, integer-string, hex-string, or Uint8Array.")}function mg(e,t=8){return(typeof e=="bigint"?e:K1(e)).toString(16).padStart(t*2,"0")}function yg(e,t=16){const n=mg(e,t);return dc(n)}function g3(e,t){if(e<-(BigInt(1)<<t-BigInt(1))||(BigInt(1)<<t-BigInt(1))-BigInt(1)<e)throw`Unable to represent integer in width: ${t}`;return e>=BigInt(0)?BigInt(e):e+(BigInt(1)<<t)}const w3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function m3(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(const n of e)t+=w3[n];return t}function dc(e){if(typeof e!="string")throw new TypeError(`hexToBytes: expected string, got ${typeof e}`);e=e.startsWith("0x")||e.startsWith("0X")?e.slice(2):e;const t=e.length%2?`0${e}`:e,n=new Uint8Array(t.length/2);for(let r=0;r<n.length;r++){const s=r*2,i=t.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function bg(e){return new TextEncoder().encode(e)}function y3(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return new Uint8Array(t)}function b3(e){return!Number.isInteger(e)||e<0||e>255}function I0(e){if(e.some(b3))throw new Error("Some values are invalid bytes.");return new Uint8Array(e)}function vg(...e){if(!e.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];const t=e.reduce((r,s)=>r+s.length,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}function rs(e){return vg(...e.map(t=>typeof t=="number"?I0([t]):t instanceof Array?I0(t):t))}function od(e,t,n=0){return e[n+3]=t,t>>>=8,e[n+2]=t,t>>>=8,e[n+1]=t,t>>>=8,e[n]=t,e}var Uf;(function(e){e[e.Testnet=2147483648]="Testnet",e[e.Mainnet=1]="Mainnet"})(Uf||(Uf={}));Uf.Mainnet;const v3=128,E3=128,G1=16;var Rf;(function(e){e[e.Address=0]="Address",e[e.Principal=1]="Principal",e[e.LengthPrefixedString=2]="LengthPrefixedString",e[e.MemoString=3]="MemoString",e[e.AssetInfo=4]="AssetInfo",e[e.PostCondition=5]="PostCondition",e[e.PublicKey=6]="PublicKey",e[e.LengthPrefixedList=7]="LengthPrefixedList",e[e.Payload=8]="Payload",e[e.MessageSignature=9]="MessageSignature",e[e.StructuredDataSignature=10]="StructuredDataSignature",e[e.TransactionAuthField=11]="TransactionAuthField"})(Rf||(Rf={}));var S0;(function(e){e[e.TokenTransfer=0]="TokenTransfer",e[e.SmartContract=1]="SmartContract",e[e.VersionedSmartContract=6]="VersionedSmartContract",e[e.ContractCall=2]="ContractCall",e[e.PoisonMicroblock=3]="PoisonMicroblock",e[e.Coinbase=4]="Coinbase",e[e.CoinbaseToAltRecipient=5]="CoinbaseToAltRecipient",e[e.TenureChange=7]="TenureChange",e[e.NakamotoCoinbase=8]="NakamotoCoinbase"})(S0||(S0={}));var N0;(function(e){e[e.Clarity1=1]="Clarity1",e[e.Clarity2=2]="Clarity2",e[e.Clarity3=3]="Clarity3"})(N0||(N0={}));var Xn;(function(e){e[e.OnChainOnly=1]="OnChainOnly",e[e.OffChainOnly=2]="OffChainOnly",e[e.Any=3]="Any"})(Xn||(Xn={}));const sh=["onChainOnly","offChainOnly","any"];sh[0]+"",Xn.OnChainOnly,sh[1]+"",Xn.OffChainOnly,sh[2]+"",Xn.Any,Xn.OnChainOnly+"",Xn.OnChainOnly,Xn.OffChainOnly+"",Xn.OffChainOnly,Xn.Any+"",Xn.Any;var Mf;(function(e){e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet"})(Mf||(Mf={}));Mf.Mainnet;var x0;(function(e){e[e.Allow=1]="Allow",e[e.Deny=2]="Deny"})(x0||(x0={}));var ii;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(ii||(ii={}));var _0;(function(e){e[e.Standard=4]="Standard",e[e.Sponsored=5]="Sponsored"})(_0||(_0={}));var T0;(function(e){e[e.SerializeP2PKH=0]="SerializeP2PKH",e[e.SerializeP2SH=1]="SerializeP2SH",e[e.SerializeP2WPKH=2]="SerializeP2WPKH",e[e.SerializeP2WSH=3]="SerializeP2WSH",e[e.SerializeP2SHNonSequential=5]="SerializeP2SHNonSequential",e[e.SerializeP2WSHNonSequential=7]="SerializeP2WSHNonSequential"})(T0||(T0={}));var O0;(function(e){e[e.MainnetSingleSig=22]="MainnetSingleSig",e[e.MainnetMultiSig=20]="MainnetMultiSig",e[e.TestnetSingleSig=26]="TestnetSingleSig",e[e.TestnetMultiSig=21]="TestnetMultiSig"})(O0||(O0={}));var D0;(function(e){e[e.Compressed=0]="Compressed",e[e.Uncompressed=1]="Uncompressed"})(D0||(D0={}));var P0;(function(e){e[e.Equal=1]="Equal",e[e.Greater=2]="Greater",e[e.GreaterEqual=3]="GreaterEqual",e[e.Less=4]="Less",e[e.LessEqual=5]="LessEqual"})(P0||(P0={}));var $0;(function(e){e[e.Sends=16]="Sends",e[e.DoesNotSend=17]="DoesNotSend"})($0||($0={}));var Lf;(function(e){e[e.Origin=1]="Origin",e[e.Standard=2]="Standard",e[e.Contract=3]="Contract"})(Lf||(Lf={}));var k0;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(k0||(k0={}));var U0;(function(e){e.Serialization="Serialization",e.Deserialization="Deserialization",e.SignatureValidation="SignatureValidation",e.FeeTooLow="FeeTooLow",e.BadNonce="BadNonce",e.NotEnoughFunds="NotEnoughFunds",e.NoSuchContract="NoSuchContract",e.NoSuchPublicFunction="NoSuchPublicFunction",e.BadFunctionArgument="BadFunctionArgument",e.ContractAlreadyExists="ContractAlreadyExists",e.PoisonMicroblocksDoNotConflict="PoisonMicroblocksDoNotConflict",e.PoisonMicroblockHasUnknownPubKeyHash="PoisonMicroblockHasUnknownPubKeyHash",e.PoisonMicroblockIsInvalid="PoisonMicroblockIsInvalid",e.BadAddressVersionByte="BadAddressVersionByte",e.NoCoinbaseViaMempool="NoCoinbaseViaMempool",e.ServerFailureNoSuchChainTip="ServerFailureNoSuchChainTip",e.TooMuchChaining="TooMuchChaining",e.ConflictingNonceInMempool="ConflictingNonceInMempool",e.BadTransactionVersion="BadTransactionVersion",e.TransferRecipientCannotEqualSender="TransferRecipientCannotEqualSender",e.TransferAmountMustBePositive="TransferAmountMustBePositive",e.ServerFailureDatabase="ServerFailureDatabase",e.EstimatorError="EstimatorError",e.TemporarilyBlacklisted="TemporarilyBlacklisted",e.ServerFailureOther="ServerFailureOther"})(U0||(U0={}));function C3(e,t,n){const s=v3;if(B3(e,s))throw new Error(`String length exceeds maximum bytes ${s}`);return{type:Rf.LengthPrefixedString,content:e,lengthPrefixBytes:1,maxLengthBytes:s}}var Ne;(function(e){e[e.Int=0]="Int",e[e.UInt=1]="UInt",e[e.Buffer=2]="Buffer",e[e.BoolTrue=3]="BoolTrue",e[e.BoolFalse=4]="BoolFalse",e[e.PrincipalStandard=5]="PrincipalStandard",e[e.PrincipalContract=6]="PrincipalContract",e[e.ResponseOk=7]="ResponseOk",e[e.ResponseErr=8]="ResponseErr",e[e.OptionalNone=9]="OptionalNone",e[e.OptionalSome=10]="OptionalSome",e[e.List=11]="List",e[e.Tuple=12]="Tuple",e[e.StringASCII=13]="StringASCII",e[e.StringUTF8=14]="StringUTF8"})(Ne||(Ne={}));class A3 extends Error{constructor(t){super(t),this.message=t,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Y1 extends A3{constructor(t){super(t)}}function ad(e){const t=[];return t.push(dc(mg(e.version,1))),t.push(dc(e.hash160)),rs(t)}function I3(e){const t=[];return t.push(e.prefix),t.push(ad(e.address)),e.prefix===Lf.Contract&&t.push(hc(e.contractName)),rs(t)}function hc(e){const t=[],n=bg(e.content),r=n.byteLength;return t.push(dc(mg(r,e.lengthPrefixBytes))),t.push(n),rs(t)}function S3(e){const t=[];return t.push(ad(e.address)),t.push(hc(e.contractName)),t.push(hc(e.assetName)),rs(t)}function N3(e){const t=[];if(t.push(e.conditionType),t.push(I3(e.principal)),(e.conditionType===ii.Fungible||e.conditionType===ii.NonFungible)&&t.push(S3(e.assetInfo)),e.conditionType===ii.NonFungible&&t.push(Zc(e.assetName)),t.push(e.conditionCode),e.conditionType===ii.STX||e.conditionType===ii.Fungible){if(e.amount>BigInt("0xffffffffffffffff"))throw new Y1("The post-condition amount may not be larger than 8 bytes");t.push(p3(e.amount,!1,8))}return rs(t)}function Pr(e,t){return rs([e,t])}function x3(e){return new Uint8Array([e.type])}function _3(e){return e.type===Ne.OptionalNone?new Uint8Array([e.type]):Pr(e.type,Zc(e.value))}function T3(e){const t=new Uint8Array(4);return od(t,e.buffer.length,0),Pr(e.type,vg(t,e.buffer))}function O3(e){const t=yg(g3(e.value,BigInt(E3)),G1);return Pr(e.type,t)}function D3(e){const t=yg(e.value,G1);return Pr(e.type,t)}function P3(e){return Pr(e.type,ad(e.address))}function $3(e){return Pr(e.type,vg(ad(e.address),hc(e.contractName)))}function k3(e){return Pr(e.type,Zc(e.value))}function U3(e){const t=[],n=new Uint8Array(4);od(n,e.list.length,0),t.push(n);for(const r of e.list){const s=Zc(r);t.push(s)}return Pr(e.type,rs(t))}function R3(e){const t=[],n=new Uint8Array(4);od(n,Object.keys(e.data).length,0),t.push(n);const r=Object.keys(e.data).sort((s,i)=>s.localeCompare(i));for(const s of r){const i=C3(s);t.push(hc(i));const o=Zc(e.data[s]);t.push(o)}return Pr(e.type,rs(t))}function Z1(e,t){const n=[],r=t=="ascii"?y3(e.data):bg(e.data),s=new Uint8Array(4);return od(s,r.length,0),n.push(s),n.push(r),Pr(e.type,rs(n))}function M3(e){return Z1(e,"ascii")}function L3(e){return Z1(e,"utf8")}function Zc(e){switch(e.type){case Ne.BoolTrue:case Ne.BoolFalse:return x3(e);case Ne.OptionalNone:case Ne.OptionalSome:return _3(e);case Ne.Buffer:return T3(e);case Ne.UInt:return D3(e);case Ne.Int:return O3(e);case Ne.PrincipalStandard:return P3(e);case Ne.PrincipalContract:return $3(e);case Ne.ResponseOk:case Ne.ResponseErr:return k3(e);case Ne.List:return U3(e);case Ne.Tuple:return R3(e);case Ne.StringASCII:return M3(e);case Ne.StringUTF8:return L3(e);default:throw new Y1("Unable to serialize. Invalid Clarity Value.")}}const B3=(e,t)=>e?bg(e).length>t:!1;var $l={exports:{}},R0;function j3(){if(R0)return $l.exports;R0=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(v,C,O){return Function.prototype.apply.call(v,C,O)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:n=function(v){return Object.getOwnPropertyNames(v)};function r(m){console&&console.warn&&console.warn(m)}var s=Number.isNaN||function(v){return v!==v};function i(){i.init.call(this)}$l.exports=i,$l.exports.once=b,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(m){if(typeof m!="number"||m<0||s(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");o=m}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||s(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this};function c(m){return m._maxListeners===void 0?i.defaultMaxListeners:m._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(v){for(var C=[],O=1;O<arguments.length;O++)C.push(arguments[O]);var D=v==="error",S=this._events;if(S!==void 0)D=D&&S.error===void 0;else if(!D)return!1;if(D){var E;if(C.length>0&&(E=C[0]),E instanceof Error)throw E;var x=new Error("Unhandled error."+(E?" ("+E.message+")":""));throw x.context=E,x}var P=S[v];if(P===void 0)return!1;if(typeof P=="function")t(P,this,C);else for(var M=P.length,R=f(P,M),O=0;O<M;++O)t(R[O],this,C);return!0};function l(m,v,C,O){var D,S,E;if(a(C),S=m._events,S===void 0?(S=m._events=Object.create(null),m._eventsCount=0):(S.newListener!==void 0&&(m.emit("newListener",v,C.listener?C.listener:C),S=m._events),E=S[v]),E===void 0)E=S[v]=C,++m._eventsCount;else if(typeof E=="function"?E=S[v]=O?[C,E]:[E,C]:O?E.unshift(C):E.push(C),D=c(m),D>0&&E.length>D&&!E.warned){E.warned=!0;var x=new Error("Possible EventEmitter memory leak detected. "+E.length+" "+String(v)+" listeners added. Use emitter.setMaxListeners() to increase limit");x.name="MaxListenersExceededWarning",x.emitter=m,x.type=v,x.count=E.length,r(x)}return m}i.prototype.addListener=function(v,C){return l(this,v,C,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(v,C){return l(this,v,C,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(m,v,C){var O={fired:!1,wrapFn:void 0,target:m,type:v,listener:C},D=u.bind(O);return D.listener=C,O.wrapFn=D,D}i.prototype.once=function(v,C){return a(C),this.on(v,d(this,v,C)),this},i.prototype.prependOnceListener=function(v,C){return a(C),this.prependListener(v,d(this,v,C)),this},i.prototype.removeListener=function(v,C){var O,D,S,E,x;if(a(C),D=this._events,D===void 0)return this;if(O=D[v],O===void 0)return this;if(O===C||O.listener===C)--this._eventsCount===0?this._events=Object.create(null):(delete D[v],D.removeListener&&this.emit("removeListener",v,O.listener||C));else if(typeof O!="function"){for(S=-1,E=O.length-1;E>=0;E--)if(O[E]===C||O[E].listener===C){x=O[E].listener,S=E;break}if(S<0)return this;S===0?O.shift():g(O,S),O.length===1&&(D[v]=O[0]),D.removeListener!==void 0&&this.emit("removeListener",v,x||C)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(v){var C,O,D;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[v]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[v]),this;if(arguments.length===0){var S=Object.keys(O),E;for(D=0;D<S.length;++D)E=S[D],E!=="removeListener"&&this.removeAllListeners(E);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(C=O[v],typeof C=="function")this.removeListener(v,C);else if(C!==void 0)for(D=C.length-1;D>=0;D--)this.removeListener(v,C[D]);return this};function h(m,v,C){var O=m._events;if(O===void 0)return[];var D=O[v];return D===void 0?[]:typeof D=="function"?C?[D.listener||D]:[D]:C?w(D):f(D,D.length)}i.prototype.listeners=function(v){return h(this,v,!0)},i.prototype.rawListeners=function(v){return h(this,v,!1)},i.listenerCount=function(m,v){return typeof m.listenerCount=="function"?m.listenerCount(v):p.call(m,v)},i.prototype.listenerCount=p;function p(m){var v=this._events;if(v!==void 0){var C=v[m];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function f(m,v){for(var C=new Array(v),O=0;O<v;++O)C[O]=m[O];return C}function g(m,v){for(;v+1<m.length;v++)m[v]=m[v+1];m.pop()}function w(m){for(var v=new Array(m.length),C=0;C<v.length;++C)v[C]=m[C].listener||m[C];return v}function b(m,v){return new Promise(function(C,O){function D(E){m.removeListener(v,S),O(E)}function S(){typeof m.removeListener=="function"&&m.removeListener("error",D),C([].slice.call(arguments))}y(m,v,S,{once:!0}),v!=="error"&&I(m,D,{once:!0})})}function I(m,v,C){typeof m.on=="function"&&y(m,"error",v,C)}function y(m,v,C,O){if(typeof m.on=="function")O.once?m.once(v,C):m.on(v,C);else if(typeof m.addEventListener=="function")m.addEventListener(v,function D(S){O.once&&m.removeEventListener(v,D),C(S)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m)}return $l.exports}var Hn=j3();const Eg=sd(Hn);var ih={};var Bf=function(e,t){return Bf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},Bf(e,t)};function F3(e,t){Bf(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var jf=function(){return jf=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},jf.apply(this,arguments)};function z3(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function H3(e,t,n,r){var s=arguments.length,i=s<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i}function q3(e,t){return function(n,r){t(n,r,e)}}function W3(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function V3(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})}function K3(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function G3(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}function Y3(e,t){for(var n in e)n!=="default"&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Ff(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function J1(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function Z3(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(J1(arguments[t]));return e}function J3(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),s=0,t=0;t<n;t++)for(var i=arguments[t],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function fc(e){return this instanceof fc?(this.v=e,this):new fc(e)}function X3(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(p){return new Promise(function(f,g){i.push([h,p,f,g])>1||a(h,p)})})}function a(h,p){try{c(r[h](p))}catch(f){d(i[0][3],f)}}function c(h){h.value instanceof fc?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,p){h(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Q3(e){var t,n;return t={},r("next"),r("throw",function(s){throw s}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(s,i){t[s]=e[s]?function(o){return(n=!n)?{value:fc(e[s](o)),done:s==="return"}:i?i(o):o}:i}}function eT(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Ff=="function"?Ff(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(o){return new Promise(function(a,c){o=e[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function tT(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function nT(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function rT(e){return e&&e.__esModule?e:{default:e}}function sT(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function iT(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}const oT=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return jf},__asyncDelegator:Q3,__asyncGenerator:X3,__asyncValues:eT,__await:fc,__awaiter:V3,__classPrivateFieldGet:sT,__classPrivateFieldSet:iT,__createBinding:G3,__decorate:H3,__exportStar:Y3,__extends:F3,__generator:K3,__importDefault:rT,__importStar:nT,__makeTemplateObject:tT,__metadata:W3,__param:q3,__read:J1,__rest:z3,__spread:Z3,__spreadArrays:J3,__values:Ff},Symbol.toStringTag,{value:"Module"})),Jc=BN(oT);var oh={},ma={},M0;function aT(){if(M0)return ma;M0=1,Object.defineProperty(ma,"__esModule",{value:!0}),ma.delay=void 0;function e(t){return new Promise(n=>{setTimeout(()=>{n(!0)},t)})}return ma.delay=e,ma}var Ys={},ah={},Zs={},L0;function cT(){return L0||(L0=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.ONE_THOUSAND=Zs.ONE_HUNDRED=void 0,Zs.ONE_HUNDRED=100,Zs.ONE_THOUSAND=1e3),Zs}var ch={},B0;function lT(){return B0||(B0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365})(ch)),ch}var j0;function X1(){return j0||(j0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Jc;t.__exportStar(cT(),e),t.__exportStar(lT(),e)})(ah)),ah}var F0;function uT(){if(F0)return Ys;F0=1,Object.defineProperty(Ys,"__esModule",{value:!0}),Ys.fromMiliseconds=Ys.toMiliseconds=void 0;const e=X1();function t(r){return r*e.ONE_THOUSAND}Ys.toMiliseconds=t;function n(r){return Math.floor(r/e.ONE_THOUSAND)}return Ys.fromMiliseconds=n,Ys}var z0;function dT(){return z0||(z0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Jc;t.__exportStar(aT(),e),t.__exportStar(uT(),e)})(oh)),oh}var Zi={},H0;function hT(){if(H0)return Zi;H0=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Zi.Watch=e,Zi.default=e,Zi}var lh={},ya={},q0;function fT(){if(q0)return ya;q0=1,Object.defineProperty(ya,"__esModule",{value:!0}),ya.IWatch=void 0;class e{}return ya.IWatch=e,ya}var W0;function pT(){return W0||(W0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),Jc.__exportStar(fT(),e)})(lh)),lh}var V0;function gT(){return V0||(V0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Jc;t.__exportStar(dT(),e),t.__exportStar(hT(),e),t.__exportStar(pT(),e),t.__exportStar(X1(),e)})(ih)),ih}var Y=gT();class Ri{}let wT=class extends Ri{constructor(t){super()}};const K0=Y.FIVE_SECONDS,Mi={pulse:"heartbeat_pulse"};let mT=class Q1 extends wT{constructor(t){super(t),this.events=new Hn.EventEmitter,this.interval=K0,this.interval=t?.interval||K0}static async init(t){const n=new Q1(t);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Y.toMiliseconds(this.interval))}pulse(){this.events.emit(Mi.pulse)}};const yT=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,bT=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,vT=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function ET(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){CT(e);return}return t}function CT(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function kl(e,t={}){if(typeof e!="string")return e;if(e[0]==='"'&&e[e.length-1]==='"'&&e.indexOf("\\")===-1)return e.slice(1,-1);const n=e.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!vT.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(yT.test(e)||bT.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,ET)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}function AT(e){return!e||typeof e.then!="function"?Promise.resolve(e):e}function bt(e,...t){try{return AT(e(...t))}catch(n){return Promise.reject(n)}}function IT(e){const t=typeof e;return e===null||t!=="object"&&t!=="function"}function ST(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}function du(e){if(IT(e))return String(e);if(ST(e)||Array.isArray(e))return JSON.stringify(e);if(typeof e.toJSON=="function")return du(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const zf="base64:";function NT(e){return typeof e=="string"?e:zf+TT(e)}function xT(e){return typeof e!="string"||!e.startsWith(zf)?e:_T(e.slice(zf.length))}function _T(e){return globalThis.Buffer?Buffer.from(e,"base64"):Uint8Array.from(globalThis.atob(e),t=>t.codePointAt(0))}function TT(e){return globalThis.Buffer?Buffer.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint(...e))}function rn(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function OT(...e){return rn(e.join(":"))}function Ul(e){return e=rn(e),e?e+":":""}function DT(e,t){if(t===void 0)return!0;let n=0,r=e.indexOf(":");for(;r>-1;)n++,r=e.indexOf(":",r+1);return n<=t}function PT(e,t){return t?e.startsWith(t)&&e[e.length-1]!=="$":e[e.length-1]!=="$"}const $T="memory",kT=()=>{const e=new Map;return{name:$T,getInstance:()=>e,hasItem(t){return e.has(t)},getItem(t){return e.get(t)??null},getItemRaw(t){return e.get(t)??null},setItem(t,n){e.set(t,n)},setItemRaw(t,n){e.set(t,n)},removeItem(t){e.delete(t)},getKeys(){return[...e.keys()]},clear(){e.clear()},dispose(){e.clear()}}};function UT(e={}){const t={mounts:{"":e.driver||kT()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of t.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:t.mounts[u]};return{base:"",relativeKey:l,driver:t.mounts[""]}},r=(l,u)=>t.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:t.mounts[d]})),s=(l,u)=>{if(t.watching){u=rn(u);for(const d of t.watchListeners)d(l,u)}},i=async()=>{if(!t.watching){t.watching=!0;for(const l in t.mounts)t.unwatch[l]=await G0(t.mounts[l],s,l)}},o=async()=>{if(t.watching){for(const l in t.unwatch)await t.unwatch[l]();t.unwatch={},t.watching=!1}},a=(l,u,d)=>{const h=new Map,p=f=>{let g=h.get(f.base);return g||(g={driver:f.driver,base:f.base,items:[]},h.set(f.base,g)),g};for(const f of l){const g=typeof f=="string",w=rn(g?f:f.key),b=g?void 0:f.value,I=g||!f.options?u:{...u,...f.options},y=n(w);p(y).items.push({key:w,value:b,relativeKey:y.relativeKey,options:I})}return Promise.all([...h.values()].map(f=>d(f))).then(f=>f.flat())},c={hasItem(l,u={}){l=rn(l);const{relativeKey:d,driver:h}=n(l);return bt(h.hasItem,d,u)},getItem(l,u={}){l=rn(l);const{relativeKey:d,driver:h}=n(l);return bt(h.getItem,d,u).then(p=>kl(p))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?bt(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(p=>({key:OT(d.base,p.key),value:kl(p.value)}))):Promise.all(d.items.map(h=>bt(d.driver.getItem,h.relativeKey,h.options).then(p=>({key:h.key,value:kl(p)})))))},getItemRaw(l,u={}){l=rn(l);const{relativeKey:d,driver:h}=n(l);return h.getItemRaw?bt(h.getItemRaw,d,u):bt(h.getItem,d,u).then(p=>xT(p))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=rn(l);const{relativeKey:h,driver:p}=n(l);p.setItem&&(await bt(p.setItem,h,du(u),d),p.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return bt(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:du(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>bt(d.driver.setItem,h.relativeKey,du(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=rn(l);const{relativeKey:h,driver:p}=n(l);if(p.setItemRaw)await bt(p.setItemRaw,h,u,d);else if(p.setItem)await bt(p.setItem,h,NT(u),d);else return;p.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=rn(l);const{relativeKey:d,driver:h}=n(l);h.removeItem&&(await bt(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await bt(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=rn(l);const{relativeKey:d,driver:h}=n(l),p=Object.create(null);if(h.getMeta&&Object.assign(p,await bt(h.getMeta,d,u)),!u.nativeOnly){const f=await bt(h.getItem,d+"$",u).then(g=>kl(g));f&&typeof f=="object"&&(typeof f.atime=="string"&&(f.atime=new Date(f.atime)),typeof f.mtime=="string"&&(f.mtime=new Date(f.mtime)),Object.assign(p,f))}return p},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=Ul(l);const d=r(l,!0);let h=[];const p=[];let f=!0;for(const w of d){w.driver.flags?.maxDepth||(f=!1);const b=await bt(w.driver.getKeys,w.relativeBase,u);for(const I of b){const y=w.mountpoint+rn(I);h.some(m=>y.startsWith(m))||p.push(y)}h=[w.mountpoint,...h.filter(I=>!I.startsWith(w.mountpoint))]}const g=u.maxDepth!==void 0&&!f;return p.filter(w=>(!g||DT(w,u.maxDepth))&&PT(w,l))},async clear(l,u={}){l=Ul(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return bt(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(p=>d.driver.removeItem(p,u)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(l=>Y0(l)))},async watch(l){return await i(),t.watchListeners.push(l),async()=>{t.watchListeners=t.watchListeners.filter(u=>u!==l),t.watchListeners.length===0&&await o()}},async unwatch(){t.watchListeners=[],await o()},mount(l,u){if(l=Ul(l),l&&t.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(t.mountpoints.push(l),t.mountpoints.sort((d,h)=>h.length-d.length)),t.mounts[l]=u,t.watching&&Promise.resolve(G0(u,s,l)).then(d=>{t.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=Ul(l),!(!l||!t.mounts[l])&&(t.watching&&l in t.unwatch&&(t.unwatch[l]?.(),delete t.unwatch[l]),u&&await Y0(t.mounts[l]),t.mountpoints=t.mountpoints.filter(d=>d!==l),delete t.mounts[l])},getMount(l=""){l=rn(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=rn(l),r(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function G0(e,t,n){return e.watch?e.watch((r,s)=>t(r,n+s)):()=>{}}async function Y0(e){typeof e.dispose=="function"&&await bt(e.dispose)}function Li(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function eE(e,t){let n;const r=()=>{if(n)return n;const s=indexedDB.open(e);return s.onupgradeneeded=()=>s.result.createObjectStore(t),n=Li(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(t,s).objectStore(t)))}let uh;function Xc(){return uh||(uh=eE("keyval-store","keyval")),uh}function Z0(e,t=Xc()){return t("readonly",n=>Li(n.get(e)))}function RT(e,t,n=Xc()){return n("readwrite",r=>(r.put(t,e),Li(r.transaction)))}function MT(e,t=Xc()){return t("readwrite",n=>(n.delete(e),Li(n.transaction)))}function LT(e=Xc()){return e("readwrite",t=>(t.clear(),Li(t.transaction)))}function BT(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Li(e.transaction)}function jT(e=Xc()){return e("readonly",t=>{if(t.getAllKeys)return Li(t.getAllKeys());const n=[];return BT(t,r=>n.push(r.key)).then(()=>n)})}const FT=e=>JSON.stringify(e,(t,n)=>typeof n=="bigint"?n.toString()+"n":n),zT=e=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=e.replace(t,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Ti(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return zT(e)}catch{return e}}function es(e){return typeof e=="string"?e:FT(e)||""}const HT="idb-keyval";var qT=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",n=s=>t+s;let r;return e.dbName&&e.storeName&&(r=eE(e.dbName,e.storeName)),{name:HT,options:e,async hasItem(s){return!(typeof await Z0(n(s),r)>"u")},async getItem(s){return await Z0(n(s),r)??null},setItem(s,i){return RT(n(s),i,r)},removeItem(s){return MT(n(s),r)},getKeys(){return jT(r)},clear(){return LT(r)}}};const WT="WALLET_CONNECT_V2_INDEXED_DB",VT="keyvaluestorage";let KT=class{constructor(){this.indexedDb=UT({driver:qT({dbName:WT,storeName:VT})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const n=await this.indexedDb.getItem(t);if(n!==null)return n}async setItem(t,n){await this.indexedDb.setItem(t,es(n))}async removeItem(t){await this.indexedDb.removeItem(t)}};var dh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hu={exports:{}};(function(){let e;function t(){}e=t,e.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},e.prototype.setItem=function(n,r){this[n]=String(r)},e.prototype.removeItem=function(n){delete this[n]},e.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},e.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof dh<"u"&&dh.localStorage?hu.exports=dh.localStorage:typeof window<"u"&&window.localStorage?hu.exports=window.localStorage:hu.exports=new t})();function GT(e){var t;return[e[0],Ti((t=e[1])!=null?t:"")]}let YT=class{constructor(){this.localStorage=hu.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(GT)}async getItem(t){const n=this.localStorage.getItem(t);if(n!==null)return Ti(n)}async setItem(t,n){this.localStorage.setItem(t,es(n))}async removeItem(t){this.localStorage.removeItem(t)}};const ZT="wc_storage_version",J0=1,JT=async(e,t,n)=>{const r=ZT,s=await t.getItem(r);if(s&&s>=J0){n(t);return}const i=await e.getKeys();if(!i.length){n(t);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await e.getItem(a);await t.setItem(a,l),o.push(a)}}await t.setItem(r,J0),n(t),XT(e,o)},XT=async(e,t)=>{t.length&&t.forEach(async n=>{await e.removeItem(n)})};let QT=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const t=new YT;this.storage=t;try{const n=new KT;JT(t,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,n){return await this.initialize(),this.storage.setItem(t,n)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),t())},20)})}};var hh,X0;function eO(){if(X0)return hh;X0=1;function e(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}hh=t;function t(n,r,s){var i=s&&s.stringify||e,o=1;if(typeof n=="object"&&n!==null){var a=r.length+o;if(a===1)return n;var c=new Array(a);c[0]=i(n);for(var l=1;l<a;l++)c[l]=i(r[l]);return c.join(" ")}if(typeof n!="string")return n;var u=r.length;if(u===0)return n;for(var d="",h=1-o,p=-1,f=n&&n.length||0,g=0;g<f;){if(n.charCodeAt(g)===37&&g+1<f){switch(p=p>-1?p:0,n.charCodeAt(g+1)){case 100:case 102:if(h>=u||r[h]==null)break;p<g&&(d+=n.slice(p,g)),d+=Number(r[h]),p=g+2,g++;break;case 105:if(h>=u||r[h]==null)break;p<g&&(d+=n.slice(p,g)),d+=Math.floor(Number(r[h])),p=g+2,g++;break;case 79:case 111:case 106:if(h>=u||r[h]===void 0)break;p<g&&(d+=n.slice(p,g));var w=typeof r[h];if(w==="string"){d+="'"+r[h]+"'",p=g+2,g++;break}if(w==="function"){d+=r[h].name||"<anonymous>",p=g+2,g++;break}d+=i(r[h]),p=g+2,g++;break;case 115:if(h>=u)break;p<g&&(d+=n.slice(p,g)),d+=String(r[h]),p=g+2,g++;break;case 37:p<g&&(d+=n.slice(p,g)),d+="%",p=g+2,g++,h--;break}++h}++g}return p===-1?n:(p<f&&(d+=n.slice(p)),d)}return hh}var fh,Q0;function tO(){if(Q0)return fh;Q0=1;const e=eO();fh=s;const t=v().console||{},n={mapHttpRequest:f,mapHttpResponse:f,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:f,res:f,err:h};function r(C,O){return Array.isArray(C)?C.filter(function(S){return S!=="!stdSerializers.err"}):C===!0?Object.keys(O):!1}function s(C){C=C||{},C.browser=C.browser||{};const O=C.browser.transmit;if(O&&typeof O.send!="function")throw Error("pino: transmit option must have a send function");const D=C.browser.write||t;C.browser.write&&(C.browser.asObject=!0);const S=C.serializers||{},E=r(C.browser.serialize,S);let x=C.browser.serialize;Array.isArray(C.browser.serialize)&&C.browser.serialize.indexOf("!stdSerializers.err")>-1&&(x=!1);const P=["error","fatal","warn","info","debug","trace"];typeof D=="function"&&(D.error=D.fatal=D.warn=D.info=D.debug=D.trace=D),C.enabled===!1&&(C.level="silent");const M=C.level||"info",R=Object.create(D);R.log||(R.log=w),Object.defineProperty(R,"levelVal",{get:_}),Object.defineProperty(R,"level",{get:k,set:L});const A={transmit:O,serialize:E,asObject:C.browser.asObject,levels:P,timestamp:p(C)};R.levels=s.levels,R.level=M,R.setMaxListeners=R.getMaxListeners=R.emit=R.addListener=R.on=R.prependListener=R.once=R.prependOnceListener=R.removeListener=R.removeAllListeners=R.listeners=R.listenerCount=R.eventNames=R.write=R.flush=w,R.serializers=S,R._serialize=E,R._stdErrSerialize=x,R.child=U,O&&(R._logEvent=d());function _(){return this.level==="silent"?1/0:this.levels.values[this.level]}function k(){return this._level}function L($){if($!=="silent"&&!this.levels.values[$])throw Error("unknown level "+$);this._level=$,i(A,R,"error","log"),i(A,R,"fatal","error"),i(A,R,"warn","error"),i(A,R,"info","log"),i(A,R,"debug","log"),i(A,R,"trace","log")}function U($,F){if(!$)throw new Error("missing bindings for child Pino");F=F||{},E&&$.serializers&&(F.serializers=$.serializers);const G=F.serializers;if(E&&G){var Z=Object.assign({},S,G),V=C.browser.serialize===!0?Object.keys(Z):E;delete $.serializers,c([$],V,Z,this._stdErrSerialize)}function ne(ue){this._childLevel=(ue._childLevel|0)+1,this.error=l(ue,$,"error"),this.fatal=l(ue,$,"fatal"),this.warn=l(ue,$,"warn"),this.info=l(ue,$,"info"),this.debug=l(ue,$,"debug"),this.trace=l(ue,$,"trace"),Z&&(this.serializers=Z,this._serialize=V),O&&(this._logEvent=d([].concat(ue._logEvent.bindings,$)))}return ne.prototype=this,new ne(this)}return R}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=n,s.stdTimeFunctions=Object.assign({},{nullTime:b,epochTime:I,unixTime:y,isoTime:m});function i(C,O,D,S){const E=Object.getPrototypeOf(O);O[D]=O.levelVal>O.levels.values[D]?w:E[D]?E[D]:t[D]||t[S]||w,o(C,O,D)}function o(C,O,D){!C.transmit&&O[D]===w||(O[D]=(function(S){return function(){const x=C.timestamp(),P=new Array(arguments.length),M=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var R=0;R<P.length;R++)P[R]=arguments[R];if(C.serialize&&!C.asObject&&c(P,this._serialize,this.serializers,this._stdErrSerialize),C.asObject?S.call(M,a(this,D,P,x)):S.apply(M,P),C.transmit){const A=C.transmit.level||O.level,_=s.levels.values[A],k=s.levels.values[D];if(k<_)return;u(this,{ts:x,methodLevel:D,methodValue:k,transmitValue:s.levels.values[C.transmit.level||O.level],send:C.transmit.send,val:O.levelVal},P)}}})(O[D]))}function a(C,O,D,S){C._serialize&&c(D,C._serialize,C.serializers,C._stdErrSerialize);const E=D.slice();let x=E[0];const P={};S&&(P.time=S),P.level=s.levels.values[O];let M=(C._childLevel|0)+1;if(M<1&&(M=1),x!==null&&typeof x=="object"){for(;M--&&typeof E[0]=="object";)Object.assign(P,E.shift());x=E.length?e(E.shift(),E):void 0}else typeof x=="string"&&(x=e(E.shift(),E));return x!==void 0&&(P.msg=x),P}function c(C,O,D,S){for(const E in C)if(S&&C[E]instanceof Error)C[E]=s.stdSerializers.err(C[E]);else if(typeof C[E]=="object"&&!Array.isArray(C[E]))for(const x in C[E])O&&O.indexOf(x)>-1&&x in D&&(C[E][x]=D[x](C[E][x]))}function l(C,O,D){return function(){const S=new Array(1+arguments.length);S[0]=O;for(var E=1;E<S.length;E++)S[E]=arguments[E-1];return C[D].apply(this,S)}}function u(C,O,D){const S=O.send,E=O.ts,x=O.methodLevel,P=O.methodValue,M=O.val,R=C._logEvent.bindings;c(D,C._serialize||Object.keys(C.serializers),C.serializers,C._stdErrSerialize===void 0?!0:C._stdErrSerialize),C._logEvent.ts=E,C._logEvent.messages=D.filter(function(A){return R.indexOf(A)===-1}),C._logEvent.level.label=x,C._logEvent.level.value=P,S(x,C._logEvent,M),C._logEvent=d(R)}function d(C){return{ts:0,messages:[],bindings:C||[],level:{label:"",value:0}}}function h(C){const O={type:C.constructor.name,msg:C.message,stack:C.stack};for(const D in C)O[D]===void 0&&(O[D]=C[D]);return O}function p(C){return typeof C.timestamp=="function"?C.timestamp:C.timestamp===!1?b:I}function f(){return{}}function g(C){return C}function w(){}function b(){return!1}function I(){return Date.now()}function y(){return Math.round(Date.now()/1e3)}function m(){return new Date(Date.now()).toISOString()}function v(){function C(O){return typeof O<"u"&&O}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return C(self)||C(window)||C(this)||{}}}return fh}var yo=tO();const Qc=sd(yo),nO={level:"info"},el="custom_context",Cg=1e3*1024;let rO=class{constructor(t){this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},em=class{constructor(t){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const n=new rO(t);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let n=this.head;for(;n!==null;)t.push(n.value),n=n.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const n=t.value;return t=t.next,{done:!1,value:n}}}}},tE=class{constructor(t,n=Cg){this.level=t??"error",this.levelValue=yo.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new em(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,n){n===yo.levels.values.error?console.error(t):n===yo.levels.values.warn?console.warn(t):n===yo.levels.values.debug?console.debug(t):n===yo.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(es({timestamp:new Date().toISOString(),log:t}));const n=typeof t=="string"?JSON.parse(t).level:t.level;n>=this.levelValue&&this.forwardToConsole(t,n)}getLogs(){return this.logs}clearLogs(){this.logs=new em(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const n=this.getLogArray();return n.push(es({extraMetadata:t})),new Blob(n,{type:"application/json"})}},sO=class{constructor(t,n=Cg){this.baseChunkLogger=new tE(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const n=URL.createObjectURL(this.logsToBlob(t)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},iO=class{constructor(t,n=Cg){this.baseChunkLogger=new tE(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}};var oO=Object.defineProperty,aO=Object.defineProperties,cO=Object.getOwnPropertyDescriptors,tm=Object.getOwnPropertySymbols,lO=Object.prototype.hasOwnProperty,uO=Object.prototype.propertyIsEnumerable,nm=(e,t,n)=>t in e?oO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Uu=(e,t)=>{for(var n in t||(t={}))lO.call(t,n)&&nm(e,n,t[n]);if(tm)for(var n of tm(t))uO.call(t,n)&&nm(e,n,t[n]);return e},Ru=(e,t)=>aO(e,cO(t));function tl(e){return Ru(Uu({},e),{level:e?.level||nO.level})}function dO(e,t=el){return e[t]||""}function hO(e,t,n=el){return e[n]=t,e}function dn(e,t=el){let n="";return typeof e.bindings>"u"?n=dO(e,t):n=e.bindings().context||"",n}function fO(e,t,n=el){const r=dn(e,n);return r.trim()?`${r}/${t}`:t}function Kt(e,t,n=el){const r=fO(e,t,n),s=e.child({context:r});return hO(s,r,n)}function pO(e){var t,n;const r=new sO((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Qc(Ru(Uu({},e.opts),{level:"trace",browser:Ru(Uu({},(n=e.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function gO(e){var t;const n=new iO((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:Qc(Ru(Uu({},e.opts),{level:"trace"}),n),chunkLoggerController:n}}function nE(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?pO(e):gO(e)}var wO=Object.defineProperty,mO=(e,t,n)=>t in e?wO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,rm=(e,t,n)=>mO(e,typeof t!="symbol"?t+"":t,n);let yO=class extends Ri{constructor(t){super(),this.opts=t,rm(this,"protocol","wc"),rm(this,"version",2)}};var bO=Object.defineProperty,vO=(e,t,n)=>t in e?bO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,EO=(e,t,n)=>vO(e,t+"",n);let CO=class extends Ri{constructor(t,n){super(),this.core=t,this.logger=n,EO(this,"records",new Map)}},AO=class{constructor(t,n){this.logger=t,this.core=n}},IO=class extends Ri{constructor(t,n){super(),this.relayer=t,this.logger=n}},SO=class extends Ri{constructor(t){super()}},NO=class{constructor(t,n,r,s){this.core=t,this.logger=n,this.name=r}},xO=class extends Ri{constructor(t,n){super(),this.relayer=t,this.logger=n}},_O=class extends Ri{constructor(t,n){super(),this.core=t,this.logger=n}},TO=class{constructor(t,n,r){this.core=t,this.logger=n,this.store=r}},OO=class{constructor(t,n){this.projectId=t,this.logger=n}},DO=class{constructor(t,n,r){this.core=t,this.logger=n,this.telemetryEnabled=r}};var PO=Object.defineProperty,$O=(e,t,n)=>t in e?PO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,sm=(e,t,n)=>$O(e,typeof t!="symbol"?t+"":t,n);let kO=class{constructor(t){this.opts=t,sm(this,"protocol","wc"),sm(this,"version",2)}},UO=class{constructor(t){this.client=t}};function RO(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function rE(e,...t){if(!RO(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function im(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function MO(e,t){rE(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const Ji=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const ph=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function LO(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function sE(e){return typeof e=="string"&&(e=LO(e)),rE(e),e}let BO=class{clone(){return this._cloneInto()}};function jO(e){const t=r=>e().update(sE(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function iE(e=32){if(Ji&&typeof Ji.getRandomValues=="function")return Ji.getRandomValues(new Uint8Array(e));if(Ji&&typeof Ji.randomBytes=="function")return Ji.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function FO(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}let zO=class extends BO{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=ph(this.buffer)}update(t){im(this);const{view:n,buffer:r,blockLen:s}=this;t=sE(t);const i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=ph(t);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){im(this),MO(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;FO(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=ph(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.length=s,t.pos=a,t.finished=i,t.destroyed=o,s%n&&t.buffer.set(r),t}};const Rl=BigInt(2**32-1),Hf=BigInt(32);function oE(e,t=!1){return t?{h:Number(e&Rl),l:Number(e>>Hf&Rl)}:{h:Number(e>>Hf&Rl)|0,l:Number(e&Rl)|0}}function HO(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:i,l:o}=oE(e[s],t);[n[s],r[s]]=[i,o]}return[n,r]}const qO=(e,t)=>BigInt(e>>>0)<<Hf|BigInt(t>>>0),WO=(e,t,n)=>e>>>n,VO=(e,t,n)=>e<<32-n|t>>>n,KO=(e,t,n)=>e>>>n|t<<32-n,GO=(e,t,n)=>e<<32-n|t>>>n,YO=(e,t,n)=>e<<64-n|t>>>n-32,ZO=(e,t,n)=>e>>>n-32|t<<64-n,JO=(e,t)=>t,XO=(e,t)=>e,QO=(e,t,n)=>e<<n|t>>>32-n,eD=(e,t,n)=>t<<n|e>>>32-n,tD=(e,t,n)=>t<<n-32|e>>>64-n,nD=(e,t,n)=>e<<n-32|t>>>64-n;function rD(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const sD=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),iD=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,oD=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),aD=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,cD=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),lD=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,ye={fromBig:oE,split:HO,toBig:qO,shrSH:WO,shrSL:VO,rotrSH:KO,rotrSL:GO,rotrBH:YO,rotrBL:ZO,rotr32H:JO,rotr32L:XO,rotlSH:QO,rotlSL:eD,rotlBH:tD,rotlBL:nD,add:rD,add3L:sD,add3H:iD,add4L:oD,add4H:aD,add5H:lD,add5L:cD},[uD,dD]=ye.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),cs=new Uint32Array(80),ls=new Uint32Array(80);let hD=class extends zO{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:f,Hh:g,Hl:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=f|0,this.Hh=g|0,this.Hl=w|0}process(t,n){for(let y=0;y<16;y++,n+=4)cs[y]=t.getUint32(n),ls[y]=t.getUint32(n+=4);for(let y=16;y<80;y++){const m=cs[y-15]|0,v=ls[y-15]|0,C=ye.rotrSH(m,v,1)^ye.rotrSH(m,v,8)^ye.shrSH(m,v,7),O=ye.rotrSL(m,v,1)^ye.rotrSL(m,v,8)^ye.shrSL(m,v,7),D=cs[y-2]|0,S=ls[y-2]|0,E=ye.rotrSH(D,S,19)^ye.rotrBH(D,S,61)^ye.shrSH(D,S,6),x=ye.rotrSL(D,S,19)^ye.rotrBL(D,S,61)^ye.shrSL(D,S,6),P=ye.add4L(O,x,ls[y-7],ls[y-16]),M=ye.add4H(P,C,E,cs[y-7],cs[y-16]);cs[y]=M|0,ls[y]=P|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:f,Gh:g,Gl:w,Hh:b,Hl:I}=this;for(let y=0;y<80;y++){const m=ye.rotrSH(d,h,14)^ye.rotrSH(d,h,18)^ye.rotrBH(d,h,41),v=ye.rotrSL(d,h,14)^ye.rotrSL(d,h,18)^ye.rotrBL(d,h,41),C=d&p^~d&g,O=h&f^~h&w,D=ye.add5L(I,v,O,dD[y],ls[y]),S=ye.add5H(D,b,m,C,uD[y],cs[y]),E=D|0,x=ye.rotrSH(r,s,28)^ye.rotrBH(r,s,34)^ye.rotrBH(r,s,39),P=ye.rotrSL(r,s,28)^ye.rotrBL(r,s,34)^ye.rotrBL(r,s,39),M=r&i^r&a^i&a,R=s&o^s&c^o&c;b=g|0,I=w|0,g=p|0,w=f|0,p=d|0,f=h|0,{h:d,l:h}=ye.add(l|0,u|0,S|0,E|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=ye.add3L(E,P,R);r=ye.add3H(A,S,x,M),s=A|0}({h:r,l:s}=ye.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=ye.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ye.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ye.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=ye.add(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:f}=ye.add(this.Fh|0,this.Fl|0,p|0,f|0),{h:g,l:w}=ye.add(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:I}=ye.add(this.Hh|0,this.Hl|0,b|0,I|0),this.set(r,s,i,o,a,c,l,u,d,h,p,f,g,w,b,I)}roundClean(){cs.fill(0),ls.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const fD=jO(()=>new hD);const Ag=BigInt(0),aE=BigInt(1),pD=BigInt(2);function Ig(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Sg(e){if(!Ig(e))throw new Error("Uint8Array expected")}function gh(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}const gD=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Ng(e){Sg(e);let t="";for(let n=0;n<e.length;n++)t+=gD[e[n]];return t}function cE(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Ag:BigInt("0x"+e)}const Mr={_0:48,_9:57,A:65,F:70,a:97,f:102};function om(e){if(e>=Mr._0&&e<=Mr._9)return e-Mr._0;if(e>=Mr.A&&e<=Mr.F)return e-(Mr.A-10);if(e>=Mr.a&&e<=Mr.f)return e-(Mr.a-10)}function lE(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=om(e.charCodeAt(i)),a=om(e.charCodeAt(i+1));if(o===void 0||a===void 0){const c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function wD(e){return cE(Ng(e))}function fu(e){return Sg(e),cE(Ng(Uint8Array.from(e).reverse()))}function uE(e,t){return lE(e.toString(16).padStart(t*2,"0"))}function qf(e,t){return uE(e,t).reverse()}function Lr(e,t,n){let r;if(typeof t=="string")try{r=lE(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(Ig(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}function am(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];Sg(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}const wh=e=>typeof e=="bigint"&&Ag<=e;function mD(e,t,n){return wh(e)&&wh(t)&&wh(n)&&t<=e&&e<n}function ba(e,t,n,r){if(!mD(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function yD(e){let t;for(t=0;e>Ag;e>>=aE,t+=1);return t}const bD=e=>(pD<<BigInt(e-1))-aE,vD={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Ig(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function xg(e,t,n={}){const r=(s,i,o)=>{const a=vD[i];if(typeof a!="function")throw new Error("invalid validator function");const c=e[s];if(!(o&&c===void 0)&&!a(c,e))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(t))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return e}function cm(e){const t=new WeakMap;return(n,...r)=>{const s=t.get(n);if(s!==void 0)return s;const i=e(n,...r);return t.set(n,i),i}}const At=BigInt(0),ot=BigInt(1),oi=BigInt(2),ED=BigInt(3),Wf=BigInt(4),lm=BigInt(5),um=BigInt(8);function wt(e,t){const n=e%t;return n>=At?n:t+n}function CD(e,t,n){if(t<At)throw new Error("invalid exponent, negatives unsupported");if(n<=At)throw new Error("invalid modulus");if(n===ot)return At;let r=ot;for(;t>At;)t&ot&&(r=r*e%n),e=e*e%n,t>>=ot;return r}function hr(e,t,n){let r=e;for(;t-- >At;)r*=r,r%=n;return r}function dm(e,t){if(e===At)throw new Error("invert: expected non-zero number");if(t<=At)throw new Error("invert: expected positive modulus, got "+t);let n=wt(e,t),r=t,s=At,i=ot;for(;n!==At;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==ot)throw new Error("invert: does not exist");return wt(s,t)}function AD(e){const t=(e-ot)/oi;let n,r,s;for(n=e-ot,r=0;n%oi===At;n/=oi,r++);for(s=oi;s<e&&CD(s,t,e)!==e-ot;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(e+ot)/Wf;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+ot)/oi;return function(o,a){if(o.pow(a,t)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let f=o.sqr(d);h<c&&!o.eql(f,o.ONE);h++)f=o.sqr(f);const p=o.pow(l,ot<<BigInt(c-h-1));l=o.sqr(p),u=o.mul(u,p),d=o.mul(d,l),c=h}return u}}function ID(e){if(e%Wf===ED){const t=(e+ot)/Wf;return function(n,r){const s=n.pow(r,t);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(e%um===lm){const t=(e-lm)/um;return function(n,r){const s=n.mul(r,oi),i=n.pow(s,t),o=n.mul(r,i),a=n.mul(n.mul(o,oi),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return AD(e)}const SD=(e,t)=>(wt(e,t)&ot)===ot,ND=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function xD(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=ND.reduce((r,s)=>(r[s]="function",r),t);return xg(e,n)}function _D(e,t,n){if(n<At)throw new Error("invalid exponent, negatives unsupported");if(n===At)return e.ONE;if(n===ot)return t;let r=e.ONE,s=t;for(;n>At;)n&ot&&(r=e.mul(r,s)),s=e.sqr(s),n>>=ot;return r}function TD(e,t){const n=new Array(t.length),r=t.reduce((i,o,a)=>e.is0(o)?i:(n[a]=i,e.mul(i,o)),e.ONE),s=e.inv(r);return t.reduceRight((i,o,a)=>e.is0(o)?i:(n[a]=e.mul(i,n[a]),e.mul(i,o)),s),n}function dE(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function hE(e,t,n=!1,r={}){if(e<=At)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:s,nByteLength:i}=dE(e,t);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:n,BITS:s,BYTES:i,MASK:bD(s),ZERO:At,ONE:ot,create:c=>wt(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return At<=c&&c<e},is0:c=>c===At,isOdd:c=>(c&ot)===ot,neg:c=>wt(-c,e),eql:(c,l)=>c===l,sqr:c=>wt(c*c,e),add:(c,l)=>wt(c+l,e),sub:(c,l)=>wt(c-l,e),mul:(c,l)=>wt(c*l,e),pow:(c,l)=>_D(a,c,l),div:(c,l)=>wt(c*dm(l,e),e),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>dm(c,e),sqrt:r.sqrt||(c=>(o||(o=ID(e)),o(a,c))),invertBatch:c=>TD(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?qf(c,i):uE(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?fu(c):wD(c)}});return Object.freeze(a)}const hm=BigInt(0),Ml=BigInt(1);function mh(e,t){const n=t.negate();return e?n:t}function fE(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function yh(e,t){fE(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1);return{windows:n,windowSize:r}}function OD(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function DD(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const bh=new WeakMap,pE=new WeakMap;function vh(e){return pE.get(e)||1}function PD(e,t){return{constTimeNegate:mh,hasPrecomputes(n){return vh(n)!==1},unsafeLadder(n,r,s=e.ZERO){let i=n;for(;r>hm;)r&Ml&&(s=s.add(i)),i=i.double(),r>>=Ml;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=yh(r,t),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=yh(n,t);let a=e.ZERO,c=e.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const p=h*o;let f=Number(s&l);s>>=d,f>o&&(f-=u,s+=Ml);const g=p,w=p+Math.abs(f)-1,b=h%2!==0,I=f<0;f===0?c=c.add(mh(b,r[g])):a=a.add(mh(I,r[w]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=e.ZERO){const{windows:o,windowSize:a}=yh(n,t),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===hm)break;let p=Number(s&c);if(s>>=u,p>a&&(p-=l,s+=Ml),p===0)continue;let f=r[h+Math.abs(p)-1];p<0&&(f=f.negate()),i=i.add(f)}return i},getPrecomputes(n,r,s){let i=bh.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&bh.set(r,s(i))),i},wNAFCached(n,r,s){const i=vh(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=vh(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){fE(r,t),pE.set(n,r),bh.delete(n)}}}function $D(e,t,n,r){if(OD(n,e),DD(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,i=yD(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((t.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let p=0;p<r.length;p++){const f=r[p],g=Number(f>>BigInt(d)&BigInt(a));c[g]=c[g].add(n[p])}let h=s;for(let p=c.length-1,f=s;p>0;p--)f=f.add(c[p]),h=h.add(f);if(u=u.add(h),d!==0)for(let p=0;p<o;p++)u=u.double()}return u}function kD(e){return xD(e.Fp),xg(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...dE(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const Kn=BigInt(0),Zt=BigInt(1),Ll=BigInt(2),UD=BigInt(8),RD={zip215:!0};function MD(e){const t=kD(e);return xg(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function LD(e){const t=MD(e),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=t,l=Ll<<BigInt(a*8)-Zt,u=n.create,d=hE(t.n,t.nBitLength),h=t.uvRatio||((A,_)=>{try{return{isValid:!0,value:n.sqrt(A*n.inv(_))}}catch{return{isValid:!1,value:Kn}}}),p=t.adjustScalarBytes||(A=>A),f=t.domain||((A,_,k)=>{if(gh("phflag",k),_.length||k)throw new Error("Contexts/pre-hash are not supported");return A});function g(A,_){ba("coordinate "+A,_,Kn,l)}function w(A){if(!(A instanceof y))throw new Error("ExtendedPoint expected")}const b=cm((A,_)=>{const{ex:k,ey:L,ez:U}=A,$=A.is0();_==null&&(_=$?UD:n.inv(U));const F=u(k*_),G=u(L*_),Z=u(U*_);if($)return{x:Kn,y:Zt};if(Z!==Zt)throw new Error("invZ was invalid");return{x:F,y:G}}),I=cm(A=>{const{a:_,d:k}=t;if(A.is0())throw new Error("bad point: ZERO");const{ex:L,ey:U,ez:$,et:F}=A,G=u(L*L),Z=u(U*U),V=u($*$),ne=u(V*V),ue=u(G*_),_e=u(V*u(ue+Z)),Ie=u(ne+u(k*u(G*Z)));if(_e!==Ie)throw new Error("bad point: equation left != right (1)");const be=u(L*U),nt=u($*F);if(be!==nt)throw new Error("bad point: equation left != right (2)");return!0});class y{constructor(_,k,L,U){this.ex=_,this.ey=k,this.ez=L,this.et=U,g("x",_),g("y",k),g("z",L),g("t",U),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(_){if(_ instanceof y)throw new Error("extended point not allowed");const{x:k,y:L}=_||{};return g("x",k),g("y",L),new y(k,L,Zt,u(k*L))}static normalizeZ(_){const k=n.invertBatch(_.map(L=>L.ez));return _.map((L,U)=>L.toAffine(k[U])).map(y.fromAffine)}static msm(_,k){return $D(y,d,_,k)}_setWindowSize(_){C.setWindowSize(this,_)}assertValidity(){I(this)}equals(_){w(_);const{ex:k,ey:L,ez:U}=this,{ex:$,ey:F,ez:G}=_,Z=u(k*G),V=u($*U),ne=u(L*G),ue=u(F*U);return Z===V&&ne===ue}is0(){return this.equals(y.ZERO)}negate(){return new y(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:_}=t,{ex:k,ey:L,ez:U}=this,$=u(k*k),F=u(L*L),G=u(Ll*u(U*U)),Z=u(_*$),V=k+L,ne=u(u(V*V)-$-F),ue=Z+F,_e=ue-G,Ie=Z-F,be=u(ne*_e),nt=u(ue*Ie),lt=u(ne*Ie),$r=u(_e*ue);return new y(be,nt,$r,lt)}add(_){w(_);const{a:k,d:L}=t,{ex:U,ey:$,ez:F,et:G}=this,{ex:Z,ey:V,ez:ne,et:ue}=_;if(k===BigInt(-1)){const gl=u(($-U)*(V+Z)),js=u(($+U)*(V-Z)),Fs=u(js-gl);if(Fs===Kn)return this.double();const la=u(F*Ll*ue),ua=u(G*Ll*ne),Vn=ua+la,zs=js+gl,wl=ua-la,ml=u(Vn*Fs),yl=u(zs*wl),bl=u(Vn*wl),Dd=u(Fs*zs);return new y(ml,yl,Dd,bl)}const _e=u(U*Z),Ie=u($*V),be=u(G*L*ue),nt=u(F*ne),lt=u((U+$)*(Z+V)-_e-Ie),$r=nt-be,qi=nt+be,kr=u(Ie-k*_e),Wi=u(lt*$r),ca=u(qi*kr),pl=u(lt*kr),Od=u($r*qi);return new y(Wi,ca,Od,pl)}subtract(_){return this.add(_.negate())}wNAF(_){return C.wNAFCached(this,_,y.normalizeZ)}multiply(_){const k=_;ba("scalar",k,Zt,r);const{p:L,f:U}=this.wNAF(k);return y.normalizeZ([L,U])[0]}multiplyUnsafe(_,k=y.ZERO){const L=_;return ba("scalar",L,Kn,r),L===Kn?v:this.is0()||L===Zt?this:C.wNAFCachedUnsafe(this,L,y.normalizeZ,k)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return C.unsafeLadder(this,r).is0()}toAffine(_){return b(this,_)}clearCofactor(){const{h:_}=t;return _===Zt?this:this.multiplyUnsafe(_)}static fromHex(_,k=!1){const{d:L,a:U}=t,$=n.BYTES;_=Lr("pointHex",_,$),gh("zip215",k);const F=_.slice(),G=_[$-1];F[$-1]=G&-129;const Z=fu(F),V=k?l:n.ORDER;ba("pointHex.y",Z,Kn,V);const ne=u(Z*Z),ue=u(ne-Zt),_e=u(L*ne-U);let{isValid:Ie,value:be}=h(ue,_e);if(!Ie)throw new Error("Point.fromHex: invalid y coordinate");const nt=(be&Zt)===Zt,lt=(G&128)!==0;if(!k&&be===Kn&&lt)throw new Error("Point.fromHex: x=0 and x_0=1");return lt!==nt&&(be=u(-be)),y.fromAffine({x:be,y:Z})}static fromPrivateKey(_){return S(_).point}toRawBytes(){const{x:_,y:k}=this.toAffine(),L=qf(k,n.BYTES);return L[L.length-1]|=_&Zt?128:0,L}toHex(){return Ng(this.toRawBytes())}}y.BASE=new y(t.Gx,t.Gy,Zt,u(t.Gx*t.Gy)),y.ZERO=new y(Kn,Zt,Zt,Kn);const{BASE:m,ZERO:v}=y,C=PD(y,a*8);function O(A){return wt(A,r)}function D(A){return O(fu(A))}function S(A){const _=n.BYTES;A=Lr("private key",A,_);const k=Lr("hashed private key",i(A),2*_),L=p(k.slice(0,_)),U=k.slice(_,2*_),$=D(L),F=m.multiply($),G=F.toRawBytes();return{head:L,prefix:U,scalar:$,point:F,pointBytes:G}}function E(A){return S(A).pointBytes}function x(A=new Uint8Array,..._){const k=am(..._);return D(i(f(k,Lr("context",A),!!s)))}function P(A,_,k={}){A=Lr("message",A),s&&(A=s(A));const{prefix:L,scalar:U,pointBytes:$}=S(_),F=x(k.context,L,A),G=m.multiply(F).toRawBytes(),Z=x(k.context,G,$,A),V=O(F+Z*U);ba("signature.s",V,Kn,r);const ne=am(G,qf(V,n.BYTES));return Lr("result",ne,n.BYTES*2)}const M=RD;function R(A,_,k,L=M){const{context:U,zip215:$}=L,F=n.BYTES;A=Lr("signature",A,2*F),_=Lr("message",_),k=Lr("publicKey",k,F),$!==void 0&&gh("zip215",$),s&&(_=s(_));const G=fu(A.slice(F,2*F));let Z,V,ne;try{Z=y.fromHex(k,$),V=y.fromHex(A.slice(0,F),$),ne=m.multiplyUnsafe(G)}catch{return!1}if(!$&&Z.isSmallOrder())return!1;const ue=x(U,V.toRawBytes(),Z.toRawBytes(),_);return V.add(Z.multiplyUnsafe(ue)).subtract(ne).clearCofactor().equals(y.ZERO)}return m._setWindowSize(8),{CURVE:t,getPublicKey:E,sign:P,verify:R,ExtendedPoint:y,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>o(n.BYTES),precompute(A=8,_=y.BASE){return _._setWindowSize(A),_.multiply(BigInt(3)),_}}}}BigInt(0),BigInt(1);const _g=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),fm=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const BD=BigInt(1),pm=BigInt(2);BigInt(3);const jD=BigInt(5),FD=BigInt(8);function zD(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=_g,o=e*e%i*e%i,a=hr(o,pm,i)*o%i,c=hr(a,BD,i)*e%i,l=hr(c,jD,i)*c%i,u=hr(l,t,i)*l%i,d=hr(u,n,i)*u%i,h=hr(d,r,i)*d%i,p=hr(h,s,i)*h%i,f=hr(p,s,i)*h%i,g=hr(f,t,i)*l%i;return{pow_p_5_8:hr(g,pm,i)*e%i,b2:o}}function HD(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function qD(e,t){const n=_g,r=wt(t*t*t,n),s=wt(r*r*t,n),i=zD(e*s).pow_p_5_8;let o=wt(e*r*i,n);const a=wt(t*o*o,n),c=o,l=wt(o*fm,n),u=a===e,d=a===wt(-e,n),h=a===wt(-e*fm,n);return u&&(o=c),(d||h)&&(o=l),SD(o,n)&&(o=wt(-o,n)),{isValid:u||d,value:o}}const WD=hE(_g,void 0,!0),VD={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:WD,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:FD,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:fD,randomBytes:iE,adjustScalarBytes:HD,uvRatio:qD},gE=LD(VD),KD="EdDSA",GD="JWT",Mu=".",cd="base64url",wE="utf8",mE="utf8",YD=":",ZD="did",JD="key",gm="base58btc",XD="z",QD="K36",eP=32;function Tg(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function yE(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Tg(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function bE(e,t){t||(t=e.reduce((s,i)=>s+i.length,0));const n=yE(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return Tg(n)}function tP(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=e.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=n[f.charCodeAt(g)];if(m===255)return;for(var v=0,C=I-1;(m!==0||v<b)&&C!==-1;C--,v++)m+=a*y[C]>>>0,y[C]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");b=v,g++}if(f[g]!==" "){for(var O=I-b;O!==I&&y[O]===0;)O++;for(var D=new Uint8Array(w+(I-O)),S=w;O!==I;)D[S++]=y[O++];return D}}}function p(f){var g=h(f);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var nP=tP,rP=nP;const vE=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},sP=e=>new TextEncoder().encode(e),iP=e=>new TextDecoder().decode(e);let oP=class{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},aP=class{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return EE(this,t)}},cP=class{constructor(t){this.decoders=t}or(t){return EE(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const EE=(e,t)=>new cP({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});let lP=class{constructor(t,n,r,s){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new oP(t,n,r),this.decoder=new aP(t,n,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const ld=({name:e,prefix:t,encode:n,decode:r})=>new lP(e,t,n,r),nl=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:s}=rP(n,t);return ld({prefix:e,name:t,encode:r,decode:i=>vE(s(i))})},uP=(e,t,n,r)=>{const s={};for(let u=0;u<t.length;++u)s[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},dP=(e,t,n)=>{const r=t[t.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,i+=t[s&a>>o];if(o&&(i+=t[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},$t=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>ld({prefix:t,name:e,encode(s){return dP(s,r,n)},decode(s){return uP(s,r,n,e)}}),hP=ld({prefix:"\0",name:"identity",encode:e=>iP(e),decode:e=>sP(e)});var fP=Object.freeze({__proto__:null,identity:hP});const pP=$t({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var gP=Object.freeze({__proto__:null,base2:pP});const wP=$t({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var mP=Object.freeze({__proto__:null,base8:wP});const yP=nl({prefix:"9",name:"base10",alphabet:"0123456789"});var bP=Object.freeze({__proto__:null,base10:yP});const vP=$t({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),EP=$t({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var CP=Object.freeze({__proto__:null,base16:vP,base16upper:EP});const AP=$t({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),IP=$t({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),SP=$t({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),NP=$t({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),xP=$t({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),_P=$t({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),TP=$t({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),OP=$t({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),DP=$t({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var PP=Object.freeze({__proto__:null,base32:AP,base32upper:IP,base32pad:SP,base32padupper:NP,base32hex:xP,base32hexupper:_P,base32hexpad:TP,base32hexpadupper:OP,base32z:DP});const $P=nl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),kP=nl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var UP=Object.freeze({__proto__:null,base36:$P,base36upper:kP});const RP=nl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),MP=nl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var LP=Object.freeze({__proto__:null,base58btc:RP,base58flickr:MP});const BP=$t({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jP=$t({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),FP=$t({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),zP=$t({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var HP=Object.freeze({__proto__:null,base64:BP,base64pad:jP,base64url:FP,base64urlpad:zP});const CE=Array.from(""),qP=CE.reduce((e,t,n)=>(e[n]=t,e),[]),WP=CE.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function VP(e){return e.reduce((t,n)=>(t+=qP[n],t),"")}function KP(e){const t=[];for(const n of e){const r=WP[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const GP=ld({prefix:"",name:"base256emoji",encode:VP,decode:KP});var YP=Object.freeze({__proto__:null,base256emoji:GP}),ZP=AE,wm=128,JP=-128,XP=Math.pow(2,31);function AE(e,t,n){t=t||[],n=n||0;for(var r=n;e>=XP;)t[n++]=e&255|wm,e/=128;for(;e&JP;)t[n++]=e&255|wm,e>>>=7;return t[n]=e|0,AE.bytes=n-r+1,t}var QP=Vf,e$=128,mm=127;function Vf(e,r){var n=0,r=r||0,s=0,i=r,o,a=e.length;do{if(i>=a)throw Vf.bytes=0,new RangeError("Could not decode varint");o=e[i++],n+=s<28?(o&mm)<<s:(o&mm)*Math.pow(2,s),s+=7}while(o>=e$);return Vf.bytes=i-r,n}var t$=Math.pow(2,7),n$=Math.pow(2,14),r$=Math.pow(2,21),s$=Math.pow(2,28),i$=Math.pow(2,35),o$=Math.pow(2,42),a$=Math.pow(2,49),c$=Math.pow(2,56),l$=Math.pow(2,63),u$=function(e){return e<t$?1:e<n$?2:e<r$?3:e<s$?4:e<i$?5:e<o$?6:e<a$?7:e<c$?8:e<l$?9:10},d$={encode:ZP,decode:QP,encodingLength:u$},IE=d$;const ym=(e,t,n=0)=>(IE.encode(e,t,n),t),bm=e=>IE.encodingLength(e),Kf=(e,t)=>{const n=t.byteLength,r=bm(e),s=r+bm(n),i=new Uint8Array(s+n);return ym(e,i,0),ym(n,i,r),i.set(t,s),new h$(e,n,t,i)};let h$=class{constructor(t,n,r,s){this.code=t,this.size=n,this.digest=r,this.bytes=s}};const SE=({name:e,code:t,encode:n})=>new f$(e,t,n);let f$=class{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?Kf(this.code,n):n.then(r=>Kf(this.code,r))}else throw Error("Unknown type, must be binary type")}};const NE=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),p$=SE({name:"sha2-256",code:18,encode:NE("SHA-256")}),g$=SE({name:"sha2-512",code:19,encode:NE("SHA-512")});var w$=Object.freeze({__proto__:null,sha256:p$,sha512:g$});const xE=0,m$="identity",_E=vE,y$=e=>Kf(xE,_E(e)),b$={code:xE,name:m$,encode:_E,digest:y$};var v$=Object.freeze({__proto__:null,identity:b$});new TextEncoder,new TextDecoder;const vm={...fP,...gP,...mP,...bP,...CP,...PP,...UP,...LP,...HP,...YP};({...w$,...v$});function TE(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Em=TE("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Eh=TE("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=yE(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),OE={utf8:Em,"utf-8":Em,hex:vm.base16,latin1:Eh,ascii:Eh,binary:Eh,...vm};function ud(e,t="utf8"){const n=OE[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}function ea(e,t="utf8"){const n=OE[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Tg(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}function Cm(e){return Ti(ud(ea(e,cd),wE))}function Lu(e){return ud(ea(es(e),wE),cd)}function DE(e){const t=ea(QD,gm),n=XD+ud(bE([t,e]),gm);return[ZD,JD,n].join(YD)}function E$(e){return ud(e,cd)}function C$(e){return ea(e,cd)}function A$(e){return ea([Lu(e.header),Lu(e.payload)].join(Mu),mE)}function I$(e){return[Lu(e.header),Lu(e.payload),E$(e.signature)].join(Mu)}function Gf(e){const t=e.split(Mu),n=Cm(t[0]),r=Cm(t[1]),s=C$(t[2]),i=ea(t.slice(0,2).join(Mu),mE);return{header:n,payload:r,signature:s,data:i}}function Am(e=iE(eP)){const t=gE.getPublicKey(e);return{secretKey:bE([e,t]),publicKey:t}}async function S$(e,t,n,r,s=Y.fromMiliseconds(Date.now())){const i={alg:KD,typ:GD},o=DE(r.publicKey),a=s+n,c={iss:o,sub:e,aud:t,iat:s,exp:a},l=A$({header:i,payload:c}),u=gE.sign(l,r.secretKey.slice(0,32));return I$({header:i,payload:c,signature:u})}var Im=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},N$=(function(){function e(t,n,r){this.name=t,this.version=n,this.os=r,this.type="browser"}return e})(),x$=(function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e})(),_$=(function(){function e(t,n,r,s){this.name=t,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return e})(),T$=(function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e})(),O$=(function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e})(),D$=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,P$=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Sm=3,$$=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",D$]],Nm=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function k$(e){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new O$:typeof navigator<"u"?R$(navigator.userAgent):L$()}function U$(e){return e!==""&&$$.reduce(function(t,n){var r=n[0],s=n[1];if(t)return t;var i=s.exec(e);return!!i&&[r,i]},!1)}function R$(e){var t=U$(e);if(!t)return null;var n=t[0],r=t[1];if(n==="searchbot")return new T$;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<Sm&&(s=Im(Im([],s,!0),B$(Sm-s.length),!0)):s=[];var i=s.join("."),o=M$(e),a=P$.exec(e);return a&&a[1]?new _$(n,i,o,a[1]):new N$(n,i,o)}function M$(e){for(var t=0,n=Nm.length;t<n;t++){var r=Nm[t],s=r[0],i=r[1],o=i.exec(e);if(o)return s}return null}function L$(){var e=typeof process<"u"&&process.version;return e?new x$(process.version.slice(1)):null}function B$(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}var He={},xm;function PE(){if(xm)return He;xm=1,Object.defineProperty(He,"__esModule",{value:!0}),He.getLocalStorage=He.getLocalStorageOrThrow=He.getCrypto=He.getCryptoOrThrow=He.getLocation=He.getLocationOrThrow=He.getNavigator=He.getNavigatorOrThrow=He.getDocument=He.getDocumentOrThrow=He.getFromWindowOrThrow=He.getFromWindow=void 0;function e(h){let p;return typeof window<"u"&&typeof window[h]<"u"&&(p=window[h]),p}He.getFromWindow=e;function t(h){const p=e(h);if(!p)throw new Error(`${h} is not defined in Window`);return p}He.getFromWindowOrThrow=t;function n(){return t("document")}He.getDocumentOrThrow=n;function r(){return e("document")}He.getDocument=r;function s(){return t("navigator")}He.getNavigatorOrThrow=s;function i(){return e("navigator")}He.getNavigator=i;function o(){return t("location")}He.getLocationOrThrow=o;function a(){return e("location")}He.getLocation=a;function c(){return t("crypto")}He.getCryptoOrThrow=c;function l(){return e("crypto")}He.getCrypto=l;function u(){return t("localStorage")}He.getLocalStorageOrThrow=u;function d(){return e("localStorage")}return He.getLocalStorage=d,He}var ts=PE(),va={},_m;function j$(){if(_m)return va;_m=1,Object.defineProperty(va,"__esModule",{value:!0}),va.getWindowMetadata=void 0;const e=PE();function t(){let n,r;try{n=e.getDocumentOrThrow(),r=e.getLocationOrThrow()}catch{return null}function s(){const p=n.getElementsByTagName("link"),f=[];for(let g=0;g<p.length;g++){const w=p[g],b=w.getAttribute("rel");if(b&&b.toLowerCase().indexOf("icon")>-1){const I=w.getAttribute("href");if(I)if(I.toLowerCase().indexOf("https:")===-1&&I.toLowerCase().indexOf("http:")===-1&&I.indexOf("//")!==0){let y=r.protocol+"//"+r.host;if(I.indexOf("/")===0)y+=I;else{const m=r.pathname.split("/");m.pop();const v=m.join("/");y+=v+"/"+I}f.push(y)}else if(I.indexOf("//")===0){const y=r.protocol+I;f.push(y)}else f.push(I)}}return f}function i(...p){const f=n.getElementsByTagName("meta");for(let g=0;g<f.length;g++){const w=f[g],b=["itemprop","property","name"].map(I=>w.getAttribute(I)).filter(I=>I?p.includes(I):!1);if(b.length&&b){const I=w.getAttribute("content");if(I)return I}}return""}function o(){let p=i("name","og:site_name","og:title","twitter:title");return p||(p=n.title),p}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=r.origin,d=s();return{description:l,url:u,icons:d,name:c}}return va.getWindowMetadata=t,va}var F$=j$();function pc(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function Yf(e){return pc(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const $E="2.31.0";let Ch={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:n})=>t?`${e??"https://viem.sh"}${t}${n?`#${n}`:""}`:void 0,version:`viem@${$E}`},dd=class Zf extends Error{constructor(t,n={}){const r=n.cause instanceof Zf?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof Zf&&n.cause.docsPath||n.docsPath,i=Ch.getDocsUrl?.({...n,docsPath:s}),o=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...Ch.version?[`Version: ${Ch.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=t,this.version=$E}walk(t){return kE(this,t)}};function kE(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause!==void 0?kE(e.cause,t):t?null:e}let UE=class extends dd{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};function ta(e,{dir:t,size:n=32}={}){return typeof e=="string"?z$(e,{dir:t,size:n}):H$(e,{dir:t,size:n})}function z$(e,{dir:t,size:n=32}={}){if(n===null)return e;const r=e.replace("0x","");if(r.length>n*2)throw new UE({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function H$(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new UE({size:e.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=t==="right";r[i?s:n-s-1]=e[i?s:e.length-s-1]}return r}let q$=class extends dd{constructor({max:t,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}},W$=class extends dd{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}};function na(e,{size:t}){if(Yf(e)>t)throw new W$({givenSize:Yf(e),maxSize:t})}function Jf(e,t={}){const{signed:n}=t;t.size&&na(e,{size:t.size});const r=BigInt(e);if(!n)return r;const s=(e.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function V$(e,t={}){return Number(Jf(e,t))}const K$=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Xf(e,t={}){return typeof e=="number"||typeof e=="bigint"?ME(e,t):typeof e=="string"?Z$(e,t):typeof e=="boolean"?G$(e,t):RE(e,t)}function G$(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(na(n,{size:t.size}),ta(n,{size:t.size})):n}function RE(e,t={}){let n="";for(let s=0;s<e.length;s++)n+=K$[e[s]];const r=`0x${n}`;return typeof t.size=="number"?(na(r,{size:t.size}),ta(r,{dir:"right",size:t.size})):r}function ME(e,t={}){const{signed:n,size:r}=t,s=BigInt(e);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof e=="bigint"?"n":"";throw new q$({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${e}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?ta(a,{size:r}):a}const Y$=new TextEncoder;function Z$(e,t={}){const n=Y$.encode(e);return RE(n,t)}const J$=new TextEncoder;function X$(e,t={}){return typeof e=="number"||typeof e=="bigint"?e8(e,t):typeof e=="boolean"?Q$(e,t):pc(e)?LE(e,t):BE(e,t)}function Q$(e,t={}){const n=new Uint8Array(1);return n[0]=Number(e),typeof t.size=="number"?(na(n,{size:t.size}),ta(n,{size:t.size})):n}const Br={zero:48,nine:57,A:65,F:70,a:97,f:102};function Tm(e){if(e>=Br.zero&&e<=Br.nine)return e-Br.zero;if(e>=Br.A&&e<=Br.F)return e-(Br.A-10);if(e>=Br.a&&e<=Br.f)return e-(Br.a-10)}function LE(e,t={}){let n=e;t.size&&(na(n,{size:t.size}),n=ta(n,{dir:"right",size:t.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Tm(r.charCodeAt(a++)),l=Tm(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new dd(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function e8(e,t){const n=ME(e,t);return LE(n)}function BE(e,t={}){const n=J$.encode(e);return typeof t.size=="number"?(na(n,{size:t.size}),ta(n,{dir:"right",size:t.size})):n}const Bl=BigInt(2**32-1),Om=BigInt(32);function t8(e,t=!1){return t?{h:Number(e&Bl),l:Number(e>>Om&Bl)}:{h:Number(e>>Om&Bl)|0,l:Number(e&Bl)|0}}function n8(e,t=!1){const n=e.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=t8(e[i],t);[r[i],s[i]]=[o,a]}return[r,s]}const r8=(e,t,n)=>e<<n|t>>>32-n,s8=(e,t,n)=>t<<n|e>>>32-n,i8=(e,t,n)=>t<<n-32|e>>>64-n,o8=(e,t,n)=>e<<n-32|t>>>64-n,Xi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function a8(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Bu(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function gc(e,...t){if(!a8(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Gq(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Bu(e.outputLen),Bu(e.blockLen)}function Dm(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function c8(e,t){gc(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function l8(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function jE(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Yq(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Zq(e,t){return e<<32-t|e>>>t}const u8=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function d8(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function h8(e){for(let t=0;t<e.length;t++)e[t]=d8(e[t]);return e}const Pm=u8?e=>e:h8;function f8(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function FE(e){return typeof e=="string"&&(e=f8(e)),gc(e),e}function Jq(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];gc(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}class p8{}function g8(e){const t=r=>e().update(FE(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function Xq(e=32){if(Xi&&typeof Xi.getRandomValues=="function")return Xi.getRandomValues(new Uint8Array(e));if(Xi&&typeof Xi.randomBytes=="function")return Uint8Array.from(Xi.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const w8=BigInt(0),Ea=BigInt(1),m8=BigInt(2),y8=BigInt(7),b8=BigInt(256),v8=BigInt(113),zE=[],HE=[],qE=[];for(let e=0,t=Ea,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],zE.push(2*(5*r+n)),HE.push((e+1)*(e+2)/2%64);let s=w8;for(let i=0;i<7;i++)t=(t<<Ea^(t>>y8)*v8)%b8,t&m8&&(s^=Ea<<(Ea<<BigInt(i))-Ea);qE.push(s)}const WE=n8(qE,!0),E8=WE[0],C8=WE[1],$m=(e,t,n)=>n>32?i8(e,t,n):r8(e,t,n),km=(e,t,n)=>n>32?o8(e,t,n):s8(e,t,n);function A8(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=$m(l,u,1)^n[a],h=km(l,u,1)^n[a+1];for(let p=0;p<50;p+=10)e[o+p]^=d,e[o+p+1]^=h}let s=e[2],i=e[3];for(let o=0;o<24;o++){const a=HE[o],c=$m(s,i,a),l=km(s,i,a),u=zE[o];s=e[u],i=e[u+1],e[u]=c,e[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=E8[r],e[1]^=C8[r]}jE(n)}class Og extends p8{constructor(t,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Bu(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=l8(this.state)}clone(){return this._cloneInto()}keccak(){Pm(this.state32),A8(this.state32,this.rounds),Pm(this.state32),this.posOut=0,this.pos=0}update(t){Dm(this),t=FE(t),gc(t);const{blockLen:n,state:r}=this,s=t.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=t[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){Dm(this,!1),gc(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=t.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Bu(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(c8(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,jE(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return t||(t=new Og(n,r,s,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}}const I8=(e,t,n)=>g8(()=>new Og(t,e,n)),S8=I8(1,136,256/8);function VE(e,t){const n=t||"hex",r=S8(pc(e,{strict:!1})?X$(e):e);return n==="bytes"?r:Xf(r)}let N8=class extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const Ah=new N8(8192);function x8(e,t){if(Ah.has(`${e}.${t}`))return Ah.get(`${e}.${t}`);const n=e.substring(2).toLowerCase(),r=VE(BE(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Ah.set(`${e}.${t}`,i),i}function _8(e){const t=VE(`0x${e.substring(4)}`).substring(26);return x8(`0x${t}`)}async function T8({hash:e,signature:t}){const n=pc(e)?e:Xf(e),{secp256k1:r}=await ic(async()=>{const{secp256k1:o}=await import("./secp256k1-D1TAqy0N.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof t=="object"&&"r"in t&&"s"in t){const{r:l,s:u,v:d,yParity:h}=t,p=Number(h??d),f=Um(p);return new r.Signature(Jf(l),Jf(u)).addRecoveryBit(f)}const o=pc(t)?t:Xf(t);if(Yf(o)!==65)throw new Error("invalid signature length");const a=V$(`0x${o.slice(130)}`),c=Um(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function Um(e){if(e===0||e===1)return e;if(e===27)return 0;if(e===28)return 1;throw new Error("Invalid yParityOrV value")}async function O8({hash:e,signature:t}){return _8(await T8({hash:e,signature:t}))}function D8(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let l=0;l<t.length;l++)t[l]=255;for(let l=0;l<e.length;l++){const u=e.charAt(l),d=u.charCodeAt(0);if(t[d]!==255)throw new TypeError(u+" is ambiguous");t[d]=l}const n=e.length,r=e.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const p=l.length;for(;h!==p&&l[h]===0;)h++,u++;const f=(p-h)*i+1>>>0,g=new Uint8Array(f);for(;h!==p;){let I=l[h],y=0;for(let m=f-1;(I!==0||y<d)&&m!==-1;m--,y++)I+=256*g[m]>>>0,g[m]=I%n>>>0,I=I/n>>>0;if(I!==0)throw new Error("Non-zero carry");d=y,h++}let w=f-d;for(;w!==f&&g[w]===0;)w++;let b=r.repeat(u);for(;w<f;++w)b+=e.charAt(g[w]);return b}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const p=(l.length-u)*s+1>>>0,f=new Uint8Array(p);for(;u<l.length;){const I=l.charCodeAt(u);if(I>255)return;let y=t[I];if(y===255)return;let m=0;for(let v=p-1;(y!==0||m<h)&&v!==-1;v--,m++)y+=n*f[v]>>>0,f[v]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");h=m,u++}let g=p-h;for(;g!==p&&f[g]===0;)g++;const w=new Uint8Array(d+(p-g));let b=d;for(;g!==p;)w[b++]=f[g++];return w}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var P8="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const ra=D8(P8);function $8(e){const t=e.length;let n=0,r=0;for(;r<t;){let s=e.charCodeAt(r++);if((s&4294967168)===0){n++;continue}else if((s&4294965248)===0)n+=2;else{if(s>=55296&&s<=56319&&r<t){const i=e.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?n+=3:n+=4}}return n}function k8(e,t,n){const r=e.length;let s=n,i=0;for(;i<r;){let o=e.charCodeAt(i++);if((o&4294967168)===0){t[s++]=o;continue}else if((o&4294965248)===0)t[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=e.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(t[s++]=o>>12&15|224,t[s++]=o>>6&63|128):(t[s++]=o>>18&7|240,t[s++]=o>>12&63|128,t[s++]=o>>6&63|128)}t[s++]=o&63|128}}const U8=new TextEncoder,R8=50;function M8(e,t,n){U8.encodeInto(e,t.subarray(n))}function L8(e,t,n){e.length>R8?M8(e,t,n):k8(e,t,n)}const B8=4096;function KE(e,t,n){let r=t;const s=r+n,i=[];let o="";for(;r<s;){const a=e[r++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=e[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=e[r++]&63,l=e[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=e[r++]&63,l=e[r++]&63,u=e[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=B8&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const j8=new TextDecoder,F8=200;function z8(e,t,n){const r=e.subarray(t,t+n);return j8.decode(r)}function H8(e,t,n){return n>F8?z8(e,t,n):KE(e,t,n)}class jl{constructor(t,n){this.type=t,this.data=n}}class vn extends Error{constructor(t){super(t);const n=Object.create(vn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:vn.name})}}const Ca=4294967295;function q8(e,t,n){const r=n/4294967296,s=n;e.setUint32(t,r),e.setUint32(t+4,s)}function GE(e,t,n){const r=Math.floor(n/4294967296),s=n;e.setUint32(t,r),e.setUint32(t+4,s)}function YE(e,t){const n=e.getInt32(t),r=e.getUint32(t+4);return n*4294967296+r}function W8(e,t){const n=e.getUint32(t),r=e.getUint32(t+4);return n*4294967296+r}const V8=-1,K8=4294967296-1,G8=17179869184-1;function Y8({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=G8)if(t===0&&e<=K8){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e),n}else{const n=e/4294967296,r=e&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,t<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,t),GE(r,4,e),n}}function Z8(e){const t=e.getTime(),n=Math.floor(t/1e3),r=(t-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function J8(e){if(e instanceof Date){const t=Z8(e);return Y8(t)}else return null}function X8(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const n=t.getUint32(0),r=t.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=YE(t,4),r=t.getUint32(0);return{sec:n,nsec:r}}default:throw new vn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}function Q8(e){const t=X8(e);return new Date(t.sec*1e3+t.nsec/1e6)}const ek={type:V8,encode:J8,decode:Q8};class ju{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(ek)}register({type:t,encode:n,decode:r}){if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{const s=-1-t;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(t,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(t,n);if(i!=null){const o=-1-r;return new jl(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(t,n);if(i!=null){const o=r;return new jl(o,i)}}}return t instanceof jl?t:null}decode(t,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(t,n,r):new jl(n,t)}}ju.defaultCodec=new ju;function tk(e){return e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer}function Qf(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):tk(e)?new Uint8Array(e):Uint8Array.from(e)}const nk=100,rk=2048;let sk=class ZE{constructor(t){this.entered=!1,this.extensionCodec=t?.extensionCodec??ju.defaultCodec,this.context=t?.context,this.useBigInt64=t?.useBigInt64??!1,this.maxDepth=t?.maxDepth??nk,this.initialBufferSize=t?.initialBufferSize??rk,this.sortKeys=t?.sortKeys??!1,this.forceFloat32=t?.forceFloat32??!1,this.ignoreUndefined=t?.ignoreUndefined??!1,this.forceIntegerToFloat=t?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new ZE({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(t){if(this.entered)return this.clone().encodeSharedRef(t);try{return this.entered=!0,this.reinitializeState(),this.doEncode(t,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(t){if(this.entered)return this.clone().encode(t);try{return this.entered=!0,this.reinitializeState(),this.doEncode(t,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(t,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);t==null?this.encodeNil():typeof t=="boolean"?this.encodeBoolean(t):typeof t=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(t):this.encodeNumber(t):typeof t=="string"?this.encodeString(t):this.useBigInt64&&typeof t=="bigint"?this.encodeBigInt64(t):this.encodeObject(t,n)}ensureBufferSizeToWrite(t){const n=this.pos+t;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(t){const n=new ArrayBuffer(t),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(t){t===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(t){!this.forceIntegerToFloat&&Number.isSafeInteger(t)?t>=0?t<128?this.writeU8(t):t<256?(this.writeU8(204),this.writeU8(t)):t<65536?(this.writeU8(205),this.writeU16(t)):t<4294967296?(this.writeU8(206),this.writeU32(t)):this.useBigInt64?this.encodeNumberAsFloat(t):(this.writeU8(207),this.writeU64(t)):t>=-32?this.writeU8(224|t+32):t>=-128?(this.writeU8(208),this.writeI8(t)):t>=-32768?(this.writeU8(209),this.writeI16(t)):t>=-2147483648?(this.writeU8(210),this.writeI32(t)):this.useBigInt64?this.encodeNumberAsFloat(t):(this.writeU8(211),this.writeI64(t)):this.encodeNumberAsFloat(t)}encodeNumberAsFloat(t){this.forceFloat32?(this.writeU8(202),this.writeF32(t)):(this.writeU8(203),this.writeF64(t))}encodeBigInt64(t){t>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(t)):(this.writeU8(211),this.writeBigInt64(t))}writeStringHeader(t){if(t<32)this.writeU8(160+t);else if(t<256)this.writeU8(217),this.writeU8(t);else if(t<65536)this.writeU8(218),this.writeU16(t);else if(t<4294967296)this.writeU8(219),this.writeU32(t);else throw new Error(`Too long string: ${t} bytes in UTF-8`)}encodeString(t){const r=$8(t);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),L8(t,this.bytes,this.pos),this.pos+=r}encodeObject(t,n){const r=this.extensionCodec.tryToEncode(t,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(t))this.encodeArray(t,n);else if(ArrayBuffer.isView(t))this.encodeBinary(t);else if(typeof t=="object")this.encodeMap(t,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(t)}`)}encodeBinary(t){const n=t.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=Qf(t);this.writeU8a(r)}encodeArray(t,n){const r=t.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of t)this.doEncode(s,n+1)}countWithoutUndefined(t,n){let r=0;for(const s of n)t[s]!==void 0&&r++;return r}encodeMap(t,n){const r=Object.keys(t);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(t,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=t[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(t){if(typeof t.data=="function"){const r=t.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(t.type),this.writeU8a(r);return}const n=t.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(t.type),this.writeU8a(t.data)}writeU8(t){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,t),this.pos++}writeU8a(t){const n=t.length;this.ensureBufferSizeToWrite(n),this.bytes.set(t,this.pos),this.pos+=n}writeI8(t){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,t),this.pos++}writeU16(t){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,t),this.pos+=2}writeI16(t){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,t),this.pos+=2}writeU32(t){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,t),this.pos+=4}writeI32(t){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,t),this.pos+=4}writeF32(t){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,t),this.pos+=4}writeF64(t){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,t),this.pos+=8}writeU64(t){this.ensureBufferSizeToWrite(8),q8(this.view,this.pos,t),this.pos+=8}writeI64(t){this.ensureBufferSizeToWrite(8),GE(this.view,this.pos,t),this.pos+=8}writeBigUint64(t){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,t),this.pos+=8}writeBigInt64(t){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,t),this.pos+=8}};function ik(e,t){return new sk(t).encodeSharedRef(e)}function Ih(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}const ok=16,ak=16;class ck{constructor(t=ok,n=ak){this.hit=0,this.miss=0,this.maxKeyLength=t,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(t){return t>0&&t<=this.maxKeyLength}find(t,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==t[n+a])continue e;return i.str}return null}store(t,n){const r=this.caches[t.length-1],s={bytes:t,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(t,n,r){const s=this.find(t,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=KE(t,n,r),o=Uint8Array.prototype.slice.call(t,n,n+r);return this.store(o,i),i}}const ep="array",qa="map_key",JE="map_value",lk=e=>{if(typeof e=="string"||typeof e=="number")return e;throw new vn("The type of key must be string or number but "+typeof e)};class uk{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(t){const n=this.getUninitializedStateFromPool();n.type=ep,n.position=0,n.size=t,n.array=new Array(t)}pushMapState(t){const n=this.getUninitializedStateFromPool();n.type=qa,n.readCount=0,n.size=t,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const t={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(t)}return this.stack[this.stackHeadPosition]}release(t){if(this.stack[this.stackHeadPosition]!==t)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(t.type===ep){const r=t;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(t.type===qa||t.type===JE){const r=t;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Aa=-1,Dg=new DataView(new ArrayBuffer(0)),dk=new Uint8Array(Dg.buffer);try{Dg.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const Rm=new RangeError("Insufficient data"),hk=new ck;let fk=class XE{constructor(t){this.totalPos=0,this.pos=0,this.view=Dg,this.bytes=dk,this.headByte=Aa,this.stack=new uk,this.entered=!1,this.extensionCodec=t?.extensionCodec??ju.defaultCodec,this.context=t?.context,this.useBigInt64=t?.useBigInt64??!1,this.rawStrings=t?.rawStrings??!1,this.maxStrLength=t?.maxStrLength??Ca,this.maxBinLength=t?.maxBinLength??Ca,this.maxArrayLength=t?.maxArrayLength??Ca,this.maxMapLength=t?.maxMapLength??Ca,this.maxExtLength=t?.maxExtLength??Ca,this.keyDecoder=t?.keyDecoder!==void 0?t.keyDecoder:hk,this.mapKeyConverter=t?.mapKeyConverter??lk}clone(){return new XE({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=Aa,this.stack.reset()}setBuffer(t){const n=Qf(t);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(t){if(this.headByte===Aa&&!this.hasRemaining(1))this.setBuffer(t);else{const n=this.bytes.subarray(this.pos),r=Qf(t),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(t){return this.view.byteLength-this.pos>=t}createExtraByteError(t){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${t}]`)}decode(t){if(this.entered)return this.clone().decode(t);try{this.entered=!0,this.reinitializeState(),this.setBuffer(t);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(t){if(this.entered){yield*this.clone().decodeMulti(t);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(t);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(t){if(this.entered)return this.clone().decodeAsync(t);try{this.entered=!0;let n=!1,r;for await(const a of t){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Ih(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(t){return this.decodeMultiAsync(t,!0)}decodeStream(t){return this.decodeMultiAsync(t,!1)}async*decodeMultiAsync(t,n){if(this.entered){yield*this.clone().decodeMultiAsync(t,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of t){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const t=this.readHeadByte();let n;if(t>=224)n=t-256;else if(t<192)if(t<128)n=t;else if(t<144){const s=t-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(t<160){const s=t-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=t-160;n=this.decodeString(s,0)}else if(t===192)n=null;else if(t===194)n=!1;else if(t===195)n=!0;else if(t===202)n=this.readF32();else if(t===203)n=this.readF64();else if(t===204)n=this.readU8();else if(t===205)n=this.readU16();else if(t===206)n=this.readU32();else if(t===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(t===208)n=this.readI8();else if(t===209)n=this.readI16();else if(t===210)n=this.readI32();else if(t===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(t===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(t===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(t===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(t===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(t===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(t===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(t===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(t===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(t===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(t===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(t===212)n=this.decodeExtension(1,0);else if(t===213)n=this.decodeExtension(2,0);else if(t===214)n=this.decodeExtension(4,0);else if(t===215)n=this.decodeExtension(8,0);else if(t===216)n=this.decodeExtension(16,0);else if(t===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(t===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(t===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new vn(`Unrecognized type byte: ${Ih(t)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===ep)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===qa){if(n==="__proto__")throw new vn("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=JE;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=qa;continue e}}return n}}readHeadByte(){return this.headByte===Aa&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Aa}readArraySize(){const t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:{if(t<160)return t-144;throw new vn(`Unrecognized array type byte: ${Ih(t)}`)}}}pushMapState(t){if(t>this.maxMapLength)throw new vn(`Max length exceeded: map length (${t}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(t)}pushArrayState(t){if(t>this.maxArrayLength)throw new vn(`Max length exceeded: array length (${t}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(t)}decodeString(t,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(t,n):this.decodeBinary(t,n)}decodeUtf8String(t,n){if(t>this.maxStrLength)throw new vn(`Max length exceeded: UTF-8 byte length (${t}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+t)throw Rm;const r=this.pos+n;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(t)?s=this.keyDecoder.decode(this.bytes,r,t):s=H8(this.bytes,r,t),this.pos+=n+t,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===qa:!1}decodeBinary(t,n){if(t>this.maxBinLength)throw new vn(`Max length exceeded: bin length (${t}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(t+n))throw Rm;const r=this.pos+n,s=this.bytes.subarray(r,r+t);return this.pos+=n+t,s}decodeExtension(t,n){if(t>this.maxExtLength)throw new vn(`Max length exceeded: ext length (${t}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(t,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const t=this.view.getUint8(this.pos);return this.pos++,t}readI8(){const t=this.view.getInt8(this.pos);return this.pos++,t}readU16(){const t=this.view.getUint16(this.pos);return this.pos+=2,t}readI16(){const t=this.view.getInt16(this.pos);return this.pos+=2,t}readU32(){const t=this.view.getUint32(this.pos);return this.pos+=4,t}readI32(){const t=this.view.getInt32(this.pos);return this.pos+=4,t}readU64(){const t=W8(this.view,this.pos);return this.pos+=8,t}readI64(){const t=YE(this.view,this.pos);return this.pos+=8,t}readU64AsBigInt(){const t=this.view.getBigUint64(this.pos);return this.pos+=8,t}readI64AsBigInt(){const t=this.view.getBigInt64(this.pos);return this.pos+=8,t}readF32(){const t=this.view.getFloat32(this.pos);return this.pos+=4,t}readF64(){const t=this.view.getFloat64(this.pos);return this.pos+=8,t}};function pk(e,t){return new fk(t).decode(e)}function Pg(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function QE(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Pg(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Wa(e,t){t||(t=e.reduce((s,i)=>s+i.length,0));const n=QE(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return Pg(n)}function gk(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=e.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=n[f.charCodeAt(g)];if(m===255)return;for(var v=0,C=I-1;(m!==0||v<b)&&C!==-1;C--,v++)m+=a*y[C]>>>0,y[C]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");b=v,g++}if(f[g]!==" "){for(var O=I-b;O!==I&&y[O]===0;)O++;for(var D=new Uint8Array(w+(I-O)),S=w;O!==I;)D[S++]=y[O++];return D}}}function p(f){var g=h(f);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var wk=gk,mk=wk;const yk=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},bk=e=>new TextEncoder().encode(e),vk=e=>new TextDecoder().decode(e);class Ek{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Ck{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return eC(this,t)}}class Ak{constructor(t){this.decoders=t}or(t){return eC(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const eC=(e,t)=>new Ak({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ik{constructor(t,n,r,s){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new Ek(t,n,r),this.decoder=new Ck(t,n,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const hd=({name:e,prefix:t,encode:n,decode:r})=>new Ik(e,t,n,r),rl=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:s}=mk(n,t);return hd({prefix:e,name:t,encode:r,decode:i=>yk(s(i))})},Sk=(e,t,n,r)=>{const s={};for(let u=0;u<t.length;++u)s[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Nk=(e,t,n)=>{const r=t[t.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,i+=t[s&a>>o];if(o&&(i+=t[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},kt=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>hd({prefix:t,name:e,encode(s){return Nk(s,r,n)},decode(s){return Sk(s,r,n,e)}}),xk=hd({prefix:"\0",name:"identity",encode:e=>vk(e),decode:e=>bk(e)}),_k=Object.freeze(Object.defineProperty({__proto__:null,identity:xk},Symbol.toStringTag,{value:"Module"})),Tk=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ok=Object.freeze(Object.defineProperty({__proto__:null,base2:Tk},Symbol.toStringTag,{value:"Module"})),Dk=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Pk=Object.freeze(Object.defineProperty({__proto__:null,base8:Dk},Symbol.toStringTag,{value:"Module"})),$k=rl({prefix:"9",name:"base10",alphabet:"0123456789"}),kk=Object.freeze(Object.defineProperty({__proto__:null,base10:$k},Symbol.toStringTag,{value:"Module"})),Uk=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rk=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Mk=Object.freeze(Object.defineProperty({__proto__:null,base16:Uk,base16upper:Rk},Symbol.toStringTag,{value:"Module"})),Lk=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Bk=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),jk=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Fk=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zk=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Hk=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),qk=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Wk=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Vk=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Kk=Object.freeze(Object.defineProperty({__proto__:null,base32:Lk,base32hex:zk,base32hexpad:qk,base32hexpadupper:Wk,base32hexupper:Hk,base32pad:jk,base32padupper:Fk,base32upper:Bk,base32z:Vk},Symbol.toStringTag,{value:"Module"})),Gk=rl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Yk=rl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Zk=Object.freeze(Object.defineProperty({__proto__:null,base36:Gk,base36upper:Yk},Symbol.toStringTag,{value:"Module"})),Jk=rl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Xk=rl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Qk=Object.freeze(Object.defineProperty({__proto__:null,base58btc:Jk,base58flickr:Xk},Symbol.toStringTag,{value:"Module"})),e4=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),t4=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),n4=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),r4=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),s4=Object.freeze(Object.defineProperty({__proto__:null,base64:e4,base64pad:t4,base64url:n4,base64urlpad:r4},Symbol.toStringTag,{value:"Module"})),tC=Array.from(""),i4=tC.reduce((e,t,n)=>(e[n]=t,e),[]),o4=tC.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function a4(e){return e.reduce((t,n)=>(t+=i4[n],t),"")}function c4(e){const t=[];for(const n of e){const r=o4[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const l4=hd({prefix:"",name:"base256emoji",encode:a4,decode:c4}),u4=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:l4},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const Mm={..._k,...Ok,...Pk,...kk,...Mk,...Kk,...Zk,...Qk,...s4,...u4};function nC(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Lm=nC("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Sh=nC("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=QE(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),rC={utf8:Lm,"utf-8":Lm,hex:Mm.base16,latin1:Sh,ascii:Sh,binary:Sh,...Mm};function jn(e,t="utf8"){const n=rC[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Pg(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}function ln(e,t="utf8"){const n=rC[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}const d4={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Nh,Bm;function sC(){if(Bm)return Nh;Bm=1;const e="Input must be an string, Buffer or Uint8Array";function t(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(e);return a}function n(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function r(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=r(a[u]).toUpperCase(),l+=" ",l+=r(a[u+1]).toUpperCase();else if(c===64)l+=r(a[u+1]).toUpperCase(),l+=r(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let h=0;h<a;h++)u[h]=h%256;const d=new Date().getTime();console.log("Generated random input in "+(d-l)+"ms"),l=d;for(let h=0;h<c;h++){const p=o(u),f=new Date().getTime(),g=f-l;l=f,console.log("Hashed in "+g+"ms: "+p.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Nh={normalizeInput:t,toHex:n,debugPrint:s,testSpeed:i},Nh}var xh,jm;function h4(){if(jm)return xh;jm=1;const e=sC();function t(b,I,y){const m=b[I]+b[y];let v=b[I+1]+b[y+1];m>=4294967296&&v++,b[I]=m,b[I+1]=v}function n(b,I,y,m){let v=b[I]+y;y<0&&(v+=4294967296);let C=b[I+1]+m;v>=4294967296&&C++,b[I]=v,b[I+1]=C}function r(b,I){return b[I]^b[I+1]<<8^b[I+2]<<16^b[I+3]<<24}function s(b,I,y,m,v,C){const O=l[v],D=l[v+1],S=l[C],E=l[C+1];t(c,b,I),n(c,b,O,D);let x=c[m]^c[b],P=c[m+1]^c[b+1];c[m]=P,c[m+1]=x,t(c,y,m),x=c[I]^c[y],P=c[I+1]^c[y+1],c[I]=x>>>24^P<<8,c[I+1]=P>>>24^x<<8,t(c,b,I),n(c,b,S,E),x=c[m]^c[b],P=c[m+1]^c[b+1],c[m]=x>>>16^P<<16,c[m+1]=P>>>16^x<<16,t(c,y,m),x=c[I]^c[y],P=c[I+1]^c[y+1],c[I]=P>>>31^x<<1,c[I+1]=x>>>31^P<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(b){return b*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(b,I){let y=0;for(y=0;y<16;y++)c[y]=b.h[y],c[y+16]=i[y];for(c[24]=c[24]^b.t,c[25]=c[25]^b.t/4294967296,I&&(c[28]=~c[28],c[29]=~c[29]),y=0;y<32;y++)l[y]=r(b.b,4*y);for(y=0;y<12;y++)s(0,8,16,24,a[y*16+0],a[y*16+1]),s(2,10,18,26,a[y*16+2],a[y*16+3]),s(4,12,20,28,a[y*16+4],a[y*16+5]),s(6,14,22,30,a[y*16+6],a[y*16+7]),s(0,10,20,30,a[y*16+8],a[y*16+9]),s(2,12,22,24,a[y*16+10],a[y*16+11]),s(4,14,16,26,a[y*16+12],a[y*16+13]),s(6,8,18,28,a[y*16+14],a[y*16+15]);for(y=0;y<16;y++)b.h[y]=b.h[y]^c[y]^c[y+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function h(b,I,y,m){if(b===0||b>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(I&&I.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(y&&y.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(m&&m.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const v={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:b};d.fill(0),d[0]=b,I&&(d[1]=I.length),d[2]=1,d[3]=1,y&&d.set(y,32),m&&d.set(m,48);for(let C=0;C<16;C++)v.h[C]=i[C]^r(d,C*4);return I&&(p(v,I),v.c=128),v}function p(b,I){for(let y=0;y<I.length;y++)b.c===128&&(b.t+=b.c,u(b,!1),b.c=0),b.b[b.c++]=I[y]}function f(b){for(b.t+=b.c;b.c<128;)b.b[b.c++]=0;u(b,!0);const I=new Uint8Array(b.outlen);for(let y=0;y<b.outlen;y++)I[y]=b.h[y>>2]>>8*(y&3);return I}function g(b,I,y,m,v){y=y||64,b=e.normalizeInput(b),m&&(m=e.normalizeInput(m)),v&&(v=e.normalizeInput(v));const C=h(y,I,m,v);return p(C,b),f(C)}function w(b,I,y,m,v){const C=g(b,I,y,m,v);return e.toHex(C)}return xh={blake2b:g,blake2bHex:w,blake2bInit:h,blake2bUpdate:p,blake2bFinal:f},xh}var _h,Fm;function f4(){if(Fm)return _h;Fm=1;const e=sC();function t(f,g){return f[g]^f[g+1]<<8^f[g+2]<<16^f[g+3]<<24}function n(f,g,w,b,I,y){o[f]=o[f]+o[g]+I,o[b]=r(o[b]^o[f],16),o[w]=o[w]+o[b],o[g]=r(o[g]^o[w],12),o[f]=o[f]+o[g]+y,o[b]=r(o[b]^o[f],8),o[w]=o[w]+o[b],o[g]=r(o[g]^o[w],7)}function r(f,g){return f>>>g^f<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(f,g){let w=0;for(w=0;w<8;w++)o[w]=f.h[w],o[w+8]=s[w];for(o[12]^=f.t,o[13]^=f.t/4294967296,g&&(o[14]=~o[14]),w=0;w<16;w++)a[w]=t(f.b,4*w);for(w=0;w<10;w++)n(0,4,8,12,a[i[w*16+0]],a[i[w*16+1]]),n(1,5,9,13,a[i[w*16+2]],a[i[w*16+3]]),n(2,6,10,14,a[i[w*16+4]],a[i[w*16+5]]),n(3,7,11,15,a[i[w*16+6]],a[i[w*16+7]]),n(0,5,10,15,a[i[w*16+8]],a[i[w*16+9]]),n(1,6,11,12,a[i[w*16+10]],a[i[w*16+11]]),n(2,7,8,13,a[i[w*16+12]],a[i[w*16+13]]),n(3,4,9,14,a[i[w*16+14]],a[i[w*16+15]]);for(w=0;w<8;w++)f.h[w]^=o[w]^o[w+8]}function l(f,g){if(!(f>0&&f<=32))throw new Error("Incorrect output length, should be in [1, 32]");const w=g?g.length:0;if(g&&!(w>0&&w<=32))throw new Error("Incorrect key length, should be in [1, 32]");const b={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:f};return b.h[0]^=16842752^w<<8^f,w>0&&(u(b,g),b.c=64),b}function u(f,g){for(let w=0;w<g.length;w++)f.c===64&&(f.t+=f.c,c(f,!1),f.c=0),f.b[f.c++]=g[w]}function d(f){for(f.t+=f.c;f.c<64;)f.b[f.c++]=0;c(f,!0);const g=new Uint8Array(f.outlen);for(let w=0;w<f.outlen;w++)g[w]=f.h[w>>2]>>8*(w&3)&255;return g}function h(f,g,w){w=w||32,f=e.normalizeInput(f);const b=l(w,g);return u(b,f),d(b)}function p(f,g,w){const b=h(f,g,w);return e.toHex(b)}return _h={blake2s:h,blake2sHex:p,blake2sInit:l,blake2sUpdate:u,blake2sFinal:d},_h}var Th,zm;function p4(){if(zm)return Th;zm=1;const e=h4(),t=f4();return Th={blake2b:e.blake2b,blake2bHex:e.blake2bHex,blake2bInit:e.blake2bInit,blake2bUpdate:e.blake2bUpdate,blake2bFinal:e.blake2bFinal,blake2s:t.blake2s,blake2sHex:t.blake2sHex,blake2sInit:t.blake2sInit,blake2sUpdate:t.blake2sUpdate,blake2sFinal:t.blake2sFinal},Th}var g4=p4(),w4={};const m4=":";function Po(e){const[t,n]=e.split(m4);return{namespace:t,reference:n}}function iC(e,t){return e.includes(":")?[e]:t.chains||[]}var y4=Object.defineProperty,b4=Object.defineProperties,v4=Object.getOwnPropertyDescriptors,Hm=Object.getOwnPropertySymbols,E4=Object.prototype.hasOwnProperty,C4=Object.prototype.propertyIsEnumerable,tp=(e,t,n)=>t in e?y4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,qm=(e,t)=>{for(var n in t||(t={}))E4.call(t,n)&&tp(e,n,t[n]);if(Hm)for(var n of Hm(t))C4.call(t,n)&&tp(e,n,t[n]);return e},A4=(e,t)=>b4(e,v4(t)),Wm=(e,t,n)=>tp(e,typeof t!="symbol"?t+"":t,n);const I4="ReactNative",In={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},S4="js";function Fu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Bs(){return!ts.getDocument()&&!!ts.getNavigator()&&navigator.product===I4}function N4(){return Bs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function x4(){return Bs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function sa(){return!Fu()&&!!ts.getNavigator()&&!!ts.getDocument()}function sl(){return Bs()?In.reactNative:Fu()?In.node:sa()?In.browser:In.unknown}function Vm(){var e;try{return Bs()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(e=global.Application)==null?void 0:e.applicationId:void 0}catch{return}}function _4(e,t){const n=new URLSearchParams(e);for(const r of Object.keys(t).sort())if(t.hasOwnProperty(r)){const s=t[r];s!==void 0&&n.set(r,s)}return n.toString()}function T4(e){var t,n;const r=oC();try{return e!=null&&e.url&&r.url&&new URL(e.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),e.url=r.url),(t=e?.icons)!=null&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(s=>s!=="")),A4(qm(qm({},r),e),{url:e?.url||r.url,name:e?.name||r.name,description:e?.description||r.description,icons:(n=e?.icons)!=null&&n.length&&e.icons.length>0?e.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),e||r}}function oC(){return F$.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function O4(){if(sl()===In.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const e=k$();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function D4(){var e;const t=sl();return t===In.browser?[t,((e=ts.getLocation())==null?void 0:e.host)||"unknown"].join(":"):t}function aC(e,t,n){const r=O4(),s=D4();return[[e,t].join("-"),[S4,n].join("-"),r,s].join("/")}function P4({protocol:e,version:t,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=aC(e,t,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=_4(l[1]||"",d);return l[0]+"?"+h}function hi(e,t){return e.filter(n=>t.includes(n)).length===e.length}function np(e){return Object.fromEntries(e.entries())}function rp(e){return new Map(Object.entries(e))}function ni(e=Y.FIVE_MINUTES,t){const n=Y.toMiliseconds(e||Y.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(t);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function xs(e,t,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),t);try{const o=await e;r(o)}catch(o){s(o)}clearTimeout(i)})}function cC(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function $4(e){return cC("topic",e)}function k4(e){return cC("id",e)}function lC(e){const[t,n]=e.split(":"),r={id:void 0,topic:void 0};if(t==="topic"&&typeof n=="string")r.topic=n;else if(t==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${n}`);return r}function gt(e,t){return Y.fromMiliseconds(Date.now()+Y.toMiliseconds(e))}function ys(e){return Date.now()>=Y.toMiliseconds(e)}function Re(e,t){return`${e}${t?`:${t}`:""}`}function Nr(e=[],t=[]){return[...new Set([...e,...t])]}async function U4({id:e,topic:t,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s?.href;if(typeof i!="string")return;const o=R4(i,e,t),a=sl();if(a===In.browser){if(!((r=ts.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}M4(o)}else a===In.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function R4(e,t,n){const r=`requestId=${t}&sessionTopic=${n}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){const i=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${F4(r,!0)}`}else s=`${s}/wc?${r}`;return s}function M4(e){let t="_self";j4()?t="_top":(B4()||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"),window.open(e,t,"noreferrer noopener")}async function L4(e,t){let n="";try{if(sa()&&(n=localStorage.getItem(t),n))return n;n=await e.getItem(t)}catch(r){console.error(r)}return n}function Km(e,t){if(!e.includes(t))return null;const n=e.split(/([&,?,=])/),r=n.indexOf(t);return n[r+2]}function Gm(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function $g(){return typeof process<"u"&&w4.IS_VITEST==="true"}function B4(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function j4(){try{return window.self!==window.top}catch{return!1}}function F4(e,t=!1){const n=Buffer.from(e).toString("base64");return t?n.replace(/[=]/g,""):n}function uC(e){return Buffer.from(e,"base64").toString("utf-8")}function z4(e){return new Promise(t=>setTimeout(t,e))}let H4=class{constructor({limit:t}){Wm(this,"limit"),Wm(this,"set"),this.limit=t,this.set=new Set}add(t){if(!this.set.has(t)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(t)}}has(t){return this.set.has(t)}};const Fl=BigInt(2**32-1),Ym=BigInt(32);function dC(e,t=!1){return t?{h:Number(e&Fl),l:Number(e>>Ym&Fl)}:{h:Number(e>>Ym&Fl)|0,l:Number(e&Fl)|0}}function hC(e,t=!1){const n=e.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=dC(e[i],t);[r[i],s[i]]=[o,a]}return[r,s]}const Zm=(e,t,n)=>e>>>n,Jm=(e,t,n)=>e<<32-n|t>>>n,bs=(e,t,n)=>e>>>n|t<<32-n,vs=(e,t,n)=>e<<32-n|t>>>n,Ra=(e,t,n)=>e<<64-n|t>>>n-32,Ma=(e,t,n)=>e>>>n-32|t<<64-n,q4=(e,t)=>t,W4=(e,t)=>e,V4=(e,t,n)=>e<<n|t>>>32-n,K4=(e,t,n)=>t<<n|e>>>32-n,G4=(e,t,n)=>t<<n-32|e>>>64-n,Y4=(e,t,n)=>e<<n-32|t>>>64-n;function Qn(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const kg=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Ug=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,Z4=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),J4=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,X4=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),Q4=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,Qi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Rg(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ns(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Fn(e,...t){if(!Rg(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Mg(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");ns(e.outputLen),ns(e.blockLen)}function Rs(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Lg(e,t){Fn(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function wc(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function zn(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Oh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function fr(e,t){return e<<32-t|e>>>t}const fC=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function pC(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const Vr=fC?e=>e:e=>pC(e);function e5(e){for(let t=0;t<e.length;t++)e[t]=pC(e[t]);return e}const Es=fC?e=>e:e5,gC=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",t5=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function mc(e){if(Fn(e),gC)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=t5[e[n]];return t}const jr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Xm(e){if(e>=jr._0&&e<=jr._9)return e-jr._0;if(e>=jr.A&&e<=jr.F)return e-(jr.A-10);if(e>=jr.a&&e<=jr.f)return e-(jr.a-10)}function Bg(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(gC)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=Xm(e.charCodeAt(i)),a=Xm(e.charCodeAt(i+1));if(o===void 0||a===void 0){const c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function n5(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function cr(e){return typeof e=="string"&&(e=n5(e)),Fn(e),e}function fi(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];Fn(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}let fd=class{};function il(e){const t=r=>e().update(cr(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function r5(e){const t=(r,s)=>e(s).update(cr(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function ia(e=32){if(Qi&&typeof Qi.getRandomValues=="function")return Qi.getRandomValues(new Uint8Array(e));if(Qi&&typeof Qi.randomBytes=="function")return Uint8Array.from(Qi.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const s5=BigInt(0),Ia=BigInt(1),i5=BigInt(2),o5=BigInt(7),a5=BigInt(256),c5=BigInt(113),wC=[],mC=[],yC=[];for(let e=0,t=Ia,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],wC.push(2*(5*r+n)),mC.push((e+1)*(e+2)/2%64);let s=s5;for(let i=0;i<7;i++)t=(t<<Ia^(t>>o5)*c5)%a5,t&i5&&(s^=Ia<<(Ia<<BigInt(i))-Ia);yC.push(s)}const bC=hC(yC,!0),l5=bC[0],u5=bC[1],Qm=(e,t,n)=>n>32?G4(e,t,n):V4(e,t,n),ey=(e,t,n)=>n>32?Y4(e,t,n):K4(e,t,n);function d5(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Qm(l,u,1)^n[a],h=ey(l,u,1)^n[a+1];for(let p=0;p<50;p+=10)e[o+p]^=d,e[o+p+1]^=h}let s=e[2],i=e[3];for(let o=0;o<24;o++){const a=mC[o],c=Qm(s,i,a),l=ey(s,i,a),u=wC[o];s=e[u],i=e[u+1],e[u]=c,e[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=l5[r],e[1]^=u5[r]}zn(n)}let h5=class vC extends fd{constructor(t,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,ns(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=wc(this.state)}clone(){return this._cloneInto()}keccak(){Es(this.state32),d5(this.state32,this.rounds),Es(this.state32),this.posOut=0,this.pos=0}update(t){Rs(this),t=cr(t),Fn(t);const{blockLen:n,state:r}=this,s=t.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=t[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){Rs(this,!1),Fn(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=t.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return ns(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Lg(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,zn(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return t||(t=new vC(n,r,s,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}};const f5=(e,t,n)=>il(()=>new h5(t,e,n)),p5=f5(1,136,256/8);function g5(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}function w5(e,t,n){return e&t^~e&n}function m5(e,t,n){return e&t^e&n^t&n}let EC=class extends fd{constructor(t,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(t),this.view=Oh(this.buffer)}update(t){Rs(this),t=cr(t),Fn(t);const{view:n,buffer:r,blockLen:s}=this,i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Oh(t);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Rs(this),Lg(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,zn(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;g5(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Oh(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=i,t.length=s,t.pos=a,s%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};const us=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Mt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Lt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),y5=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ds=new Uint32Array(64);let b5=class extends EC{constructor(t=32){super(64,t,8,!1),this.A=us[0]|0,this.B=us[1]|0,this.C=us[2]|0,this.D=us[3]|0,this.E=us[4]|0,this.F=us[5]|0,this.G=us[6]|0,this.H=us[7]|0}get(){const{A:t,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[t,n,r,s,i,o,a,c]}set(t,n,r,s,i,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)ds[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=ds[d-15],p=ds[d-2],f=fr(h,7)^fr(h,18)^h>>>3,g=fr(p,17)^fr(p,19)^p>>>10;ds[d]=g+ds[d-7]+f+ds[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=fr(a,6)^fr(a,11)^fr(a,25),p=u+h+w5(a,c,l)+y5[d]+ds[d]|0,f=(fr(r,2)^fr(r,13)^fr(r,22))+m5(r,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=r,r=p+f|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){zn(ds)}destroy(){this.set(0,0,0,0,0,0,0,0),zn(this.buffer)}};const CC=hC(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),v5=CC[0],E5=CC[1],hs=new Uint32Array(80),fs=new Uint32Array(80);let jg=class extends EC{constructor(t=64){super(128,t,16,!1),this.Ah=Lt[0]|0,this.Al=Lt[1]|0,this.Bh=Lt[2]|0,this.Bl=Lt[3]|0,this.Ch=Lt[4]|0,this.Cl=Lt[5]|0,this.Dh=Lt[6]|0,this.Dl=Lt[7]|0,this.Eh=Lt[8]|0,this.El=Lt[9]|0,this.Fh=Lt[10]|0,this.Fl=Lt[11]|0,this.Gh=Lt[12]|0,this.Gl=Lt[13]|0,this.Hh=Lt[14]|0,this.Hl=Lt[15]|0}get(){const{Ah:t,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:f,Hh:g,Hl:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=f|0,this.Hh=g|0,this.Hl=w|0}process(t,n){for(let y=0;y<16;y++,n+=4)hs[y]=t.getUint32(n),fs[y]=t.getUint32(n+=4);for(let y=16;y<80;y++){const m=hs[y-15]|0,v=fs[y-15]|0,C=bs(m,v,1)^bs(m,v,8)^Zm(m,v,7),O=vs(m,v,1)^vs(m,v,8)^Jm(m,v,7),D=hs[y-2]|0,S=fs[y-2]|0,E=bs(D,S,19)^Ra(D,S,61)^Zm(D,S,6),x=vs(D,S,19)^Ma(D,S,61)^Jm(D,S,6),P=Z4(O,x,fs[y-7],fs[y-16]),M=J4(P,C,E,hs[y-7],hs[y-16]);hs[y]=M|0,fs[y]=P|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:f,Gh:g,Gl:w,Hh:b,Hl:I}=this;for(let y=0;y<80;y++){const m=bs(d,h,14)^bs(d,h,18)^Ra(d,h,41),v=vs(d,h,14)^vs(d,h,18)^Ma(d,h,41),C=d&p^~d&g,O=h&f^~h&w,D=X4(I,v,O,E5[y],fs[y]),S=Q4(D,b,m,C,v5[y],hs[y]),E=D|0,x=bs(r,s,28)^Ra(r,s,34)^Ra(r,s,39),P=vs(r,s,28)^Ma(r,s,34)^Ma(r,s,39),M=r&i^r&a^i&a,R=s&o^s&c^o&c;b=g|0,I=w|0,g=p|0,w=f|0,p=d|0,f=h|0,{h:d,l:h}=Qn(l|0,u|0,S|0,E|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=kg(E,P,R);r=Ug(A,S,x,M),s=A|0}({h:r,l:s}=Qn(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Qn(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Qn(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Qn(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Qn(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:f}=Qn(this.Fh|0,this.Fl|0,p|0,f|0),{h:g,l:w}=Qn(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:I}=Qn(this.Hh|0,this.Hl|0,b|0,I|0),this.set(r,s,i,o,a,c,l,u,d,h,p,f,g,w,b,I)}roundClean(){zn(hs,fs)}destroy(){zn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},C5=class extends jg{constructor(){super(48),this.Ah=Mt[0]|0,this.Al=Mt[1]|0,this.Bh=Mt[2]|0,this.Bl=Mt[3]|0,this.Ch=Mt[4]|0,this.Cl=Mt[5]|0,this.Dh=Mt[6]|0,this.Dl=Mt[7]|0,this.Eh=Mt[8]|0,this.El=Mt[9]|0,this.Fh=Mt[10]|0,this.Fl=Mt[11]|0,this.Gh=Mt[12]|0,this.Gl=Mt[13]|0,this.Hh=Mt[14]|0,this.Hl=Mt[15]|0}};const Bt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class A5 extends jg{constructor(){super(32),this.Ah=Bt[0]|0,this.Al=Bt[1]|0,this.Bh=Bt[2]|0,this.Bl=Bt[3]|0,this.Ch=Bt[4]|0,this.Cl=Bt[5]|0,this.Dh=Bt[6]|0,this.Dl=Bt[7]|0,this.Eh=Bt[8]|0,this.El=Bt[9]|0,this.Fh=Bt[10]|0,this.Fl=Bt[11]|0,this.Gh=Bt[12]|0,this.Gl=Bt[13]|0,this.Hh=Bt[14]|0,this.Hl=Bt[15]|0}}const pd=il(()=>new b5),I5=il(()=>new jg),S5=il(()=>new C5),N5=il(()=>new A5),x5=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),ht=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ee=new Uint32Array(32);function ps(e,t,n,r,s,i){const o=s[i],a=s[i+1];let c=ee[2*e],l=ee[2*e+1],u=ee[2*t],d=ee[2*t+1],h=ee[2*n],p=ee[2*n+1],f=ee[2*r],g=ee[2*r+1],w=kg(c,u,o);l=Ug(w,l,d,a),c=w|0,{Dh:g,Dl:f}={Dh:g^l,Dl:f^c},{Dh:g,Dl:f}={Dh:q4(g,f),Dl:W4(g)},{h:p,l:h}=Qn(p,h,g,f),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:bs(d,u,24),Bl:vs(d,u,24)},ee[2*e]=c,ee[2*e+1]=l,ee[2*t]=u,ee[2*t+1]=d,ee[2*n]=h,ee[2*n+1]=p,ee[2*r]=f,ee[2*r+1]=g}function gs(e,t,n,r,s,i){const o=s[i],a=s[i+1];let c=ee[2*e],l=ee[2*e+1],u=ee[2*t],d=ee[2*t+1],h=ee[2*n],p=ee[2*n+1],f=ee[2*r],g=ee[2*r+1],w=kg(c,u,o);l=Ug(w,l,d,a),c=w|0,{Dh:g,Dl:f}={Dh:g^l,Dl:f^c},{Dh:g,Dl:f}={Dh:bs(g,f,16),Dl:vs(g,f,16)},{h:p,l:h}=Qn(p,h,g,f),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:Ra(d,u,63),Bl:Ma(d,u,63)},ee[2*e]=c,ee[2*e+1]=l,ee[2*t]=u,ee[2*t+1]=d,ee[2*n]=h,ee[2*n+1]=p,ee[2*r]=f,ee[2*r+1]=g}function _5(e,t={},n,r,s){if(ns(n),e<0||e>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=t;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class T5 extends fd{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,ns(t),ns(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=wc(this.buffer)}update(t){Rs(this),t=cr(t),Fn(t);const{blockLen:n,buffer:r,buffer32:s}=this,i=t.length,o=t.byteOffset,a=t.buffer;for(let c=0;c<i;){this.pos===n&&(Es(s),this.compress(s,0,!1),Es(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));Es(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);Es(d);continue}r.set(t.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(t){Rs(this),Lg(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,zn(this.buffer.subarray(n)),Es(r),this.compress(r,0,!0),Es(r);const s=wc(t);this.get().forEach((i,o)=>s[o]=Vr(i))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.buffer.set(n),t.destroyed=i,t.finished=s,t.length=r,t.pos=a,t.outputLen=o,t}clone(){return this._cloneInto()}}class O5 extends T5{constructor(t={}){const n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=ht[0]|0,this.v0h=ht[1]|0,this.v1l=ht[2]|0,this.v1h=ht[3]|0,this.v2l=ht[4]|0,this.v2h=ht[5]|0,this.v3l=ht[6]|0,this.v3h=ht[7]|0,this.v4l=ht[8]|0,this.v4h=ht[9]|0,this.v5l=ht[10]|0,this.v5h=ht[11]|0,this.v6l=ht[12]|0,this.v6h=ht[13]|0,this.v7l=ht[14]|0,this.v7h=ht[15]|0,_5(n,t,64,16,16);let{key:r,personalization:s,salt:i}=t,o=0;if(r!==void 0&&(r=cr(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=cr(i);const a=wc(i);this.v4l^=Vr(a[0]),this.v4h^=Vr(a[1]),this.v5l^=Vr(a[2]),this.v5h^=Vr(a[3])}if(s!==void 0){s=cr(s);const a=wc(s);this.v6l^=Vr(a[0]),this.v6h^=Vr(a[1]),this.v7l^=Vr(a[2]),this.v7h^=Vr(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:p,v6h:f,v7l:g,v7h:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=p|0,this.v6h=f|0,this.v7l=g|0,this.v7h=w|0}compress(t,n,r){this.get().forEach((c,l)=>ee[l]=c),ee.set(ht,16);let{h:s,l:i}=dC(BigInt(this.length));ee[24]=ht[8]^i,ee[25]=ht[9]^s,r&&(ee[28]=~ee[28],ee[29]=~ee[29]);let o=0;const a=x5;for(let c=0;c<12;c++)ps(0,4,8,12,t,n+2*a[o++]),gs(0,4,8,12,t,n+2*a[o++]),ps(1,5,9,13,t,n+2*a[o++]),gs(1,5,9,13,t,n+2*a[o++]),ps(2,6,10,14,t,n+2*a[o++]),gs(2,6,10,14,t,n+2*a[o++]),ps(3,7,11,15,t,n+2*a[o++]),gs(3,7,11,15,t,n+2*a[o++]),ps(0,5,10,15,t,n+2*a[o++]),gs(0,5,10,15,t,n+2*a[o++]),ps(1,6,11,12,t,n+2*a[o++]),gs(1,6,11,12,t,n+2*a[o++]),ps(2,7,8,13,t,n+2*a[o++]),gs(2,7,8,13,t,n+2*a[o++]),ps(3,4,9,14,t,n+2*a[o++]),gs(3,4,9,14,t,n+2*a[o++]);this.v0l^=ee[0]^ee[16],this.v0h^=ee[1]^ee[17],this.v1l^=ee[2]^ee[18],this.v1h^=ee[3]^ee[19],this.v2l^=ee[4]^ee[20],this.v2h^=ee[5]^ee[21],this.v3l^=ee[6]^ee[22],this.v3h^=ee[7]^ee[23],this.v4l^=ee[8]^ee[24],this.v4h^=ee[9]^ee[25],this.v5l^=ee[10]^ee[26],this.v5h^=ee[11]^ee[27],this.v6l^=ee[12]^ee[28],this.v6h^=ee[13]^ee[29],this.v7l^=ee[14]^ee[30],this.v7h^=ee[15]^ee[31],zn(ee)}destroy(){this.destroyed=!0,zn(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const D5=r5(e=>new O5(e)),P5="https://rpc.walletconnect.org/v1";function AC(e){const t=`Ethereum Signed Message:
${e.length}`,n=new TextEncoder().encode(t+e);return"0x"+Buffer.from(p5(n)).toString("hex")}async function $5(e,t,n,r,s,i){switch(n.t){case"eip191":return await k5(e,t,n.s);case"eip1271":return await U5(e,t,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function k5(e,t,n){return(await O8({hash:AC(t),signature:n})).toLowerCase()===e.toLowerCase()}async function U5(e,t,n,r,s,i){const o=Po(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(t.startsWith("0x")?t:AC(t)).substring(2),h=a+d+c+u+l,p=await fetch(`${i||P5}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:R5(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:h},"latest"]})}),{result:f}=await p.json();return f?f.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function R5(){return Date.now()+Math.floor(Math.random()*1e3)}function M5(e){const t=atob(e),n=new Uint8Array(t.length);for(let o=0;o<t.length;o++)n[o]=t.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(e,"base64").slice(1,65);return ra.encode(i)}function L5(e){const t=new Uint8Array(Buffer.from(e,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+t.length);r.set(n),r.set(t,n.length);const s=D5(r,{dkLen:32});return ra.encode(s)}function ty(e){const t=new Uint8Array(pd(B5(e)));return ra.encode(t)}function B5(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if(typeof e=="object"&&e!=null&&e.data)return new Uint8Array(Object.values(e.data));if(typeof e=="object"&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function ny(e){const t=Buffer.from(e,"base64"),n=pk(t).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=ik(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=N5(i);return XI.encode(o).replace(/=+$/,"")}function Dh(e){const t=[];let n=BigInt(e);for(;n>=BigInt(128);)t.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return t.push(Number(n)),Buffer.from(t)}function j5(e){const t=Buffer.from(e.signed.bodyBytes,"base64"),n=Buffer.from(e.signed.authInfoBytes,"base64"),r=Buffer.from(e.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Dh(t.length)),s.push(t),s.push(Buffer.from([18])),s.push(Dh(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(Dh(r.length)),s.push(r);const i=Buffer.concat(s),o=pd(i);return Buffer.from(o).toString("hex").toUpperCase()}var F5=Object.defineProperty,z5=Object.defineProperties,H5=Object.getOwnPropertyDescriptors,ry=Object.getOwnPropertySymbols,q5=Object.prototype.hasOwnProperty,W5=Object.prototype.propertyIsEnumerable,sy=(e,t,n)=>t in e?F5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,V5=(e,t)=>{for(var n in t||(t={}))q5.call(t,n)&&sy(e,n,t[n]);if(ry)for(var n of ry(t))W5.call(t,n)&&sy(e,n,t[n]);return e},K5=(e,t)=>z5(e,H5(t));const G5="did:pkh:",Fg=e=>e?.split(":"),Y5=e=>{const t=e&&Fg(e);if(t)return e.includes(G5)?t[3]:t[1]},sp=e=>{const t=e&&Fg(e);if(t)return t[2]+":"+t[3]},zu=e=>{const t=e&&Fg(e);if(t)return t.pop()};async function iy(e){const{cacao:t,projectId:n}=e,{s:r,p:s}=t,i=IC(s,s.iss),o=zu(s.iss);return await $5(o,i,r,sp(s.iss),n)}const IC=(e,t)=>{const n=`${e.domain} wants you to sign in with your Ethereum account:`,r=zu(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0;const i=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${Y5(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,u=e.exp?`Expiration Time: ${e.exp}`:void 0,d=e.nbf?`Not Before: ${e.nbf}`:void 0,h=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(g=>`
- ${g}`).join("")}`:void 0,f=pu(e.resources);if(f){const g=yc(f);s=sU(s,g)}return[n,r,"",s,"",i,o,a,c,l,u,d,h,p].filter(g=>g!=null).join(`
`)};function Z5(e){return Buffer.from(JSON.stringify(e)).toString("base64")}function J5(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}function Oi(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(n=>{const r=e.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function X5(e,t,n,r={}){return n?.sort((s,i)=>s.localeCompare(i)),{att:{[e]:Q5(t,n,r)}}}function Q5(e,t,n={}){t=t?.sort((s,i)=>s.localeCompare(i));const r=t.map(s=>({[`${e}/${s}`]:[n]}));return Object.assign({},...r)}function SC(e){return Oi(e),`urn:recap:${Z5(e).replace(/=/g,"")}`}function yc(e){const t=J5(e.replace("urn:recap:",""));return Oi(t),t}function eU(e,t,n){const r=X5(e,t,n);return SC(r)}function tU(e){return e&&e.includes("urn:recap:")}function nU(e,t){const n=yc(e),r=yc(t),s=rU(n,r);return SC(s)}function rU(e,t){Oi(e),Oi(t);const n=Object.keys(e.att).concat(Object.keys(t.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=e.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=t.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=K5(V5({},r.att[s]),{[a]:((c=e.att[s])==null?void 0:c[a])||((l=t.att[s])==null?void 0:l[a])})})}),r}function sU(e="",t){Oi(t);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(n))return e;const r=[];let s=0;Object.keys(t.att).forEach(a=>{const c=Object.keys(t.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${e?e+" ":""}${o}`}function oy(e){var t;const n=yc(e);Oi(n);const r=(t=n.att)==null?void 0:t.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function ay(e){const t=yc(e);Oi(t);const n=[];return Object.values(t.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function pu(e){if(!e)return;const t=e?.[e.length-1];return tU(t)?t:void 0}function NC(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ip(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Ph(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function an(e,...t){if(!NC(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function cy(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function iU(e,t){an(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Ps(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function zo(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function oU(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const aU=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function cU(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function op(e){if(typeof e=="string")e=cU(e);else if(NC(e))e=ap(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function lU(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function uU(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}const dU=(e,t)=>{function n(r,...s){if(an(r),!aU)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");e.varSizeNonce?an(l):an(l,e.nonceLength)}const i=e.tagLength;i&&s[1]!==void 0&&an(s[1]);const o=t(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");an(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,an(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(an(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,e),n};function ly(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!fU(t))throw new Error("invalid output, must be aligned");return t}function uy(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);e.setUint32(t+4,o,r),e.setUint32(t+0,a,r)}function hU(e,t,n){ip(n);const r=new Uint8Array(16),s=oU(r);return uy(s,0,BigInt(t),n),uy(s,8,BigInt(e),n),r}function fU(e){return e.byteOffset%4===0}function ap(e){return Uint8Array.from(e)}const xC=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),pU=xC("expand 16-byte k"),gU=xC("expand 32-byte k"),wU=Ps(pU),mU=Ps(gU);function Te(e,t){return e<<t|e>>>32-t}function cp(e){return e.byteOffset%4===0}const zl=64,yU=16,_C=2**32-1,dy=new Uint32Array;function bU(e,t,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(zl),u=Ps(l),d=cp(s)&&cp(i),h=d?Ps(s):dy,p=d?Ps(i):dy;for(let f=0;f<c;o++){if(e(t,n,r,u,o,a),o>=_C)throw new Error("arx: counter overflow");const g=Math.min(zl,c-f);if(d&&g===zl){const w=f/4;if(f%4!==0)throw new Error("arx: invalid block position");for(let b=0,I;b<yU;b++)I=w+b,p[I]=h[I]^u[b];f+=zl;continue}for(let w=0,b;w<g;w++)b=f+w,i[b]=s[b]^l[w];f+=g}}function vU(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=lU({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Ph(s),Ph(o),ip(i),ip(n),(a,c,l,u,d=0)=>{an(a),an(c),an(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),an(u),Ph(d),d<0||d>=_C)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const p=[];let f=a.length,g,w;if(f===32)p.push(g=ap(a)),w=mU;else if(f===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),w=wU,p.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${f}`);cp(c)||p.push(c=ap(c));const b=Ps(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(w,b,Ps(c.subarray(0,16)),b),c=c.subarray(16)}const I=16-s;if(I!==c.length)throw new Error(`arx: nonce must be ${I} or 16 bytes`);if(I!==12){const m=new Uint8Array(12);m.set(c,i?0:12-c.length),c=m,p.push(c)}const y=Ps(c);return bU(e,w,b,y,l,u,d,o),zo(...p),u}}const St=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class EU{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=op(t),an(t,32);const n=St(t,0),r=St(t,2),s=St(t,4),i=St(t,6),o=St(t,8),a=St(t,10),c=St(t,12),l=St(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=St(t,16+2*u)}process(t,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],p=o[6],f=o[7],g=o[8],w=o[9],b=St(t,n+0),I=St(t,n+2),y=St(t,n+4),m=St(t,n+6),v=St(t,n+8),C=St(t,n+10),O=St(t,n+12),D=St(t,n+14);let S=i[0]+(b&8191),E=i[1]+((b>>>13|I<<3)&8191),x=i[2]+((I>>>10|y<<6)&8191),P=i[3]+((y>>>7|m<<9)&8191),M=i[4]+((m>>>4|v<<12)&8191),R=i[5]+(v>>>1&8191),A=i[6]+((v>>>14|C<<2)&8191),_=i[7]+((C>>>11|O<<5)&8191),k=i[8]+((O>>>8|D<<8)&8191),L=i[9]+(D>>>5|s),U=0,$=U+S*a+E*(5*w)+x*(5*g)+P*(5*f)+M*(5*p);U=$>>>13,$&=8191,$+=R*(5*h)+A*(5*d)+_*(5*u)+k*(5*l)+L*(5*c),U+=$>>>13,$&=8191;let F=U+S*c+E*a+x*(5*w)+P*(5*g)+M*(5*f);U=F>>>13,F&=8191,F+=R*(5*p)+A*(5*h)+_*(5*d)+k*(5*u)+L*(5*l),U+=F>>>13,F&=8191;let G=U+S*l+E*c+x*a+P*(5*w)+M*(5*g);U=G>>>13,G&=8191,G+=R*(5*f)+A*(5*p)+_*(5*h)+k*(5*d)+L*(5*u),U+=G>>>13,G&=8191;let Z=U+S*u+E*l+x*c+P*a+M*(5*w);U=Z>>>13,Z&=8191,Z+=R*(5*g)+A*(5*f)+_*(5*p)+k*(5*h)+L*(5*d),U+=Z>>>13,Z&=8191;let V=U+S*d+E*u+x*l+P*c+M*a;U=V>>>13,V&=8191,V+=R*(5*w)+A*(5*g)+_*(5*f)+k*(5*p)+L*(5*h),U+=V>>>13,V&=8191;let ne=U+S*h+E*d+x*u+P*l+M*c;U=ne>>>13,ne&=8191,ne+=R*a+A*(5*w)+_*(5*g)+k*(5*f)+L*(5*p),U+=ne>>>13,ne&=8191;let ue=U+S*p+E*h+x*d+P*u+M*l;U=ue>>>13,ue&=8191,ue+=R*c+A*a+_*(5*w)+k*(5*g)+L*(5*f),U+=ue>>>13,ue&=8191;let _e=U+S*f+E*p+x*h+P*d+M*u;U=_e>>>13,_e&=8191,_e+=R*l+A*c+_*a+k*(5*w)+L*(5*g),U+=_e>>>13,_e&=8191;let Ie=U+S*g+E*f+x*p+P*h+M*d;U=Ie>>>13,Ie&=8191,Ie+=R*u+A*l+_*c+k*a+L*(5*w),U+=Ie>>>13,Ie&=8191;let be=U+S*w+E*g+x*f+P*p+M*h;U=be>>>13,be&=8191,be+=R*d+A*u+_*l+k*c+L*a,U+=be>>>13,be&=8191,U=(U<<2)+U|0,U=U+$|0,$=U&8191,U=U>>>13,F+=U,i[0]=$,i[1]=F,i[2]=G,i[3]=Z,i[4]=V,i[5]=ne,i[6]=ue,i[7]=_e,i[8]=Ie,i[9]=be}finalize(){const{h:t,pad:n}=this,r=new Uint16Array(10);let s=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=s,s=t[a]>>>13,t[a]&=8191;t[0]+=s*5,s=t[0]>>>13,t[0]&=8191,t[1]+=s,s=t[1]>>>13,t[1]&=8191,t[2]+=s,r[0]=t[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=t[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)t[a]=t[a]&i|r[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let o=t[0]+n[0];t[0]=o&65535;for(let a=1;a<8;a++)o=(t[a]+n[a]|0)+(o>>>16)|0,t[a]=o&65535;zo(r)}update(t){cy(this),t=op(t),an(t);const{buffer:n,blockLen:r}=this,s=t.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(t,i);continue}n.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){zo(this.h,this.r,this.buffer,this.pad)}digestInto(t){cy(this),iU(t,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)t[i++]=r[o]>>>0,t[i++]=r[o]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}}function CU(e){const t=(r,s)=>e(s).update(op(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const AU=CU(e=>new EU(e));function IU(e,t,n,r,s,i=20){let o=e[0],a=e[1],c=e[2],l=e[3],u=t[0],d=t[1],h=t[2],p=t[3],f=t[4],g=t[5],w=t[6],b=t[7],I=s,y=n[0],m=n[1],v=n[2],C=o,O=a,D=c,S=l,E=u,x=d,P=h,M=p,R=f,A=g,_=w,k=b,L=I,U=y,$=m,F=v;for(let Z=0;Z<i;Z+=2)C=C+E|0,L=Te(L^C,16),R=R+L|0,E=Te(E^R,12),C=C+E|0,L=Te(L^C,8),R=R+L|0,E=Te(E^R,7),O=O+x|0,U=Te(U^O,16),A=A+U|0,x=Te(x^A,12),O=O+x|0,U=Te(U^O,8),A=A+U|0,x=Te(x^A,7),D=D+P|0,$=Te($^D,16),_=_+$|0,P=Te(P^_,12),D=D+P|0,$=Te($^D,8),_=_+$|0,P=Te(P^_,7),S=S+M|0,F=Te(F^S,16),k=k+F|0,M=Te(M^k,12),S=S+M|0,F=Te(F^S,8),k=k+F|0,M=Te(M^k,7),C=C+x|0,F=Te(F^C,16),_=_+F|0,x=Te(x^_,12),C=C+x|0,F=Te(F^C,8),_=_+F|0,x=Te(x^_,7),O=O+P|0,L=Te(L^O,16),k=k+L|0,P=Te(P^k,12),O=O+P|0,L=Te(L^O,8),k=k+L|0,P=Te(P^k,7),D=D+M|0,U=Te(U^D,16),R=R+U|0,M=Te(M^R,12),D=D+M|0,U=Te(U^D,8),R=R+U|0,M=Te(M^R,7),S=S+E|0,$=Te($^S,16),A=A+$|0,E=Te(E^A,12),S=S+E|0,$=Te($^S,8),A=A+$|0,E=Te(E^A,7);let G=0;r[G++]=o+C|0,r[G++]=a+O|0,r[G++]=c+D|0,r[G++]=l+S|0,r[G++]=u+E|0,r[G++]=d+x|0,r[G++]=h+P|0,r[G++]=p+M|0,r[G++]=f+R|0,r[G++]=g+A|0,r[G++]=w+_|0,r[G++]=b+k|0,r[G++]=I+L|0,r[G++]=y+U|0,r[G++]=m+$|0,r[G++]=v+F|0}const SU=vU(IU,{counterRight:!1,counterLength:4,allowShortKeys:!1}),NU=new Uint8Array(16),hy=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(NU.subarray(n))},xU=new Uint8Array(32);function fy(e,t,n,r,s){const i=e(t,n,xU),o=AU.create(i);s&&hy(o,s),hy(o,r);const a=hU(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return zo(i,a),c}const _U=e=>(t,n,r)=>({encrypt(s,i){const o=s.length;i=ly(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);e(t,n,a,a,1);const c=fy(e,t,n,a,r);return i.set(c,o),zo(c),i},decrypt(s,i){i=ly(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=fy(e,t,n,o,r);if(!uU(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),e(t,n,i,i,1),zo(c),i}}),TC=dU({blockSize:64,nonceLength:12,tagLength:16},_U(SU));let OC=class extends fd{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Mg(t);const r=cr(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?t.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),zn(i)}update(t){return Rs(this),this.iHash.update(t),this}digestInto(t){Rs(this),Fn(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const gd=(e,t,n)=>new OC(e,t).update(n).digest();gd.create=(e,t)=>new OC(e,t);function TU(e,t,n){return Mg(e),n===void 0&&(n=new Uint8Array(e.outputLen)),gd(e,cr(n),cr(t))}const $h=Uint8Array.from([0]),py=Uint8Array.of();function OU(e,t,n,r=32){Mg(e),ns(r);const s=e.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=py);const o=new Uint8Array(i*s),a=gd.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)$h[0]=u+1,c.update(u===0?py:l).update(n).update($h).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),zn(l,$h),o.slice(0,r)}const DU=(e,t,n,r,s)=>OU(e,TU(e,t,n),r,s),wd=pd,zg=BigInt(0),lp=BigInt(1);function Hu(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function Hl(e){const t=e.toString(16);return t.length&1?"0"+t:t}function DC(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?zg:BigInt("0x"+e)}function md(e){return DC(mc(e))}function qu(e){return Fn(e),DC(mc(Uint8Array.from(e).reverse()))}function Hg(e,t){return Bg(e.toString(16).padStart(t*2,"0"))}function qg(e,t){return Hg(e,t).reverse()}function on(e,t,n){let r;if(typeof t=="string")try{r=Bg(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(Rg(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}const kh=e=>typeof e=="bigint"&&zg<=e;function PU(e,t,n){return kh(e)&&kh(t)&&kh(n)&&t<=e&&e<n}function up(e,t,n,r){if(!PU(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function $U(e){let t;for(t=0;e>zg;e>>=lp,t+=1);return t}const yd=e=>(lp<<BigInt(e))-lp;function kU(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(e),o=r(e),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>n(o,i,...h),u=(h=r(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<t;){i=l();const f=i.slice();p.push(f),h+=i.length}return fi(...p)};return(h,p)=>{c(),u(h);let f;for(;!(f=p(d()));)u();return c(),f}}function bd(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(s,i,o){const a=e[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(t).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function gy(e){const t=new WeakMap;return(n,...r)=>{const s=t.get(n);if(s!==void 0)return s;const i=e(n,...r);return t.set(n,i),i}}const cn=BigInt(0),qt=BigInt(1),pi=BigInt(2),UU=BigInt(3),PC=BigInt(4),$C=BigInt(5),kC=BigInt(8);function Ln(e,t){const n=e%t;return n>=cn?n:t+n}function Jn(e,t,n){let r=e;for(;t-- >cn;)r*=r,r%=n;return r}function wy(e,t){if(e===cn)throw new Error("invert: expected non-zero number");if(t<=cn)throw new Error("invert: expected positive modulus, got "+t);let n=Ln(e,t),r=t,s=cn,i=qt;for(;n!==cn;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==qt)throw new Error("invert: does not exist");return Ln(s,t)}function UC(e,t){const n=(e.ORDER+qt)/PC,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function RU(e,t){const n=(e.ORDER-$C)/kC,r=e.mul(t,pi),s=e.pow(r,n),i=e.mul(t,s),o=e.mul(e.mul(i,pi),s),a=e.mul(i,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function MU(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-qt,n=0;for(;t%pi===cn;)t/=pi,n++;let r=pi;const s=oa(e);for(;my(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return UC;let i=s.pow(r,t);const o=(t+qt)/pi;return function(a,c){if(a.is0(c))return c;if(my(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,t),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let p=1,f=a.sqr(d);for(;!a.eql(f,a.ONE);)if(p++,f=a.sqr(f),p===l)throw new Error("Cannot find square root");const g=qt<<BigInt(l-p-1),w=a.pow(u,g);l=p,u=a.sqr(w),d=a.mul(d,u),h=a.mul(h,w)}return h}}function LU(e){return e%PC===UU?UC:e%kC===$C?RU:MU(e)}const BU=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function jU(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=BU.reduce((r,s)=>(r[s]="function",r),t);return bd(e,n),e}function FU(e,t,n){if(n<cn)throw new Error("invalid exponent, negatives unsupported");if(n===cn)return e.ONE;if(n===qt)return t;let r=e.ONE,s=t;for(;n>cn;)n&qt&&(r=e.mul(r,s)),s=e.sqr(s),n>>=qt;return r}function RC(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),s=t.reduce((o,a,c)=>e.is0(a)?o:(r[c]=o,e.mul(o,a)),e.ONE),i=e.inv(s);return t.reduceRight((o,a,c)=>e.is0(a)?o:(r[c]=e.mul(o,r[c]),e.mul(o,a)),i),r}function my(e,t){const n=(e.ORDER-qt)/pi,r=e.pow(t,n),s=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function zU(e,t){t!==void 0&&ns(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function oa(e,t,n=!1,r={}){if(e<=cn)throw new Error("invalid field: expected ORDER > 0, got "+e);let s,i;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const u=t;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(n=u.isLE)}else typeof t=="number"&&(s=t),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=zU(e,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:e,isLE:n,BITS:o,BYTES:a,MASK:yd(o),ZERO:cn,ONE:qt,create:u=>Ln(u,e),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return cn<=u&&u<e},is0:u=>u===cn,isValidNot0:u=>!l.is0(u)&&l.isValid(u),isOdd:u=>(u&qt)===qt,neg:u=>Ln(-u,e),eql:(u,d)=>u===d,sqr:u=>Ln(u*u,e),add:(u,d)=>Ln(u+d,e),sub:(u,d)=>Ln(u-d,e),mul:(u,d)=>Ln(u*d,e),pow:(u,d)=>FU(l,u,d),div:(u,d)=>Ln(u*wy(d,e),e),sqrN:u=>u*u,addN:(u,d)=>u+d,subN:(u,d)=>u-d,mulN:(u,d)=>u*d,inv:u=>wy(u,e),sqrt:i||(u=>(c||(c=LU(e)),c(l,u))),toBytes:u=>n?qg(u,a):Hg(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return n?qu(u):md(u)},invertBatch:u=>RC(l,u),cmov:(u,d,h)=>h?d:u});return Object.freeze(l)}function MC(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function LC(e){const t=MC(e);return t+Math.ceil(t/2)}function HU(e,t,n=!1){const r=e.length,s=MC(t),i=LC(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?qu(e):md(e),a=Ln(o,t-qt)+qt;return n?qg(a,s):Hg(a,s)}const Ho=BigInt(0),gi=BigInt(1);function Va(e,t){const n=t.negate();return e?n:t}function qU(e,t,n){const r=i=>i.pz,s=RC(e.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(e.fromAffine)}function BC(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Uh(e,t){BC(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),s=2**e,i=yd(e),o=BigInt(e);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function yy(e,t,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(e&s),c=e>>o;a>r&&(a-=i,c+=gi);const l=t*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=t%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function WU(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function VU(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Rh=new WeakMap,jC=new WeakMap;function Mh(e){return jC.get(e)||1}function by(e){if(e!==Ho)throw new Error("invalid wNAF")}function KU(e,t){return{constTimeNegate:Va,hasPrecomputes(n){return Mh(n)!==1},unsafeLadder(n,r,s=e.ZERO){let i=n;for(;r>Ho;)r&gi&&(s=s.add(i)),i=i.double(),r>>=gi;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Uh(r,t),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=e.ZERO,o=e.BASE;const a=Uh(n,t);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:f}=yy(s,c,a);s=l,d?o=o.add(Va(p,r[f])):i=i.add(Va(h,r[u]))}return by(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=e.ZERO){const o=Uh(n,t);for(let a=0;a<o.windows&&s!==Ho;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=yy(s,a,o);if(s=c,!u){const h=r[l];i=i.add(d?h.negate():h)}}return by(s),i},getPrecomputes(n,r,s){let i=Rh.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),Rh.set(r,i))),i},wNAFCached(n,r,s){const i=Mh(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Mh(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){BC(r,t),jC.set(n,r),Rh.delete(n)}}}function GU(e,t,n,r){let s=t,i=e.ZERO,o=e.ZERO;for(;n>Ho||r>Ho;)n&gi&&(i=i.add(s)),r&gi&&(o=o.add(s)),s=s.double(),n>>=gi,r>>=gi;return{p1:i,p2:o}}function YU(e,t,n,r){WU(n,e),VU(r,t);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=$U(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=yd(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let g=0;g<i;g++){const w=r[g],b=Number(w>>BigInt(p)&l);u[b]=u[b].add(n[g])}let f=o;for(let g=u.length-1,w=o;g>0;g--)w=w.add(u[g]),f=f.add(w);if(h=h.add(f),p!==0)for(let g=0;g<c;g++)h=h.double()}return h}function vy(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return jU(t),t}else return oa(e)}function ZU(e,t,n={}){if(!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const o of["p","n","h"]){const a=t[o];if(!(typeof a=="bigint"&&a>Ho))throw new Error(`CURVE.${o} must be positive bigint`)}const r=vy(t.p,n.Fp),s=vy(t.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(t[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Sa=BigInt(0),eo=BigInt(1),ql=BigInt(2);function JU(e){return bd(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function XU(e){const t=JU(e),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=t,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||ia,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),p=a?ql**BigInt(254):ql**BigInt(447),f=a?BigInt(8)*ql**BigInt(251)-eo:BigInt(4)*ql**BigInt(445)-eo,g=p+f+eo,w=S=>Ln(S,n),b=I(d);function I(S){return qg(w(S),u)}function y(S){const E=on("u coordinate",S,u);return a&&(E[31]&=127),w(qu(E))}function m(S){return qu(s(on("scalar",S,u)))}function v(S,E){const x=D(y(E),m(S));if(x===Sa)throw new Error("invalid private or public key received");return I(x)}function C(S){return v(S,b)}function O(S,E,x){const P=w(S*(E-x));return E=w(E-P),x=w(x+P),{x_2:E,x_3:x}}function D(S,E){up("u",S,Sa,n),up("scalar",E,p,g);const x=E,P=S;let M=eo,R=Sa,A=S,_=eo,k=Sa;for(let U=BigInt(l-1);U>=Sa;U--){const $=x>>U&eo;k^=$,{x_2:M,x_3:A}=O(k,M,A),{x_2:R,x_3:_}=O(k,R,_),k=$;const F=M+R,G=w(F*F),Z=M-R,V=w(Z*Z),ne=G-V,ue=A+_,_e=A-_,Ie=w(_e*F),be=w(ue*Z),nt=Ie+be,lt=Ie-be;A=w(nt*nt),_=w(P*w(lt*lt)),M=w(G*V),R=w(ne*(G+w(h*ne)))}({x_2:M,x_3:A}=O(k,M,A)),{x_2:R,x_3:_}=O(k,R,_);const L=i(R);return w(M*L)}return{scalarMult:v,scalarMultBase:C,getSharedSecret:(S,E)=>v(S,E),getPublicKey:S=>C(S),utils:{randomPrivateKey:()=>c(u)},GuBytes:b.slice()}}BigInt(0);const QU=BigInt(1),Ey=BigInt(2),e6=BigInt(3),t6=BigInt(5);BigInt(8);const FC={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function n6(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=FC.p,o=e*e%i*e%i,a=Jn(o,Ey,i)*o%i,c=Jn(a,QU,i)*e%i,l=Jn(c,t6,i)*c%i,u=Jn(l,t,i)*l%i,d=Jn(u,n,i)*u%i,h=Jn(d,r,i)*d%i,p=Jn(h,s,i)*h%i,f=Jn(p,s,i)*h%i,g=Jn(f,t,i)*l%i;return{pow_p_5_8:Jn(g,Ey,i)*e%i,b2:o}}function r6(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const dp=(()=>{const e=FC.p;return XU({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:n,b2:r}=n6(t);return Ln(Jn(n,e6,e)*r,e)},adjustScalarBytes:r6})})();function Cy(e){e.lowS!==void 0&&Hu("lowS",e.lowS),e.prehash!==void 0&&Hu("prehash",e.prehash)}class s6 extends Error{constructor(t=""){super(t)}}const Gr={Err:s6,_tlv:{encode:(e,t)=>{const{Err:n}=Gr;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,s=Hl(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?Hl(s.length/2|128):"";return Hl(e)+i+s+t},decode(e,t){const{Err:n}=Gr;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const s=t[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=t.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=Gr;if(e<Ka)throw new t("integer: negative integers are not allowed");let n=Hl(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Gr;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return md(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Gr,s=on("signature",e),{v:i,l:o}=r.decode(48,s);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(e){const{_tlv:t,_int:n}=Gr,r=t.encode(2,n.encode(e.r)),s=t.encode(2,n.encode(e.s)),i=r+s;return t.encode(48,i)}},Ka=BigInt(0),Ga=BigInt(1),i6=BigInt(2),Wl=BigInt(3),o6=BigInt(4);function a6(e,t,n){function r(s){const i=e.sqr(s),o=e.mul(i,s);return e.add(e.add(o,e.mul(s,t)),n)}return r}function zC(e,t,n){const{BYTES:r}=e;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=on("private key",i);if(t){if(!t.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=e.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=e.create(o)),!e.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function c6(e,t={}){const{Fp:n,Fn:r}=ZU("weierstrass",e,t),{h:s,n:i}=e;bd(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=t;if(o&&(!n.is0(e.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(D,S,E){const{x,y:P}=S.toAffine(),M=n.toBytes(x);if(Hu("isCompressed",E),E){a();const R=!n.isOdd(P);return fi(HC(R),M)}else return fi(Uint8Array.of(4),M,n.toBytes(P))}function l(D){Fn(D);const S=n.BYTES,E=S+1,x=2*S+1,P=D.length,M=D[0],R=D.subarray(1);if(P===E&&(M===2||M===3)){const A=n.fromBytes(R);if(!n.isValid(A))throw new Error("bad point: is not on curve, wrong x");const _=h(A);let k;try{k=n.sqrt(_)}catch(U){const $=U instanceof Error?": "+U.message:"";throw new Error("bad point: is not on curve, sqrt error"+$)}a();const L=n.isOdd(k);return(M&1)===1!==L&&(k=n.neg(k)),{x:A,y:k}}else if(P===x&&M===4){const A=n.fromBytes(R.subarray(S*0,S*1)),_=n.fromBytes(R.subarray(S*1,S*2));if(!p(A,_))throw new Error("bad point: is not on curve");return{x:A,y:_}}else throw new Error(`bad point: got length ${P}, expected compressed=${E} or uncompressed=${x}`)}const u=t.toBytes||c,d=t.fromBytes||l,h=a6(n,e.a,e.b);function p(D,S){const E=n.sqr(S),x=h(D);return n.eql(E,x)}if(!p(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const f=n.mul(n.pow(e.a,Wl),o6),g=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(f,g)))throw new Error("bad curve params: a or b");function w(D,S,E=!1){if(!n.isValid(S)||E&&n.is0(S))throw new Error(`bad point coordinate ${D}`);return S}function b(D){if(!(D instanceof v))throw new Error("ProjectivePoint expected")}const I=gy((D,S)=>{const{px:E,py:x,pz:P}=D;if(n.eql(P,n.ONE))return{x:E,y:x};const M=D.is0();S==null&&(S=M?n.ONE:n.inv(P));const R=n.mul(E,S),A=n.mul(x,S),_=n.mul(P,S);if(M)return{x:n.ZERO,y:n.ZERO};if(!n.eql(_,n.ONE))throw new Error("invZ was invalid");return{x:R,y:A}}),y=gy(D=>{if(D.is0()){if(t.allowInfinityPoint&&!n.is0(D.py))return;throw new Error("bad point: ZERO")}const{x:S,y:E}=D.toAffine();if(!n.isValid(S)||!n.isValid(E))throw new Error("bad point: x or y not field elements");if(!p(S,E))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function m(D,S,E,x,P){return E=new v(n.mul(E.px,D),E.py,E.pz),S=Va(x,S),E=Va(P,E),S.add(E)}class v{constructor(S,E,x){this.px=w("x",S),this.py=w("y",E,!0),this.pz=w("z",x),Object.freeze(this)}static fromAffine(S){const{x:E,y:x}=S||{};if(!S||!n.isValid(E)||!n.isValid(x))throw new Error("invalid affine point");if(S instanceof v)throw new Error("projective point not allowed");return n.is0(E)&&n.is0(x)?v.ZERO:new v(E,x,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(S){return qU(v,"pz",S)}static fromBytes(S){return Fn(S),v.fromHex(S)}static fromHex(S){const E=v.fromAffine(d(on("pointHex",S)));return E.assertValidity(),E}static fromPrivateKey(S){const E=zC(r,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return v.BASE.multiply(E(S))}static msm(S,E){return YU(v,r,S,E)}precompute(S=8,E=!0){return O.setWindowSize(this,S),E||this.multiply(Wl),this}_setWindowSize(S){this.precompute(S)}assertValidity(){y(this)}hasEvenY(){const{y:S}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(S)}equals(S){b(S);const{px:E,py:x,pz:P}=this,{px:M,py:R,pz:A}=S,_=n.eql(n.mul(E,A),n.mul(M,P)),k=n.eql(n.mul(x,A),n.mul(R,P));return _&&k}negate(){return new v(this.px,n.neg(this.py),this.pz)}double(){const{a:S,b:E}=e,x=n.mul(E,Wl),{px:P,py:M,pz:R}=this;let A=n.ZERO,_=n.ZERO,k=n.ZERO,L=n.mul(P,P),U=n.mul(M,M),$=n.mul(R,R),F=n.mul(P,M);return F=n.add(F,F),k=n.mul(P,R),k=n.add(k,k),A=n.mul(S,k),_=n.mul(x,$),_=n.add(A,_),A=n.sub(U,_),_=n.add(U,_),_=n.mul(A,_),A=n.mul(F,A),k=n.mul(x,k),$=n.mul(S,$),F=n.sub(L,$),F=n.mul(S,F),F=n.add(F,k),k=n.add(L,L),L=n.add(k,L),L=n.add(L,$),L=n.mul(L,F),_=n.add(_,L),$=n.mul(M,R),$=n.add($,$),L=n.mul($,F),A=n.sub(A,L),k=n.mul($,U),k=n.add(k,k),k=n.add(k,k),new v(A,_,k)}add(S){b(S);const{px:E,py:x,pz:P}=this,{px:M,py:R,pz:A}=S;let _=n.ZERO,k=n.ZERO,L=n.ZERO;const U=e.a,$=n.mul(e.b,Wl);let F=n.mul(E,M),G=n.mul(x,R),Z=n.mul(P,A),V=n.add(E,x),ne=n.add(M,R);V=n.mul(V,ne),ne=n.add(F,G),V=n.sub(V,ne),ne=n.add(E,P);let ue=n.add(M,A);return ne=n.mul(ne,ue),ue=n.add(F,Z),ne=n.sub(ne,ue),ue=n.add(x,P),_=n.add(R,A),ue=n.mul(ue,_),_=n.add(G,Z),ue=n.sub(ue,_),L=n.mul(U,ne),_=n.mul($,Z),L=n.add(_,L),_=n.sub(G,L),L=n.add(G,L),k=n.mul(_,L),G=n.add(F,F),G=n.add(G,F),Z=n.mul(U,Z),ne=n.mul($,ne),G=n.add(G,Z),Z=n.sub(F,Z),Z=n.mul(U,Z),ne=n.add(ne,Z),F=n.mul(G,ne),k=n.add(k,F),F=n.mul(ue,ne),_=n.mul(V,_),_=n.sub(_,F),F=n.mul(V,G),L=n.mul(ue,L),L=n.add(L,F),new v(_,k,L)}subtract(S){return this.add(S.negate())}is0(){return this.equals(v.ZERO)}multiply(S){const{endo:E}=t;if(!r.isValidNot0(S))throw new Error("invalid scalar: out of range");let x,P;const M=R=>O.wNAFCached(this,R,v.normalizeZ);if(E){const{k1neg:R,k1:A,k2neg:_,k2:k}=E.splitScalar(S),{p:L,f:U}=M(A),{p:$,f:F}=M(k);P=U.add(F),x=m(E.beta,L,$,R,_)}else{const{p:R,f:A}=M(S);x=R,P=A}return v.normalizeZ([x,P])[0]}multiplyUnsafe(S){const{endo:E}=t,x=this;if(!r.isValid(S))throw new Error("invalid scalar: out of range");if(S===Ka||x.is0())return v.ZERO;if(S===Ga)return x;if(O.hasPrecomputes(this))return this.multiply(S);if(E){const{k1neg:P,k1:M,k2neg:R,k2:A}=E.splitScalar(S),{p1:_,p2:k}=GU(v,x,M,A);return m(E.beta,_,k,P,R)}else return O.wNAFCachedUnsafe(x,S)}multiplyAndAddUnsafe(S,E,x){const P=this.multiplyUnsafe(E).add(S.multiplyUnsafe(x));return P.is0()?void 0:P}toAffine(S){return I(this,S)}isTorsionFree(){const{isTorsionFree:S}=t;return s===Ga?!0:S?S(v,this):O.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:S}=t;return s===Ga?this:S?S(v,this):this.multiplyUnsafe(s)}toBytes(S=!0){return Hu("isCompressed",S),this.assertValidity(),u(v,this,S)}toRawBytes(S=!0){return this.toBytes(S)}toHex(S=!0){return mc(this.toBytes(S))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}v.BASE=new v(e.Gx,e.Gy,n.ONE),v.ZERO=new v(n.ZERO,n.ONE,n.ZERO),v.Fp=n,v.Fn=r;const C=r.BITS,O=KU(v,t.endo?Math.ceil(C/2):C);return v}function HC(e){return Uint8Array.of(e?2:3)}function l6(e,t,n={}){bd(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=t.randomBytes||ia,s=t.hmac||((x,...P)=>gd(t.hash,x,fi(...P))),{Fp:i,Fn:o}=e,{ORDER:a,BITS:c}=o;function l(x){const P=a>>Ga;return x>P}function u(x){return l(x)?o.neg(x):x}function d(x,P){if(!o.isValidNot0(P))throw new Error(`invalid signature ${x}: out of range 1..CURVE.n`)}class h{constructor(P,M,R){d("r",P),d("s",M),this.r=P,this.s=M,R!=null&&(this.recovery=R),Object.freeze(this)}static fromCompact(P){const M=o.BYTES,R=on("compactSignature",P,M*2);return new h(o.fromBytes(R.subarray(0,M)),o.fromBytes(R.subarray(M,M*2)))}static fromDER(P){const{r:M,s:R}=Gr.toSig(on("DER",P));return new h(M,R)}assertValidity(){}addRecoveryBit(P){return new h(this.r,this.s,P)}recoverPublicKey(P){const M=i.ORDER,{r:R,s:A,recovery:_}=this;if(_==null||![0,1,2,3].includes(_))throw new Error("recovery id invalid");if(a*i6<M&&_>1)throw new Error("recovery id is ambiguous for h>1 curve");const k=_===2||_===3?R+a:R;if(!i.isValid(k))throw new Error("recovery id 2 or 3 invalid");const L=i.toBytes(k),U=e.fromHex(fi(HC((_&1)===0),L)),$=o.inv(k),F=y(on("msgHash",P)),G=o.create(-F*$),Z=o.create(A*$),V=e.BASE.multiplyUnsafe(G).add(U.multiplyUnsafe(Z));if(V.is0())throw new Error("point at infinify");return V.assertValidity(),V}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,o.neg(this.s),this.recovery):this}toBytes(P){if(P==="compact")return fi(o.toBytes(this.r),o.toBytes(this.s));if(P==="der")return Bg(Gr.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return mc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return mc(this.toBytes("compact"))}}const p=zC(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),f={isValidPrivateKey(x){try{return p(x),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const x=a;return HU(r(LC(x)),x)},precompute(x=8,P=e.BASE){return P.precompute(x,!1)}};function g(x,P=!0){return e.fromPrivateKey(x).toBytes(P)}function w(x){if(typeof x=="bigint")return!1;if(x instanceof e)return!0;const P=on("key",x).length,M=i.BYTES,R=M+1,A=2*M+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===R))return P===R||P===A}function b(x,P,M=!0){if(w(x)===!0)throw new Error("first arg must be private key");if(w(P)===!1)throw new Error("second arg must be public key");return e.fromHex(P).multiply(p(x)).toBytes(M)}const I=t.bits2int||function(x){if(x.length>8192)throw new Error("input is too large");const P=md(x),M=x.length*8-c;return M>0?P>>BigInt(M):P},y=t.bits2int_modN||function(x){return o.create(I(x))},m=yd(c);function v(x){return up("num < 2^"+c,x,Ka,m),o.toBytes(x)}function C(x,P,M=O){if(["recovered","canonical"].some(V=>V in M))throw new Error("sign() legacy options not supported");const{hash:R}=t;let{lowS:A,prehash:_,extraEntropy:k}=M;A==null&&(A=!0),x=on("msgHash",x),Cy(M),_&&(x=on("prehashed msgHash",R(x)));const L=y(x),U=p(P),$=[v(U),v(L)];if(k!=null&&k!==!1){const V=k===!0?r(i.BYTES):k;$.push(on("extraEntropy",V))}const F=fi(...$),G=L;function Z(V){const ne=I(V);if(!o.isValidNot0(ne))return;const ue=o.inv(ne),_e=e.BASE.multiply(ne).toAffine(),Ie=o.create(_e.x);if(Ie===Ka)return;const be=o.create(ue*o.create(G+Ie*U));if(be===Ka)return;let nt=(_e.x===Ie?0:2)|Number(_e.y&Ga),lt=be;return A&&l(be)&&(lt=u(be),nt^=1),new h(Ie,lt,nt)}return{seed:F,k2sig:Z}}const O={lowS:t.lowS,prehash:!1},D={lowS:t.lowS,prehash:!1};function S(x,P,M=O){const{seed:R,k2sig:A}=C(x,P,M);return kU(t.hash.outputLen,o.BYTES,s)(R,A)}e.BASE.precompute(8);function E(x,P,M,R=D){const A=x;P=on("msgHash",P),M=on("publicKey",M),Cy(R);const{lowS:_,prehash:k,format:L}=R;if("strict"in R)throw new Error("options.strict was renamed to lowS");if(L!==void 0&&!["compact","der","js"].includes(L))throw new Error('format must be "compact", "der" or "js"');const U=typeof A=="string"||Rg(A),$=!U&&!L&&typeof A=="object"&&A!==null&&typeof A.r=="bigint"&&typeof A.s=="bigint";if(!U&&!$)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let F,G;try{if($)if(L===void 0||L==="js")F=new h(A.r,A.s);else throw new Error("invalid format");if(U){try{L!=="compact"&&(F=h.fromDER(A))}catch(nt){if(!(nt instanceof Gr.Err))throw nt}!F&&L!=="der"&&(F=h.fromCompact(A))}G=e.fromHex(M)}catch{return!1}if(!F||_&&F.hasHighS())return!1;k&&(P=t.hash(P));const{r:Z,s:V}=F,ne=y(P),ue=o.inv(V),_e=o.create(ne*ue),Ie=o.create(Z*ue),be=e.BASE.multiplyUnsafe(_e).add(G.multiplyUnsafe(Ie));return be.is0()?!1:o.create(be.x)===Z}return Object.freeze({getPublicKey:g,getSharedSecret:b,sign:S,verify:E,utils:f,Point:e,Signature:h})}function u6(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=oa(t.n,e.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}function d6(e){const{CURVE:t,curveOpts:n}=u6(e),r={hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,ecdsaOpts:r}}function h6(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}function f6(e){const{CURVE:t,curveOpts:n,ecdsaOpts:r}=d6(e),s=c6(t,n),i=l6(s,r,n);return h6(e,i)}function hp(e,t){const n=r=>f6({...e,hash:r});return{...n(t),create:n}}const qC={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},WC={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},VC={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},p6=oa(qC.p),g6=oa(WC.p),w6=oa(VC.p),m6=hp({...qC,Fp:p6,lowS:!1},pd);hp({...WC,Fp:g6,lowS:!1},S5),hp({...VC,Fp:w6,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},I5);const y6=m6,KC="base10",Wt="base16",ir="base64pad",As="base64url",ol="utf8",GC=0,Zr=1,al=2,b6=0,Ay=1,Ya=12,Wg=32;function v6(){const e=dp.utils.randomPrivateKey(),t=dp.getPublicKey(e);return{privateKey:ln(e,Wt),publicKey:ln(t,Wt)}}function fp(){const e=ia(Wg);return ln(e,Wt)}function E6(e,t){const n=dp.getSharedSecret(jn(e,Wt),jn(t,Wt)),r=DU(wd,n,void 0,void 0,Wg);return ln(r,Wt)}function gu(e){const t=wd(jn(e,Wt));return ln(t,Wt)}function vr(e){const t=wd(jn(e,ol));return ln(t,Wt)}function YC(e){return jn(`${e}`,KC)}function Di(e){return Number(ln(e,KC))}function ZC(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function JC(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return t+"=".repeat(n)}function C6(e){const t=YC(typeof e.type<"u"?e.type:GC);if(Di(t)===Zr&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof e.senderPublicKey<"u"?jn(e.senderPublicKey,Wt):void 0,r=typeof e.iv<"u"?jn(e.iv,Wt):ia(Ya),s=jn(e.symKey,Wt),i=TC(s,r).encrypt(jn(e.message,ol)),o=XC({type:t,sealed:i,iv:r,senderPublicKey:n});return e.encoding===As?ZC(o):o}function A6(e){const t=jn(e.symKey,Wt),{sealed:n,iv:r}=bc({encoded:e.encoded,encoding:e.encoding}),s=TC(t,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return ln(s,ol)}function I6(e,t){const n=YC(al),r=ia(Ya),s=jn(e,ol),i=XC({type:n,sealed:s,iv:r});return t===As?ZC(i):i}function S6(e,t){const{sealed:n}=bc({encoded:e,encoding:t});return ln(n,ol)}function XC(e){if(Di(e.type)===al)return ln(Wa([e.type,e.sealed]),ir);if(Di(e.type)===Zr){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ln(Wa([e.type,e.senderPublicKey,e.iv,e.sealed]),ir)}return ln(Wa([e.type,e.iv,e.sealed]),ir)}function bc(e){const t=(e.encoding||ir)===As?JC(e.encoded):e.encoded,n=jn(t,ir),r=n.slice(b6,Ay),s=Ay;if(Di(r)===Zr){const c=s+Wg,l=c+Ya,u=n.slice(s,c),d=n.slice(c,l),h=n.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(Di(r)===al){const c=n.slice(s),l=ia(Ya);return{type:r,sealed:c,iv:l}}const i=s+Ya,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function N6(e,t){const n=bc({encoded:e,encoding:t?.encoding});return QC({type:Di(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?ln(n.senderPublicKey,Wt):void 0,receiverPublicKey:t?.receiverPublicKey})}function QC(e){const t=e?.type||GC;if(t===Zr){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Iy(e){return e.type===Zr&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}function Sy(e){return e.type===al}function x6(e){const t=Buffer.from(e.x,"base64"),n=Buffer.from(e.y,"base64");return Wa([new Uint8Array([4]),t,n])}function _6(e,t){const[n,r,s]=e.split("."),i=Buffer.from(JC(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=wd(c),u=x6(t);if(!y6.verify(Wa([o,a]),l,u))throw new Error("Invalid signature");return Gf(e).payload}const T6="irn";function Wu(e){return e?.relay||{protocol:T6}}function La(e){const t=d4[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}function O6(e,t="-"){const n={},r="relay"+t;return Object.keys(e).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=e[s];n[i]=o}}),n}function Ny(e){if(!e.includes("wc:")){const l=uC(e);l!=null&&l.includes("wc:")&&(e=l)}e=e.includes("wc://")?e.replace("wc://",""):e,e=e.includes("wc:")?e.replace("wc:",""):e;const t=e.indexOf(":"),n=e.indexOf("?")!==-1?e.indexOf("?"):void 0,r=e.substring(0,t),s=e.substring(t+1,n).split("@"),i=typeof n<"u"?e.substring(n):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:D6(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:O6(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function D6(e){return e.startsWith("//")?e.substring(2):e}function P6(e,t="-"){const n="relay",r={};return Object.keys(e).forEach(s=>{const i=s,o=n+t+i;e[i]&&(r[o]=e[i])}),r}function xy(e){const t=new URLSearchParams,n=P6(e.relay);Object.keys(n).sort().forEach(s=>{t.set(s,n[s])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));const r=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${r}`}function Vl(e,t,n){return`${e}?wc_ev=${n}&topic=${t}`}var $6=Object.defineProperty,k6=Object.defineProperties,U6=Object.getOwnPropertyDescriptors,_y=Object.getOwnPropertySymbols,R6=Object.prototype.hasOwnProperty,M6=Object.prototype.propertyIsEnumerable,Ty=(e,t,n)=>t in e?$6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,L6=(e,t)=>{for(var n in t||(t={}))R6.call(t,n)&&Ty(e,n,t[n]);if(_y)for(var n of _y(t))M6.call(t,n)&&Ty(e,n,t[n]);return e},B6=(e,t)=>k6(e,U6(t));function aa(e){const t=[];return e.forEach(n=>{const[r,s]=n.split(":");t.push(`${r}:${s}`)}),t}function j6(e){const t=[];return Object.values(e).forEach(n=>{t.push(...aa(n.accounts))}),t}function F6(e,t){const n=[];return Object.values(e).forEach(r=>{aa(r.accounts).includes(t)&&n.push(...r.methods)}),n}function z6(e,t){const n=[];return Object.values(e).forEach(r=>{aa(r.accounts).includes(t)&&n.push(...r.events)}),n}function vd(e){return e.includes(":")}function No(e){return vd(e)?e.split(":")[0]:e}function Oy(e){var t,n,r;const s={};if(!xr(e))return s;for(const[i,o]of Object.entries(e)){const a=vd(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=No(i);s[u]=B6(L6({},s[u]),{chains:Nr(a,(t=s[u])==null?void 0:t.chains),methods:Nr(c,(n=s[u])==null?void 0:n.methods),events:Nr(l,(r=s[u])==null?void 0:r.events)})}return s}function H6(e){const t={};return e?.forEach(n=>{var r;const[s,i]=n.split(":");t[s]||(t[s]={accounts:[],chains:[],events:[],methods:[]}),t[s].accounts.push(n),(r=t[s].chains)==null||r.push(`${s}:${i}`)}),t}function Dy(e,t){t=t.map(r=>r.replace("did:pkh:",""));const n=H6(t);for(const[r,s]of Object.entries(n))s.methods?s.methods=Nr(s.methods,e):s.methods=e,s.events=["chainChanged","accountsChanged"];return n}function q6(e,t){var n,r,s,i,o,a;const c=Oy(e),l=Oy(t),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:Nr((n=c[h])==null?void 0:n.chains,(r=l[h])==null?void 0:r.chains),methods:Nr((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:Nr((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const W6={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},V6={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function K(e,t){const{message:n,code:r}=V6[e];return{message:t?`${n} ${t}`:n,code:r}}function et(e,t){const{message:n,code:r}=W6[e];return{message:t?`${n} ${t}`:n,code:r}}function Jr(e,t){return!!Array.isArray(e)}function xr(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Ot(e){return typeof e>"u"}function dt(e,t){return t&&Ot(e)?!0:typeof e=="string"&&!!e.trim().length}function Vg(e,t){return t&&Ot(e)?!0:typeof e=="number"&&!isNaN(e)}function K6(e,t){const{requiredNamespaces:n}=t,r=Object.keys(e.namespaces),s=Object.keys(n);let i=!0;return hi(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=e.namespaces[o],u=aa(a),d=n[o];(!hi(iC(o,d),u)||!hi(d.methods,c)||!hi(d.events,l))&&(i=!1)}),i):!1}function Vu(e){return dt(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function G6(e){if(dt(e,!1)&&e.includes(":")){const t=e.split(":");if(t.length===3){const n=t[0]+":"+t[1];return!!t[2]&&Vu(n)}}return!1}function Y6(e){function t(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(dt(e,!1)){if(t(e))return!0;const n=uC(e);return t(n)}}catch{}return!1}function Z6(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function J6(e){return e?.topic}function X6(e,t){let n=null;return dt(e?.publicKey,!1)||(n=K("MISSING_OR_INVALID",`${t} controller public key should be a string`)),n}function Py(e){let t=!0;return Jr(e)?e.length&&(t=e.every(n=>dt(n,!1))):t=!1,t}function Q6(e,t,n){let r=null;return Jr(t)&&t.length?t.forEach(s=>{r||Vu(s)||(r=et("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Vu(e)||(r=et("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function eR(e,t,n){let r=null;return Object.entries(e).forEach(([s,i])=>{if(r)return;const o=Q6(s,iC(s,i),`${t} ${n}`);o&&(r=o)}),r}function tR(e,t){let n=null;return Jr(e)?e.forEach(r=>{n||G6(r)||(n=et("UNSUPPORTED_ACCOUNTS",`${t}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=et("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function nR(e,t){let n=null;return Object.values(e).forEach(r=>{if(n)return;const s=tR(r?.accounts,`${t} namespace`);s&&(n=s)}),n}function rR(e,t){let n=null;return Py(e?.methods)?Py(e?.events)||(n=et("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):n=et("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),n}function e2(e,t){let n=null;return Object.values(e).forEach(r=>{if(n)return;const s=rR(r,`${t}, namespace`);s&&(n=s)}),n}function sR(e,t,n){let r=null;if(e&&xr(e)){const s=e2(e,t);s&&(r=s);const i=eR(e,t,n);i&&(r=i)}else r=K("MISSING_OR_INVALID",`${t}, ${n} should be an object with data`);return r}function Lh(e,t){let n=null;if(e&&xr(e)){const r=e2(e,t);r&&(n=r);const s=nR(e,t);s&&(n=s)}else n=K("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return n}function t2(e){return dt(e.protocol,!0)}function iR(e,t){let n=!1;return e?e&&Jr(e)&&e.length&&e.forEach(r=>{n=t2(r)}):n=!0,n}function oR(e){return typeof e=="number"}function sn(e){return typeof e<"u"&&typeof e!==null}function aR(e){return!(!e||typeof e!="object"||!e.code||!Vg(e.code,!1)||!e.message||!dt(e.message,!1))}function cR(e){return!(Ot(e)||!dt(e.method,!1))}function lR(e){return!(Ot(e)||Ot(e.result)&&Ot(e.error)||!Vg(e.id,!1)||!dt(e.jsonrpc,!1))}function uR(e){return!(Ot(e)||!dt(e.name,!1))}function $y(e,t){return!(!Vu(t)||!j6(e).includes(t))}function dR(e,t,n){return dt(n,!1)?F6(e,t).includes(n):!1}function hR(e,t,n){return dt(n,!1)?z6(e,t).includes(n):!1}function ky(e,t,n){let r=null;const s=fR(e),i=pR(t),o=Object.keys(s),a=Object.keys(i),c=Uy(Object.keys(e)),l=Uy(Object.keys(t)),u=c.filter(d=>!l.includes(d));return u.length&&(r=K("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(t).toString()}`)),hi(o,a)||(r=K("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(d=>{if(!d.includes(":")||r)return;const h=aa(t[d].accounts);h.includes(d)||(r=K("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(hi(s[d].methods,i[d].methods)?hi(s[d].events,i[d].events)||(r=K("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=K("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function fR(e){const t={};return Object.keys(e).forEach(n=>{var r;n.includes(":")?t[n]=e[n]:(r=e[n].chains)==null||r.forEach(s=>{t[s]={methods:e[n].methods,events:e[n].events}})}),t}function Uy(e){return[...new Set(e.map(t=>t.includes(":")?t.split(":")[0]:t))]}function pR(e){const t={};return Object.keys(e).forEach(n=>{n.includes(":")?t[n]=e[n]:aa(e[n].accounts)?.forEach(s=>{t[s]={accounts:e[n].accounts.filter(i=>i.includes(`${s}:`)),methods:e[n].methods,events:e[n].events}})}),t}function gR(e,t){return Vg(e,!1)&&e<=t.max&&e>=t.min}function Ry(){const e=sl();return new Promise(t=>{switch(e){case In.browser:t(wR());break;case In.reactNative:t(mR());break;case In.node:t(yR());break;default:t(!0)}})}function wR(){return sa()&&navigator?.onLine}async function mR(){return Bs()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function yR(){return!0}function bR(e){switch(sl()){case In.browser:vR(e);break;case In.reactNative:ER(e);break}}function vR(e){!Bs()&&sa()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}function ER(e){Bs()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(t=>e(t?.isConnected))}function CR(){var e;return sa()&&ts.getDocument()?((e=ts.getDocument())==null?void 0:e.visibilityState)==="visible":!0}const Bh={};class Na{static get(t){return Bh[t]}static set(t,n){Bh[t]=n}static delete(t){delete Bh[t]}}function AR(e){const t=ra.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}function IR({publicKey:e,signature:t,payload:n}){var r;const s=pp(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=xR(n.address),a=n.era==="00"?new Uint8Array([0]):pp(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${NR(n.tip)}`),d=TR(u),h=new Uint8Array([0,...e,o,...t,...a,...l,...d,...s]),p=_R(h.length+1);return new Uint8Array([...p,i,...h])}function SR(e){const t=pp(e),n=g4.blake2b(t,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function pp(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(t=>parseInt(t,16)))}function NR(e){return e.startsWith("0x")?e.slice(2):e}function xR(e){const t=ra.decode(e)[0];return t===42?0:t===60?2:1}function _R(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){const t=e<<2|1;return new Uint8Array([t&255,t>>8&255])}else if(e<1<<30){const t=e<<2|2;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function TR(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){const t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}else if(e<BigInt(1)<<BigInt(30)){const t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function OR(e){const t=Uint8Array.from(Buffer.from(e.signature,"hex")),n=AR(e.transaction.address),r=IR({publicKey:n,signature:t,payload:e.transaction}),s=Buffer.from(r).toString("hex");return SR(s)}const DR="PARSE_ERROR",PR="INVALID_REQUEST",$R="METHOD_NOT_FOUND",kR="INVALID_PARAMS",n2="INTERNAL_ERROR",Kg="SERVER_ERROR",UR=[-32700,-32600,-32601,-32602,-32603],Za={[DR]:{code:-32700,message:"Parse error"},[PR]:{code:-32600,message:"Invalid Request"},[$R]:{code:-32601,message:"Method not found"},[kR]:{code:-32602,message:"Invalid params"},[n2]:{code:-32603,message:"Internal error"},[Kg]:{code:-32e3,message:"Server error"}},r2=Kg;function RR(e){return UR.includes(e)}function My(e){return Object.keys(Za).includes(e)?Za[e]:Za[r2]}function MR(e){const t=Object.values(Za).find(n=>n.code===e);return t||Za[r2]}function s2(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}var jh={},Fr={},Ly;function LR(){if(Ly)return Fr;Ly=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.isBrowserCryptoAvailable=Fr.getSubtleCrypto=Fr.getBrowerCrypto=void 0;function e(){return zt?.crypto||zt?.msCrypto||{}}Fr.getBrowerCrypto=e;function t(){const r=e();return r.subtle||r.webkitSubtle}Fr.getSubtleCrypto=t;function n(){return!!e()&&!!t()}return Fr.isBrowserCryptoAvailable=n,Fr}var zr={},By;function BR(){if(By)return zr;By=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.isBrowser=zr.isNode=zr.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}zr.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}zr.isNode=t;function n(){return!e()&&!t()}return zr.isBrowser=n,zr}var jy;function jR(){return jy||(jy=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Jc;t.__exportStar(LR(),e),t.__exportStar(BR(),e)})(jh)),jh}var FR=jR();function yr(e=3){const t=Date.now()*Math.pow(10,e),n=Math.floor(Math.random()*Math.pow(10,e));return t+n}function wi(e=6){return BigInt(yr(e))}function _s(e,t,n){return{id:n||yr(),jsonrpc:"2.0",method:e,params:t}}function Ed(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Cd(e,t,n){return{id:e,jsonrpc:"2.0",error:zR(t)}}function zR(e,t){return typeof e>"u"?My(n2):(typeof e=="string"&&(e=Object.assign(Object.assign({},My(Kg)),{message:e})),RR(e.code)&&(e=MR(e.code)),e)}let HR=class{},qR=class extends HR{constructor(){super()}},WR=class extends qR{constructor(t){super()}};const VR="^https?:",KR="^wss?:";function GR(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function i2(e,t){const n=GR(e);return typeof n>"u"?!1:new RegExp(t).test(n)}function Fy(e){return i2(e,VR)}function zy(e){return i2(e,KR)}function YR(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function o2(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function Gg(e){return o2(e)&&"method"in e}function Ad(e){return o2(e)&&(br(e)||Mn(e))}function br(e){return"result"in e}function Mn(e){return"error"in e}let qn=class extends WR{constructor(t){super(t),this.events=new Hn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async request(t,n){return this.requestStrict(_s(t.method,t.params||[],t.id||wi().toString()),n)}async requestStrict(t,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${t.id}`,i=>{Mn(i)?s(i.error):r(i.result)});try{await this.connection.send(t,n)}catch(i){s(i)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ad(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const ZR=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),JR=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Hy=e=>e.split("?")[0],qy=10,XR=ZR();let QR=class{constructor(t){if(this.url=t,this.events=new Hn.EventEmitter,this.registering=!1,!zy(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(es(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!zy(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=t,this.registering=!0,new Promise((n,r)=>{const s=FR.isReactNative()?void 0:{rejectUnauthorized:!YR(t)},i=new XR(t,[],s);JR()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(t){t.onmessage=n=>this.onPayload(n),t.onclose=n=>this.onClose(n),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const n=typeof t.data=="string"?Ti(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n),s=r.message||r.toString(),i=Cd(t,s);this.events.emit("payload",i)}parseError(t,n=this.url){return s2(t,Hy(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>qy&&this.events.setMaxListeners(qy)}emitError(t){const n=this.parseError(new Error(t?.message||`WebSocket connection failed for host: ${Hy(this.url)}`));return this.events.emit("register_error",n),n}};var eM={};const a2="wc",c2=2,gp="core",Tr=`${a2}@2:${gp}:`,tM={logger:"error"},nM={database:":memory:"},rM="crypto",Wy="client_ed25519_seed",sM=Y.ONE_DAY,iM="keychain",oM="0.3",aM="messages",cM="0.3",Vy=Y.SIX_HOURS,lM="publisher",l2="irn",uM="error",u2="wss://relay.walletconnect.org",dM="relayer",vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},hM="_subscription",Dn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},fM=.1,wp="2.21.5",Xe={link_mode:"link_mode",relay:"relay"},wu={inbound:"inbound",outbound:"outbound"},pM="0.3",gM="WALLETCONNECT_CLIENT_ID",Ky="WALLETCONNECT_LINK_MODE_APPS",wn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},wM="subscription",mM="0.3",yM="pairing",bM="0.3",xa={wc_pairingDelete:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:0},res:{ttl:Y.ONE_DAY,prompt:!1,tag:0}}},ai={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Gn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},vM="history",EM="0.3",CM="expirer",Rn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},AM="0.3",IM="verify-api",SM="https://verify.walletconnect.com",d2="https://verify.walletconnect.org",Ja=d2,NM=`${Ja}/v3`,xM=[SM,d2],_M="echo",TM="https://echo.walletconnect.com",mr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Kr={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Yn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Js={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Xs={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},_a={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},OM=.1,DM="event-client",PM=86400,$M="https://pulse.walletconnect.org/batch";function kM(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=e.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=n[f.charCodeAt(g)];if(m===255)return;for(var v=0,C=I-1;(m!==0||v<b)&&C!==-1;C--,v++)m+=a*y[C]>>>0,y[C]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");b=v,g++}if(f[g]!==" "){for(var O=I-b;O!==I&&y[O]===0;)O++;for(var D=new Uint8Array(w+(I-O)),S=w;O!==I;)D[S++]=y[O++];return D}}}function p(f){var g=h(f);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var UM=kM,RM=UM;const h2=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},MM=e=>new TextEncoder().encode(e),LM=e=>new TextDecoder().decode(e);class BM{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class jM{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return f2(this,t)}}class FM{constructor(t){this.decoders=t}or(t){return f2(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const f2=(e,t)=>new FM({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class zM{constructor(t,n,r,s){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new BM(t,n,r),this.decoder=new jM(t,n,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Id=({name:e,prefix:t,encode:n,decode:r})=>new zM(e,t,n,r),cl=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:s}=RM(n,t);return Id({prefix:e,name:t,encode:r,decode:i=>h2(s(i))})},HM=(e,t,n,r)=>{const s={};for(let u=0;u<t.length;++u)s[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},qM=(e,t,n)=>{const r=t[t.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,i+=t[s&a>>o];if(o&&(i+=t[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Ut=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>Id({prefix:t,name:e,encode(s){return qM(s,r,n)},decode(s){return HM(s,r,n,e)}}),WM=Id({prefix:"\0",name:"identity",encode:e=>LM(e),decode:e=>MM(e)});var VM=Object.freeze({__proto__:null,identity:WM});const KM=Ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var GM=Object.freeze({__proto__:null,base2:KM});const YM=Ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ZM=Object.freeze({__proto__:null,base8:YM});const JM=cl({prefix:"9",name:"base10",alphabet:"0123456789"});var XM=Object.freeze({__proto__:null,base10:JM});const QM=Ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),eL=Ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var tL=Object.freeze({__proto__:null,base16:QM,base16upper:eL});const nL=Ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),rL=Ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),sL=Ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),iL=Ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oL=Ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),aL=Ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cL=Ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lL=Ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),uL=Ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var dL=Object.freeze({__proto__:null,base32:nL,base32upper:rL,base32pad:sL,base32padupper:iL,base32hex:oL,base32hexupper:aL,base32hexpad:cL,base32hexpadupper:lL,base32z:uL});const hL=cl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fL=cl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var pL=Object.freeze({__proto__:null,base36:hL,base36upper:fL});const gL=cl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),wL=cl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var mL=Object.freeze({__proto__:null,base58btc:gL,base58flickr:wL});const yL=Ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),bL=Ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),vL=Ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),EL=Ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var CL=Object.freeze({__proto__:null,base64:yL,base64pad:bL,base64url:vL,base64urlpad:EL});const p2=Array.from(""),AL=p2.reduce((e,t,n)=>(e[n]=t,e),[]),IL=p2.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function SL(e){return e.reduce((t,n)=>(t+=AL[n],t),"")}function NL(e){const t=[];for(const n of e){const r=IL[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const xL=Id({prefix:"",name:"base256emoji",encode:SL,decode:NL});var _L=Object.freeze({__proto__:null,base256emoji:xL}),TL=g2,Gy=128,OL=-128,DL=Math.pow(2,31);function g2(e,t,n){t=t||[],n=n||0;for(var r=n;e>=DL;)t[n++]=e&255|Gy,e/=128;for(;e&OL;)t[n++]=e&255|Gy,e>>>=7;return t[n]=e|0,g2.bytes=n-r+1,t}var PL=mp,$L=128,Yy=127;function mp(e,r){var n=0,r=r||0,s=0,i=r,o,a=e.length;do{if(i>=a)throw mp.bytes=0,new RangeError("Could not decode varint");o=e[i++],n+=s<28?(o&Yy)<<s:(o&Yy)*Math.pow(2,s),s+=7}while(o>=$L);return mp.bytes=i-r,n}var kL=Math.pow(2,7),UL=Math.pow(2,14),RL=Math.pow(2,21),ML=Math.pow(2,28),LL=Math.pow(2,35),BL=Math.pow(2,42),jL=Math.pow(2,49),FL=Math.pow(2,56),zL=Math.pow(2,63),HL=function(e){return e<kL?1:e<UL?2:e<RL?3:e<ML?4:e<LL?5:e<BL?6:e<jL?7:e<FL?8:e<zL?9:10},qL={encode:TL,decode:PL,encodingLength:HL},w2=qL;const Zy=(e,t,n=0)=>(w2.encode(e,t,n),t),Jy=e=>w2.encodingLength(e),yp=(e,t)=>{const n=t.byteLength,r=Jy(e),s=r+Jy(n),i=new Uint8Array(s+n);return Zy(e,i,0),Zy(n,i,r),i.set(t,s),new WL(e,n,t,i)};class WL{constructor(t,n,r,s){this.code=t,this.size=n,this.digest=r,this.bytes=s}}const m2=({name:e,code:t,encode:n})=>new VL(e,t,n);class VL{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?yp(this.code,n):n.then(r=>yp(this.code,r))}else throw Error("Unknown type, must be binary type")}}const y2=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),KL=m2({name:"sha2-256",code:18,encode:y2("SHA-256")}),GL=m2({name:"sha2-512",code:19,encode:y2("SHA-512")});var YL=Object.freeze({__proto__:null,sha256:KL,sha512:GL});const b2=0,ZL="identity",v2=h2,JL=e=>yp(b2,v2(e)),XL={code:b2,name:ZL,encode:v2,digest:JL};var QL=Object.freeze({__proto__:null,identity:XL});new TextEncoder,new TextDecoder;const Xy={...VM,...GM,...ZM,...XM,...tL,...dL,...pL,...mL,...CL,..._L};({...YL,...QL});function E2(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function eB(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?E2(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function C2(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Qy=C2("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Fh=C2("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=eB(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),tB={utf8:Qy,"utf-8":Qy,hex:Xy.base16,latin1:Fh,ascii:Fh,binary:Fh,...Xy};function nB(e,t="utf8"){const n=tB[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?E2(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}var rB=Object.defineProperty,sB=(e,t,n)=>t in e?rB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pr=(e,t,n)=>sB(e,typeof t!="symbol"?t+"":t,n);let iB=class{constructor(t,n){this.core=t,this.logger=n,pr(this,"keychain",new Map),pr(this,"name",iM),pr(this,"version",oM),pr(this,"initialized",!1),pr(this,"storagePrefix",Tr),pr(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),pr(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),pr(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),pr(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=K("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),pr(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=t,this.logger=Kt(n,this.name)}get context(){return dn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,np(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?rp(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}};var oB=Object.defineProperty,aB=(e,t,n)=>t in e?oB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Nt=(e,t,n)=>aB(e,typeof t!="symbol"?t+"":t,n);class cB{constructor(t,n,r){this.core=t,this.logger=n,Nt(this,"name",rM),Nt(this,"keychain"),Nt(this,"randomSessionIdentifier",fp()),Nt(this,"initialized",!1),Nt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),Nt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),Nt(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=Am(s);return DE(i.publicKey)}),Nt(this,"generateKeyPair",()=>{this.isInitialized();const s=v6();return this.setPrivateKey(s.publicKey,s.privateKey)}),Nt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=Am(i),a=this.randomSessionIdentifier;return await S$(a,s,sM,o)}),Nt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=E6(a,i);return this.setSymKey(c,o)}),Nt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||gu(s);return await this.keychain.set(o,s),o}),Nt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),Nt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),Nt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=QC(o),c=es(i);if(Sy(a))return I6(c,o?.encoding);if(Iy(a)){const h=a.senderPublicKey,p=a.receiverPublicKey;s=await this.generateSharedKey(h,p)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return C6({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),Nt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=N6(i,o);if(Sy(a)){const c=S6(i,o?.encoding);return Ti(c)}if(Iy(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=A6({symKey:c,encoded:i,encoding:o?.encoding});return Ti(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),Nt(this,"getPayloadType",(s,i=ir)=>{const o=bc({encoded:s,encoding:i});return Di(o.type)}),Nt(this,"getPayloadSenderPublicKey",(s,i=ir)=>{const o=bc({encoded:s,encoding:i});return o.senderPublicKey?ln(o.senderPublicKey,Wt):void 0}),this.core=t,this.logger=Kt(n,this.name),this.keychain=r||new iB(this.core,this.logger)}get context(){return dn(this.logger)}async setPrivateKey(t,n){return await this.keychain.set(t,n),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Wy)}catch{t=fp(),await this.keychain.set(Wy,t)}return nB(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}}var lB=Object.defineProperty,uB=Object.defineProperties,dB=Object.getOwnPropertyDescriptors,eb=Object.getOwnPropertySymbols,hB=Object.prototype.hasOwnProperty,fB=Object.prototype.propertyIsEnumerable,bp=(e,t,n)=>t in e?lB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pB=(e,t)=>{for(var n in t||(t={}))hB.call(t,n)&&bp(e,n,t[n]);if(eb)for(var n of eb(t))fB.call(t,n)&&bp(e,n,t[n]);return e},gB=(e,t)=>uB(e,dB(t)),pn=(e,t,n)=>bp(e,typeof t!="symbol"?t+"":t,n);class wB extends AO{constructor(t,n){super(t,n),this.logger=t,this.core=n,pn(this,"messages",new Map),pn(this,"messagesWithoutClientAck",new Map),pn(this,"name",aM),pn(this,"version",cM),pn(this,"initialized",!1),pn(this,"storagePrefix",Tr),pn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),pn(this,"set",async(r,s,i)=>{this.isInitialized();const o=vr(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===wu.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,gB(pB({},c),{[o]:s}))}return await this.persist(),o}),pn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),pn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),pn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=vr(s);return typeof i[o]<"u"}),pn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=vr(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),pn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Kt(t,this.name),this.core=n}get context(){return dn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,np(t))}async setRelayerMessagesWithoutClientAck(t){await this.core.storage.setItem(this.storageKeyWithoutClientAck,np(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?rp(t):void 0}async getRelayerMessagesWithoutClientAck(){const t=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof t<"u"?rp(t):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}}var mB=Object.defineProperty,yB=Object.defineProperties,bB=Object.getOwnPropertyDescriptors,tb=Object.getOwnPropertySymbols,vB=Object.prototype.hasOwnProperty,EB=Object.prototype.propertyIsEnumerable,vp=(e,t,n)=>t in e?mB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Kl=(e,t)=>{for(var n in t||(t={}))vB.call(t,n)&&vp(e,n,t[n]);if(tb)for(var n of tb(t))EB.call(t,n)&&vp(e,n,t[n]);return e},zh=(e,t)=>yB(e,bB(t)),Zn=(e,t,n)=>vp(e,typeof t!="symbol"?t+"":t,n);class CB extends IO{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,Zn(this,"events",new Hn.EventEmitter),Zn(this,"name",lM),Zn(this,"queue",new Map),Zn(this,"publishTimeout",Y.toMiliseconds(Y.ONE_MINUTE)),Zn(this,"initialPublishTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),Zn(this,"needsTransportRestart",!1),Zn(this,"publish",async(r,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const a=i?.ttl||Vy,c=Wu(i),l=i?.prompt||!1,u=i?.tag||0,d=i?.id||wi().toString(),h={topic:r,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:d,attestation:i?.attestation,tvf:i?.tvf}},p=`Failed to publish payload, please try again. id:${d} tag:${u}`;try{const f=new Promise(async g=>{const w=({id:I})=>{h.opts.id===I&&(this.removeRequestFromQueue(I),this.relayer.events.removeListener(vt.publish,w),g(h))};this.relayer.events.on(vt.publish,w);const b=xs(new Promise((I,y)=>{this.rpcPublish({topic:r,message:s,ttl:a,prompt:l,tag:u,id:d,attestation:i?.attestation,tvf:i?.tvf}).then(I).catch(m=>{this.logger.warn(m,m?.message),y(m)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${u}`);try{await b,this.events.removeListener(vt.publish,w)}catch(I){this.queue.set(d,zh(Kl({},h),{attempt:1})),this.logger.warn(I,I?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:r,message:s,opts:i}}),await xs(f,this.publishTimeout,p)}catch(f){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(f),(o=i?.internal)!=null&&o.throwOnFailedPublish)throw f}finally{this.queue.delete(d)}}),Zn(this,"on",(r,s)=>{this.events.on(r,s)}),Zn(this,"once",(r,s)=>{this.events.once(r,s)}),Zn(this,"off",(r,s)=>{this.events.off(r,s)}),Zn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=t,this.logger=Kt(n,this.name),this.registerEventListeners()}get context(){return dn(this.logger)}async rpcPublish(t){var n,r,s,i;const{topic:o,message:a,ttl:c=Vy,prompt:l,tag:u,id:d,attestation:h,tvf:p}=t,f={method:La(Wu().protocol).publish,params:Kl({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:h},p),id:d};Ot((n=f.params)==null?void 0:n.prompt)&&((r=f.params)==null||delete r.prompt),Ot((s=f.params)==null?void 0:s.tag)&&((i=f.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:f});const g=await this.relayer.request(f);return this.relayer.events.emit(vt.publish,t),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async(t,n)=>{const r=t.attempt+1;this.queue.set(n,zh(Kl({},t),{attempt:r}));const{topic:s,message:i,opts:o,attestation:a}=t;this.logger.warn({},`Publisher: queue->publishing: ${t.opts.id}, tag: ${t.opts.tag}, attempt: ${r}`),await this.rpcPublish(zh(Kl({},t),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${t.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Mi.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(vt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}var AB=Object.defineProperty,IB=(e,t,n)=>t in e?AB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,to=(e,t,n)=>IB(e,typeof t!="symbol"?t+"":t,n);class SB{constructor(){to(this,"map",new Map),to(this,"set",(t,n)=>{const r=this.get(t);this.exists(t,n)||this.map.set(t,[...r,n])}),to(this,"get",t=>this.map.get(t)||[]),to(this,"exists",(t,n)=>this.get(t).includes(n)),to(this,"delete",(t,n)=>{if(typeof n>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const r=this.get(t);if(!this.exists(t,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(t);return}this.map.set(t,s)}),to(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var NB=Object.defineProperty,xB=Object.defineProperties,_B=Object.getOwnPropertyDescriptors,nb=Object.getOwnPropertySymbols,TB=Object.prototype.hasOwnProperty,OB=Object.prototype.propertyIsEnumerable,Ep=(e,t,n)=>t in e?NB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ta=(e,t)=>{for(var n in t||(t={}))TB.call(t,n)&&Ep(e,n,t[n]);if(nb)for(var n of nb(t))OB.call(t,n)&&Ep(e,n,t[n]);return e},Hh=(e,t)=>xB(e,_B(t)),qe=(e,t,n)=>Ep(e,typeof t!="symbol"?t+"":t,n);class DB extends xO{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,qe(this,"subscriptions",new Map),qe(this,"topicMap",new SB),qe(this,"events",new Hn.EventEmitter),qe(this,"name",wM),qe(this,"version",mM),qe(this,"pending",new Map),qe(this,"cached",[]),qe(this,"initialized",!1),qe(this,"storagePrefix",Tr),qe(this,"subscribeTimeout",Y.toMiliseconds(Y.ONE_MINUTE)),qe(this,"initialSubscribeTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),qe(this,"clientId"),qe(this,"batchSubscribeTopicsLimit",500),qe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),qe(this,"subscribe",async(r,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const i=Wu(s),o={topic:r,relay:i,transportType:s?.transportType};this.pending.set(r,o);const a=await this.rpcSubscribe(r,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),qe(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),qe(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),qe(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),qe(this,"on",(r,s)=>{this.events.on(r,s)}),qe(this,"once",(r,s)=>{this.events.once(r,s)}),qe(this,"off",(r,s)=>{this.events.off(r,s)}),qe(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),qe(this,"start",async()=>{await this.onConnect()}),qe(this,"stop",async()=>{await this.onDisconnect()}),qe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),qe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),qe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Mi.pulse,async()=>{await this.checkPending()}),this.events.on(wn.created,async r=>{const s=wn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(wn.deleted,async r=>{const s=wn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=t,this.logger=Kt(n,this.name),this.clientId=""}get context(){return dn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(t,n){let r=!1;try{r=this.getSubscription(t).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,n){const r=this.topicMap.get(t);await Promise.all(r.map(async s=>await this.unsubscribeById(t,s,n)))}async unsubscribeById(t,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}});try{const s=Wu(r);await this.restartToComplete({topic:t,id:n,relay:s}),await this.rpcUnsubscribe(t,n,s);const i=et("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,n,r){var s;(!r||r?.transportType===Xe.relay)&&await this.restartToComplete({topic:t,id:t,relay:n});const i={method:La(n.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=r?.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(t);if(r?.transportType===Xe.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},Y.toMiliseconds(Y.ONE_SECOND)),a;const c=new Promise(async u=>{const d=h=>{h.topic===t&&(this.events.removeListener(wn.created,d),u(h.id))};this.events.on(wn.created,d);try{const h=await xs(new Promise((p,f)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g?.message),f(g)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${t} failed, please try again`);this.events.removeListener(wn.created,d),u(h)}catch{}}),l=await xs(c,this.subscribeTimeout,`Subscribing to ${t} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${t} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(vt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(t){if(!t.length)return;const n=t[0].relay,r={method:La(n.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await xs(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(vt.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const n=t[0].relay,r={method:La(n.protocol).batchFetchMessages,params:{topics:t.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await xs(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(vt.connection_stalled)}return s}rpcUnsubscribe(t,n,r){const s={method:La(r.protocol).unsubscribe,params:{topic:t,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,n){this.setSubscription(t,Hh(Ta({},n),{id:t})),this.pending.delete(n.topic)}onBatchSubscribe(t){t.length&&t.forEach(n=>{this.setSubscription(n.id,Ta({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(t,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,t)&&this.deleteSubscription(n,r),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:n}),this.addSubscription(t,n)}addSubscription(t,n){this.subscriptions.set(t,Ta({},n)),this.topicMap.set(n.topic,t),this.events.emit(wn.created,n)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const n=this.subscriptions.get(t);if(!n){const{message:r}=K("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}deleteSubscription(t,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:n});const r=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(r.topic,t),this.events.emit(wn.deleted,Hh(Ta({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(wn.sync)}async onRestart(){if(this.cached.length){const t=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=t.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(wn.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:n}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){t.length&&(await this.rpcBatchSubscribe(t),this.onBatchSubscribe(await Promise.all(t.map(async n=>Hh(Ta({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const n=await this.rpcBatchFetchMessages(t);n&&n.messages&&(await z4(Y.toMiliseconds(Y.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(t){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(t),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(t){return vr(t+await this.getClientId())}}var PB=Object.defineProperty,rb=Object.getOwnPropertySymbols,$B=Object.prototype.hasOwnProperty,kB=Object.prototype.propertyIsEnumerable,Cp=(e,t,n)=>t in e?PB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,sb=(e,t)=>{for(var n in t||(t={}))$B.call(t,n)&&Cp(e,n,t[n]);if(rb)for(var n of rb(t))kB.call(t,n)&&Cp(e,n,t[n]);return e},Oe=(e,t,n)=>Cp(e,typeof t!="symbol"?t+"":t,n);class UB extends SO{constructor(t){super(t),Oe(this,"protocol","wc"),Oe(this,"version",2),Oe(this,"core"),Oe(this,"logger"),Oe(this,"events",new Hn.EventEmitter),Oe(this,"provider"),Oe(this,"messages"),Oe(this,"subscriber"),Oe(this,"publisher"),Oe(this,"name",dM),Oe(this,"transportExplicitlyClosed",!1),Oe(this,"initialized",!1),Oe(this,"connectionAttemptInProgress",!1),Oe(this,"relayUrl"),Oe(this,"projectId"),Oe(this,"packageName"),Oe(this,"bundleId"),Oe(this,"hasExperiencedNetworkDisruption",!1),Oe(this,"pingTimeout"),Oe(this,"heartBeatTimeout",Y.toMiliseconds(Y.THIRTY_SECONDS+Y.FIVE_SECONDS)),Oe(this,"reconnectTimeout"),Oe(this,"connectPromise"),Oe(this,"reconnectInProgress",!1),Oe(this,"requestsInFlight",[]),Oe(this,"connectTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),Oe(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||wi().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Oe(this,"resetPingTimeout",()=>{Fu()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o?.message)}},this.heartBeatTimeout))}),Oe(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),Oe(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(vt.connect)}),Oe(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Oe(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(vt.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Oe(this,"registerProviderListeners",()=>{this.provider.on(Dn.payload,this.onPayloadHandler),this.provider.on(Dn.connect,this.onConnectHandler),this.provider.on(Dn.disconnect,this.onDisconnectHandler),this.provider.on(Dn.error,this.onProviderErrorHandler)}),this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Kt(t.logger,this.name):Qc(tl({level:t.logger||uM})),this.messages=new wB(this.logger,t.core),this.subscriber=new DB(this,this.logger),this.publisher=new CB(this,this.logger),this.relayUrl=t?.relayUrl||u2,this.projectId=t.projectId,N4()?this.packageName=Vm():x4()&&(this.bundleId=Vm()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(t=>this.logger.warn(t,t?.message))}get context(){return dn(this.logger)}get connected(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(t,n,r){this.isInitialized(),await this.publisher.publish(t,n,r),await this.recordMessageEvent({topic:t,message:n,publishedAt:Date.now(),transportType:Xe.relay},wu.outbound)}async subscribe(t,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(t))==null?void 0:i[0])||"",c;const l=u=>{u.topic===t&&(this.subscriber.off(wn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(wn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(t,sb({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(t,n){this.isInitialized(),await this.subscriber.unsubscribe(t,n)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await xs(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(t).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(t){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Ry())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if(t?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=t.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(t,n){const{topic:r}=t;if(!n.sessionExists){const s=gt(Y.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(vt.message,t),await this.recordMessageEvent(t,wu.inbound)}async connect(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Dn.disconnect,i),await xs(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Dn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Dn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Dn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,Y.toMiliseconds(n*1))),n++}}startPingTimeout(){var t,n,r,s,i;if(Fu())try{(n=(t=this.provider)==null?void 0:t.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new qn(new QR(P4({sdkVersion:wp,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(t,n){const{topic:r,message:s}=t;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(t){const{topic:n,message:r}=t;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Gg(t)){if(!t.method.endsWith(hM))return;const n=t.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:Xe.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(sb({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(t),await this.onMessageEvent(a)}else Ad(t)&&this.events.emit(vt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(await this.recordMessageEvent(t,wu.inbound),this.events.emit(vt.message,t))}async acknowledgePayload(t){const n=Ed(t.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(Dn.payload,this.onPayloadHandler),this.provider.off(Dn.connect,this.onConnectHandler),this.provider.off(Dn.disconnect,this.onDisconnectHandler),this.provider.off(Dn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await Ry();bR(async n=>{t!==n&&(t=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Mi.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&CR())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(vt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t,t?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Y.toMiliseconds(fM)))))}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function RB(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function ib(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function ob(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const MB="[object RegExp]",LB="[object String]",BB="[object Number]",jB="[object Boolean]",ab="[object Arguments]",FB="[object Symbol]",zB="[object Date]",HB="[object Map]",qB="[object Set]",WB="[object Array]",VB="[object Function]",KB="[object ArrayBuffer]",qh="[object Object]",GB="[object Error]",YB="[object DataView]",ZB="[object Uint8Array]",JB="[object Uint8ClampedArray]",XB="[object Uint16Array]",QB="[object Uint32Array]",ej="[object BigUint64Array]",tj="[object Int8Array]",nj="[object Int16Array]",rj="[object Int32Array]",sj="[object BigInt64Array]",ij="[object Float32Array]",oj="[object Float64Array]";function aj(){}function cb(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}function cj(e,t,n){return Ba(e,t,void 0,void 0,void 0,void 0,n)}function Ba(e,t,n,r,s,i,o){const a=o(e,t,n,r,s,i);if(a!==void 0)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return Xa(e,t,i,o)}return Xa(e,t,i,o)}function Xa(e,t,n,r){if(Object.is(e,t))return!0;let s=ob(e),i=ob(t);if(s===ab&&(s=qh),i===ab&&(i=qh),s!==i)return!1;switch(s){case LB:return e.toString()===t.toString();case BB:{const c=e.valueOf(),l=t.valueOf();return RB(c,l)}case jB:case zB:case FB:return Object.is(e.valueOf(),t.valueOf());case MB:return e.source===t.source&&e.flags===t.flags;case VB:return e===t}n=n??new Map;const o=n.get(e),a=n.get(t);if(o!=null&&a!=null)return o===t;n.set(e,t),n.set(t,e);try{switch(s){case HB:{if(e.size!==t.size)return!1;for(const[c,l]of e.entries())if(!t.has(c)||!Ba(l,t.get(c),c,e,t,n,r))return!1;return!0}case qB:{if(e.size!==t.size)return!1;const c=Array.from(e.values()),l=Array.from(t.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(p=>Ba(d,p,void 0,e,t,n,r));if(h===-1)return!1;l.splice(h,1)}return!0}case WB:case ZB:case JB:case XB:case QB:case ej:case tj:case nj:case rj:case sj:case ij:case oj:{if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let c=0;c<e.length;c++)if(!Ba(e[c],t[c],c,e,t,n,r))return!1;return!0}case KB:return e.byteLength!==t.byteLength?!1:Xa(new Uint8Array(e),new Uint8Array(t),n,r);case YB:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:Xa(new Uint8Array(e),new Uint8Array(t),n,r);case GB:return e.name===t.name&&e.message===t.message;case qh:{if(!(Xa(e.constructor,t.constructor,n,r)||cb(e)&&cb(t)))return!1;const c=[...Object.keys(e),...ib(e)],l=[...Object.keys(t),...ib(t)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=e[d];if(!Object.hasOwn(t,d))return!1;const p=t[d];if(!Ba(h,p,d,e,t,n,r))return!1}return!0}default:return!1}}finally{n.delete(e),n.delete(t)}}function lj(e,t){return cj(e,t,aj)}var uj=Object.defineProperty,lb=Object.getOwnPropertySymbols,dj=Object.prototype.hasOwnProperty,hj=Object.prototype.propertyIsEnumerable,Ap=(e,t,n)=>t in e?uj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ub=(e,t)=>{for(var n in t||(t={}))dj.call(t,n)&&Ap(e,n,t[n]);if(lb)for(var n of lb(t))hj.call(t,n)&&Ap(e,n,t[n]);return e},Jt=(e,t,n)=>Ap(e,typeof t!="symbol"?t+"":t,n);class Bi extends NO{constructor(t,n,r,s=Tr,i=void 0){super(t,n,r,s),this.core=t,this.logger=n,this.name=r,Jt(this,"map",new Map),Jt(this,"version",pM),Jt(this,"cached",[]),Jt(this,"initialized",!1),Jt(this,"getKey"),Jt(this,"storagePrefix",Tr),Jt(this,"recentlyDeleted",[]),Jt(this,"recentlyDeletedLimit",200),Jt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Ot(o)?this.map.set(this.getKey(o),o):Z6(o)?this.map.set(o.id,o):J6(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Jt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Jt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Jt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>lj(a[c],o[c]))):this.values)),Jt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=ub(ub({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Jt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Kt(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return dn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const n=this.map.get(t);if(!n){if(this.recentlyDeleted.includes(t)){const{message:s}=K("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}const{message:r}=K("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:n}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}}var fj=Object.defineProperty,pj=(e,t,n)=>t in e?fj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ve=(e,t,n)=>pj(e,typeof t!="symbol"?t+"":t,n);class gj{constructor(t,n){this.core=t,this.logger=n,ve(this,"name",yM),ve(this,"version",bM),ve(this,"events",new Eg),ve(this,"pairings"),ve(this,"initialized",!1),ve(this,"storagePrefix",Tr),ve(this,"ignoredPayloadTypes",[Zr]),ve(this,"registeredMethods",[]),ve(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ve(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),ve(this,"create",async r=>{this.isInitialized();const s=fp(),i=await this.core.crypto.setSymKey(s),o=gt(Y.FIVE_MINUTES),a={protocol:l2},c={topic:i,expiry:o,relay:a,active:!1,methods:r?.methods},l=xy({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(ai.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r?.transportType}),{topic:i,uri:l}}),ve(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[mr.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Ny(r.uri);s.props.properties.topic=i,s.addTrace(mr.pairing_uri_validation_success),s.addTrace(mr.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(mr.existing_pairing),u.active)throw s.setError(Kr.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(mr.pairing_not_expired)}const d=c||gt(Y.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(mr.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(ai.create,h),s.addTrace(mr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(mr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Kr.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(p){throw s.setError(Kr.subscribe_pairing_topic_failure),p}return s.addTrace(mr.subscribe_pairing_topic_success),h}),ve(this,"activate",async({topic:r})=>{this.isInitialized();const s=gt(Y.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),ve(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=ni();this.events.once(Re("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ve(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),ve(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),ve(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ve(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",et("USER_DISCONNECTED")),await this.deletePairing(s))}),ve(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return xy({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ve(this,"sendRequest",async(r,s,i)=>{const o=_s(s,i),a=await this.core.crypto.encode(r,o),c=xa[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),ve(this,"sendResult",async(r,s,i)=>{const o=Ed(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=xa[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ve(this,"sendError",async(r,s,i)=>{const o=Cd(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=xa[c]?xa[c].res:xa.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ve(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,et("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),ve(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>ys(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),ve(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ve(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ve(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(ai.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ve(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{br(s)?this.events.emit(Re("pairing_ping",i),{}):Mn(s)&&this.events.emit(Re("pairing_ping",i),{error:s.error})},500)}),ve(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(ai.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ve(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=et("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),ve(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(et("WC_METHOD_UNSUPPORTED",r))}),ve(this,"isValidPair",(r,s)=>{var i;if(!sn(r)){const{message:a}=K("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(Kr.malformed_pairing_uri),new Error(a)}if(!Y6(r.uri)){const{message:a}=K("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(Kr.malformed_pairing_uri),new Error(a)}const o=Ny(r?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=K("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Kr.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=K("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Kr.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Y.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(Kr.pairing_expired);const{message:a}=K("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ve(this,"isValidPing",async r=>{if(!sn(r)){const{message:i}=K("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ve(this,"isValidDisconnect",async r=>{if(!sn(r)){const{message:i}=K("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ve(this,"isValidPairingTopic",async r=>{if(!dt(r,!1)){const{message:s}=K("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=K("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(ys(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=K("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=t,this.logger=Kt(n,this.name),this.pairings=new Bi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return dn(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(vt.message,async t=>{const{topic:n,message:r,transportType:s}=t;if(this.pairings.keys.includes(n)&&s!==Xe.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);Gg(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):Ad(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Rn.expired,async t=>{const{topic:n}=lC(t.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(ai.expire,{topic:n}))})}}var wj=Object.defineProperty,mj=(e,t,n)=>t in e?wj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xt=(e,t,n)=>mj(e,typeof t!="symbol"?t+"":t,n);class yj extends CO{constructor(t,n){super(t,n),this.core=t,this.logger=n,xt(this,"records",new Map),xt(this,"events",new Hn.EventEmitter),xt(this,"name",vM),xt(this,"version",EM),xt(this,"cached",[]),xt(this,"initialized",!1),xt(this,"storagePrefix",Tr),xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),xt(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:gt(Y.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Gn.created,o)}),xt(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=Mn(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Gn.updated,s))}),xt(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),xt(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Gn.deleted,i)}}),this.persist()}),xt(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),xt(this,"on",(r,s)=>{this.events.on(r,s)}),xt(this,"once",(r,s)=>{this.events.once(r,s)}),xt(this,"off",(r,s)=>{this.events.off(r,s)}),xt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Kt(n,this.name)}get context(){return dn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:_s(n.request.method,n.request.params,n.id),chainId:n.chainId};return t.push(r)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const n=this.records.get(t);if(!n){const{message:r}=K("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Gn.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:n}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Gn.created,t=>{const n=Gn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(Gn.updated,t=>{const n=Gn.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(Gn.deleted,t=>{const n=Gn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.core.heartbeat.on(Mi.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(n=>{Y.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Gn.deleted,n,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}}var bj=Object.defineProperty,vj=(e,t,n)=>t in e?bj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jt=(e,t,n)=>vj(e,typeof t!="symbol"?t+"":t,n);class Ej extends _O{constructor(t,n){super(t,n),this.core=t,this.logger=n,jt(this,"expirations",new Map),jt(this,"events",new Hn.EventEmitter),jt(this,"name",CM),jt(this,"version",AM),jt(this,"cached",[]),jt(this,"initialized",!1),jt(this,"storagePrefix",Tr),jt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),jt(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),jt(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Rn.created,{target:i,expiration:o})}),jt(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),jt(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Rn.deleted,{target:s,expiration:i})}}),jt(this,"on",(r,s)=>{this.events.on(r,s)}),jt(this,"once",(r,s)=>{this.events.once(r,s)}),jt(this,"off",(r,s)=>{this.events.off(r,s)}),jt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Kt(n,this.name)}get context(){return dn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return $4(t);if(typeof t=="number")return k4(t);const{message:n}=K("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(n)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Rn.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:n}=K("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const n=this.expirations.get(t);if(!n){const{message:r}=K("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(t,n){const{expiry:r}=n;Y.toMiliseconds(r)-Date.now()<=0&&this.expire(t,n)}expire(t,n){this.expirations.delete(t),this.events.emit(Rn.expired,{target:t,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,n)=>this.checkExpiry(n,t))}registerEventListeners(){this.core.heartbeat.on(Mi.pulse,()=>this.checkExpirations()),this.events.on(Rn.created,t=>{const n=Rn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(Rn.expired,t=>{const n=Rn.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(Rn.deleted,t=>{const n=Rn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Cj=Object.defineProperty,Aj=(e,t,n)=>t in e?Cj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ut=(e,t,n)=>Aj(e,typeof t!="symbol"?t+"":t,n);class Ij extends TO{constructor(t,n,r){super(t,n,r),this.core=t,this.logger=n,this.store=r,ut(this,"name",IM),ut(this,"abortController"),ut(this,"isDevEnv"),ut(this,"verifyUrlV3",NM),ut(this,"storagePrefix",Tr),ut(this,"version",c2),ut(this,"publicKey"),ut(this,"fetchPromise"),ut(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Y.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ut(this,"register",async s=>{if(!sa()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=ts.getDocument(),u=this.startAbortTimer(Y.ONE_SECOND*5),d=await new Promise((h,p)=>{const f=()=>{window.removeEventListener("message",w),l.body.removeChild(g),p("attestation aborted")};this.abortController.signal.addEventListener("abort",f);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",f,{signal:this.abortController.signal});const w=b=>{if(b.data&&typeof b.data=="string")try{const I=JSON.parse(b.data);if(I.type==="verify_attestation"){if(Gf(I.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",f),window.removeEventListener("message",w),h(I.attestation===null?"":I.attestation)}}catch(I){this.logger.warn(I)}};l.body.appendChild(g),window.addEventListener("message",w,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),ut(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Gf(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),ut(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Y.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ut(this,"getVerifyUrl",s=>{let i=s||Ja;return xM.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Ja}`),i=Ja),i}),ut(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Y.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),ut(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),ut(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ut(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ut(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ut(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),ut(this,"validateAttestation",(s,i)=>{const o=_6(s,i.publicKey),a={hasExpired:Y.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Kt(n,this.name),this.abortController=new AbortController,this.isDevEnv=$g(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return dn(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Y.toMiliseconds(t))}}var Sj=Object.defineProperty,Nj=(e,t,n)=>t in e?Sj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,db=(e,t,n)=>Nj(e,typeof t!="symbol"?t+"":t,n);class xj extends OO{constructor(t,n){super(t,n),this.projectId=t,this.logger=n,db(this,"context",_M),db(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${TM}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Kt(n,this.context)}}var _j=Object.defineProperty,hb=Object.getOwnPropertySymbols,Tj=Object.prototype.hasOwnProperty,Oj=Object.prototype.propertyIsEnumerable,Ip=(e,t,n)=>t in e?_j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Oa=(e,t)=>{for(var n in t||(t={}))Tj.call(t,n)&&Ip(e,n,t[n]);if(hb)for(var n of hb(t))Oj.call(t,n)&&Ip(e,n,t[n]);return e},mt=(e,t,n)=>Ip(e,typeof t!="symbol"?t+"":t,n);class Dj extends DO{constructor(t,n,r=!0){super(t,n,r),this.core=t,this.logger=n,mt(this,"context",DM),mt(this,"storagePrefix",Tr),mt(this,"storageVersion",OM),mt(this,"events",new Map),mt(this,"shouldPersist",!1),mt(this,"init",async()=>{if(!$g())try{const s={eventId:Gm(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:aC(this.core.relayer.protocol,this.core.relayer.version,wp)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),mt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=Gm(),u=this.core.projectId||"",d=Date.now(),h=Oa({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),mt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Oa(Oa({},a),this.setMethods(a.eventId))}),mt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),mt(this,"setEventListeners",()=>{this.core.heartbeat.on(Mi.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Y.fromMiliseconds(Date.now())-Y.fromMiliseconds(s.timestamp)>PM&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),mt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),mt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),mt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),mt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),mt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,Oa(Oa({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),mt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),mt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${$M}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${wp}${i}`,{method:"POST",body:JSON.stringify(s)})}),mt(this,"getAppDomain",()=>oC().url),this.logger=Kt(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Pj=Object.defineProperty,fb=Object.getOwnPropertySymbols,$j=Object.prototype.hasOwnProperty,kj=Object.prototype.propertyIsEnumerable,Sp=(e,t,n)=>t in e?Pj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,pb=(e,t)=>{for(var n in t||(t={}))$j.call(t,n)&&Sp(e,n,t[n]);if(fb)for(var n of fb(t))kj.call(t,n)&&Sp(e,n,t[n]);return e},Ke=(e,t,n)=>Sp(e,typeof t!="symbol"?t+"":t,n);let Uj=class A2 extends yO{constructor(t){var n;super(t),Ke(this,"protocol",a2),Ke(this,"version",c2),Ke(this,"name",gp),Ke(this,"relayUrl"),Ke(this,"projectId"),Ke(this,"customStoragePrefix"),Ke(this,"events",new Hn.EventEmitter),Ke(this,"logger"),Ke(this,"heartbeat"),Ke(this,"relayer"),Ke(this,"crypto"),Ke(this,"storage"),Ke(this,"history"),Ke(this,"expirer"),Ke(this,"pairing"),Ke(this,"verify"),Ke(this,"echoClient"),Ke(this,"linkModeSupportedApps"),Ke(this,"eventClient"),Ke(this,"initialized",!1),Ke(this,"logChunkController"),Ke(this,"on",(a,c)=>this.events.on(a,c)),Ke(this,"once",(a,c)=>this.events.once(a,c)),Ke(this,"off",(a,c)=>this.events.off(a,c)),Ke(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ke(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Xe.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(t?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||u2,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const s=tl({level:typeof t?.logger=="string"&&t.logger?t.logger:tM.logger,name:gp}),{logger:i,chunkLoggerController:o}=nE({opts:s,maxSizeInBytes:t?.maxLogBlobSizeInBytes,loggerOverride:t?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Kt(i,this.name),this.heartbeat=new mT,this.crypto=new cB(this,this.logger,t?.keychain),this.history=new yj(this,this.logger),this.expirer=new Ej(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new QT(pb(pb({},nM),t?.storageOptions)),this.relayer=new UB({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new gj(this,this.logger),this.verify=new Ij(this,this.logger,this.storage),this.echoClient=new xj(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Dj(this,this.logger,t?.telemetryEnabled),this.setGlobalCore(this)}static async init(t){const n=new A2(t);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(gM,r),n}get context(){return dn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(Ky,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Ky)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}getGlobalCore(t=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${t}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(t){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=t.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=t}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&eM.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Rj=Uj,I2="wc",S2=2,N2="client",Yg=`${I2}@${S2}:${N2}:`,Wh={name:N2,logger:"error"},gb="WALLETCONNECT_DEEPLINK_CHOICE",Mj="proposal",wb="Proposal expired",Lj="session",no=Y.SEVEN_DAYS,Bj="engine",yt={wc_sessionPropose:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Y.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Y.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1119}}},Vh={min:Y.FIVE_MINUTES,max:Y.SEVEN_DAYS},gr={idle:"IDLE",active:"ACTIVE"},jj={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Fj="request",zj=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Hj="wc",qj="auth",Wj="authKeys",Vj="pairingTopics",Kj="requests",Sd=`${Hj}@${1.5}:${qj}:`,mu=`${Sd}:PUB_KEY`;var Gj=Object.defineProperty,Yj=Object.defineProperties,Zj=Object.getOwnPropertyDescriptors,mb=Object.getOwnPropertySymbols,Jj=Object.prototype.hasOwnProperty,Xj=Object.prototype.propertyIsEnumerable,Np=(e,t,n)=>t in e?Gj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Je=(e,t)=>{for(var n in t||(t={}))Jj.call(t,n)&&Np(e,n,t[n]);if(mb)for(var n of mb(t))Xj.call(t,n)&&Np(e,n,t[n]);return e},Xt=(e,t)=>Yj(e,Zj(t)),q=(e,t,n)=>Np(e,typeof t!="symbol"?t+"":t,n);class Qj extends UO{constructor(t){super(t),q(this,"name",Bj),q(this,"events",new Eg),q(this,"initialized",!1),q(this,"requestQueue",{state:gr.idle,queue:[]}),q(this,"sessionRequestQueue",{state:gr.idle,queue:[]}),q(this,"emittedSessionRequests",new H4({limit:500})),q(this,"requestQueueDelay",Y.ONE_SECOND),q(this,"expectedPairingMethodMap",new Map),q(this,"recentlyDeletedMap",new Map),q(this,"recentlyDeletedLimit",200),q(this,"relayMessageCache",[]),q(this,"pendingSessions",new Map),q(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(yt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Y.toMiliseconds(this.requestQueueDelay)))}),q(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=Xt(Je({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=q6(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r;let u=s,d,h=!1;try{if(u){const C=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=C.active}}catch(C){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),C}if(!u||!h){const{topic:C,uri:O}=await this.client.core.pairing.create();u=C,d=O}if(!u){const{message:C}=K("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(C)}const p=await this.client.core.crypto.generateKeyPair(),f=yt.wc_sessionPropose.req.ttl||Y.FIVE_MINUTES,g=gt(f),w=Xt(Je(Je({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:l2}],proposer:{publicKey:p,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:yr()}),b=Re("session_connect",w.id),{reject:I,resolve:y,done:m}=ni(f,wb),v=({id:C})=>{C===w.id&&(this.client.events.off("proposal_expire",v),this.pendingSessions.delete(w.id),this.events.emit(b,{error:{message:wb,code:0}}))};return this.client.events.on("proposal_expire",v),this.events.once(b,({error:C,session:O})=>{this.client.events.off("proposal_expire",v),C?I(C):O&&y(O)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:w,throwOnFailedPublish:!0,clientRpcId:w.id}),await this.setProposal(w.id,w),{uri:d,approval:m}}),q(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),q(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n?.id)==null?void 0:r.toString(),trace:[Yn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(S){throw o.setError(Js.no_internet_connection),S}try{await this.isValidProposalId(n?.id)}catch(S){throw this.client.logger.error(`approve() -> proposal.get(${n?.id}) failed`),o.setError(Js.proposal_not_found),S}try{await this.isValidApprove(n)}catch(S){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Js.session_approve_namespace_validation_failure),S}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:f,proposer:g,requiredNamespaces:w,optionalNamespaces:b}=p;let I=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:f});I||(I=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Yn.session_approve_started,properties:{topic:f,trace:[Yn.session_approve_started,Yn.session_namespaces_validation_success]}}));const y=await this.client.core.crypto.generateKeyPair(),m=g.publicKey,v=await this.client.core.crypto.generateSharedKey(y,m),C=Je(Je(Je({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:y,metadata:this.client.metadata},expiry:gt(no)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),O=Xe.relay;I.addTrace(Yn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(v,{transportType:O})}catch(S){throw I.setError(Js.subscribe_session_topic_failure),S}I.addTrace(Yn.subscribe_session_topic_success);const D=Xt(Je({},C),{topic:v,requiredNamespaces:w,optionalNamespaces:b,pairingTopic:f,acknowledged:!1,self:C.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:y,transportType:Xe.relay});await this.client.session.set(v,D),I.addTrace(Yn.store_session);try{I.addTrace(Yn.publishing_session_settle),await this.sendRequest({topic:v,method:"wc_sessionSettle",params:C,throwOnFailedPublish:!0}).catch(S=>{throw I?.setError(Js.session_settle_publish_failure),S}),I.addTrace(Yn.session_settle_publish_success),I.addTrace(Yn.publishing_session_approve),await this.sendResult({id:a,topic:f,result:{relay:{protocol:c??"irn"},responderPublicKey:y},throwOnFailedPublish:!0}).catch(S=>{throw I?.setError(Js.session_approve_publish_failure),S}),I.addTrace(Yn.session_approve_publish_success)}catch(S){throw this.client.logger.error(S),this.client.session.delete(v,et("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(v),S}return this.client.core.eventClient.deleteEvent({eventId:I.eventId}),await this.client.core.pairing.updateMetadata({topic:f,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:f}),await this.setExpiry(v,gt(no)),{topic:v,acknowledged:()=>Promise.resolve(this.client.session.get(v))}}),q(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:yt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),q(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=ni(),c=yr(),l=wi().toString(),u=this.client.session.get(r).namespaces;return this.events.once(Re("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),q(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=yr(),{done:i,resolve:o,reject:a}=ni();return this.events.once(Re("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,gt(no)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),q(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:r,request:s,topic:i,expiry:o=yt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);a?.transportType===Xe.relay&&await this.confirmOnlineStateOrThrow();const c=yr(),l=wi().toString(),{done:u,resolve:d,reject:h}=ni(o,"Request expired. Please try again.");this.events.once(Re("session_request",c),({error:w,result:b})=>{w?h(w):d(b)});const p="wc_sessionRequest",f=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(f)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:{request:Xt(Je({},s),{expiryTimestamp:gt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:f}).catch(w=>h(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const g={request:Xt(Je({},s),{expiryTimestamp:gt(o)}),chainId:r};return await Promise.all([new Promise(async w=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(b=>h(b)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),w()}),new Promise(async w=>{var b;if(!((b=a.sessionConfig)!=null&&b.disableDeepLink)){const I=await L4(this.client.core.storage,gb);await U4({id:c,topic:i,wcDeepLink:I})}w()}),u()]).then(w=>w[2])}),q(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===Xe.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);br(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):Mn(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(n)}),q(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=yr(),i=wi().toString(),{done:o,resolve:a,reject:c}=ni();this.events.once(Re("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),q(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=wi().toString(),a=yr();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),q(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:et("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=K("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),q(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>K6(r,n)))),q(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),q(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Xe.link_mode:Xe.relay;o===Xe.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:p,nbf:f,methods:g=[],expiry:w}=n,b=[...n.resources||[]],{topic:I,uri:y}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:I,uri:y}});const m=await this.client.core.crypto.generateKeyPair(),v=gu(m);if(await Promise.all([this.client.auth.authKeys.set(mu,{responseTopic:v,publicKey:m}),this.client.auth.pairingTopics.set(v,{topic:v,pairingTopic:I})]),await this.client.core.relayer.subscribe(v,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${I}`),g.length>0){const{namespace:U}=Po(a[0]);let $=eU(U,"request",g);pu(b)&&($=nU($,b.pop())),b.push($)}const C=w&&w>yt.wc_sessionAuthenticate.req.ttl?w:yt.wc_sessionAuthenticate.req.ttl,O={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:p,nbf:f,resources:b},requester:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:gt(C)},D={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},S={requiredNamespaces:{},optionalNamespaces:D,relays:[{protocol:"irn"}],pairingTopic:I,proposer:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:gt(yt.wc_sessionPropose.req.ttl),id:yr()},{done:E,resolve:x,reject:P}=ni(C,"Request expired"),M=yr(),R=Re("session_connect",S.id),A=Re("session_request",M),_=async({error:U,session:$})=>{this.events.off(A,k),U?P(U):$&&x({session:$})},k=async U=>{var $,F,G;if(await this.deletePendingAuthRequest(M,{message:"fulfilled",code:0}),U.error){const be=et("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return U.error.code===be.code?void 0:(this.events.off(R,_),P(U.error.message))}await this.deleteProposal(S.id),this.events.off(R,_);const{cacaos:Z,responder:V}=U.result,ne=[],ue=[];for(const be of Z){await iy({cacao:be,projectId:this.client.core.projectId})||(this.client.logger.error(be,"Signature verification failed"),P(et("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:nt}=be,lt=pu(nt.resources),$r=[sp(nt.iss)],qi=zu(nt.iss);if(lt){const kr=oy(lt),Wi=ay(lt);ne.push(...kr),$r.push(...Wi)}for(const kr of $r)ue.push(`${kr}:${qi}`)}const _e=await this.client.core.crypto.generateSharedKey(m,V.publicKey);let Ie;ne.length>0&&(Ie={topic:_e,acknowledged:!0,self:{publicKey:m,metadata:this.client.metadata},peer:V,controller:V.publicKey,expiry:gt(no),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:I,namespaces:Dy([...new Set(ne)],[...new Set(ue)]),transportType:o},await this.client.core.relayer.subscribe(_e,{transportType:o}),await this.client.session.set(_e,Ie),I&&await this.client.core.pairing.updateMetadata({topic:I,metadata:V.metadata}),Ie=this.client.session.get(_e)),($=this.client.metadata.redirect)!=null&&$.linkMode&&(F=V.metadata.redirect)!=null&&F.linkMode&&(G=V.metadata.redirect)!=null&&G.universal&&r&&(this.client.core.addLinkModeSupportedApp(V.metadata.redirect.universal),this.client.session.update(_e,{transportType:Xe.link_mode})),x({auths:Z,session:Ie})};this.events.once(R,_),this.events.once(A,k);let L;try{if(i){const U=_s("wc_sessionAuthenticate",O,M);this.client.core.history.set(I,U);const $=await this.client.core.crypto.encode("",U,{type:al,encoding:As});L=Vl(r,I,$)}else await Promise.all([this.sendRequest({topic:I,method:"wc_sessionAuthenticate",params:O,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:M}),this.sendRequest({topic:I,method:"wc_sessionPropose",params:S,expiry:yt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(U){throw this.events.off(R,_),this.events.off(A,k),U}return await this.setProposal(S.id,S),await this.setAuthRequest(M,{request:Xt(Je({},O),{verifyContext:{}}),pairingTopic:I,transportType:o}),{uri:L??y,response:E}}),q(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Xs.authenticated_session_approve_started]}});try{this.isInitialized()}catch(w){throw i.setError(_a.no_internet_connection),w}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(_a.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Xe.relay;a===Xe.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=gu(c),d={type:Zr,receiverPublicKey:c,senderPublicKey:l},h=[],p=[];for(const w of s){if(!await iy({cacao:w,projectId:this.client.core.projectId})){i.setError(_a.invalid_cacao);const v=et("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:v,encodeOpts:d}),new Error(v.message)}i.addTrace(Xs.cacaos_verified);const{p:b}=w,I=pu(b.resources),y=[sp(b.iss)],m=zu(b.iss);if(I){const v=oy(I),C=ay(I);h.push(...v),y.push(...C)}for(const v of y)p.push(`${v}:${m}`)}const f=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Xs.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:f,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:gt(no),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Dy([...new Set(h)],[...new Set(p)]),transportType:a},i.addTrace(Xs.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(f,{transportType:a})}catch(w){throw i.setError(_a.subscribe_authenticated_session_topic_failure),w}i.addTrace(Xs.subscribe_authenticated_session_topic_success),await this.client.session.set(f,g),i.addTrace(Xs.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Xs.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(w){throw i.setError(_a.authenticated_session_approve_publish_failure),w}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),q(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Xe.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=gu(o),l={type:Zr,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:yt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),q(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return IC(r,s)}),q(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),q(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),q(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,et("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(gb).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,et("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=gr.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),q(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(Js.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,et("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),q(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=gr.idle,this.client.events.emit("session_request_expire",{id:n}))}),q(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),q(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),q(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,gt(yt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),q(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=Xe.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),q(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||gt(yt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),q(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d}=n,h=_s(s,i,c);let p;const f=!!u;try{const b=f?As:ir;p=await this.client.core.crypto.encode(r,h,{encoding:b})}catch(b){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),b}let g;if(zj.includes(s)){const b=vr(JSON.stringify(h)),I=vr(p);g=await this.client.core.verify.register({id:I,decryptedId:b})}const w=yt[s].req;if(w.attestation=g,o&&(w.ttl=o),a&&(w.id=a),this.client.core.history.set(r,h),f){const b=Vl(u,r,p);await global.Linking.openURL(b,this.client.name)}else{const b=yt[s].req;o&&(b.ttl=o),a&&(b.id=a),b.tvf=Xt(Je({},d),{correlationId:h.id}),l?(b.internal=Xt(Je({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,b)):this.client.core.relayer.publish(r,p,b).catch(I=>this.client.logger.error(I))}return h.id}),q(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=Ed(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?As:ir;u=await this.client.core.crypto.encode(s,l,Xt(Je({},a||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),f}let h,p;try{h=await this.client.core.history.get(s,r);const f=h.request;try{p=this.getTVFParams(r,f.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(f){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),f}if(d){const f=Vl(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,g=yt[f].res;g.tvf=Xt(Je({},p),{correlationId:r}),o?(g.internal=Xt(Je({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(w=>this.client.logger.error(w))}await this.client.core.history.resolve(l)}),q(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=Cd(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?As:ir;u=await this.client.core.crypto.encode(s,l,Xt(Je({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),p}let h;try{h=await this.client.core.history.get(s,r)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),p}if(d){const p=Vl(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,f=a||yt[p].res;this.client.core.relayer.publish(s,u,f)}await this.client.core.history.resolve(l)}),q(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;ys(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ys(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),q(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),q(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),q(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===gr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=gr.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=gr.idle}),q(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),q(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),q(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=K("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),q(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),q(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(Kr.proposal_listener_not_found)),this.isValidConnect(Je({},s.params));const u=a.expiryTimestamp||gt(yt.wc_sessionPropose.req.ttl),d=Je({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:vr(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(mr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:yt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),q(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(br(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(Mn(r)){await this.deleteProposal(i);const o=Re("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),q(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r.params,p=[...this.pendingSessions.values()].find(w=>w.sessionTopic===n);if(!p)return this.client.logger.error(`Pending session not found for topic ${n}`);const f=this.client.proposal.get(p.proposalId),g=Xt(Je(Je(Je({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:f.requiredNamespaces,optionalNamespaces:f.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Xe.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Re("session_connect",p.proposalId),{session:g}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;br(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(Re("session_approve",s),{})):Mn(r)&&(await this.client.session.delete(n,et("USER_DISCONNECTED")),this.events.emit(Re("session_approve",s),{error:r.error}))}),q(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=Na.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:et("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Je({topic:n},s));try{Na.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw Na.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),q(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=Re("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);br(r)?this.events.emit(Re("session_update",s),{}):Mn(r)&&this.events.emit(Re("session_update",s),{error:r.error})}),q(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,gt(no)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=Re("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);br(r)?this.events.emit(Re("session_extend",s),{}):Mn(r)&&this.events.emit(Re("session_extend",s),{error:r.error})}),q(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=Re("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);br(r)?this.events.emit(Re("session_ping",s),{}):Mn(r)&&this.events.emit(Re("session_ping",s),{error:r.error})},500)}),q(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(vt.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:et("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),q(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:h}=a;try{await this.isValidRequest(Je({topic:o},h));const p=this.client.session.get(o),f=await this.getVerifyContext({attestationId:c,hash:vr(JSON.stringify(_s("wc_sessionRequest",h,d))),encryptedId:l,metadata:p.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:f};await this.setPendingSessionRequest(g),u===Xe.link_mode&&(r=p.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=p.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(p){await this.sendError({id:d,topic:o,error:p}),this.client.logger.error(p)}}),q(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=Re("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);br(r)?this.events.emit(Re("session_request",s),{result:r.result}):Mn(r)&&this.events.emit(Re("session_request",s),{error:r.error})}),q(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=Na.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Je({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),Na.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),br(r)?this.events.emit(Re("session_request",s),{result:r.result}):Mn(r)&&this.events.emit(Re("session_request",s),{error:r.error})}),q(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:vr(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),p={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:p,pairingTopic:s,transportType:c}),c===Xe.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),p={type:Zr,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:p,rpcOpts:yt.wc_sessionAuthenticate.autoReject,appLink:h})}}),q(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),q(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=gr.idle,this.processSessionRequestQueue()},Y.toMiliseconds(this.requestQueueDelay))}),q(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=Re("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Re("session_request",i.request.id),{error:r})})}),q(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===gr.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),q(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=gr.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),q(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:_s("wc_sessionPropose",Xt(Je({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),q(this,"isValidConnect",async n=>{if(!sn(n)){const{message:l}=K("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(Ot(r)||await this.isValidPairingTopic(r),!iR(c)){const{message:l}=K("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!Ot(s)&&xr(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!Ot(i)&&xr(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),Ot(o)||this.validateSessionProps(o,"sessionProperties"),!Ot(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),q(this,"validateNamespaces",(n,r)=>{const s=sR(n,"connect()",r);if(s)throw new Error(s.message)}),q(this,"isValidApprove",async n=>{if(!sn(n))throw new Error(K("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=Lh(s,"approve()");if(l)throw new Error(l.message);const u=ky(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!dt(i,!0)){const{message:d}=K("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(Ot(o)||this.validateSessionProps(o,"sessionProperties"),!Ot(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),q(this,"isValidReject",async n=>{if(!sn(n)){const{message:i}=K("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!aR(s)){const{message:i}=K("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),q(this,"isValidSessionSettleRequest",n=>{if(!sn(n)){const{message:l}=K("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!t2(r)){const{message:l}=K("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=X6(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Lh(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ys(o)){const{message:l}=K("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),q(this,"isValidUpdate",async n=>{if(!sn(n)){const{message:c}=K("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Lh(s,"update()");if(o)throw new Error(o.message);const a=ky(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),q(this,"isValidExtend",async n=>{if(!sn(n)){const{message:s}=K("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),q(this,"isValidRequest",async n=>{if(!sn(n)){const{message:c}=K("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!$y(a,i)){const{message:c}=K("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!cR(s)){const{message:c}=K("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!dR(a,i,s.method)){const{message:c}=K("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!gR(o,Vh)){const{message:c}=K("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Vh.min} and ${Vh.max}`);throw new Error(c)}}),q(this,"isValidRespond",async n=>{var r;if(!sn(n)){const{message:o}=K("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n?.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!lR(i)){const{message:o}=K("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),q(this,"isValidPing",async n=>{if(!sn(n)){const{message:s}=K("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidEmit",async n=>{if(!sn(n)){const{message:a}=K("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!$y(o,i)){const{message:a}=K("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!uR(s)){const{message:a}=K("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!hR(o,i,s.name)){const{message:a}=K("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),q(this,"isValidDisconnect",async n=>{if(!sn(n)){const{message:s}=K("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!dt(s,!1))throw new Error("uri is required parameter");if(!dt(i,!1))throw new Error("domain is required parameter");if(!dt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>Po(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Po(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),q(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||Ja,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Xe.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),q(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=K("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),q(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),q(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),q(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=K("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),q(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,h;return!n||r!==Xe.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n?.redirect)==null?void 0:u.universal)!==void 0&&((d=n?.redirect)==null?void 0:d.universal)!==""&&((h=n?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),q(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n?.redirect)==null?void 0:s.universal:void 0}),q(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=Km(n,"topic")||"",s=decodeURIComponent(Km(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Xe.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),q(this,"registerLinkModeListeners",async()=>{var n;if($g()||Bs()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),q(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),q(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=n?.data||((r=n?.[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),q(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=jj[i];if(i==="sui_signTransaction")return[L5(r.transactionBytes)];if(i==="near_signTransaction")return[ty(r)];if(i==="near_signTransactions")return r.map(c=>ty(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[OR({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return Jr(r)?r.map(c=>ny(c)):[ny(r)];if(i==="cosmos_signDirect")return[j5(r)];if(typeof r=="string")return[r];const a=r[o.key];if(Jr(a))return i==="solana_signAllTransactions"?a.map(c=>M5(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const t=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(t);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(t){this.client.logger.warn("processPendingMessageEvents failed",t)}}isInitialized(){if(!this.initialized){const{message:t}=K("NOT_INITIALIZED",this.name);throw new Error(t)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(vt.message,t=>{this.onProviderMessageEvent(t)})}async onRelayMessage(t){const{topic:n,message:r,attestation:s,transportType:i}=t,{publicKey:o}=this.client.auth.authKeys.keys.includes(mu)?this.client.auth.authKeys.get(mu):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===Xe.link_mode?As:ir});Gg(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:vr(r)})):Ad(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Rn.expired,async t=>{const{topic:n,id:r}=lC(t.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,K("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,K("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(ai.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(ai.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!dt(t,!1)){const{message:n}=K("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:n}=K("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(n)}if(ys(this.client.core.pairing.pairings.get(t).expiry)){const{message:n}=K("EXPIRED",`pairing topic: ${t}`);throw new Error(n)}}async isValidSessionTopic(t){if(!dt(t,!1)){const{message:n}=K("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(n)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){const{message:n}=K("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(n)}if(ys(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:n}=K("EXPIRED",`session topic: ${t}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(t)){const{message:n}=K("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(n)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(dt(t,!1)){const{message:n}=K("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(n)}else{const{message:n}=K("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(n)}}async isValidProposalId(t){if(!oR(t)){const{message:n}=K("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(n)}if(!this.client.proposal.keys.includes(t)){const{message:n}=K("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(n)}if(ys(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:n}=K("EXPIRED",`proposal id: ${t}`);throw new Error(n)}}}class e9 extends Bi{constructor(t,n){super(t,n,Mj,Yg),this.core=t,this.logger=n}}let t9=class extends Bi{constructor(t,n){super(t,n,Lj,Yg),this.core=t,this.logger=n}};class n9 extends Bi{constructor(t,n){super(t,n,Fj,Yg,r=>r.id),this.core=t,this.logger=n}}class r9 extends Bi{constructor(t,n){super(t,n,Wj,Sd,()=>mu),this.core=t,this.logger=n}}let s9=class extends Bi{constructor(t,n){super(t,n,Vj,Sd),this.core=t,this.logger=n}};class i9 extends Bi{constructor(t,n){super(t,n,Kj,Sd,r=>r.id),this.core=t,this.logger=n}}var o9=Object.defineProperty,a9=(e,t,n)=>t in e?o9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Kh=(e,t,n)=>a9(e,typeof t!="symbol"?t+"":t,n);class c9{constructor(t,n){this.core=t,this.logger=n,Kh(this,"authKeys"),Kh(this,"pairingTopics"),Kh(this,"requests"),this.authKeys=new r9(this.core,this.logger),this.pairingTopics=new s9(this.core,this.logger),this.requests=new i9(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var l9=Object.defineProperty,u9=(e,t,n)=>t in e?l9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ee=(e,t,n)=>u9(e,typeof t!="symbol"?t+"":t,n);let d9=class x2 extends kO{constructor(t){super(t),Ee(this,"protocol",I2),Ee(this,"version",S2),Ee(this,"name",Wh.name),Ee(this,"metadata"),Ee(this,"core"),Ee(this,"logger"),Ee(this,"events",new Hn.EventEmitter),Ee(this,"engine"),Ee(this,"session"),Ee(this,"proposal"),Ee(this,"pendingRequest"),Ee(this,"auth"),Ee(this,"signConfig"),Ee(this,"on",(r,s)=>this.events.on(r,s)),Ee(this,"once",(r,s)=>this.events.once(r,s)),Ee(this,"off",(r,s)=>this.events.off(r,s)),Ee(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Ee(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Ee(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Ee(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Ee(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=t?.name||Wh.name,this.metadata=T4(t?.metadata),this.signConfig=t?.signConfig;const n=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Qc(tl({level:t?.logger||Wh.logger}));this.core=t?.core||new Rj(t),this.logger=Kt(n,this.name),this.session=new t9(this.core,this.logger),this.proposal=new e9(this.core,this.logger),this.pendingRequest=new n9(this.core,this.logger),this.engine=new Qj(this),this.auth=new c9(this.core,this.logger)}static async init(t){const n=new x2(t);return await n.initialize(),n}get context(){return dn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var Gl={exports:{}},yb;function h9(){return yb||(yb=1,(function(e,t){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof zt<"u"&&zt,r=(function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i})();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof zt<"u"&&zt||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(A){return A&&DataView.prototype.isPrototypeOf(A)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(A){return A&&u.indexOf(Object.prototype.toString.call(A))>-1};function h(A){if(typeof A!="string"&&(A=String(A)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(A)||A==="")throw new TypeError('Invalid character in header field name: "'+A+'"');return A.toLowerCase()}function p(A){return typeof A!="string"&&(A=String(A)),A}function f(A){var _={next:function(){var k=A.shift();return{done:k===void 0,value:k}}};return c.iterable&&(_[Symbol.iterator]=function(){return _}),_}function g(A){this.map={},A instanceof g?A.forEach(function(_,k){this.append(k,_)},this):Array.isArray(A)?A.forEach(function(_){if(_.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+_.length);this.append(_[0],_[1])},this):A&&Object.getOwnPropertyNames(A).forEach(function(_){this.append(_,A[_])},this)}g.prototype.append=function(A,_){A=h(A),_=p(_);var k=this.map[A];this.map[A]=k?k+", "+_:_},g.prototype.delete=function(A){delete this.map[h(A)]},g.prototype.get=function(A){return A=h(A),this.has(A)?this.map[A]:null},g.prototype.has=function(A){return this.map.hasOwnProperty(h(A))},g.prototype.set=function(A,_){this.map[h(A)]=p(_)},g.prototype.forEach=function(A,_){for(var k in this.map)this.map.hasOwnProperty(k)&&A.call(_,this.map[k],k,this)},g.prototype.keys=function(){var A=[];return this.forEach(function(_,k){A.push(k)}),f(A)},g.prototype.values=function(){var A=[];return this.forEach(function(_){A.push(_)}),f(A)},g.prototype.entries=function(){var A=[];return this.forEach(function(_,k){A.push([k,_])}),f(A)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function w(A){if(!A._noBody){if(A.bodyUsed)return Promise.reject(new TypeError("Already read"));A.bodyUsed=!0}}function b(A){return new Promise(function(_,k){A.onload=function(){_(A.result)},A.onerror=function(){k(A.error)}})}function I(A){var _=new FileReader,k=b(_);return _.readAsArrayBuffer(A),k}function y(A){var _=new FileReader,k=b(_),L=/charset=([A-Za-z0-9_-]+)/.exec(A.type),U=L?L[1]:"utf-8";return _.readAsText(A,U),k}function m(A){for(var _=new Uint8Array(A),k=new Array(_.length),L=0;L<_.length;L++)k[L]=String.fromCharCode(_[L]);return k.join("")}function v(A){if(A.slice)return A.slice(0);var _=new Uint8Array(A.byteLength);return _.set(new Uint8Array(A)),_.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(A){this.bodyUsed=this.bodyUsed,this._bodyInit=A,A?typeof A=="string"?this._bodyText=A:c.blob&&Blob.prototype.isPrototypeOf(A)?this._bodyBlob=A:c.formData&&FormData.prototype.isPrototypeOf(A)?this._bodyFormData=A:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)?this._bodyText=A.toString():c.arrayBuffer&&c.blob&&l(A)?(this._bodyArrayBuffer=v(A.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(A)||d(A))?this._bodyArrayBuffer=v(A):this._bodyText=A=Object.prototype.toString.call(A):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof A=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var A=w(this);if(A)return A;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var A=w(this);return A||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(I);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var A=w(this);if(A)return A;if(this._bodyBlob)return y(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(m(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}var O=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function D(A){var _=A.toUpperCase();return O.indexOf(_)>-1?_:A}function S(A,_){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');_=_||{};var k=_.body;if(A instanceof S){if(A.bodyUsed)throw new TypeError("Already read");this.url=A.url,this.credentials=A.credentials,_.headers||(this.headers=new g(A.headers)),this.method=A.method,this.mode=A.mode,this.signal=A.signal,!k&&A._bodyInit!=null&&(k=A._bodyInit,A.bodyUsed=!0)}else this.url=String(A);if(this.credentials=_.credentials||this.credentials||"same-origin",(_.headers||!this.headers)&&(this.headers=new g(_.headers)),this.method=D(_.method||this.method||"GET"),this.mode=_.mode||this.mode||null,this.signal=_.signal||this.signal||(function(){if("AbortController"in a){var $=new AbortController;return $.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&k)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(k),(this.method==="GET"||this.method==="HEAD")&&(_.cache==="no-store"||_.cache==="no-cache")){var L=/([?&])_=[^&]*/;if(L.test(this.url))this.url=this.url.replace(L,"$1_="+new Date().getTime());else{var U=/\?/;this.url+=(U.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function E(A){var _=new FormData;return A.trim().split("&").forEach(function(k){if(k){var L=k.split("="),U=L.shift().replace(/\+/g," "),$=L.join("=").replace(/\+/g," ");_.append(decodeURIComponent(U),decodeURIComponent($))}}),_}function x(A){var _=new g,k=A.replace(/\r?\n[\t ]+/g," ");return k.split("\r").map(function(L){return L.indexOf(`
`)===0?L.substr(1,L.length):L}).forEach(function(L){var U=L.split(":"),$=U.shift().trim();if($){var F=U.join(":").trim();try{_.append($,F)}catch(G){console.warn("Response "+G.message)}}}),_}C.call(S.prototype);function P(A,_){if(!(this instanceof P))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(_||(_={}),this.type="default",this.status=_.status===void 0?200:_.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=_.statusText===void 0?"":""+_.statusText,this.headers=new g(_.headers),this.url=_.url||"",this._initBody(A)}C.call(P.prototype),P.prototype.clone=function(){return new P(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},P.error=function(){var A=new P(null,{status:200,statusText:""});return A.ok=!1,A.status=0,A.type="error",A};var M=[301,302,303,307,308];P.redirect=function(A,_){if(M.indexOf(_)===-1)throw new RangeError("Invalid status code");return new P(null,{status:_,headers:{location:A}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(_,k){this.message=_,this.name=k;var L=Error(_);this.stack=L.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function R(A,_){return new Promise(function(k,L){var U=new S(A,_);if(U.signal&&U.signal.aborted)return L(new o.DOMException("Aborted","AbortError"));var $=new XMLHttpRequest;function F(){$.abort()}$.onload=function(){var V={statusText:$.statusText,headers:x($.getAllResponseHeaders()||"")};U.url.indexOf("file://")===0&&($.status<200||$.status>599)?V.status=200:V.status=$.status,V.url="responseURL"in $?$.responseURL:V.headers.get("X-Request-URL");var ne="response"in $?$.response:$.responseText;setTimeout(function(){k(new P(ne,V))},0)},$.onerror=function(){setTimeout(function(){L(new TypeError("Network request failed"))},0)},$.ontimeout=function(){setTimeout(function(){L(new TypeError("Network request timed out"))},0)},$.onabort=function(){setTimeout(function(){L(new o.DOMException("Aborted","AbortError"))},0)};function G(V){try{return V===""&&a.location.href?a.location.href:V}catch{return V}}if($.open(U.method,G(U.url),!0),U.credentials==="include"?$.withCredentials=!0:U.credentials==="omit"&&($.withCredentials=!1),"responseType"in $&&(c.blob?$.responseType="blob":c.arrayBuffer&&($.responseType="arraybuffer")),_&&typeof _.headers=="object"&&!(_.headers instanceof g||a.Headers&&_.headers instanceof a.Headers)){var Z=[];Object.getOwnPropertyNames(_.headers).forEach(function(V){Z.push(h(V)),$.setRequestHeader(V,p(_.headers[V]))}),U.headers.forEach(function(V,ne){Z.indexOf(ne)===-1&&$.setRequestHeader(ne,V)})}else U.headers.forEach(function(V,ne){$.setRequestHeader(ne,V)});U.signal&&(U.signal.addEventListener("abort",F),$.onreadystatechange=function(){$.readyState===4&&U.signal.removeEventListener("abort",F)}),$.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return R.polyfill=!0,a.fetch||(a.fetch=R,a.Headers=g,a.Request=S,a.Response=P),o.Headers=g,o.Request=S,o.Response=P,o.fetch=R,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t})(Gl,Gl.exports)),Gl.exports}var f9=h9();const bb=sd(f9);var p9=Object.defineProperty,g9=Object.defineProperties,w9=Object.getOwnPropertyDescriptors,vb=Object.getOwnPropertySymbols,m9=Object.prototype.hasOwnProperty,y9=Object.prototype.propertyIsEnumerable,Eb=(e,t,n)=>t in e?p9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Cb=(e,t)=>{for(var n in t||(t={}))m9.call(t,n)&&Eb(e,n,t[n]);if(vb)for(var n of vb(t))y9.call(t,n)&&Eb(e,n,t[n]);return e},Ab=(e,t)=>g9(e,w9(t));const b9={Accept:"application/json","Content-Type":"application/json"},v9="POST",Ib={headers:b9,method:v9},Sb=10;let ur=class{constructor(t,n=!1){if(this.url=t,this.disableProviderPing=n,this.events=new Hn.EventEmitter,this.isAvailable=!1,this.registering=!1,!Fy(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const n=es(t),r=await(await bb(this.url,Ab(Cb({},Ib),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!Fy(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const n=es({id:1,jsonrpc:"2.0",method:"test",params:[]});await bb(t,Ab(Cb({},Ib),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const n=typeof t.data=="string"?Ti(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n),s=r.message||r.toString(),i=Cd(t,s);this.events.emit("payload",i)}parseError(t,n=this.url){return s2(t,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Sb&&this.events.setMaxListeners(Sb)}};const Nb="error",E9="wss://relay.walletconnect.org",C9="wc",A9="universal_provider",Yl=`${C9}@2:${A9}:`,_2="https://rpc.walletconnect.org/v1/",bo="generic",I9=`${_2}bundler`,Wn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Zg(e){return e==null||typeof e!="object"&&typeof e!="function"}function T2(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function O2(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const S9="[object RegExp]",D2="[object String]",P2="[object Number]",$2="[object Boolean]",k2="[object Arguments]",N9="[object Symbol]",x9="[object Date]",_9="[object Map]",T9="[object Set]",O9="[object Array]",D9="[object ArrayBuffer]",P9="[object Object]",$9="[object DataView]",k9="[object Uint8Array]",U9="[object Uint8ClampedArray]",R9="[object Uint16Array]",M9="[object Uint32Array]",L9="[object Int8Array]",B9="[object Int16Array]",j9="[object Int32Array]",F9="[object Float32Array]",z9="[object Float64Array]";function Jg(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function H9(e,t){return xo(e,void 0,e,new Map,t)}function xo(e,t,n,r=new Map,s=void 0){const i=s?.(e,t,n,r);if(i!=null)return i;if(Zg(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const o=new Array(e.length);r.set(e,o);for(let a=0;a<e.length;a++)o[a]=xo(e[a],a,n,r,s);return Object.hasOwn(e,"index")&&(o.index=e.index),Object.hasOwn(e,"input")&&(o.input=e.input),o}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const o=new RegExp(e.source,e.flags);return o.lastIndex=e.lastIndex,o}if(e instanceof Map){const o=new Map;r.set(e,o);for(const[a,c]of e)o.set(a,xo(c,a,n,r,s));return o}if(e instanceof Set){const o=new Set;r.set(e,o);for(const a of e)o.add(xo(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(e))return e.subarray();if(Jg(e)){const o=new(Object.getPrototypeOf(e)).constructor(e.length);r.set(e,o);for(let a=0;a<e.length;a++)o[a]=xo(e[a],a,n,r,s);return o}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const o=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,o),ci(o,e,n,r,s),o}if(typeof File<"u"&&e instanceof File){const o=new File([e],e.name,{type:e.type});return r.set(e,o),ci(o,e,n,r,s),o}if(e instanceof Blob){const o=new Blob([e],{type:e.type});return r.set(e,o),ci(o,e,n,r,s),o}if(e instanceof Error){const o=new e.constructor;return r.set(e,o),o.message=e.message,o.name=e.name,o.stack=e.stack,o.cause=e.cause,ci(o,e,n,r,s),o}if(typeof e=="object"&&q9(e)){const o=Object.create(Object.getPrototypeOf(e));return r.set(e,o),ci(o,e,n,r,s),o}return e}function ci(e,t,n=e,r,s){const i=[...Object.keys(t),...T2(t)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(e,a);(c==null||c.writable)&&(e[a]=xo(t[a],a,n,r,s))}}function q9(e){switch(O2(e)){case k2:case O9:case D9:case $9:case $2:case x9:case F9:case z9:case L9:case B9:case j9:case _9:case P2:case P9:case S9:case T9:case D2:case N9:case k9:case U9:case R9:case M9:return!0;default:return!1}}function W9(e,t){return H9(e,(n,r,s,i)=>{if(typeof e=="object")switch(Object.prototype.toString.call(e)){case P2:case D2:case $2:{const o=new e.constructor(e?.valueOf());return ci(o,e),o}case k2:{const o={};return ci(o,e),o.length=e.length,o[Symbol.iterator]=e[Symbol.iterator],o}default:return}})}function xb(e){return W9(e)}function _b(e){return e!==null&&typeof e=="object"&&O2(e)==="[object Arguments]"}function Tb(e){return typeof e=="object"&&e!==null}function V9(){}function K9(e){return Jg(e)}function G9(e){if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){const n=e[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable?!1:e.toString()===`[object ${n}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function Y9(e){if(Zg(e))return e;if(Array.isArray(e)||Jg(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e),n=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new n(e);if(e instanceof RegExp){const r=new n(e);return r.lastIndex=e.lastIndex,r}if(e instanceof DataView)return new n(e.buffer.slice(0));if(e instanceof Error){const r=new n(e.message);return r.stack=e.stack,r.name=e.name,r.cause=e.cause,r}if(typeof File<"u"&&e instanceof File)return new n([e],e.name,{type:e.type,lastModified:e.lastModified});if(typeof e=="object"){const r=Object.create(t);return Object.assign(r,e)}return e}function Z9(e,...t){const n=t.slice(0,-1),r=t[t.length-1];let s=e;for(let i=0;i<n.length;i++){const o=n[i];s=xp(s,o,r,new Map)}return s}function xp(e,t,n,r){if(Zg(e)&&(e=Object(e)),t==null||typeof t!="object")return e;if(r.has(t))return Y9(r.get(t));if(r.set(t,e),Array.isArray(t)){t=t.slice();for(let i=0;i<t.length;i++)t[i]=t[i]??void 0}const s=[...Object.keys(t),...T2(t)];for(let i=0;i<s.length;i++){const o=s[i];let a=t[o],c=e[o];if(_b(a)&&(a={...a}),_b(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=xb(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const p=d[h];u[p]=c[p]}c=u}else c=[];const l=n(c,a,o,e,t,r);l!=null?e[o]=l:Array.isArray(a)||Tb(c)&&Tb(a)?e[o]=xp(c,a,n,r):c==null&&G9(a)?e[o]=xp({},a,n,r):c==null&&K9(a)?e[o]=xb(a):(c===void 0||a!==void 0)&&(e[o]=a)}return e}function J9(e,...t){return Z9(e,...t,V9)}var X9=Object.defineProperty,Q9=Object.defineProperties,e7=Object.getOwnPropertyDescriptors,Ob=Object.getOwnPropertySymbols,t7=Object.prototype.hasOwnProperty,n7=Object.prototype.propertyIsEnumerable,Db=(e,t,n)=>t in e?X9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Zl=(e,t)=>{for(var n in t||(t={}))t7.call(t,n)&&Db(e,n,t[n]);if(Ob)for(var n of Ob(t))n7.call(t,n)&&Db(e,n,t[n]);return e},r7=(e,t)=>Q9(e,e7(t));function Nn(e,t,n){var r;const s=Po(e);return((r=t.rpcMap)==null?void 0:r[s.reference])||`${_2}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function ji(e){return e.includes(":")?e.split(":")[1]:e}function U2(e){return e.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function s7(e,t){const n=Object.keys(t.namespaces).filter(s=>s.includes(e));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=t.namespaces[s].accounts;r.push(...i)}),r}function Pb(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>{var r,s;return((r=n?.chains)==null?void 0:r.length)&&((s=n?.chains)==null?void 0:s.length)>0}))}function Jl(e={},t={}){const n=Pb($b(e)),r=Pb($b(t));return J9(n,r)}function $b(e){var t,n,r,s,i;const o={};if(!xr(e))return o;for(const[a,c]of Object.entries(e)){const l=vd(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},p=No(a);o[p]=r7(Zl(Zl({},o[p]),c),{chains:Nr(l,(t=o[p])==null?void 0:t.chains),methods:Nr(u,(n=o[p])==null?void 0:n.methods),events:Nr(d,(r=o[p])==null?void 0:r.events)}),(xr(h)||xr(((s=o[p])==null?void 0:s.rpcMap)||{}))&&(o[p].rpcMap=Zl(Zl({},h),(i=o[p])==null?void 0:i.rpcMap))}return o}function kb(e){return e.includes(":")?e.split(":")[2]:e}function Ub(e){const t={};for(const[n,r]of Object.entries(e)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=vd(n)?[n]:r.chains?r.chains:U2(r.accounts);t[n]={chains:a,methods:s,events:i,accounts:o}}return t}function Gh(e){return typeof e=="number"?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}const R2={},$e=e=>R2[e],Yh=(e,t)=>{R2[e]=t};var i7=Object.defineProperty,Rb=Object.getOwnPropertySymbols,o7=Object.prototype.hasOwnProperty,a7=Object.prototype.propertyIsEnumerable,Mb=(e,t,n)=>t in e?i7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Lb=(e,t)=>{for(var n in t||(t={}))o7.call(t,n)&&Mb(e,n,t[n]);if(Rb)for(var n of Rb(t))a7.call(t,n)&&Mb(e,n,t[n]);return e};const Bb="eip155",c7=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],l7=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,Zh=e=>e&&e.startsWith("0x")?e:`0x${BigInt(e).toString(16)}`,jb=e=>Object.keys(e).filter(t=>c7.includes(t)).reduce((t,n)=>(t[n]=e[n],t),{}),u7=(e,t,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=e,i={};if(!xr(s)&&!xr(r))return;const o=jb(r);for(const a of n){const c=l7(a);if(!c)continue;i[Zh(c)]=o;const l=s?.[`${Bb}:${c}`];if(l){const u=l?.[`${Bb}:${c}:${t}`];i[Zh(c)]=Lb(Lb({},i[Zh(c)]),jb(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var d7=Object.defineProperty,h7=(e,t,n)=>t in e?d7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ro=(e,t,n)=>h7(e,typeof t!="symbol"?t+"":t,n);let f7=class{constructor(t){ro(this,"name","polkadot"),ro(this,"client"),ro(this,"httpProviders"),ro(this,"events"),ro(this,"namespace"),ro(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=ji(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}};var p7=Object.defineProperty,g7=Object.defineProperties,w7=Object.getOwnPropertyDescriptors,Fb=Object.getOwnPropertySymbols,m7=Object.prototype.hasOwnProperty,y7=Object.prototype.propertyIsEnumerable,_p=(e,t,n)=>t in e?p7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zb=(e,t)=>{for(var n in t||(t={}))m7.call(t,n)&&_p(e,n,t[n]);if(Fb)for(var n of Fb(t))y7.call(t,n)&&_p(e,n,t[n]);return e},Hb=(e,t)=>g7(e,w7(t)),so=(e,t,n)=>_p(e,typeof t!="symbol"?t+"":t,n);class b7{constructor(t){so(this,"name","eip155"),so(this,"client"),so(this,"chainId"),so(this,"namespace"),so(this,"httpProviders"),so(this,"events"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(t);case"wallet_getCallsStatus":return await this.getCallStatus(t)}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(parseInt(t),n),this.chainId=parseInt(t),this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,n){const r=n||Nn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(ji(n));t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}async handleSwitchChain(t){var n,r;let s=t.request.params?(n=t.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}async getCapabilities(t){var n,r,s,i,o;const a=(r=(n=t.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=t.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(t.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let p;try{p=u7(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(p)return p;const f=await this.client.request(t);try{await this.client.session.update(t.topic,{sessionProperties:Hb(zb({},l.sessionProperties||{}),{capabilities:Hb(zb({},u||{}),{[d]:f})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return f}async getCallStatus(t){var n,r;const s=this.client.session.get(t.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const a=this.getBundlerUrl(t.chainId,i);try{return await this.getUserOperationReceipt(a,t)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,t)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(t.request.method))return await this.client.request(t);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(t,n){var r;const s=new URL(t),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_s("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(t,n){return`${I9}?projectId=${this.client.core.projectId}&chainId=${t}&bundler=${n}`}}var v7=Object.defineProperty,E7=(e,t,n)=>t in e?v7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,io=(e,t,n)=>E7(e,typeof t!="symbol"?t+"":t,n);let C7=class{constructor(t){io(this,"name","solana"),io(this,"client"),io(this,"httpProviders"),io(this,"events"),io(this,"namespace"),io(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=ji(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}};var A7=Object.defineProperty,I7=(e,t,n)=>t in e?A7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oo=(e,t,n)=>I7(e,typeof t!="symbol"?t+"":t,n);class S7{constructor(t){oo(this,"name","cosmos"),oo(this,"client"),oo(this,"httpProviders"),oo(this,"events"),oo(this,"namespace"),oo(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=ji(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}}var N7=Object.defineProperty,x7=(e,t,n)=>t in e?N7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ao=(e,t,n)=>x7(e,typeof t!="symbol"?t+"":t,n);let _7=class{constructor(t){ao(this,"name","algorand"),ao(this,"client"),ao(this,"httpProviders"),ao(this,"events"),ao(this,"namespace"),ao(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){if(!this.httpProviders[t]){const r=n||Nn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;t[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new qn(new ur(r,$e("disableProviderPing")))}};var T7=Object.defineProperty,O7=(e,t,n)=>t in e?T7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,co=(e,t,n)=>O7(e,typeof t!="symbol"?t+"":t,n);let D7=class{constructor(t){co(this,"name","cip34"),co(this,"client"),co(this,"httpProviders"),co(this,"events"),co(this,"namespace"),co(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=ji(n);t[s]=this.createHttpProvider(s,r)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}getCardanoRPCUrl(t){const n=this.namespace.rpcMap;if(n)return n[t]}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||this.getCardanoRPCUrl(t);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}};var P7=Object.defineProperty,$7=(e,t,n)=>t in e?P7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,lo=(e,t,n)=>$7(e,typeof t!="symbol"?t+"":t,n);let k7=class{constructor(t){lo(this,"name","elrond"),lo(this,"client"),lo(this,"httpProviders"),lo(this,"events"),lo(this,"namespace"),lo(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=ji(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}};var U7=Object.defineProperty,R7=(e,t,n)=>t in e?U7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,uo=(e,t,n)=>R7(e,typeof t!="symbol"?t+"":t,n);class M7{constructor(t){uo(this,"name","multiversx"),uo(this,"client"),uo(this,"httpProviders"),uo(this,"events"),uo(this,"namespace"),uo(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=ji(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}}var L7=Object.defineProperty,B7=(e,t,n)=>t in e?L7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ho=(e,t,n)=>B7(e,typeof t!="symbol"?t+"":t,n);class j7{constructor(t){ho(this,"name","near"),ho(this,"client"),ho(this,"httpProviders"),ho(this,"events"),ho(this,"namespace"),ho(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){if(this.chainId=t,!this.httpProviders[t]){const r=n||Nn(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;t[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace);return typeof r>"u"?void 0:new qn(new ur(r,$e("disableProviderPing")))}}var F7=Object.defineProperty,z7=(e,t,n)=>t in e?F7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,fo=(e,t,n)=>z7(e,typeof t!="symbol"?t+"":t,n);class H7{constructor(t){fo(this,"name","tezos"),fo(this,"client"),fo(this,"httpProviders"),fo(this,"events"),fo(this,"namespace"),fo(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){if(this.chainId=t,!this.httpProviders[t]){const r=n||Nn(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{t[n]=this.createHttpProvider(n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace);return typeof r>"u"?void 0:new qn(new ur(r))}}var q7=Object.defineProperty,W7=(e,t,n)=>t in e?q7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,po=(e,t,n)=>W7(e,typeof t!="symbol"?t+"":t,n);class V7{constructor(t){po(this,"name",bo),po(this,"client"),po(this,"httpProviders"),po(this,"events"),po(this,"namespace"),po(this,"chainId"),this.namespace=t.namespace,this.events=$e("events"),this.client=$e("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(t.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(t.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(t.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(t.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider(t.chainId).request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Wn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var t,n;const r={};return(n=(t=this.namespace)==null?void 0:t.accounts)==null||n.forEach(s=>{const i=Po(s);r[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),r}getHttpProvider(t){const n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Nn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new qn(new ur(r,$e("disableProviderPing")))}}var K7=Object.defineProperty,G7=Object.defineProperties,Y7=Object.getOwnPropertyDescriptors,qb=Object.getOwnPropertySymbols,Z7=Object.prototype.hasOwnProperty,J7=Object.prototype.propertyIsEnumerable,Tp=(e,t,n)=>t in e?K7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Xl=(e,t)=>{for(var n in t||(t={}))Z7.call(t,n)&&Tp(e,n,t[n]);if(qb)for(var n of qb(t))J7.call(t,n)&&Tp(e,n,t[n]);return e},Jh=(e,t)=>G7(e,Y7(t)),Pn=(e,t,n)=>Tp(e,typeof t!="symbol"?t+"":t,n);let M2=class L2{constructor(t){Pn(this,"client"),Pn(this,"namespaces"),Pn(this,"optionalNamespaces"),Pn(this,"sessionProperties"),Pn(this,"scopedProperties"),Pn(this,"events",new Eg),Pn(this,"rpcProviders",{}),Pn(this,"session"),Pn(this,"providerOpts"),Pn(this,"logger"),Pn(this,"uri"),Pn(this,"disableProviderPing",!1),this.providerOpts=t,this.logger=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Qc(tl({level:t?.logger||Nb})),this.disableProviderPing=t?.disableProviderPing||!1}static async init(t){const n=new L2(t);return await n.initialize(),n}async request(t,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Xl({},t),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(t,n,r,s){const i=new Date().getTime();this.request(t,r,s).then(o=>n(null,Ed(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:et("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}async authenticate(t,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(t),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(t,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=Ub(this.session.namespaces);this.namespaces=Jl(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}removeListener(t,n){this.events.removeListener(t,n)}off(t,n){this.events.off(t,n)}get isWalletConnect(){return!0}async pair(t){const{uri:n,approval:r}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=Ub(s.namespaces);return this.namespaces=Jl(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(t,n){try{if(!this.session)return;const[r,s]=this.validateChain(t),i=this.getProvider(r);i.name===bo?i.setDefaultChain(`${r}:${s}`,n):i.setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(Jr(n)){for(const r of n)t.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var t,n;if(this.client=this.providerOpts.client||await d9.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Nb,relayUrl:this.providerOpts.relayUrl||E9,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(t=this.providerOpts)==null?void 0:t.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(n=>No(n)))];Yh("client",this.client),Yh("events",this.events),Yh("disableProviderPing",this.disableProviderPing),t.forEach(n=>{if(!this.session)return;const r=s7(n,this.session);if(r?.length===0)return;const s=U2(r),i=Jl(this.namespaces,this.optionalNamespaces),o=Jh(Xl({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new b7({namespace:o});break;case"algorand":this.rpcProviders[n]=new _7({namespace:o});break;case"solana":this.rpcProviders[n]=new C7({namespace:o});break;case"cosmos":this.rpcProviders[n]=new S7({namespace:o});break;case"polkadot":this.rpcProviders[n]=new f7({namespace:o});break;case"cip34":this.rpcProviders[n]=new D7({namespace:o});break;case"elrond":this.rpcProviders[n]=new k7({namespace:o});break;case"multiversx":this.rpcProviders[n]=new M7({namespace:o});break;case"near":this.rpcProviders[n]=new j7({namespace:o});break;case"tezos":this.rpcProviders[n]=new H7({namespace:o});break;default:this.rpcProviders[bo]?this.rpcProviders[bo].updateNamespace(o):this.rpcProviders[bo]=new V7({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{var n;const{topic:r}=t;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{var n;const{params:r,topic:s}=t;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&Jr(o)&&this.events.emit("accountsChanged",o.map(kb))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=No(o),l=Gh(o)!==Gh(a)?`${c}:${Gh(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:n})=>{var r,s;if(t!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(t);this.session=Jh(Xl({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:n})}),this.client.on("session_delete",async t=>{var n;t.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Jh(Xl({},et("USER_DISCONNECTED")),{data:t.topic})))}),this.on(Wn.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){return this.rpcProviders[t]||this.rpcProviders[bo]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var n;this.getProvider(t).updateNamespace((n=this.session)==null?void 0:n.namespaces[t])})}setNamespaces(t){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=t;this.optionalNamespaces=Jl(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(t){const[n,r]=t?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>No(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=No(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}async onChainChanged(t,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(t);if(!s)return;this.updateNamespaceChain(r,s),this.events.emit("chainChanged",s);const i=this.getProvider(r).getDefaultChain();n||this.getProvider(r).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:t}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:t,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[t])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(kb);if(!Jr(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(t,n){if(!this.namespaces)return;const r=this.namespaces[t]?t:`${t}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(t,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Yl}/${t}${s}`,n)}async getFromStore(t){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${Yl}/${t}${r}`)}async deleteFromStore(t){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${Yl}/${t}${r}`)}async cleanupStorage(){var t;try{if(((t=this.client)==null?void 0:t.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(Yl)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}};const X7=M2;var Wb={};const H={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Wb<"u"?Wb.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}},B2={caipNetworkIdToNumber(e){return e?Number(e.split(":")[1]):void 0},parseEvmChainId(e){return typeof e=="string"?this.caipNetworkIdToNumber(e):e},getNetworksByNamespace(e,t){return e?.filter(n=>n.chainNamespace===t)||[]},getFirstNetworkByNamespace(e,t){return this.getNetworksByNamespace(e,t)[0]},getNetworkNameByCaipNetworkId(e,t){if(!t)return;const n=e.find(s=>s.caipNetworkId===t);if(n)return n.name;const[r]=t.split(":");return H.CHAIN_NAME_MAP?.[r]||void 0}},j2=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var Q7=20,eF=1,Pi=1e6,Vb=1e6,tF=-7,nF=21,rF=!1,ll="[big.js] ",Fi=ll+"Invalid ",Nd=Fi+"decimal places",sF=Fi+"rounding mode",F2=ll+"Division by zero",je={},_r=void 0,iF=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function z2(){function e(t){var n=this;if(!(n instanceof e))return t===_r?z2():new e(t);if(t instanceof e)n.s=t.s,n.e=t.e,n.c=t.c.slice();else{if(typeof t!="string"){if(e.strict===!0&&typeof t!="bigint")throw TypeError(Fi+"value");t=t===0&&1/t<0?"-0":String(t)}oF(n,t)}n.constructor=e}return e.prototype=je,e.DP=Q7,e.RM=eF,e.NE=tF,e.PE=nF,e.strict=rF,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}function oF(e,t){var n,r,s;if(!iF.test(t))throw Error(Fi+"number");for(e.s=t.charAt(0)=="-"?(t=t.slice(1),-1):1,(n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),s=t.length,r=0;r<s&&t.charAt(r)=="0";)++r;if(r==s)e.c=[e.e=0];else{for(;s>0&&t.charAt(--s)=="0";);for(e.e=n-r-1,e.c=[],n=0;r<=s;)e.c[n++]=+t.charAt(r++)}return e}function zi(e,t,n,r){var s=e.c;if(n===_r&&(n=e.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(sF);if(t<1)r=n===3&&(r||!!s[0])||t===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==_r))),s.length=1,r?(e.e=e.e-t+1,s[0]=1):s[0]=e.e=0;else if(t<s.length){if(r=n===1&&s[t]>=5||n===2&&(s[t]>5||s[t]===5&&(r||s[t+1]!==_r||s[t-1]&1))||n===3&&(r||!!s[0]),s.length=t,r){for(;++s[--t]>9;)if(s[t]=0,t===0){++e.e,s.unshift(1);break}}for(t=s.length;!s[--t];)s.pop()}return e}function Hi(e,t,n){var r=e.e,s=e.c.join(""),i=s.length;if(t)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return e.s<0&&n?"-"+s:s}je.abs=function(){var e=new this.constructor(this);return e.s=1,e};je.cmp=function(e){var t,n=this,r=n.c,s=(e=new n.constructor(e)).c,i=n.s,o=e.s,a=n.e,c=e.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(t=i<0,a!=c)return a>c^t?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^t?1:-1;return a==c?0:a>c^t?1:-1};je.div=function(e){var t=this,n=t.constructor,r=t.c,s=(e=new n(e)).c,i=t.s==e.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>Pi)throw Error(Nd);if(!s[0])throw Error(F2);if(!r[0])return e.s=i,e.c=[e.e=0],e;var a,c,l,u,d,h=s.slice(),p=a=s.length,f=r.length,g=r.slice(0,a),w=g.length,b=e,I=b.c=[],y=0,m=o+(b.e=t.e-e.e)+1;for(b.s=i,i=m<0?0:m,h.unshift(0);w++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(w=g.length))u=a>w?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=w==a?s:h;w;){if(g[--w]<c[w]){for(d=w;d&&!g[--d];)g[d]=9;--g[d],g[w]+=10}g[w]-=c[w]}for(;!g[0];)g.shift()}else break}I[y++]=u?l:++l,g[0]&&u?g[w]=r[p]||0:g=[r[p]]}while((p++<f||g[0]!==_r)&&i--);return!I[0]&&y!=1&&(I.shift(),b.e--,m--),y>m&&zi(b,m,n.RM,g[0]!==_r),b};je.eq=function(e){return this.cmp(e)===0};je.gt=function(e){return this.cmp(e)>0};je.gte=function(e){return this.cmp(e)>-1};je.lt=function(e){return this.cmp(e)<0};je.lte=function(e){return this.cmp(e)<1};je.minus=je.sub=function(e){var t,n,r,s,i=this,o=i.constructor,a=i.s,c=(e=new o(e)).s;if(a!=c)return e.s=-c,i.plus(e);var l=i.c.slice(),u=i.e,d=e.c,h=e.e;if(!l[0]||!d[0])return d[0]?e.s=-c:l[0]?e=new o(i):e.s=1,e;if(a=u-h){for((s=a<0)?(a=-a,r=l):(h=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,e.s=-e.s),(c=(n=d.length)-(t=l.length))>0)for(;c--;)l[t++]=0;for(c=t;n>a;){if(l[--n]<d[n]){for(t=n;t&&!l[--t];)l[t]=9;--l[t],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(e.s=1,l=[h=0]),e.c=l,e.e=h,e};je.mod=function(e){var t,n=this,r=n.constructor,s=n.s,i=(e=new r(e)).s;if(!e.c[0])throw Error(F2);return n.s=e.s=1,t=e.cmp(n)==1,n.s=s,e.s=i,t?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(e),r.DP=s,r.RM=i,this.minus(n.times(e)))};je.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e};je.plus=je.add=function(e){var t,n,r,s=this,i=s.constructor;if(e=new i(e),s.s!=e.s)return e.s=-e.s,s.minus(e);var o=s.e,a=s.c,c=e.e,l=e.c;if(!a[0]||!l[0])return l[0]||(a[0]?e=new i(s):e.s=s.s),e;if(a=a.slice(),t=o-c){for(t>0?(c=o,r=l):(t=-t,r=a),r.reverse();t--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),t=l.length,n=0;t;a[t]%=10)n=(a[--t]=a[t]+l[t]+n)/10|0;for(n&&(a.unshift(n),++c),t=a.length;a[--t]===0;)a.pop();return e.c=a,e.e=c,e};je.pow=function(e){var t=this,n=new t.constructor("1"),r=n,s=e<0;if(e!==~~e||e<-Vb||e>Vb)throw Error(Fi+"exponent");for(s&&(e=-e);e&1&&(r=r.times(t)),e>>=1,!!e;)t=t.times(t);return s?n.div(r):r};je.prec=function(e,t){if(e!==~~e||e<1||e>Pi)throw Error(Fi+"precision");return zi(new this.constructor(this),e,t)};je.round=function(e,t){if(e===_r)e=0;else if(e!==~~e||e<-Pi||e>Pi)throw Error(Nd);return zi(new this.constructor(this),e+this.e+1,t)};je.sqrt=function(){var e,t,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(ll+"No square root");i=Math.sqrt(+Hi(r,!0,!0)),i===0||i===1/0?(t=r.c.join(""),t.length+o&1||(t+="0"),i=Math.sqrt(t),o=((o+1)/2|0)-(o<0||o&1),e=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):e=new s(i+""),o=e.e+(s.DP+=4);do n=e,e=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==e.c.slice(0,o).join(""));return zi(e,(s.DP-=4)+e.e+1,s.RM)};je.times=je.mul=function(e){var t,n=this,r=n.constructor,s=n.c,i=(e=new r(e)).c,o=s.length,a=i.length,c=n.e,l=e.e;if(e.s=n.s==e.s?1:-1,!s[0]||!i[0])return e.c=[e.e=0],e;for(e.e=c+l,o<a&&(t=s,s=i,i=t,l=o,o=a,a=l),t=new Array(l=o+a);l--;)t[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=t[l]+i[c]*s[l-c-1]+a,t[l--]=a%10,a=a/10|0;t[l]=a}for(a?++e.e:t.shift(),c=t.length;!t[--c];)t.pop();return e.c=t,e};je.toExponential=function(e,t){var n=this,r=n.c[0];if(e!==_r){if(e!==~~e||e<0||e>Pi)throw Error(Nd);for(n=zi(new n.constructor(n),++e,t);n.c.length<e;)n.c.push(0)}return Hi(n,!0,!!r)};je.toFixed=function(e,t){var n=this,r=n.c[0];if(e!==_r){if(e!==~~e||e<0||e>Pi)throw Error(Nd);for(n=zi(new n.constructor(n),e+n.e+1,t),e=e+n.e+1;n.c.length<e;)n.c.push(0)}return Hi(n,!1,!!r)};je[Symbol.for("nodejs.util.inspect.custom")]=je.toJSON=je.toString=function(){var e=this,t=e.constructor;return Hi(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])};je.toNumber=function(){var e=+Hi(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(e.toString()))throw Error(ll+"Imprecise conversion");return e};je.toPrecision=function(e,t){var n=this,r=n.constructor,s=n.c[0];if(e!==_r){if(e!==~~e||e<1||e>Pi)throw Error(Fi+"precision");for(n=zi(new r(n),e,t);n.c.length<e;)n.c.push(0)}return Hi(n,e<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};je.valueOf=function(){var e=this,t=e.constructor;if(t.strict===!0)throw Error(ll+"valueOf disallowed");return Hi(e,e.e<=t.NE||e.e>=t.PE,!0)};var Da=z2();const aF={bigNumber(e){return e?new Da(e):new Da(0)},multiply(e,t){if(e===void 0||t===void 0)return new Da(0);const n=new Da(e),r=new Da(t);return n.times(r)},formatNumberToLocalString(e,t=2){return e===void 0?"0.00":typeof e=="number"?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})},parseLocalStringToNumber(e){return e===void 0?0:parseFloat(e.replace(/,/gu,""))}},cF=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],lF=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],uF=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],dF={getERC20Abi:e=>H.USDT_CONTRACT_ADDRESSES.includes(e)?uF:cF,getSwapAbi:()=>lF},En={validateCaipAddress(e){if(e.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return e},parseCaipAddress(e){const t=e.split(":");if(t.length!==3)throw new Error(`Invalid CAIP-10 address: ${e}`);const[n,r,s]=t;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(e){const t=e.split(":");if(t.length!==2)throw new Error(`Invalid CAIP-2 network id: ${e}`);const[n,r]=t;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:n,chainId:r}}},de={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails"};function Xh(e){if(!e)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${e}:connected_connector_id`}const le={setItem(e,t){_o()&&t!==void 0&&localStorage.setItem(e,t)},getItem(e){if(_o())return localStorage.getItem(e)||void 0},removeItem(e){_o()&&localStorage.removeItem(e)},clear(){_o()&&localStorage.clear()}};function _o(){return typeof window<"u"&&typeof localStorage<"u"}function Ts(e,t){return t==="light"?{"--w3m-accent":e?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":e?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}const hF=Symbol(),Kb=Object.getPrototypeOf,Op=new WeakMap,fF=e=>e&&(Op.has(e)?Op.get(e):Kb(e)===Object.prototype||Kb(e)===Array.prototype),pF=e=>fF(e)&&e[hF]||null,Gb=(e,t=!0)=>{Op.set(e,t)},Ku={},Xg=e=>typeof e=="object"&&e!==null,gF=e=>Xg(e)&&!ul.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer)&&!(e instanceof Promise),H2=(e,t)=>{const n=Dp.get(e);if(n?.[0]===t)return n[1];const r=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return Gb(r,!0),Dp.set(e,[t,r]),Reflect.ownKeys(e).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(e,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(e,s),a={value:i,enumerable:o,configurable:!0};if(ul.has(i))Gb(i,!1);else if(Ms.has(i)){const[c,l]=Ms.get(i);a.value=H2(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},wF=(e,t,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!e()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Yb(l,o)||vc.has(o)&&Yb(l,vc.get(o))))return!0;n(i),Xg(o)&&(o=pF(o)||o);const u=!Ms.has(o)&&yF(o)?Ze(o):o;return t(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),Ms=new WeakMap,ul=new WeakSet,Dp=new WeakMap,ja=[1,1],vc=new WeakMap;let Yb=Object.is,mF=(e,t)=>new Proxy(e,t),yF=gF,bF=H2,vF=wF;function Ze(e={}){if(!Xg(e))throw new Error("object required");const t=vc.get(e);if(t)return t;let n=ja[0];const r=new Set,s=(w,b=++ja[0])=>{n!==b&&(n=b,r.forEach(I=>I(w,b)))};let i=ja[1];const o=(w=++ja[1])=>(i!==w&&!r.size&&(i=w,c.forEach(([b])=>{const I=b[1](w);I>n&&(n=I)})),n),a=w=>(b,I)=>{const y=[...b];y[1]=[w,...y[1]],s(y,I)},c=new Map,l=(w,b)=>{const I=!ul.has(b)&&Ms.get(b);if(I){if((Ku?"production":void 0)!=="production"&&c.has(w))throw new Error("prop listener already exists");if(r.size){const y=I[2](a(w));c.set(w,[I,y])}else c.set(w,[I])}},u=w=>{var b;const I=c.get(w);I&&(c.delete(w),(b=I[1])==null||b.call(I))},d=w=>(r.add(w),r.size===1&&c.forEach(([I,y],m)=>{if((Ku?"production":void 0)!=="production"&&y)throw new Error("remove already exists");const v=I[2](a(m));c.set(m,[I,v])}),()=>{r.delete(w),r.size===0&&c.forEach(([I,y],m)=>{y&&(y(),c.set(m,[I]))})});let h=!0;const p=vF(()=>h,l,u,s),f=mF(e,p);vc.set(e,f);const g=[e,o,d];return Ms.set(f,g),Reflect.ownKeys(e).forEach(w=>{const b=Object.getOwnPropertyDescriptor(e,w);"value"in b&&b.writable&&(f[w]=e[w])}),h=!1,f}function Pt(e,t,n){const r=Ms.get(e);(Ku?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&t(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Ec(e){const t=Ms.get(e);(Ku?"production":void 0)!=="production"&&!t&&console.warn("Please use proxy object");const[n,r]=t;return bF(n,r())}function $i(e){return ul.add(e),e}function EF(){return{proxyStateMap:Ms,refSet:ul,snapCache:Dp,versionHolder:ja,proxyCache:vc}}function Ht(e,t,n,r){let s=e[t];return Pt(e,()=>{const i=e[t];Object.is(s,i)||n(s=i)})}const{proxyStateMap:CF,snapCache:AF}=EF(),Ql=e=>CF.has(e);function IF(e){const t=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=AF.get(a),u=l?.[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:t,index:n,epoch:0,get size(){return Ql(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!Ql(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!Ql(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!Ql(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Ze(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}const q2=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],SF="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Le={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,ONE_SEC_MS:1e3,BALANCE_SUPPORTED_CHAINS:[H.CHAIN.EVM,H.CHAIN.SOLANA],NAMES_SUPPORTED_CHAIN_NAMESPACES:[H.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[H.CHAIN.EVM,H.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},W={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3},isCacheExpired(e,t){return Date.now()-e>t},getActiveNetworkProps(){const e=W.getActiveNamespace(),t=W.getActiveCaipNetworkId(),n=t?t.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:e,caipNetworkId:t,chainId:r}},setWalletConnectDeepLink({name:e,href:t}){try{le.setItem(de.DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const e=le.getItem(de.DEEPLINK_CHOICE);if(e)return JSON.parse(e)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{le.removeItem(de.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(e){try{le.setItem(de.ACTIVE_NAMESPACE,e)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(e){try{le.setItem(de.ACTIVE_CAIP_NETWORK_ID,e),W.setActiveNamespace(e.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return le.getItem(de.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{le.removeItem(de.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(e){try{const t=Xh(e);le.removeItem(t)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(e){try{const t=W.getRecentWallets();t.find(r=>r.id===e.id)||(t.unshift(e),t.length>2&&t.pop(),le.setItem(de.RECENT_WALLETS,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const e=le.getItem(de.RECENT_WALLETS);return e?JSON.parse(e):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(e,t){try{const n=Xh(e);le.setItem(n,t)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return le.getItem(de.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(e){if(e)try{const t=Xh(e);return le.getItem(t)}catch{console.info("Unable to get connected connector id in namespace",e)}},setConnectedSocialProvider(e){try{le.setItem(de.CONNECTED_SOCIAL,e)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return le.getItem(de.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{le.removeItem(de.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return le.getItem(de.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return le.getItem(de.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(e){try{le.setItem(de.CONNECTION_STATUS,e)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return le.getItem(de.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const e=le.getItem(de.CONNECTED_NAMESPACES);return e?.length?e.split(","):[]}catch{return[]}},setConnectedNamespaces(e){try{const t=Array.from(new Set(e));le.setItem(de.CONNECTED_NAMESPACES,t.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(e){try{const t=W.getConnectedNamespaces();t.includes(e)||(t.push(e),W.setConnectedNamespaces(t))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(e){try{const t=W.getConnectedNamespaces(),n=t.indexOf(e);n>-1&&(t.splice(n,1),W.setConnectedNamespaces(t))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return le.getItem(de.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(e){try{le.setItem(de.TELEGRAM_SOCIAL_PROVIDER,e)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{le.removeItem(de.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let e={};try{const t=le.getItem(de.PORTFOLIO_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromBalanceCache(e){try{const t=W.getBalanceCache();le.setItem(de.PORTFOLIO_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getBalanceCacheForCaipAddress(e){try{const n=W.getBalanceCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;W.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateBalanceCache(e){try{const t=W.getBalanceCache();t[e.caipAddress]=e,le.setItem(de.PORTFOLIO_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getNativeBalanceCache(){let e={};try{const t=le.getItem(de.NATIVE_BALANCE_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromNativeBalanceCache(e){try{const t=W.getBalanceCache();le.setItem(de.NATIVE_BALANCE_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getNativeBalanceCacheForCaipAddress(e){try{const n=W.getNativeBalanceCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",e),W.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateNativeBalanceCache(e){try{const t=W.getNativeBalanceCache();t[e.caipAddress]=e,le.setItem(de.NATIVE_BALANCE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getEnsCache(){let e={};try{const t=le.getItem(de.ENS_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get ens name cache")}return e},getEnsFromCacheForAddress(e){try{const n=W.getEnsCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;W.removeEnsFromCache(e)}catch{console.info("Unable to get ens name from cache",e)}},updateEnsCache(e){try{const t=W.getEnsCache();t[e.address]=e,le.setItem(de.ENS_CACHE,JSON.stringify(t))}catch{console.info("Unable to update ens name cache",e)}},removeEnsFromCache(e){try{const t=W.getEnsCache();le.setItem(de.ENS_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove ens name from cache",e)}},getIdentityCache(){let e={};try{const t=le.getItem(de.IDENTITY_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get identity cache")}return e},getIdentityFromCacheForAddress(e){try{const n=W.getIdentityCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;W.removeIdentityFromCache(e)}catch{console.info("Unable to get identity from cache",e)}},updateIdentityCache(e){try{const t=W.getIdentityCache();t[e.address]={identity:e.identity,timestamp:e.timestamp},le.setItem(de.IDENTITY_CACHE,JSON.stringify(t))}catch{console.info("Unable to update identity cache",e)}},removeIdentityFromCache(e){try{const t=W.getIdentityCache();le.setItem(de.IDENTITY_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove identity from cache",e)}},clearAddressCache(){try{le.removeItem(de.PORTFOLIO_CACHE),le.removeItem(de.NATIVE_BALANCE_CACHE),le.removeItem(de.ENS_CACHE),le.removeItem(de.IDENTITY_CACHE),le.removeItem(de.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(e){try{le.setItem(de.PREFERRED_ACCOUNT_TYPES,JSON.stringify(e))}catch{console.info("Unable to set preferred account types",e)}},getPreferredAccountTypes(){try{const e=le.getItem(de.PREFERRED_ACCOUNT_TYPES);return e?JSON.parse(e):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(e,t){try{const n=W.getConnections(),r=n[t]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of e){const a=s.get(o.connectorId),c=o.connectorId===H.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[t]:Array.from(s.values())};le.setItem(de.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const e=le.getItem(de.CONNECTIONS);return e?JSON.parse(e):{}}catch(e){return console.error("Unable to get connections from storage",e),{}}},deleteAddressFromConnection({connectorId:e,address:t,namespace:n}){try{const r=W.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(e);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==t.toLowerCase()).length===0?i.delete(e):i.set(e,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==t.toLowerCase())})),le.setItem(de.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${t}" from connector "${e}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const e=le.getItem(de.DISCONNECTED_CONNECTOR_IDS);return e?JSON.parse(e):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(e,t){try{const n=W.getDisconnectedConnectorIds(),r=n[t]??[];r.push(e),le.setItem(de.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[t]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${e}" for namespace "${t}"`)}},removeDisconnectedConnectorId(e,t){try{const n=W.getDisconnectedConnectorIds();let r=n[t]??[];r=r.filter(s=>s.toLowerCase()!==e.toLowerCase()),le.setItem(de.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[t]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${e}" for namespace "${t}"`)}},isConnectorDisconnected(e,t){try{return(W.getDisconnectedConnectorIds()[t]??[]).some(s=>s.toLowerCase()===e.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${e}" for namespace "${t}"`)}return!1},getTransactionsCache(){try{const e=le.getItem(de.HISTORY_TRANSACTIONS_CACHE);return e?JSON.parse(e):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:e,chainId:t=""}){try{const r=W.getTransactionsCache()[e]?.[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.transactionsHistory))return r.transactions;W.removeTransactionsCache({address:e,chainId:t})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:e,chainId:t="",timestamp:n,transactions:r}){try{const s=W.getTransactionsCache();s[e]={...s[e],[t]:{timestamp:n,transactions:r}},le.setItem(de.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:e,chainId:t,timestamp:n,transactions:r})}},removeTransactionsCache({address:e,chainId:t}){try{const n=W.getTransactionsCache(),r=n?.[e]||{},{[t]:s,...i}=r;le.setItem(de.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[e]:i}))}catch{console.info("Unable to remove transactions cache",{address:e,chainId:t})}},getTokenPriceCache(){try{const e=le.getItem(de.TOKEN_PRICE_CACHE);return e?JSON.parse(e):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(e){try{const n=W.getTokenPriceCache()[e.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;W.removeTokenPriceCache(e)}catch{console.info("Unable to get token price cache for addresses",e)}},updateTokenPriceCache(e){try{const t=W.getTokenPriceCache();t[e.addresses.join(",")]={timestamp:e.timestamp,tokenPrice:e.tokenPrice},le.setItem(de.TOKEN_PRICE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update token price cache",e)}},removeTokenPriceCache(e){try{const t=W.getTokenPriceCache();le.setItem(de.TOKEN_PRICE_CACHE,JSON.stringify({...t,[e.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",e)}}},ce={isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(e,t=""){return e?.caipNetworkId.toLocaleLowerCase().includes(t.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return ce.isMobile()&&e.includes("android")},isIos(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return e.includes("iphone")||e.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(e){return e?e-Date.now()<=Le.TEN_SEC_MS:!0},isAllowedRetry(e,t=Le.ONE_SEC_MS){return Date.now()-e>=t},copyToClopboard(e){navigator.clipboard.writeText(e)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(ce.isClient()&&window.self!==window.top)try{const e=window?.location?.ancestorOrigins?.[0],t="https://app.safe.global";if(e){const n=new URL(e),r=new URL(t);return n.hostname===r.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Le.FOUR_MINUTES_MS},getNetworkId(e){return e?.split(":")[1]},getPlainAddress(e){return e?.split(":")[2]},async wait(e){return new Promise(t=>{setTimeout(t,e)})},debounce(e,t=500){let n;return(...r)=>{function s(){e(...r)}n&&clearTimeout(n),n=setTimeout(s,t)}},isHttpUrl(e){return e.startsWith("http://")||e.startsWith("https://")},formatNativeUrl(e,t,n=null){if(ce.isHttpUrl(e))return this.formatUniversalUrl(e,t);let r=e,s=n;r.includes("://")||(r=e.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(t=encodeURIComponent(t));const i=encodeURIComponent(t);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(e,t){if(!ce.isHttpUrl(e))return this.formatNativeUrl(e,t);let n=e;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(t);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(e){return e==="popupWindow"?e:this.isTelegram()?W.getTelegramSocialProvider()?"_top":"_blank":e},openHref(e,t,n){window?.open(e,this.getOpenTargetForPlatform(t),n||"noreferrer noopener")},returnOpenHref(e,t,n){return window?.open(e,this.getOpenTargetForPlatform(t),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const e=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,t=window?.navigator?.standalone;return!!(e||t)},async preloadImage(e){const t=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=e});return Promise.race([t,ce.wait(2e3)])},formatBalance(e,t){let n="0.000";if(typeof e=="string"){const r=Number(e);if(r){const s=Math.floor(r*1e3)/1e3;s&&(n=s.toString())}}return`${n}${t?` ${t}`:""}`},formatBalance2(e,t){let n;if(e==="0")n="0";else if(typeof e=="string"){const r=Number(e);r&&(n=r.toString().match(/^-?\d+(?:\.\d{0,3})?/u)?.[0])}return{value:n??"0",rest:n==="0"?"000":"",symbol:t}},getApiUrl(){return H.W3M_API_URL},getBlockchainApiUrl(){return H.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return H.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})},parseError(e){return typeof e=="string"?e:typeof e?.issues?.[0]?.message=="string"?e.issues[0].message:e instanceof Error?e.message:"Unknown error"},sortRequestedNetworks(e,t=[]){const n={};return t&&e&&(e.forEach((r,s)=>{n[r]=s}),t.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),t},calculateBalance(e){let t=0;for(const n of e)t+=n.value??0;return t},formatTokenBalance(e){const t=e.toFixed(2),[n,r]=t.split(".");return{dollars:n,pennies:r}},isAddress(e,t="eip155"){switch(t){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)||/^(?:0x)?[0-9A-F]{40}$/iu.test(e))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(e);default:return!1}},uniqueBy(e,t){const n=new Set;return e.filter(r=>{const s=r[t];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(e,t,n){const s=e.length===0?Le.ADAPTER_TYPES.UNIVERSAL:e.map(i=>i.adapterType).join(",");return`${t}-${s}-${n}`},createAccount(e,t,n,r,s){return{namespace:e,address:t,type:n,publicKey:r,path:s}},isCaipAddress(e){if(typeof e!="string")return!1;const t=e.split(":"),n=t[0];return t.filter(Boolean).length===3&&n in H.CHAIN_NAME_MAP},getAccount(e){return e?typeof e=="string"?{address:e,chainId:void 0}:{address:e.address,chainId:e.chainId}:{address:void 0,chainId:void 0}},isMac(){const e=window?.navigator.userAgent.toLowerCase();return e.includes("macintosh")&&!e.includes("safari")},formatTelegramSocialLoginUrl(e){const t=`--${encodeURIComponent(window?.location.href)}`,n="state=";if(new URL(e).host==="auth.magic.link"){const s="provider_authorization_url=",i=e.substring(e.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,t);return e.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(e,n,t)},injectIntoUrl(e,t,n){const r=e.indexOf(t);if(r===-1)throw new Error(`${t} parameter not found in the URL: ${e}`);const s=e.indexOf("&",r),i=t.length,o=s!==-1?s:e.length,a=e.substring(0,r+i),c=e.substring(r+i,o),l=e.substring(s),u=c+n;return a+u+l}};async function Pa(...e){const t=await fetch(...e);if(!t.ok)throw new Error(`HTTP status code: ${t.status}`,{cause:t});return t}class dl{constructor({baseUrl:t,clientId:n}){this.baseUrl=t,this.clientId=n}async get({headers:t,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await Pa(i,{method:"GET",headers:t,signal:n,cache:r})).json()}async getBlob({headers:t,signal:n,...r}){const s=this.createUrl(r);return(await Pa(s,{method:"GET",headers:t,signal:n})).blob()}async post({body:t,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Pa(i,{method:"POST",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}async put({body:t,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Pa(i,{method:"PUT",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}async delete({body:t,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Pa(i,{method:"DELETE",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}createUrl({path:t,params:n}){const r=new URL(t,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}const NF={getFeatureValue(e,t){const n=t?.[e];return n===void 0?Le.DEFAULT_FEATURES[e]:n},filterSocialsByPlatform(e){if(!e||!e.length)return e;if(ce.isTelegram()){if(ce.isIos())return e.filter(t=>t!=="google");if(ce.isMac())return e.filter(t=>t!=="x");if(ce.isAndroid())return e.filter(t=>!["facebook","x"].includes(t))}return e}},ie=Ze({features:Le.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Le.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),z={state:ie,subscribeKey(e,t){return Ht(ie,e,t)},setOptions(e){Object.assign(ie,e)},setRemoteFeatures(e){if(!e)return;const t={...ie.remoteFeatures,...e};ie.remoteFeatures=t,ie.remoteFeatures?.socials&&(ie.remoteFeatures.socials=NF.filterSocialsByPlatform(ie.remoteFeatures.socials)),ie.features?.pay&&(ie.remoteFeatures.email=!1,ie.remoteFeatures.socials=!1)},setFeatures(e){if(!e)return;ie.features||(ie.features=Le.DEFAULT_FEATURES);const t={...ie.features,...e};ie.features=t,ie.features?.pay&&ie.remoteFeatures&&(ie.remoteFeatures.email=!1,ie.remoteFeatures.socials=!1)},setProjectId(e){ie.projectId=e},setCustomRpcUrls(e){ie.customRpcUrls=e},setAllWallets(e){ie.allWallets=e},setIncludeWalletIds(e){ie.includeWalletIds=e},setExcludeWalletIds(e){ie.excludeWalletIds=e},setFeaturedWalletIds(e){ie.featuredWalletIds=e},setTokens(e){ie.tokens=e},setTermsConditionsUrl(e){ie.termsConditionsUrl=e},setPrivacyPolicyUrl(e){ie.privacyPolicyUrl=e},setCustomWallets(e){ie.customWallets=e},setIsSiweEnabled(e){ie.isSiweEnabled=e},setIsUniversalProvider(e){ie.isUniversalProvider=e},setSdkVersion(e){ie.sdkVersion=e},setMetadata(e){ie.metadata=e},setDisableAppend(e){ie.disableAppend=e},setEIP6963Enabled(e){ie.enableEIP6963=e},setDebug(e){ie.debug=e},setEnableWalletConnect(e){ie.enableWalletConnect=e},setEnableWalletGuide(e){ie.enableWalletGuide=e},setEnableAuthLogger(e){ie.enableAuthLogger=e},setEnableWallets(e){ie.enableWallets=e},setPreferUniversalLinks(e){ie.experimental_preferUniversalLinks=e},setSIWX(e){if(e)for(const[t,n]of Object.entries(Le.SIWX_DEFAULTS))e[t]??=n;ie.siwx=e},setConnectMethodsOrder(e){ie.features={...ie.features,connectMethodsOrder:e}},setWalletFeaturesOrder(e){ie.features={...ie.features,walletFeaturesOrder:e}},setSocialsOrder(e){ie.remoteFeatures={...ie.remoteFeatures,socials:e}},setCollapseWallets(e){ie.features={...ie.features,collapseWallets:e}},setEnableEmbedded(e){ie.enableEmbedded=e},setAllowUnsupportedChain(e){ie.allowUnsupportedChain=e},setManualWCControl(e){ie.manualWCControl=e},setEnableNetworkSwitch(e){ie.enableNetworkSwitch=e},setEnableReconnect(e){ie.enableReconnect=e},setDefaultAccountTypes(e={}){Object.entries(e).forEach(([t,n])=>{n&&(ie.defaultAccountTypes[t]=n)})},setUniversalProviderConfigOverride(e){ie.universalProviderConfigOverride=e},getUniversalProviderConfigOverride(){return ie.universalProviderConfigOverride},getSnapshot(){return Ec(ie)}},xF=Object.freeze({enabled:!0,events:[]}),_F=new dl({baseUrl:ce.getAnalyticsUrl(),clientId:null}),TF=5,OF=60*1e3,ws=Ze({...xF}),DF={state:ws,subscribeKey(e,t){return Ht(ws,e,t)},async sendError(e,t){if(!ws.enabled)return;const n=Date.now();if(ws.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<OF}).length>=TF)return;const s={type:"error",event:t,properties:{errorType:e.name,errorMessage:e.message,stackTrace:e.stack,timestamp:new Date().toISOString()}};ws.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=z.state;await _F.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:ce.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:t,errorType:e.name,errorMessage:e.message,stackTrace:e.stack}}})}catch{}},enable(){ws.enabled=!0},disable(){ws.enabled=!1},clearEvents(){ws.events=[]}};class qo extends Error{constructor(t,n,r){super(t),this.name="AppKitError",this.category=n,this.originalError=r,Object.setPrototypeOf(this,qo.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,qo):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function Zb(e,t){const n=e instanceof qo?e:new qo(e instanceof Error?e.message:String(e),t,e);throw DF.sendError(n,n.category),n}function _n(e,t="INTERNAL_SDK_ERROR"){const n={};return Object.keys(e).forEach(r=>{const s=e[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return Zb(a,t)}}:i=(...o)=>{try{return s(...o)}catch(a){return Zb(a,t)}},n[r]=i}else n[r]=s}),n}const Ei={ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},Er={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"}},PF={handleMobileDeeplinkRedirect(e,t){const n=window.location.href,r=encodeURIComponent(n);if(e===Er.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${Er.PHANTOM.url}/ul/browse/${r}?ref=${o}`}e===Er.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${Er.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),t===H.CHAIN.SOLANA&&e===Er.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${Er.COINBASE.url}/dapp?cb_url=${r}`)}},gn=Ze({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),$F={state:gn,subscribeNetworkImages(e){return Pt(gn.networkImages,()=>e(gn.networkImages))},subscribeKey(e,t){return Ht(gn,e,t)},subscribe(e){return Pt(gn,()=>e(gn))},setWalletImage(e,t){gn.walletImages[e]=t},setNetworkImage(e,t){gn.networkImages[e]=t},setChainImage(e,t){gn.chainImages[e]=t},setConnectorImage(e,t){gn.connectorImages={...gn.connectorImages,[e]:t}},setTokenImage(e,t){gn.tokenImages[e]=t},setCurrencyImage(e,t){gn.currencyImages[e]=t}},er=_n($F),kF={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},Qh=Ze({networkImagePromises:{}}),W2={async fetchWalletImage(e){if(e)return await he._fetchWalletImage(e),this.getWalletImageById(e)},async fetchNetworkImage(e){if(!e)return;const t=this.getNetworkImageById(e);return t||(Qh.networkImagePromises[e]||(Qh.networkImagePromises[e]=he._fetchNetworkImage(e)),await Qh.networkImagePromises[e],this.getNetworkImageById(e))},getWalletImageById(e){if(e)return er.state.walletImages[e]},getWalletImage(e){if(e?.image_url)return e?.image_url;if(e?.image_id)return er.state.walletImages[e.image_id]},getNetworkImage(e){if(e?.assets?.imageUrl)return e?.assets?.imageUrl;if(e?.assets?.imageId)return er.state.networkImages[e.assets.imageId]},getNetworkImageById(e){if(e)return er.state.networkImages[e]},getConnectorImage(e){if(e?.imageUrl)return e.imageUrl;if(e?.info?.icon)return e.info.icon;if(e?.imageId)return er.state.connectorImages[e.imageId]},getChainImage(e){return er.state.networkImages[kF[e]]}},ms=Ze({message:"",variant:"info",open:!1}),UF={state:ms,subscribeKey(e,t){return Ht(ms,e,t)},open(e,t){const{debug:n}=z.state,{code:r,displayMessage:s,debugMessage:i}=e;s&&n&&(ms.message=s,ms.variant=t,ms.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},close(){ms.open=!1,ms.message="",ms.variant="info"}},Ft=_n(UF),RF=ce.getAnalyticsUrl(),MF=new dl({baseUrl:RF,clientId:null}),LF=["MODAL_CREATED"],Hr=Ze({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),ze={state:Hr,subscribe(e){return Pt(Hr,()=>e(Hr))},getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:n}=z.state;return{projectId:e,st:t,sv:n||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(e){try{const t=ae.state.address;if(LF.includes(e.data.event)||typeof window>"u")return;await MF.post({path:"/e",params:ze.getSdkProperties(),body:{eventId:ce.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:e.timestamp,props:{...e.data,address:t}}}),Hr.reportedErrors.FORBIDDEN=!1}catch(t){t instanceof Error&&t.cause instanceof Response&&t.cause.status===H.HTTP_STATUS_CODES.FORBIDDEN&&!Hr.reportedErrors.FORBIDDEN&&(Ft.open({displayMessage:"Invalid App Configuration",debugMessage:`Origin ${_o()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Hr.reportedErrors.FORBIDDEN=!0)}},sendEvent(e){Hr.timestamp=Date.now(),Hr.data=e,(z.state.features?.analytics||e.event==="INITIALIZE")&&ze._sendAnalyticsEvent(Hr)}},BF=ce.getApiUrl(),Qt=new dl({baseUrl:BF,clientId:null}),jF=40,Jb=4,FF=20,ge=Ze({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),he={state:ge,subscribeKey(e,t){return Ht(ge,e,t)},_getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:n}=z.state;return{projectId:e,st:t||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(e){return z.state.isUniversalProvider?e.filter(t=>!!(t.mobile_link||t.desktop_link||t.webapp_link)):e},async _fetchWalletImage(e){const t=`${Qt.baseUrl}/getWalletImage/${e}`,n=await Qt.getBlob({path:t,params:he._getSdkProperties()});er.setWalletImage(e,URL.createObjectURL(n))},async _fetchNetworkImage(e){const t=`${Qt.baseUrl}/public/getAssetImage/${e}`,n=await Qt.getBlob({path:t,params:he._getSdkProperties()});er.setNetworkImage(e,URL.createObjectURL(n))},async _fetchConnectorImage(e){const t=`${Qt.baseUrl}/public/getAssetImage/${e}`,n=await Qt.getBlob({path:t,params:he._getSdkProperties()});er.setConnectorImage(e,URL.createObjectURL(n))},async _fetchCurrencyImage(e){const t=`${Qt.baseUrl}/public/getCurrencyImage/${e}`,n=await Qt.getBlob({path:t,params:he._getSdkProperties()});er.setCurrencyImage(e,URL.createObjectURL(n))},async _fetchTokenImage(e){const t=`${Qt.baseUrl}/public/getTokenImage/${e}`,n=await Qt.getBlob({path:t,params:he._getSdkProperties()});er.setTokenImage(e,URL.createObjectURL(n))},_filterWalletsByPlatform(e){return ce.isMobile()?e?.filter(n=>n.mobile_link||n.id===Er.COINBASE.id?!0:T.state.activeChain==="solana"&&(n.id===Er.SOLFLARE.id||n.id===Er.PHANTOM.id)):e},async fetchProjectConfig(){return(await Qt.get({path:"/appkit/v1/config",params:he._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:e}=await Qt.get({path:"/projects/v1/origins",params:he._getSdkProperties()});return e}catch(e){if(e instanceof Error&&e.cause instanceof Response){const t=e.cause.status;if(t===H.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:e});if(t>=H.HTTP_STATUS_CODES.SERVER_ERROR&&t<600)throw new Error("SERVER_ERROR",{cause:e});return[]}return[]}},async fetchNetworkImages(){const t=T.getAllRequestedCaipNetworks()?.map(({assets:n})=>n?.imageId).filter(Boolean).filter(n=>!W2.getNetworkImageById(n));t&&await Promise.allSettled(t.map(n=>he._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:e}=J.state,t=e.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(t.map(n=>he._fetchConnectorImage(n)))},async fetchCurrencyImages(e=[]){await Promise.allSettled(e.map(t=>he._fetchCurrencyImage(t)))},async fetchTokenImages(e=[]){await Promise.allSettled(e.map(t=>he._fetchTokenImage(t)))},async fetchWallets(e){const t=e.exclude??[];he._getSdkProperties().sv.startsWith("html-core-")&&t.push(...Object.values(Er).map(i=>i.id));const r=await Qt.get({path:"/getWallets",params:{...he._getSdkProperties(),...e,page:String(e.page),entries:String(e.entries),include:e.include?.join(","),exclude:t.join(",")}});return{data:he._filterWalletsByPlatform(r?.data)||[],count:r?.count}},async fetchFeaturedWallets(){const{featuredWalletIds:e}=z.state;if(e?.length){const t={...he._getSdkProperties(),page:1,entries:e?.length??Jb,include:e},{data:n}=await he.fetchWallets(t),r=[...n].sort((i,o)=>e.indexOf(i.id)-e.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>he._fetchWalletImage(i))),ge.featured=r,ge.allFeatured=r}},async fetchRecommendedWallets(){try{ge.isFetchingRecommendedWallets=!0;const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:n}=z.state,r=[...t??[],...n??[]].filter(Boolean),s=T.getRequestedCaipNetworkIds().join(","),i={page:1,entries:Jb,include:e,exclude:r,chains:s},{data:o,count:a}=await he.fetchWallets(i),c=W.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>he._fetchWalletImage(d))),ge.recommended=o,ge.allRecommended=o,ge.count=a??0}catch{}finally{ge.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:e}){const{includeWalletIds:t,excludeWalletIds:n,featuredWalletIds:r}=z.state,s=T.getRequestedCaipNetworkIds().join(","),i=[...ge.recommended.map(({id:u})=>u),...n??[],...r??[]].filter(Boolean),o={page:e,entries:jF,include:t,exclude:i,chains:s},{data:a,count:c}=await he.fetchWallets(o),l=a.slice(0,FF).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>he._fetchWalletImage(u))),ge.wallets=ce.uniqueBy([...ge.wallets,...he._filterOutExtensions(a)],"id").filter(u=>u.chains?.some(d=>s.includes(d))),ge.count=c>ge.count?c:ge.count,ge.page=e},async initializeExcludedWallets({ids:e}){const t={page:1,entries:e.length,include:e},{data:n}=await he.fetchWallets(t);n&&n.forEach(r=>{ge.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:e,badge:t}){const{includeWalletIds:n,excludeWalletIds:r}=z.state,s=T.getRequestedCaipNetworkIds().join(",");ge.search=[];const i={page:1,entries:100,search:e?.trim(),badge_type:t,include:n,exclude:r,chains:s},{data:o}=await he.fetchWallets(i);ze.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:t??"",search:e??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>he._fetchWalletImage(c)),ce.wait(300)]),ge.search=he._filterOutExtensions(o)},initPromise(e,t){const n=ge.promises[e];return n||(ge.promises[e]=t())},prefetch({fetchConnectorImages:e=!0,fetchFeaturedWallets:t=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0}={}){const s=[e&&he.initPromise("connectorImages",he.fetchConnectorImages),t&&he.initPromise("featuredWallets",he.fetchFeaturedWallets),n&&he.initPromise("recommendedWallets",he.fetchRecommendedWallets),r&&he.initPromise("networkImages",he.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){z.state.features?.analytics&&he.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:e}=await Qt.get({path:"/getAnalyticsConfig",params:he._getSdkProperties()});z.setFeatures({analytics:e})}catch{z.setFeatures({analytics:!1})}},filterByNamespaces(e){if(!e?.length){ge.featured=ge.allFeatured,ge.recommended=ge.allRecommended;return}const t=T.getRequestedCaipNetworkIds().join(",");ge.featured=ge.allFeatured.filter(n=>n.chains?.some(r=>t.includes(r))),ge.recommended=ge.allRecommended.filter(n=>n.chains?.some(r=>t.includes(r))),ge.filteredWallets=ge.wallets.filter(n=>n.chains?.some(r=>t.includes(r)))},clearFilterByNamespaces(){ge.filteredWallets=[]},setFilterByNamespace(e){if(!e){ge.featured=ge.allFeatured,ge.recommended=ge.allRecommended;return}const t=T.getRequestedCaipNetworkIds().join(",");ge.featured=ge.allFeatured.filter(n=>n.chains?.some(r=>t.includes(r))),ge.recommended=ge.allRecommended.filter(n=>n.chains?.some(r=>t.includes(r))),ge.filteredWallets=ge.wallets.filter(n=>n.chains?.some(r=>t.includes(r)))}},Fe=Ze({view:"Connect",history:["Connect"],transactionStack:[]}),zF={state:Fe,subscribeKey(e,t){return Ht(Fe,e,t)},pushTransactionStack(e){Fe.transactionStack.push(e)},popTransactionStack(e){const t=Fe.transactionStack.pop();if(!t)return;const{onSuccess:n,onError:r,onCancel:s}=t;switch(e){case"success":n?.();break;case"error":r?.(),pe.goBack();break;case"cancel":s?.(),pe.goBack();break}},push(e,t){e!==Fe.view&&(Fe.view=e,Fe.history.push(e),Fe.data=t)},reset(e,t){Fe.view=e,Fe.history=[e],Fe.data=t},replace(e,t){Fe.history.at(-1)===e||(Fe.view=e,Fe.history[Fe.history.length-1]=e,Fe.data=t)},goBack(){const e=T.state.activeCaipAddress,t=pe.state.view==="ConnectingFarcaster",n=!e&&t;if(Fe.history.length>1){Fe.history.pop();const[r]=Fe.history.slice(-1);r&&(e&&r==="Connect"?Fe.view="Account":Fe.view=r)}else Ae.close();Fe.data?.wallet&&(Fe.data.wallet=void 0),setTimeout(()=>{if(n){ae.setFarcasterUrl(void 0,T.state.activeChain);const r=J.getAuthConnector();r?.provider?.reload();const s=Ec(z.state);r?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(e){if(Fe.history.length>1){Fe.history=Fe.history.slice(0,e+1);const[t]=Fe.history.slice(-1);t&&(Fe.view=t)}},goBackOrCloseModal(){pe.state.history.length>1?pe.goBack():Ae.close()}},pe=_n(zF),qr=Ze({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Pp={state:qr,subscribe(e){return Pt(qr,()=>e(qr))},setThemeMode(e){qr.themeMode=e;try{const t=J.getAuthConnector();if(t){const n=Pp.getSnapshot().themeVariables;t.provider.syncTheme({themeMode:e,themeVariables:n,w3mThemeVariables:Ts(n,e)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(e){qr.themeVariables={...qr.themeVariables,...e};try{const t=J.getAuthConnector();if(t){const n=Pp.getSnapshot().themeVariables;t.provider.syncTheme({themeVariables:n,w3mThemeVariables:Ts(qr.themeVariables,qr.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Ec(qr)}},yn=_n(Pp),V2=Object.fromEntries(j2.map(e=>[e,void 0])),HF=Object.fromEntries(j2.map(e=>[e,!0])),De=Ze({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:V2,filterByNamespaceMap:HF}),qF={state:De,subscribe(e){return Pt(De,()=>{e(De)})},subscribeKey(e,t){return Ht(De,e,t)},initialize(e){e.forEach(t=>{const n=W.getConnectedConnectorId(t);n&&J.setConnectorId(n,t)})},setActiveConnector(e){e&&(De.activeConnector=$i(e))},setConnectors(e){e.filter(s=>!De.allConnectors.some(i=>i.id===s.id&&J.getConnectorName(i.name)===J.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&De.allConnectors.push($i(s))});const n=J.getEnabledNamespaces(),r=J.getEnabledConnectors(n);De.connectors=J.mergeMultiChainConnectors(r)},filterByNamespaces(e){Object.keys(De.filterByNamespaceMap).forEach(t=>{De.filterByNamespaceMap[t]=!1}),e.forEach(t=>{De.filterByNamespaceMap[t]=!0}),J.updateConnectorsForEnabledNamespaces()},filterByNamespace(e,t){De.filterByNamespaceMap[e]=t,J.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const e=J.getEnabledNamespaces(),t=J.getEnabledConnectors(e),n=J.areAllNamespacesEnabled();De.connectors=J.mergeMultiChainConnectors(t),n?he.clearFilterByNamespaces():he.filterByNamespaces(e)},getEnabledNamespaces(){return Object.entries(De.filterByNamespaceMap).filter(([e,t])=>t).map(([e])=>e)},getEnabledConnectors(e){return De.allConnectors.filter(t=>e.includes(t.chain))},areAllNamespacesEnabled(){return Object.values(De.filterByNamespaceMap).every(e=>e)},mergeMultiChainConnectors(e){const t=J.generateConnectorMapByName(e),n=[];return t.forEach(r=>{const s=r[0],i=s?.id===H.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&n.push(s)}),n},generateConnectorMapByName(e){const t=new Map;return e.forEach(n=>{const{name:r}=n,s=J.getConnectorName(r);if(!s)return;const i=t.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),t.set(s,i)}),t},getConnectorName(e){return e&&({"Trust Wallet":"Trust"}[e]||e)},getUniqueConnectorsByName(e){const t=[];return e.forEach(n=>{t.find(r=>r.chain===n.chain)||t.push(n)}),t},addConnector(e){if(e.id===H.CONNECTOR_ID.AUTH){const t=e,n=Ec(z.state),r=yn.getSnapshot().themeMode,s=yn.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),t?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Ts(s,r)}),J.setConnectors([e])}else J.setConnectors([e])},getAuthConnector(e){const t=e||T.state.activeChain,n=De.connectors.find(r=>r.id===H.CONNECTOR_ID.AUTH);if(n)return n?.connectors?.length?n.connectors.find(s=>s.chain===t):n},getAnnouncedConnectorRdns(){return De.connectors.filter(e=>e.type==="ANNOUNCED").map(e=>e.info?.rdns)},getConnectorById(e){return De.allConnectors.find(t=>t.id===e)},getConnector({id:e,rdns:t,namespace:n}){const r=n||T.state.activeChain;return De.allConnectors.filter(i=>i.chain===r).find(i=>i.explorerId===e||i.info?.rdns===t)},syncIfAuthConnector(e){if(e.id!=="ID_AUTH")return;const t=e,n=Ec(z.state),r=yn.getSnapshot().themeMode,s=yn.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),t.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Ts(s,r)})},getConnectorsByNamespace(e){const t=De.allConnectors.filter(n=>n.chain===e);return J.mergeMultiChainConnectors(t)},canSwitchToSmartAccount(e){return T.checkIfSmartAccountEnabled()&&Or(e)===Ei.ACCOUNT_TYPES.EOA},selectWalletConnector(e){const t=J.getConnector({id:e.id,rdns:e.rdns});PF.handleMobileDeeplinkRedirect(t?.explorerId||e.id,T.state.activeChain),t?pe.push("ConnectingExternal",{connector:t,wallet:e}):pe.push("ConnectingWalletConnect",{wallet:e})},getConnectors(e){return e?J.getConnectorsByNamespace(e):J.mergeMultiChainConnectors(De.allConnectors)},setFilterByNamespace(e){De.filterByNamespace=e,De.connectors=J.getConnectors(e),he.setFilterByNamespace(e)},setConnectorId(e,t){e&&(De.activeConnectorIds={...De.activeConnectorIds,[t]:e},W.setConnectedConnectorId(t,e))},removeConnectorId(e){De.activeConnectorIds={...De.activeConnectorIds,[e]:void 0},W.deleteConnectedConnectorId(e)},getConnectorId(e){if(e)return De.activeConnectorIds[e]},isConnected(e){return e?!!De.activeConnectorIds[e]:Object.values(De.activeConnectorIds).some(t=>!!t)},resetConnectorIds(){De.activeConnectorIds={...V2}}},J=_n(qF),WF=1e3,$a={checkNamespaceConnectorId(e,t){return J.getConnectorId(e)===t},isSocialProvider(e){return Le.DEFAULT_REMOTE_FEATURES.socials.includes(e)},connectWalletConnect({walletConnect:e,connector:t,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(e&&J.setActiveConnector(t),s?.(ce.isMobile()&&e),r){const l=Ae.subscribeKey("open",u=>{u||(pe.state.view!==r&&pe.replace(r),l(),a(new Error("Modal closed")))})}const c=T.subscribeKey("activeCaipAddress",l=>{l&&(i?.(),n&&Ae.close(),c(),o(En.parseCaipAddress(l)))})})},connectExternal(e){return new Promise((t,n)=>{const r=T.subscribeKey("activeCaipAddress",s=>{s&&(Ae.close(),r(),t(En.parseCaipAddress(s)))});X.connectExternal(e,e.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:e,namespace:t,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){let i=ae.state.socialWindow,o=ae.state.socialProvider,a=!1,c=null;const l=t||T.state.activeChain,u=T.subscribeKey("activeCaipAddress",d=>{d&&(n&&Ae.close(),u())});return new Promise((d,h)=>{async function p(g){if(g.data?.resultUri)if(g.origin===H.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",p,!1);try{const w=J.getAuthConnector(l);if(w&&!a){i&&(i.close(),ae.setSocialWindow(void 0,l),i=ae.state.socialWindow),a=!0;const b=g.data.resultUri;if(o&&ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:o}}),o){W.setConnectedSocialProvider(o),await X.connectExternal({id:w.id,type:w.type,socialUri:b},w.chain);const I=T.state.activeCaipAddress;if(!I){h(new Error("Failed to connect"));return}d(En.parseCaipAddress(I)),ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:o,caipNetworkId:T.getActiveCaipNetwork()?.caipNetworkId}})}}}catch{o&&ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}}),h(new Error("Failed to connect"))}}else o&&ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}})}async function f(){if(e&&(ae.setSocialProvider(e,l),o=ae.state.socialProvider,ze.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:o}})),o==="farcaster"){r?.();const g=Ae.subscribeKey("open",b=>{!b&&e==="farcaster"&&(h(new Error("Popup closed")),s?.(),g())}),w=J.getAuthConnector();if(w&&!ae.state.farcasterUrl)try{const{url:b}=await w.provider.getFarcasterUri();ae.setFarcasterUrl(b,l)}catch{h(new Error("Failed to connect to farcaster"))}}else{const g=J.getAuthConnector();c=ce.returnOpenHref(`${H.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(g&&o){const{uri:w}=await g.provider.getSocialRedirectUri({provider:o});if(c&&w){ae.setSocialWindow(c,l),i=ae.state.socialWindow,c.location.href=w;const b=setInterval(()=>{i?.closed&&!a&&(h(new Error("Popup closed")),clearInterval(b))},1e3);window.addEventListener("message",p,!1)}else c?.close(),h(new Error("Failed to initiate social connection"))}}catch{h(new Error("Failed to initiate social connection")),c?.close()}}}f()})},connectEmail({closeModalOnConnect:e=!0,redirectViewOnModalClose:t="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n?.(),t){const a=Ae.subscribeKey("open",c=>{c||(pe.state.view!==t&&pe.replace(t),a(),i(new Error("Modal closed")))})}const o=T.subscribeKey("activeCaipAddress",a=>{a&&(r?.(),e&&Ae.close(),o(),s(En.parseCaipAddress(a)))})})},async updateEmail(){const e=W.getConnectedConnectorId(T.state.activeChain),t=J.getAuthConnector();if(!t)throw new Error("No auth connector found");if(e!==H.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=t.provider.getEmail()??"";return await Ae.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=t.provider.getEmail()??"";a!==n&&(Ae.close(),clearInterval(i),o(),r({email:a}))},WF),o=Ae.subscribeKey("open",a=>{a||(pe.state.view!=="Connect"&&pe.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(e){return T.checkIfSmartAccountEnabled()&&Or(e)===Ei.ACCOUNT_TYPES.EOA}};function K2(){const e=T.state.activeCaipNetwork?.chainNamespace||"eip155",t=T.state.activeCaipNetwork?.id||1,n=Le.NATIVE_TOKEN_ADDRESS[e];return`${e}:${t}:${n}`}function Or(e){return T.getAccountData(e)?.preferredAccountType}function Xb(e){return T.state.activeCaipNetwork}const Gu={getConnectionStatus(e,t){const n=J.state.activeConnectorIds[t],r=X.getConnections(t);return!!n&&e.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===e.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:e,connectorId:t,addresses:n}){return e.map(r=>{if((t?r.connectorId.toLowerCase()===t.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(e,t){const n=new Set(e);return t.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(e,t){return e.filter(n=>n.connectorId.toLowerCase()===t.toLowerCase())},getConnectionsData(e){const t=!!z.state.remoteFeatures?.multiWallet,n=J.state.activeConnectorIds[e],r=X.getConnections(e),i=(X.state.recentConnections.get(e)??[]).filter(a=>J.getConnectorById(a.connectorId)),o=Gu.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return t?{connections:r,recentConnections:o}:{connections:r.filter(a=>a.connectorId.toLowerCase()===n?.toLowerCase()),recentConnections:[]}}},ri=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),ft=Ze({...ri}),VF={state:ft,subscribeKey(e,t){return Ht(ft,e,t)},showLoading(e,t={}){this._showMessage({message:e,variant:"loading",...t})},showSuccess(e){this._showMessage({message:e,variant:"success"})},showSvg(e,t){this._showMessage({message:e,svg:t})},showError(e){const t=ce.parseError(e);this._showMessage({message:t,variant:"error"})},hide(){ft.message=ri.message,ft.variant=ri.variant,ft.svg=ri.svg,ft.open=ri.open,ft.autoClose=ri.autoClose},_showMessage({message:e,svg:t,variant:n="success",autoClose:r=ri.autoClose}){ft.open?(ft.open=!1,setTimeout(()=>{ft.message=e,ft.variant=n,ft.svg=t,ft.open=!0,ft.autoClose=r},150)):(ft.message=e,ft.variant=n,ft.svg=t,ft.open=!0,ft.autoClose=r)}},Ir=VF,Qe=Ze({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),KF={state:Qe,subscribe(e){return Pt(Qe,()=>e(Qe))},setLastNetworkInView(e){Qe.lastNetworkInView=e},async fetchTransactions(e){if(!e)throw new Error("Transactions can't be fetched without an accountAddress");Qe.loading=!0;try{const t=await fe.fetchTransactions({account:e,cursor:Qe.next,chainId:T.state.activeCaipNetwork?.caipNetworkId}),n=yu.filterSpamTransactions(t.data),r=yu.filterByConnectedChain(n),s=[...Qe.transactions,...r];Qe.loading=!1,Qe.transactions=s,Qe.transactionsByYear=yu.groupTransactionsByYearAndMonth(Qe.transactionsByYear,r),Qe.empty=s.length===0,Qe.next=t.next?t.next:void 0}catch{const n=T.state.activeChain;ze.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:e,projectId:z.state.projectId,cursor:Qe.next,isSmartAccount:Or(n)===Ei.ACCOUNT_TYPES.SMART_ACCOUNT}}),Ir.showError("Failed to fetch transactions"),Qe.loading=!1,Qe.empty=!0,Qe.next=void 0}},groupTransactionsByYearAndMonth(e={},t=[]){const n=e;return t.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(e){return e.filter(t=>!t.transfers.every(r=>r.nft_info?.flags.is_spam===!0))},filterByConnectedChain(e){const t=T.state.activeCaipNetwork?.caipNetworkId;return e.filter(r=>r.metadata.chain===t)},clearCursor(){Qe.next=void 0},resetTransactions(){Qe.transactions=[],Qe.transactionsByYear={},Qe.lastNetworkInView=void 0,Qe.loading=!1,Qe.empty=!1,Qe.next=void 0}},yu=_n(KF,"API_ERROR"),Pe=Ze({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let Qs;const GF={state:Pe,subscribe(e){return Pt(Pe,()=>e(Pe))},subscribeKey(e,t){return Ht(Pe,e,t)},_getClient(){return Pe._client},setClient(e){Pe._client=$i(e)},initialize(e){const t=e.filter(n=>!!n.namespace).map(n=>n.namespace);X.syncStorageConnections(t)},syncStorageConnections(e){const t=W.getConnections(),n=e??Array.from(T.state.chains.keys());for(const r of n){const s=t[r]??[],i=new Map(Pe.recentConnections);i.set(r,s),Pe.recentConnections=i}},getConnections(e){return e?Pe.connections.get(e)??[]:[]},hasAnyConnection(e){const t=X.state.connections;return Array.from(t.values()).flatMap(n=>n).some(({connectorId:n})=>n===e)},async connectWalletConnect(){if(ce.isTelegram()||ce.isSafari()&&ce.isIos()){if(Qs){await Qs,Qs=void 0;return}if(!ce.isPairingExpired(Pe?.wcPairingExpiry)){const e=Pe.wcUri;Pe.wcUri=e;return}Qs=X._getClient()?.connectWalletConnect?.().catch(()=>{}),X.state.status="connecting",await Qs,Qs=void 0,Pe.wcPairingExpiry=void 0,X.state.status="connected"}else await X._getClient()?.connectWalletConnect?.()},async connectExternal(e,t,n=!0){const r=await X._getClient()?.connectExternal?.(e);return n&&T.setActiveNamespace(t),r},async reconnectExternal(e){await X._getClient()?.reconnectExternal?.(e);const t=e.chain||T.state.activeChain;t&&J.setConnectorId(e.id,t)},async setPreferredAccountType(e,t){if(!t)return;Ae.setLoading(!0,T.state.activeChain);const n=J.getAuthConnector();n&&(ae.setPreferredAccountType(e,t),await n.provider.setPreferredAccount(e),W.setPreferredAccountTypes(Object.entries(T.state.chains).reduce((r,[s,i])=>{const o=s,a=Or(o);return a!==void 0&&(r[o]=a),r},{})),await X.reconnectExternal(n),Ae.setLoading(!1,T.state.activeChain),ze.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:e,network:T.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(e){return X._getClient()?.signMessage(e)},parseUnits(e,t){return X._getClient()?.parseUnits(e,t)},formatUnits(e,t){return X._getClient()?.formatUnits(e,t)},async sendTransaction(e){return X._getClient()?.sendTransaction(e)},async getCapabilities(e){return X._getClient()?.getCapabilities(e)},async grantPermissions(e){return X._getClient()?.grantPermissions(e)},async walletGetAssets(e){return X._getClient()?.walletGetAssets(e)??{}},async estimateGas(e){return X._getClient()?.estimateGas(e)},async writeContract(e){return X._getClient()?.writeContract(e)},async getEnsAddress(e){return X._getClient()?.getEnsAddress(e)},async getEnsAvatar(e){return X._getClient()?.getEnsAvatar(e)},checkInstalled(e){return X._getClient()?.checkInstalled?.(e)||!1},resetWcConnection(){Pe.wcUri=void 0,Pe.wcPairingExpiry=void 0,Pe.wcLinking=void 0,Pe.recentWallet=void 0,Pe.status="disconnected",yu.resetTransactions(),W.deleteWalletConnectDeepLink()},resetUri(){Pe.wcUri=void 0,Pe.wcPairingExpiry=void 0,Qs=void 0},finalizeWcConnection(){const{wcLinking:e,recentWallet:t}=X.state;e&&W.setWalletConnectDeepLink(e),t&&W.setAppKitRecent(t),ze.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:e?"mobile":"qrcode",name:pe.state.data?.wallet?.name||"Unknown",caipNetworkId:T.getActiveCaipNetwork()?.caipNetworkId}})},setWcBasic(e){Pe.wcBasic=e},setUri(e){Pe.wcUri=e,Pe.wcPairingExpiry=ce.getPairingExpiry()},setWcLinking(e){Pe.wcLinking=e},setWcError(e){Pe.wcError=e,Pe.buffering=!1},setRecentWallet(e){Pe.recentWallet=e},setBuffering(e){Pe.buffering=e},setStatus(e){Pe.status=e},setIsSwitchingConnection(e){Pe.isSwitchingConnection=e},async disconnect({id:e,namespace:t,initialDisconnect:n}={}){try{await X._getClient()?.disconnect({id:e,chainNamespace:t,initialDisconnect:n})}catch(r){throw new qo("Failed to disconnect","INTERNAL_SDK_ERROR",r)}},setConnections(e,t){const n=new Map(Pe.connections);n.set(t,e),Pe.connections=n},async handleAuthAccountSwitch({address:e,namespace:t}){const n=ae.state.user?.accounts?.find(s=>s.type==="smartAccount"),r=n&&n.address.toLowerCase()===e.toLowerCase()&&$a.canSwitchToSmartAccount(t)?"smartAccount":"eoa";await X.setPreferredAccountType(r,t)},async handleActiveConnection({connection:e,namespace:t,address:n}){const r=J.getConnectorById(e.connectorId),s=e.connectorId===H.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${e.connectorId}`);if(s)s&&n&&await X.handleAuthAccountSwitch({address:n,namespace:t});else return(await X.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:t},t))?.address;return n},async handleDisconnectedConnection({connection:e,namespace:t,address:n,closeModalOnConnect:r}){const s=J.getConnectorById(e.connectorId),i=e.auth?.name?.toLowerCase(),o=e.connectorId===H.CONNECTOR_ID.AUTH,a=e.connectorId===H.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${e.connectorId}`);let c;if(o)if(i&&$a.isSocialProvider(i)){const{address:l}=await $a.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Ae.open({view:"ConnectingFarcaster"})},onConnect(){pe.replace("ProfileWallets")}});c=l}else{const{address:l}=await $a.connectEmail({closeModalOnConnect:r,onOpen(){Ae.open({view:"EmailLogin"})},onConnect(){pe.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await $a.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(u){Ae.open({view:u?"AllWallets":"ConnectingWalletConnect"})},onConnect(){pe.replace("ProfileWallets")}});c=l}else{const l=await X.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:t},t);l&&(c=l.address)}return o&&n&&await X.handleAuthAccountSwitch({address:n,namespace:t}),c},async switchConnection({connection:e,address:t,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=ae.getCaipAddress(n);if(o){const{address:c}=En.parseCaipAddress(o);i=c}const a=Gu.getConnectionStatus(e,n);switch(a){case"connected":case"active":{const c=await X.handleActiveConnection({connection:e,namespace:n,address:t});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:n,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await X.handleDisconnectedConnection({connection:e,namespace:n,address:t,closeModalOnConnect:r});c&&s?.({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},X=_n(GF),go=Ze({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Yr={state:go,subscribe(e){return Pt(go,()=>e(go))},subscribeOpen(e){return Ht(go,"open",e)},set(e){Object.assign(go,{...go,...e})}},YF={async getTokenList(){const e=T.state.activeCaipNetwork;return(await fe.fetchSwapTokens({chainId:e?.caipNetworkId}))?.tokens?.map(r=>({...r,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const e=T.state.activeCaipNetwork;if(!e)return null;try{switch(e.chainNamespace){case"solana":const t=(await X?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:t,fast:t,instant:t};case"eip155":default:return await fe.fetchGasPrice({chainId:e.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:e,userAddress:t,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await fe.fetchSwapAllowance({tokenAddress:e,userAddress:t});if(s?.allowance&&n&&r){const i=X.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(e){const t=await nw.getMyTokensWithBalance(e);return ae.setTokenBalance(t,T.state.activeChain),this.mapBalancesToSwapTokens(t)},mapBalancesToSwapTokens(e){return e?.map(t=>({...t,address:t?.address?t.address:K2(),decimals:parseInt(t.quantity.decimals,10),logoUri:t.iconUrl,eip2612:!1}))||[]}},Be=Ze({tokenBalances:[],loading:!1}),ZF={state:Be,subscribe(e){return Pt(Be,()=>e(Be))},subscribeKey(e,t){return Ht(Be,e,t)},setToken(e){e&&(Be.token=$i(e))},setTokenAmount(e){Be.sendTokenAmount=e},setReceiverAddress(e){Be.receiverAddress=e},setReceiverProfileImageUrl(e){Be.receiverProfileImageUrl=e},setReceiverProfileName(e){Be.receiverProfileName=e},setNetworkBalanceInUsd(e){Be.networkBalanceInUSD=e},setLoading(e){Be.loading=e},async sendToken(){try{switch(ke.setLoading(!0),T.state.activeCaipNetwork?.chainNamespace){case"eip155":await ke.sendEvmToken();return;case"solana":await ke.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{ke.setLoading(!1)}},async sendEvmToken(){const e=T.state.activeChain;if(!e)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const t=Or(e);if(!ke.state.sendTokenAmount||!ke.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!ke.state.token)throw new Error("A token is required");ke.state.token?.address?(ze.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===Ei.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token.address,amount:ke.state.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),await ke.sendERC20Token({receiverAddress:ke.state.receiverAddress,tokenAddress:ke.state.token.address,sendTokenAmount:ke.state.sendTokenAmount,decimals:ke.state.token.quantity.decimals})):(ze.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===Ei.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token.symbol||"",amount:ke.state.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),await ke.sendNativeToken({receiverAddress:ke.state.receiverAddress,sendTokenAmount:ke.state.sendTokenAmount,decimals:ke.state.token.quantity.decimals}))},async fetchTokenBalance(e){Be.loading=!0;const t=T.state.activeCaipNetwork?.caipNetworkId,n=T.state.activeCaipNetwork?.chainNamespace,r=T.state.activeCaipAddress,s=r?ce.getPlainAddress(r):void 0;if(Be.lastRetry&&!ce.isAllowedRetry(Be.lastRetry,30*Le.ONE_SEC_MS))return Be.loading=!1,[];try{if(s&&t&&n){const i=await nw.getMyTokensWithBalance();return Be.tokenBalances=i,Be.lastRetry=void 0,i}}catch(i){Be.lastRetry=Date.now(),e?.(i),Ir.showError("Token Balance Unavailable")}finally{Be.loading=!1}return[]},fetchNetworkBalance(){if(Be.tokenBalances.length===0)return;const e=YF.mapBalancesToSwapTokens(Be.tokenBalances);if(!e)return;const t=e.find(n=>n.address===K2());t&&(Be.networkBalanceInUSD=t?aF.multiply(t.quantity.numeric,t.price).toString():"0")},async sendNativeToken(e){pe.pushTransactionStack({});const t=e.receiverAddress,n=ae.state.address,r=X.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));await X.sendTransaction({chainNamespace:H.CHAIN.EVM,to:t,address:n,data:"0x",value:r??BigInt(0)}),ze.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:Or("eip155")===Ei.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token?.symbol||"",amount:e.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),X._getClient()?.updateBalance("eip155"),ke.resetSend()},async sendERC20Token(e){pe.pushTransactionStack({onSuccess(){pe.replace("Account")}});const t=X.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));if(ae.state.address&&e.sendTokenAmount&&e.receiverAddress&&e.tokenAddress){const n=ce.getPlainAddress(e.tokenAddress);if(!n)throw new Error("SendController:sendERC20Token - tokenAddress is required");await X.writeContract({fromAddress:ae.state.address,tokenAddress:n,args:[e.receiverAddress,t??BigInt(0)],method:"transfer",abi:dF.getERC20Abi(n),chainNamespace:H.CHAIN.EVM}),ke.resetSend()}},async sendSolanaToken(){if(!ke.state.sendTokenAmount||!ke.state.receiverAddress)throw new Error("An amount and receiver address are required");pe.pushTransactionStack({onSuccess(){pe.replace("Account")}}),await X.sendTransaction({chainNamespace:"solana",to:ke.state.receiverAddress,value:ke.state.sendTokenAmount}),X._getClient()?.updateBalance("solana"),ke.resetSend()},resetSend(){Be.token=void 0,Be.sendTokenAmount=void 0,Be.receiverAddress=void 0,Be.receiverProfileImageUrl=void 0,Be.receiverProfileName=void 0,Be.loading=!1,Be.tokenBalances=[]}},ke=_n(ZF),ef={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},eu={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},Q=Ze({chains:IF(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),JF={state:Q,subscribe(e){return Pt(Q,()=>{e(Q)})},subscribeKey(e,t){return Ht(Q,e,t)},subscribeChainProp(e,t,n){let r;return Pt(Q.chains,()=>{const s=n||Q.activeChain;if(s){const i=Q.chains.get(s)?.[e];r!==i&&(r=i,t(i))}})},initialize(e,t,n){const{chainId:r,namespace:s}=W.getActiveNetworkProps(),i=t?.find(u=>u.id.toString()===r?.toString()),a=e.find(u=>u?.namespace===s)||e?.[0],c=e.map(u=>u.namespace).filter(u=>u!==void 0),l=z.state.enableEmbedded?new Set([...c]):new Set([...t?.map(u=>u.chainNamespace)??[]]);(e?.length===0||!a)&&(Q.noAdapters=!0),Q.noAdapters||(Q.activeChain=a?.namespace,Q.activeCaipNetwork=i,T.setChainNetworkData(a?.namespace,{caipNetwork:i}),Q.activeChain&&Yr.set({activeChain:a?.namespace})),l.forEach(u=>{const d=t?.filter(f=>f.chainNamespace===u),h=W.getPreferredAccountTypes()||{},p={...z.state.defaultAccountTypes,...h};T.state.chains.set(u,{namespace:u,networkState:Ze({...eu,caipNetwork:d?.[0]}),accountState:Ze({...ef,preferredAccountType:p[u]}),caipNetworks:d??[],...n}),T.setRequestedCaipNetworks(d??[],u)})},removeAdapter(e){if(Q.activeChain===e){const t=Array.from(Q.chains.entries()).find(([n])=>n!==e);if(t){const n=t[1]?.caipNetworks?.[0];n&&T.setActiveCaipNetwork(n)}}Q.chains.delete(e)},addAdapter(e,{networkControllerClient:t,connectionControllerClient:n},r){if(!e.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");Q.chains.set(e.namespace,{namespace:e.namespace,networkState:{...eu,caipNetwork:r[0]},accountState:ef,caipNetworks:r,connectionControllerClient:n,networkControllerClient:t}),T.setRequestedCaipNetworks(r?.filter(s=>s.chainNamespace===e.namespace)??[],e.namespace)},addNetwork(e){const t=Q.chains.get(e.chainNamespace);if(t){const n=[...t.caipNetworks||[]];t.caipNetworks?.find(r=>r.id===e.id)||n.push(e),Q.chains.set(e.chainNamespace,{...t,caipNetworks:n}),T.setRequestedCaipNetworks(n,e.chainNamespace),J.filterByNamespace(e.chainNamespace,!0)}},removeNetwork(e,t){const n=Q.chains.get(e);if(n){const r=Q.activeCaipNetwork?.id===t,s=[...n.caipNetworks?.filter(i=>i.id!==t)||[]];r&&n?.caipNetworks?.[0]&&T.setActiveCaipNetwork(n.caipNetworks[0]),Q.chains.set(e,{...n,caipNetworks:s}),T.setRequestedCaipNetworks(s||[],e),s.length===0&&J.filterByNamespace(e,!1)}},setAdapterNetworkState(e,t){const n=Q.chains.get(e);n&&(n.networkState={...n.networkState||eu,...t},Q.chains.set(e,n))},setChainAccountData(e,t,n=!0){if(!e)throw new Error("Chain is required to update chain account data");const r=Q.chains.get(e);if(r){const s={...r.accountState||ef,...t};Q.chains.set(e,{...r,accountState:s}),(Q.chains.size===1||Q.activeChain===e)&&(t.caipAddress&&(Q.activeCaipAddress=t.caipAddress),ae.replaceState(s))}},setChainNetworkData(e,t){if(!e)return;const n=Q.chains.get(e);if(n){const r={...n.networkState||eu,...t};Q.chains.set(e,{...n,networkState:r})}},setAccountProp(e,t,n,r=!0){T.setChainAccountData(n,{[e]:t},r)},setActiveNamespace(e){Q.activeChain=e;const t=e?Q.chains.get(e):void 0,n=t?.networkState?.caipNetwork;n?.id&&e&&(Q.activeCaipAddress=t?.accountState?.caipAddress,Q.activeCaipNetwork=n,T.setChainNetworkData(e,{caipNetwork:n}),W.setActiveCaipNetworkId(n?.caipNetworkId),Yr.set({activeChain:e,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(e){if(!e)return;Q.activeChain!==e.chainNamespace&&T.setIsSwitchingNamespace(!0);const t=Q.chains.get(e.chainNamespace);Q.activeChain=e.chainNamespace,Q.activeCaipNetwork=e,T.setChainNetworkData(e.chainNamespace,{caipNetwork:e}),t?.accountState?.address?Q.activeCaipAddress=`${e.chainNamespace}:${e.id}:${t?.accountState?.address}`:Q.activeCaipAddress=void 0,T.setAccountProp("caipAddress",Q.activeCaipAddress,e.chainNamespace),t&&ae.replaceState(t.accountState),ke.resetSend(),Yr.set({activeChain:Q.activeChain,selectedNetworkId:Q.activeCaipNetwork?.caipNetworkId}),W.setActiveCaipNetworkId(e.caipNetworkId),!T.checkIfSupportedNetwork(e.chainNamespace)&&z.state.enableNetworkSwitch&&!z.state.allowUnsupportedChain&&!X.state.wcBasic&&T.showUnsupportedChainUI()},addCaipNetwork(e){if(!e)return;const t=Q.chains.get(e.chainNamespace);t&&t?.caipNetworks?.push(e)},async switchActiveNamespace(e){if(!e)return;const t=e!==T.state.activeChain,n=T.getNetworkData(e)?.caipNetwork,r=T.getCaipNetworkByNamespace(e,n?.id);t&&r&&await T.switchActiveNetwork(r)},async switchActiveNetwork(e){const t=T.state.activeChain;if(!t)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=!T.state.chains.get(t)?.caipNetworks?.some(i=>i.id===Q.activeCaipNetwork?.id),s=T.getNetworkControllerClient(e.chainNamespace);if(s){try{await s.switchCaipNetwork(e),r&&Ae.close()}catch{pe.goBack()}ze.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:e.caipNetworkId}})}},getNetworkControllerClient(e){const t=e||Q.activeChain;if(!t)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=Q.chains.get(t);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(e){const t=e||Q.activeChain;if(!t)throw new Error("Chain is required to get connection controller client");const n=Q.chains.get(t);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(e,t){const n=Q.chains.get(t)?.networkState;if(n)return n[e]},getRequestedCaipNetworks(e){const t=Q.chains.get(e),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=t?.networkState||{};return ce.sortRequestedNetworks(n,r).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const e=[];return Q.chains.forEach(t=>{if(!t.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=T.getRequestedCaipNetworks(t.namespace);e.push(...n)}),e},setRequestedCaipNetworks(e,t){T.setAdapterNetworkState(t,{requestedCaipNetworks:e});const r=T.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));J.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const e=[];return Q.chains.forEach(t=>{if(!t.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=T.getApprovedCaipNetworkIds(t.namespace);e.push(...n)}),e},getActiveCaipNetwork(e){return e?Q.chains.get(e)?.networkState?.caipNetwork:Q.activeCaipNetwork},getActiveCaipAddress(){return Q.activeCaipAddress},getApprovedCaipNetworkIds(e){return Q.chains.get(e)?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(e){const n=await T.getNetworkControllerClient()?.getApprovedCaipNetworksData();T.setAdapterNetworkState(e,{approvedCaipNetworkIds:n?.approvedCaipNetworkIds,supportsAllNetworks:n?.supportsAllNetworks})},checkIfSupportedNetwork(e,t){const n=t||Q.activeCaipNetwork?.caipNetworkId,r=T.getRequestedCaipNetworks(e);return r.length?r?.some(s=>s.caipNetworkId===n):!0},checkIfSupportedChainId(e){return Q.activeChain?T.getRequestedCaipNetworks(Q.activeChain)?.some(n=>n.id===e):!0},setSmartAccountEnabledNetworks(e,t){T.setAdapterNetworkState(t,{smartAccountEnabledNetworks:e})},checkIfSmartAccountEnabled(){const e=B2.caipNetworkIdToNumber(Q.activeCaipNetwork?.caipNetworkId),t=Q.activeChain;return!t||!e?!1:!!T.getNetworkProp("smartAccountEnabledNetworks",t)?.includes(Number(e))},showUnsupportedChainUI(){Ae.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const e=Q.activeCaipNetwork;return!!(e?.chainNamespace&&Le.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(e.chainNamespace))},resetNetwork(e){T.setAdapterNetworkState(e,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(e){const t=e;if(!t)throw new Error("Chain is required to set account prop");const n=T.state.chains.get(t)?.accountState?.preferredAccountType,r=z.state.defaultAccountTypes[t];Q.activeCaipAddress=void 0,T.setChainAccountData(t,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),J.removeConnectorId(t)},setIsSwitchingNamespace(e){Q.isSwitchingNamespace=e},getFirstCaipNetworkSupportsAuthConnector(){const e=[];let t;if(Q.chains.forEach(n=>{H.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(r=>r===n.namespace)&&n.namespace&&e.push(n.namespace)}),e.length>0){const n=e[0];return t=n?Q.chains.get(n)?.caipNetworks?.[0]:void 0,t}},getAccountData(e){const t=e||Q.activeChain;if(t)return T.state.chains.get(t)?.accountState},getNetworkData(e){const t=e||Q.activeChain;if(t)return T.state.chains.get(t)?.networkState},getCaipNetworkByNamespace(e,t){if(!e)return;const n=T.state.chains.get(e),r=n?.caipNetworks?.find(s=>s.id===t);return r||n?.networkState?.caipNetwork||n?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const e=J.state.filterByNamespace;return(e?[Q.chains.get(e)]:Array.from(Q.chains.values())).flatMap(n=>n?.caipNetworks||[]).map(n=>n.caipNetworkId)},getCaipNetworks(e){return e?T.getRequestedCaipNetworks(e):T.getAllRequestedCaipNetworks()},setLastConnectedSIWECaipNetwork(e){Q.lastConnectedSIWECaipNetwork=e},getLastConnectedSIWECaipNetwork(){return Q.lastConnectedSIWECaipNetwork}},T=_n(JF),XF={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},G2=ce.getBlockchainApiUrl(),en=Ze({clientId:null,api:new dl({baseUrl:G2,clientId:null}),supportedChains:{http:[],ws:[]}}),fe={state:en,async get(e){const{st:t,sv:n}=fe.getSdkProperties(),r=z.state.projectId,s={...e.params||{},st:t,sv:n,projectId:r};return en.api.get({...e,params:s})},getSdkProperties(){const{sdkType:e,sdkVersion:t}=z.state;return{st:e||"unknown",sv:t||"unknown"}},async isNetworkSupported(e){if(!e)return!1;try{en.supportedChains.http.length||await fe.getSupportedNetworks()}catch{return!1}return en.supportedChains.http.includes(e)},async getSupportedNetworks(){try{const e=await fe.get({path:"v1/supported-chains"});return en.supportedChains=e,e}catch{return en.supportedChains}},async fetchIdentity({address:e,caipNetworkId:t}){if(!await fe.isNetworkSupported(t))return{avatar:"",name:""};const r=W.getIdentityFromCacheForAddress(e);if(r)return r;const s=await fe.get({path:`/v1/identity/${e}`,params:{sender:T.state.activeCaipAddress?ce.getPlainAddress(T.state.activeCaipAddress):void 0}});return W.updateIdentityCache({address:e,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:e,cursor:t,signal:n,cache:r,chainId:s}){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=W.getTransactionsCacheForAddress({address:e,chainId:s});if(o)return o;const a=await fe.get({path:`/v1/account/${e}/history`,params:{cursor:t,chainId:s},signal:n,cache:r});return W.updateTransactionsCache({address:e,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:e,userAddress:t,from:n,to:r,gasPrice:s}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:e,userAddress:t,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:e}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:"/v1/convert/tokens",params:{chainId:e}}):{tokens:[]}},async fetchTokenPrice({addresses:e}){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const n=W.getTokenPriceCacheForAddresses(e);if(n)return n;const r=await en.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:e,projectId:z.state.projectId},headers:{"Content-Type":"application/json"}});return W.updateTokenPriceCache({addresses:e,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:e,userAddress:t}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:"/v1/convert/allowance",params:{tokenAddress:e,userAddress:t},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:e}){const{st:t,sv:n}=fe.getSdkProperties();if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return fe.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:e,st:t,sv:n}})},async generateSwapCalldata({amount:e,from:t,to:n,userAddress:r,disableEstimate:s}){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return en.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:e,eip155:{slippage:Le.CONVERT_SLIPPAGE_TOLERANCE},projectId:z.state.projectId,from:t,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:e,to:t,userAddress:n}){const{st:r,sv:s}=fe.getSdkProperties();if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return fe.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:e,to:t,st:r,sv:s}})},async getBalance(e,t,n){const{st:r,sv:s}=fe.getSdkProperties();if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return Ir.showError("Token Balance Unavailable"),{balances:[]};const o=`${t}:${e}`,a=W.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await fe.get({path:`/v1/account/${e}/balance`,params:{currency:"usd",chainId:t,forceUpdate:n,st:r,sv:s}});return W.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(e){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/profile/account/${e}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:e}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/profile/reverse/${e}`,params:{sender:ae.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(e){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/profile/suggestions/${e}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:e,address:t,message:n,signature:r}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?en.api.post({path:"/v1/profile/account",body:{coin_type:e,address:t,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:e,partnerUserId:t,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?(await en.api.post({path:"/v1/generators/onrampurl",params:{projectId:z.state.projectId},body:{destinationWallets:e,defaultNetwork:n,partnerUserId:t,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await fe.get({path:"/v1/onramp/options"})}catch{return XF}},async getOnrampQuote({purchaseCurrency:e,paymentCurrency:t,amount:n,network:r}){try{return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?await en.api.post({path:"/v1/onramp/quote",params:{projectId:z.state.projectId},body:{purchaseCurrency:e,paymentCurrency:t,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:t.id},paymentSubtotal:{amount:n,currency:t.id},paymentTotal:{amount:n,currency:t.id},purchaseAmount:{amount:n,currency:t.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(e){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/sessions/${e}`}):[]},async revokeSmartSession(e,t,n){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?en.api.post({path:`/v1/sessions/${e}/revoke`,params:{projectId:z.state.projectId},body:{pci:t,signature:n}}):{success:!1}},setClientId(e){en.clientId=e,en.api=new dl({baseUrl:G2,clientId:e})}};function QF(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function Qb(e){return QF(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const Y2="2.41.2";let tf={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:n})=>t?`${e??"https://viem.sh"}${t}${n?`#${n}`:""}`:void 0,version:`viem@${Y2}`};class xn extends Error{constructor(t,n={}){const r=n.cause instanceof xn?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof xn&&n.cause.docsPath||n.docsPath,i=tf.getDocsUrl?.({...n,docsPath:s}),o=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...tf.version?[`Version: ${tf.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=t,this.version=Y2}walk(t){return Z2(this,t)}}function Z2(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause!==void 0?Z2(e.cause,t):t?null:e}class J2 extends xn{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Qg(e,{dir:t,size:n=32}={}){return typeof e=="string"?ez(e,{dir:t,size:n}):tz(e,{dir:t,size:n})}function ez(e,{dir:t,size:n=32}={}){if(n===null)return e;const r=e.replace("0x","");if(r.length>n*2)throw new J2({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function tz(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new J2({size:e.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=t==="right";r[i?s:n-s-1]=e[i?s:e.length-s-1]}return r}class nz extends xn{constructor({max:t,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class rz extends xn{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}function X2(e,{size:t}){if(Qb(e)>t)throw new rz({givenSize:Qb(e),maxSize:t})}const sz=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ev(e,t={}){return typeof e=="number"||typeof e=="bigint"?oz(e,t):typeof e=="string"?eA(e,t):typeof e=="boolean"?iz(e,t):Q2(e,t)}function iz(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(X2(n,{size:t.size}),Qg(n,{size:t.size})):n}function Q2(e,t={}){let n="";for(let s=0;s<e.length;s++)n+=sz[e[s]];const r=`0x${n}`;return typeof t.size=="number"?(X2(r,{size:t.size}),Qg(r,{dir:"right",size:t.size})):r}function oz(e,t={}){const{signed:n,size:r}=t,s=BigInt(e);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof e=="bigint"?"n":"";throw new nz({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${e}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Qg(a,{size:r}):a}const az=new TextEncoder;function eA(e,t={}){const n=az.encode(e);return Q2(n,t)}class cz extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const Ci=(e,t,n)=>JSON.stringify(e,(r,s)=>typeof s=="bigint"?s.toString():s,n);function lz(e,t){let n=e.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(t,"0");let[s,i]=[n.slice(0,n.length-t),n.slice(n.length-t)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}const ew=e=>e;class Qa extends xn{constructor({body:t,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${ew(o)}`,t&&`Request body: ${Ci(t)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=t,this.headers=s,this.status=i,this.url=o}}class tA extends xn{constructor({body:t,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${ew(r)}`,`Request body: ${Ci(t)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data,this.url=r}}class tv extends xn{constructor({body:t,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${ew(n)}`,`Request body: ${Ci(t)}`],name:"TimeoutError"}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.url=n}}const uz=-1;class hn extends xn{constructor(t,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:t,docsPath:r,metaMessages:s||t?.metaMessages,name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||t.name,this.code=t instanceof tA?t.code:n??uz}}class Tn extends hn{constructor(t,n){super(t,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class Cc extends hn{constructor(t){super(t,{code:Cc.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Cc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class Ac extends hn{constructor(t){super(t,{code:Ac.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(Ac,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Ic extends hn{constructor(t,{method:n}={}){super(t,{code:Ic.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(Ic,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Sc extends hn{constructor(t){super(t,{code:Sc.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Sc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Wo extends hn{constructor(t){super(t,{code:Wo.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(Wo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Nc extends hn{constructor(t){super(t,{code:Nc.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Nc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class xc extends hn{constructor(t){super(t,{code:xc.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(xc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class _c extends hn{constructor(t){super(t,{code:_c.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(_c,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Vo extends hn{constructor(t){super(t,{code:Vo.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Vo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class mi extends hn{constructor(t,{method:n}={}){super(t,{code:mi.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(mi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Ko extends hn{constructor(t){super(t,{code:Ko.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Ko,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Tc extends hn{constructor(t){super(t,{code:Tc.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Tc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Ai extends Tn{constructor(t){super(t,{code:Ai.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Ai,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class Oc extends Tn{constructor(t){super(t,{code:Oc.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(Oc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Dc extends Tn{constructor(t,{method:n}={}){super(t,{code:Dc.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(Dc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Pc extends Tn{constructor(t){super(t,{code:Pc.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Pc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class $c extends Tn{constructor(t){super(t,{code:$c.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty($c,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class kc extends Tn{constructor(t){super(t,{code:kc.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(kc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Uc extends Tn{constructor(t){super(t,{code:Uc.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(Uc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Rc extends Tn{constructor(t){super(t,{code:Rc.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Rc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Mc extends Tn{constructor(t){super(t,{code:Mc.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(Mc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Lc extends Tn{constructor(t){super(t,{code:Lc.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(Lc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Bc extends Tn{constructor(t){super(t,{code:Bc.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Bc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class jc extends Tn{constructor(t){super(t,{code:jc.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(jc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class Fc extends Tn{constructor(t){super(t,{code:Fc.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(Fc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class dz extends hn{constructor(t){super(t,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class tw extends xn{constructor({cause:t,message:n}={}){const r=n?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"})}}Object.defineProperty(tw,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(tw,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});function hz(){let e=()=>{},t=()=>{};return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}const nf=new Map;function fz({fn:e,id:t,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:h})=>h);d.length!==0&&e(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let p=0;p<u.length;p++){const{resolve:f}=u[p];f?.([h[p],h])}}).catch(h=>{for(let p=0;p<u.length;p++){const{reject:f}=u[p];f?.(h)}})},o=()=>nf.delete(t),a=()=>c().map(({args:u})=>u),c=()=>nf.get(t)||[],l=u=>nf.set(t,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:h,reject:p}=hz();return n?.([...a(),u])&&i(),c().length>0?(l({args:u,resolve:h,reject:p}),d):(l({args:u,resolve:h,reject:p}),setTimeout(i,r),d)}}}async function nA(e){return new Promise(t=>setTimeout(t,e))}function pz(e,{delay:t=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof t=="function"?t({count:a,error:l}):t;u&&await nA(u),o({count:a+1})};try{const l=await e();s(l)}catch(l){if(a<n&&await r({count:a,error:l}))return c({error:l});i(l)}};o()})}const $p=256;let tu=$p,nu;function gz(e=11){if(!nu||tu+e>$p*2){nu="",tu=0;for(let t=0;t<$p;t++)nu+=(256+Math.random()*256|0).toString(16).substring(1)}return nu.substring(tu,tu+++e)}const ru=new cz(8192);function wz(e,{enabled:t=!0,id:n}){if(!t||!n)return e();if(ru.get(n))return ru.get(n);const r=e().finally(()=>ru.delete(n));return ru.set(n,r),r}function mz(e,t={}){return async(n,r={})=>{const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...t,...r},{method:l}=n;if(i?.exclude?.includes(l))throw new mi(new Error("method not supported"),{method:l});if(i?.include&&!i.include.includes(l))throw new mi(new Error("method not supported"),{method:l});const u=s?eA(`${c}.${Ci(n)}`):void 0;return wz(()=>pz(async()=>{try{return await e(n)}catch(d){const h=d;switch(h.code){case Cc.code:throw new Cc(h);case Ac.code:throw new Ac(h);case Ic.code:throw new Ic(h,{method:n.method});case Sc.code:throw new Sc(h);case Wo.code:throw new Wo(h);case Nc.code:throw new Nc(h);case xc.code:throw new xc(h);case _c.code:throw new _c(h);case Vo.code:throw new Vo(h);case mi.code:throw new mi(h,{method:n.method});case Ko.code:throw new Ko(h);case Tc.code:throw new Tc(h);case Ai.code:throw new Ai(h);case Oc.code:throw new Oc(h);case Dc.code:throw new Dc(h);case Pc.code:throw new Pc(h);case $c.code:throw new $c(h);case kc.code:throw new kc(h);case Uc.code:throw new Uc(h);case Rc.code:throw new Rc(h);case Mc.code:throw new Mc(h);case Lc.code:throw new Lc(h);case Bc.code:throw new Bc(h);case jc.code:throw new jc(h);case Fc.code:throw new Fc(h);case 5e3:throw new Ai(h);default:throw d instanceof xn?d:new dz(h)}}},{delay:({count:d,error:h})=>{if(h&&h instanceof Qa){const p=h?.headers?.get("Retry-After");if(p?.match(/\d/))return Number.parseInt(p,10)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>yz(d)}),{enabled:s,id:u})}}function yz(e){return"code"in e&&typeof e.code=="number"?e.code===-1||e.code===Ko.code||e.code===Wo.code:e instanceof Qa&&e.status?e.status===403||e.status===408||e.status===413||e.status===429||e.status===500||e.status===502||e.status===503||e.status===504:!0}function bz(e,{errorInstance:t=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r&&a.abort()},n)),s(await e({signal:a?.signal||null}))}catch(a){a?.name==="AbortError"&&i(t),i(a)}finally{clearTimeout(o)}})()})}function vz(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const nv=vz();function Ez(e,t={}){return{async request(n){const{body:r,fetchFn:s=t.fetchFn??fetch,onRequest:i=t.onRequest,onResponse:o=t.onResponse,timeout:a=t.timeout??1e4}=n,c={...t.fetchOptions??{},...n.fetchOptions??{}},{headers:l,method:u,signal:d}=c;try{const h=await bz(async({signal:f})=>{const g={...c,body:Array.isArray(r)?Ci(r.map(y=>({jsonrpc:"2.0",id:y.id??nv.take(),...y}))):Ci({jsonrpc:"2.0",id:r.id??nv.take(),...r}),headers:{"Content-Type":"application/json",...l},method:u||"POST",signal:d||(a>0?f:null)},w=new Request(e,g),b=await i?.(w,g)??{...g,url:e};return await s(b.url??e,b)},{errorInstance:new tv({body:r,url:e}),timeout:a,signal:!0});o&&await o(h);let p;if(h.headers.get("Content-Type")?.startsWith("application/json"))p=await h.json();else{p=await h.text();try{p=JSON.parse(p||"{}")}catch(f){if(h.ok)throw f;p={error:p}}}if(!h.ok)throw new Qa({body:r,details:Ci(p.error)||h.statusText,headers:h.headers,status:h.status,url:e});return p}catch(h){throw h instanceof Qa||h instanceof tv?h:new Qa({body:r,cause:h,url:e})}}}}function rA({key:e,methods:t,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=gz();return{config:{key:e,methods:t,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:mz(r,{methods:t,retryCount:s,retryDelay:i,uid:l}),value:c}}function rv(e,t={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=Cz,retryCount:o,retryDelay:a}=t;return(({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let h=e,p=()=>{};const f=rA({key:n,name:r,async request({method:g,params:w}){let b;const I=async(y=0)=>{const m=h[y]({...d,chain:c,retryCount:0,timeout:u});try{const v=await m.request({method:g,params:w});return p({method:g,params:w,response:v,transport:m,status:"success"}),v}catch(v){if(p({error:v,method:g,params:w,transport:m,status:"error"}),i(v)||y===h.length-1||(b??=h.slice(y+1).some(C=>{const{include:O,exclude:D}=C({chain:c}).config.methods||{};return O?O.includes(g):D?!D.includes(g):!0}),!b))throw v;return I(y+1)}};return I()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>p=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};Az({chain:c,interval:g.interval??l,onTransports:w=>h=w,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return f})}function Cz(e){return!!("code"in e&&typeof e.code=="number"&&(e.code===Vo.code||e.code===Ai.code||tw.nodeMessage.test(e.message)||e.code===5e3))}function Az({chain:e,interval:t=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const w=g({chain:e,retryCount:0,timeout:i}),b=Date.now();let I,y;try{await(r?r({transport:w}):w.request({method:"net_listening"})),y=1}catch{y=0}finally{I=Date.now()}return{latency:I-b,success:y}}));u.push(h),u.length>s&&u.shift();const p=Math.max(...u.map(g=>Math.max(...g.map(({latency:w})=>w)))),f=o.map((g,w)=>{const b=u.map(C=>C[w].latency),y=1-b.reduce((C,O)=>C+O,0)/b.length/p,m=u.map(C=>C[w].success),v=m.reduce((C,O)=>C+O,0)/m.length;return v===0?[0,w]:[l*y+c*v,w]}).sort((g,w)=>w[0]-g[0]);n(f.map(([,g])=>o[g])),await nA(t),d()};d()}class Iz extends xn{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function su(e,t={}){const{batch:n,fetchFn:r,fetchOptions:s,key:i="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:c,onFetchResponse:l,retryDelay:u,raw:d}=t;return({chain:h,retryCount:p,timeout:f})=>{const{batchSize:g=1e3,wait:w=0}=typeof n=="object"?n:{},b=t.retryCount??p,I=f??t.timeout??1e4,y=e||h?.rpcUrls.default.http[0];if(!y)throw new Iz;const m=Ez(y,{fetchFn:r,fetchOptions:s,onRequest:c,onResponse:l,timeout:I});return rA({key:i,methods:o,name:a,async request({method:v,params:C}){const O={method:v,params:C},{schedule:D}=fz({id:y,wait:w,shouldSplitBatch(P){return P.length>g},fn:P=>m.request({body:P}),sort:(P,M)=>P.id-M.id}),S=async P=>n?D(P):[await m.request({body:P})],[{error:E,result:x}]=await S(O);if(d)return{error:E,result:x};if(E)throw new tA({body:O,error:E,url:y});return x},retryCount:b,retryDelay:u,timeout:I,type:"http"},{fetchOptions:s,url:y})}}const rf={createBalance(e,t){const n={name:e.metadata.name||"",symbol:e.metadata.symbol||"",decimals:e.metadata.decimals||0,value:e.metadata.value||0,price:e.metadata.price||0,iconUrl:e.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:t,address:e.address==="native"?void 0:this.convertAddressToCAIP10Address(e.address,t),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:e.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:e,decimals:t}){return lz(BigInt(e),t)},convertAddressToCAIP10Address(e,t){return`${t}:${e}`},createCAIP2ChainId(e,t){return`${t}:${parseInt(e,16)}`},getChainIdHexFromCAIP2ChainId(e){const t=e.split(":");if(t.length<2||!t[1])return"0x0";const n=t[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(e){return typeof e!="object"||e===null?!1:Object.values(e).every(t=>Array.isArray(t)&&t.every(n=>this.isValidAsset(n)))},isValidAsset(e){return typeof e=="object"&&e!==null&&typeof e.address=="string"&&typeof e.balance=="string"&&(e.type==="ERC20"||e.type==="NATIVE")&&typeof e.metadata=="object"&&e.metadata!==null&&typeof e.metadata.name=="string"&&typeof e.metadata.symbol=="string"&&typeof e.metadata.decimals=="number"&&typeof e.metadata.price=="number"&&typeof e.metadata.iconUrl=="string"}},nw={async getMyTokensWithBalance(e){const t=ae.state.address,n=T.state.activeCaipNetwork,r=J.getConnectorId("eip155")===H.CONNECTOR_ID.AUTH;if(!t||!n)return[];const s=`${n.caipNetworkId}:${t}`,i=W.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===H.CHAIN.EVM&&r){const a=await this.getEIP155Balances(t,n);if(a)return this.filterLowQualityTokens(a)}const o=await fe.getBalance(t,n.caipNetworkId,e);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(e,t){try{const n=rf.getChainIdHexFromCAIP2ChainId(t.caipNetworkId);if(!(await X.getCapabilities(e))?.[n]?.assetDiscovery?.supported)return null;const s=await X.walletGetAssets({account:e,chainFilter:[n]});if(!rf.isWalletGetAssetsResponse(s))return null;const o=(s[n]||[]).map(a=>rf.createBalance(a,t.caipNetworkId));return W.updateBalanceCache({caipAddress:`${t.caipNetworkId}:${e}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(e){return e.filter(t=>t.quantity.decimals!=="0")}},wr=Ze({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),Sz={state:wr,replaceState(e){e&&Object.assign(wr,$i(e))},subscribe(e){return T.subscribeChainProp("accountState",t=>{if(t)return e(t)})},subscribeKey(e,t,n){let r;return T.subscribeChainProp("accountState",s=>{if(s){const i=s[e];r!==i&&(r=i,t(i))}},n)},setStatus(e,t){T.setAccountProp("status",e,t)},getCaipAddress(e){if(e)return T.state.chains.get(e)?.accountState?.caipAddress},setCaipAddress(e,t){const n=e?ce.getPlainAddress(e):void 0;t===T.state.activeChain&&(T.state.activeCaipAddress=e),T.setAccountProp("caipAddress",e,t),T.setAccountProp("address",n,t)},setBalance(e,t,n){T.setAccountProp("balance",e,n),T.setAccountProp("balanceSymbol",t,n)},setProfileName(e,t){T.setAccountProp("profileName",e,t)},setProfileImage(e,t){T.setAccountProp("profileImage",e,t)},setUser(e,t){T.setAccountProp("user",e,t)},setAddressExplorerUrl(e,t){T.setAccountProp("addressExplorerUrl",e,t)},setSmartAccountDeployed(e,t){T.setAccountProp("smartAccountDeployed",e,t)},setCurrentTab(e){T.setAccountProp("currentTab",e,T.state.activeChain)},setTokenBalance(e,t){e&&T.setAccountProp("tokenBalance",e,t)},setShouldUpdateToAddress(e,t){T.setAccountProp("shouldUpdateToAddress",e,t)},addAddressLabel(e,t,n){if(!n)return;const r=T.state.chains.get(n)?.accountState?.addressLabels||new Map;r.set(e,t),T.setAccountProp("addressLabels",r,n)},removeAddressLabel(e,t){if(!t)return;const n=T.state.chains.get(t)?.accountState?.addressLabels||new Map;n.delete(e),T.setAccountProp("addressLabels",n,t)},setConnectedWalletInfo(e,t){T.setAccountProp("connectedWalletInfo",e,t,!1)},setPreferredAccountType(e,t){T.setAccountProp("preferredAccountType",e,t)},setSocialProvider(e,t){e&&T.setAccountProp("socialProvider",e,t)},setSocialWindow(e,t){T.setAccountProp("socialWindow",e?$i(e):void 0,t)},setFarcasterUrl(e,t){T.setAccountProp("farcasterUrl",e,t)},async fetchTokenBalance(e){wr.balanceLoading=!0;const t=T.state.activeCaipNetwork?.caipNetworkId,n=T.state.activeCaipNetwork?.chainNamespace,r=T.state.activeCaipAddress,s=r?ce.getPlainAddress(r):void 0;if(wr.lastRetry&&!ce.isAllowedRetry(wr.lastRetry,30*Le.ONE_SEC_MS))return wr.balanceLoading=!1,[];try{if(s&&t&&n){const i=await nw.getMyTokensWithBalance();return ae.setTokenBalance(i,n),wr.lastRetry=void 0,wr.balanceLoading=!1,i}}catch(i){wr.lastRetry=Date.now(),e?.(i),Ir.showError("Token Balance Unavailable")}finally{wr.balanceLoading=!1}return[]},resetAccount(e){T.resetAccount(e)}},ae=_n(Sz),Nz={onSwitchNetwork({network:e,ignoreSwitchConfirmation:t=!1}){const n=T.state.activeCaipNetwork,r=pe.state.data;if(e.id===n?.id)return;const i=ae.getCaipAddress(T.state.activeChain),o=e.chainNamespace!==T.state.activeChain,a=ae.getCaipAddress(e.chainNamespace),l=J.getConnectorId(T.state.activeChain)===H.CONNECTOR_ID.AUTH,u=H.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(d=>d===e.chainNamespace);t||l&&u?pe.push("SwitchNetwork",{...r,network:e}):i&&o&&!a?pe.push("SwitchActiveChain",{switchToChain:e.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:e}):pe.push("SwitchNetwork",{...r,network:e})}},tn=Ze({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),xz={state:tn,subscribe(e){return Pt(tn,()=>e(tn))},subscribeKey(e,t){return Ht(tn,e,t)},async open(e){const t=e?.namespace,n=T.state.activeChain,r=t&&t!==n,s=T.getAccountData(e?.namespace)?.caipAddress;if(X.state.wcBasic?he.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await he.prefetch(),J.setFilterByNamespace(e?.namespace),Ae.setLoading(!0,t),t&&r){const i=T.getNetworkData(t)?.caipNetwork||T.getRequestedCaipNetworks(t)[0];i&&Nz.onSwitchNetwork({network:i,ignoreSwitchConfirmation:!0})}else{const i=T.state.noAdapters;z.state.manualWCControl||i&&!s?ce.isMobile()?pe.reset("AllWallets"):pe.reset("ConnectingWalletConnectBasic"):e?.view?pe.reset(e.view,e.data):s?pe.reset("Account"):pe.reset("Connect")}tn.open=!0,Yr.set({open:!0}),ze.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const e=z.state.enableEmbedded,t=!!T.state.activeCaipAddress;tn.open&&ze.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),tn.open=!1,pe.reset("Connect"),Ae.clearLoading(),e?t?pe.replace("Account"):pe.push("Connect"):Yr.set({open:!1}),X.resetUri()},setLoading(e,t){t&&tn.loadingNamespaceMap.set(t,e),tn.loading=e,Yr.set({loading:e})},clearLoading(){tn.loadingNamespaceMap.clear(),tn.loading=!1,Yr.set({loading:!1})},shake(){tn.shake||(tn.shake=!0,setTimeout(()=>{tn.shake=!1},500))}},Ae=_n(xz),ec={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},kp={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},_z={providers:q2,selectedProvider:null,error:null,purchaseCurrency:ec,paymentCurrency:kp,purchaseCurrencies:[ec],paymentCurrencies:[],quotesLoading:!1},Se=Ze(_z),Tz={state:Se,subscribe(e){return Pt(Se,()=>e(Se))},subscribeKey(e,t){return Ht(Se,e,t)},setSelectedProvider(e){if(e&&e.name==="meld"){const t=T.state.activeChain,n=t===H.CHAIN.SOLANA?"SOL":"USDC",r=t?T.state.chains.get(t)?.accountState?.address??"":"",s=new URL(e.url);s.searchParams.append("publicKey",SF),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",z.state.projectId),Se.selectedProvider={...e,url:s.toString()}}else Se.selectedProvider=e},setOnrampProviders(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string")){const t=e,n=q2.filter(r=>t.includes(r.name));Se.providers=n}else Se.providers=[]},setPurchaseCurrency(e){Se.purchaseCurrency=e},setPaymentCurrency(e){Se.paymentCurrency=e},setPurchaseAmount(e){Up.state.purchaseAmount=e},setPaymentAmount(e){Up.state.paymentAmount=e},async getAvailableCurrencies(){const e=await fe.getOnrampOptions();Se.purchaseCurrencies=e.purchaseCurrencies,Se.paymentCurrencies=e.paymentCurrencies,Se.paymentCurrency=e.paymentCurrencies[0]||kp,Se.purchaseCurrency=e.purchaseCurrencies[0]||ec,await he.fetchCurrencyImages(e.paymentCurrencies.map(t=>t.id)),await he.fetchTokenImages(e.purchaseCurrencies.map(t=>t.symbol))},async getQuote(){Se.quotesLoading=!0;try{const e=await fe.getOnrampQuote({purchaseCurrency:Se.purchaseCurrency,paymentCurrency:Se.paymentCurrency,amount:Se.paymentAmount?.toString()||"0",network:Se.purchaseCurrency?.symbol});return Se.quotesLoading=!1,Se.purchaseAmount=Number(e?.purchaseAmount.amount),e}catch(e){return Se.error=e.message,Se.quotesLoading=!1,null}finally{Se.quotesLoading=!1}},resetState(){Se.selectedProvider=null,Se.error=null,Se.purchaseCurrency=ec,Se.paymentCurrency=kp,Se.purchaseCurrencies=[ec],Se.paymentCurrencies=[],Se.paymentAmount=void 0,Se.purchaseAmount=void 0,Se.quotesLoading=!1}},Up=_n(Tz),sv=2147483648,Oz={convertEVMChainIdToCoinType(e){if(e>=sv)throw new Error("Invalid chainId");return(sv|e)>>>0}},$n=Ze({suggestions:[],loading:!1}),Dz={state:$n,subscribe(e){return Pt($n,()=>e($n))},subscribeKey(e,t){return Ht($n,e,t)},async resolveName(e){try{return await fe.lookupEnsName(e)}catch(t){const n=t;throw new Error(n?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await fe.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{$n.loading=!0,$n.suggestions=[];const t=await fe.getEnsNameSuggestions(e);return $n.suggestions=t.suggestions.map(n=>({...n,name:n.name}))||[],$n.suggestions}catch(t){const n=tc.parseEnsApiError(t,"Error fetching name suggestions");throw new Error(n)}finally{$n.loading=!1}},async getNamesForAddress(e){try{if(!T.state.activeCaipNetwork)return[];const n=W.getEnsFromCacheForAddress(e);if(n)return n;const r=await fe.reverseLookupEnsName({address:e});return W.updateEnsCache({address:e,ens:r,timestamp:Date.now()}),r}catch(t){const n=tc.parseEnsApiError(t,"Error fetching names for address");throw new Error(n)}},async registerName(e){const t=T.state.activeCaipNetwork,n=ae.state.address,r=J.getAuthConnector();if(!t)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");$n.loading=!0;try{const s=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});pe.pushTransactionStack({onCancel(){pe.replace("RegisterAccountName")}});const i=await X.signMessage(s);$n.loading=!1;const o=t.id;if(!o)throw new Error("Network not found");const a=Oz.convertEVMChainIdToCoinType(Number(o));await fe.registerEnsName({coinType:a,address:n,signature:i,message:s}),ae.setProfileName(e,t.chainNamespace),pe.replace("RegisterAccountNameSuccess")}catch(s){const i=tc.parseEnsApiError(s,`Error registering name ${e}`);throw pe.replace("RegisterAccountName"),new Error(i)}finally{$n.loading=!1}},validateName(e){return/^[a-zA-Z0-9-]{4,}$/u.test(e)},parseEnsApiError(e,t){return e?.reasons?.[0]?.description||t}},tc=_n(Dz);let ei=null;const Cr={getSIWX(){return z.state.siwx},async initializeIfEnabled(e=T.getActiveCaipAddress()){const t=z.state.siwx;if(!(t&&e))return;const[n,r,s]=e.split(":");if(T.checkIfSupportedNetwork(n,`${n}:${r}`))try{if(z.state.remoteFeatures?.emailCapture){const o=T.getAccountData(n)?.user;await Ae.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(ei&&await ei,(await t.getSessions(`${n}:${r}`,s)).length)return;await Ae.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),ze.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await X._getClient()?.disconnect().catch(console.error),pe.reset("Connect"),Ir.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const e=z.state.siwx,t=ce.getPlainAddress(T.getActiveCaipAddress()),n=Xb(),r=X._getClient();if(!e)throw new Error("SIWX is not enabled");if(!t)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await e.createMessage({chainId:n.caipNetworkId,accountAddress:t}),i=s.toString();J.getConnectorId(n.chainNamespace)===H.CONNECTOR_ID.AUTH&&pe.pushTransactionStack({});const a=await r.signMessage(i);await e.addSession({data:s,message:i,signature:a}),T.setLastConnectedSIWECaipNetwork(n),Ae.close(),ze.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!Ae.state.open||pe.state.view==="ApproveTransaction")&&await Ae.open({view:"SIWXSignMessage"}),Ir.showError("Error signing message"),ze.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){try{const e=this.getSIWX();if(e?.getRequired?.()){const n=T.getLastConnectedSIWECaipNetwork();if(n){const r=await e?.getSessions(n?.caipNetworkId,ce.getPlainAddress(T.getActiveCaipAddress())||"");r&&r.length>0?await T.switchActiveNetwork(n):await X.disconnect()}else await X.disconnect()}else Ae.close();Ae.close(),ze.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const e=this.getSIWX(),t=T.getAllRequestedCaipNetworks(),n=[];return await Promise.all(t.map(async r=>{const s=await e?.getSessions(r.caipNetworkId,ce.getPlainAddress(T.getActiveCaipAddress())||"");s&&n.push(...s)})),n},async getSessions(e){const t=z.state.siwx;let n=e?.address;if(!n){const s=T.getActiveCaipAddress();n=ce.getPlainAddress(s)}let r=e?.caipNetworkId;return r||(r=T.getActiveCaipNetwork()?.caipNetworkId),t&&n&&r?t.getSessions(r,n):[]},async isSIWXCloseDisabled(){const e=this.getSIWX();if(e){const t=pe.state.view==="ApproveTransaction",n=pe.state.view==="SIWXSignMessage";if(t||n)return e.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:e,chainId:t,socialUri:n,preferredAccountType:r,chainNamespace:s}){const i=Cr.getSIWX();if(!i||!s.includes(H.CHAIN.EVM)||z.state.remoteFeatures?.emailCapture){const u=await e.connect({chainId:t,socialUri:n,preferredAccountType:r});return{address:u.address,chainId:u.chainId,accounts:u.accounts}}const o=`${s}:${t}`,a=await i.createMessage({chainId:o,accountAddress:"<<AccountAddress>>"}),c={accountAddress:a.accountAddress,chainId:a.chainId,domain:a.domain,uri:a.uri,version:a.version,nonce:a.nonce,notBefore:a.notBefore,statement:a.statement,resources:a.resources,requestId:a.requestId,issuedAt:a.issuedAt,expirationTime:a.expirationTime,serializedMessage:a.toString()},l=await e.connect({chainId:t,socialUri:n,siwxMessage:c,preferredAccountType:r});return c.accountAddress=l.address,c.serializedMessage=l.message||"",l.signature&&l.message&&await Cr.addEmbeddedWalletSession(c,l.message,l.signature),{address:l.address,chainId:l.chainId,accounts:l.accounts}},async addEmbeddedWalletSession(e,t,n){if(ei)return ei;const r=Cr.getSIWX();return r?(ei=r.addSession({data:e,message:t,signature:n}).finally(()=>{ei=null}),ei):Promise.resolve()},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:n}){const r=Cr.getSIWX(),s=new Set(t.map(a=>a.split(":")[0]));if(!r||s.size!==1||!s.has("eip155"))return!1;const i=await r.createMessage({chainId:Xb()?.caipNetworkId||"",accountAddress:""}),o=await e.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:n,chains:[i.chainId,...t.filter(a=>a!==i.chainId)]});if(Ir.showLoading("Authenticating...",{autoClose:!1}),ae.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:o.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(s)[0]),o?.auths?.length){const a=o.auths.map(c=>{const l=e.client.formatAuthMessage({request:c.p,iss:c.p.iss});return{data:{...c.p,accountAddress:c.p.iss.split(":").slice(-1).join(""),chainId:c.p.iss.split(":").slice(2,4).join(":"),uri:c.p.aud,version:c.p.version||i.version,expirationTime:c.p.exp,issuedAt:c.p.iat,notBefore:c.p.nbf},message:l,signature:c.s.s,cacao:c}});try{await r.setSessions(a),ze.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Cr.getSIWXEventProperties()})}catch(c){throw console.error("SIWX:universalProviderAuth - failed to set sessions",c),ze.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Cr.getSIWXEventProperties()}),await e.disconnect().catch(console.error),c}finally{Ir.hide()}}return!0},getSIWXEventProperties(){const e=T.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:T.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:Or(e)===Ei.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const e=this.getSIWX();e&&await e.setSessions([])}},si={EIP155:H.CHAIN.EVM,CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED"},zc={NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[H.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[H.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[H.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[H.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[H.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[H.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[H.CONNECTOR_ID.INJECTED]:"Browser Wallet",[H.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[H.CONNECTOR_ID.COINBASE]:"Coinbase",[H.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[H.CONNECTOR_ID.LEDGER]:"Ledger",[H.CONNECTOR_ID.SAFE]:"Safe"}},Cn={getCaipTokens(e){if(!e)return;const t={};return Object.entries(e).forEach(([n,r])=>{t[`${si.EIP155}:${n}`]=r}),t},isLowerCaseMatch(e,t){return e?.toLowerCase()===t?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const e=T.state.activeChain;return H.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(t=>J.getConnectorId(t)===H.CONNECTOR_ID.AUTH&&t===e)},withRetry({conditionFn:e,intervalMs:t,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await e()?s(!0):r>=n?s(!1):(setTimeout(i,t),null)}i()})}},Pz=new AbortController,kn={EmbeddedWalletAbortController:Pz,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${_o()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:e=>`Unable to fetch App Configuration. ${e}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:e=>`[Reown Config Notice] ${e}`}}},$z={createLogger(e,t="error"){const n=tl({level:t}),{logger:r}=nE({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){e(i,...s);return}e(void 0,...s)},r}},kz="rpc.walletconnect.org";function iv(e,t){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",e),n.searchParams.set("projectId",t),n.toString()}const sf=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],vo={extendRpcUrlWithProjectId(e,t){let n=!1;try{n=new URL(e).host===kz}catch{n=!1}if(n){const r=new URL(e);return r.searchParams.has("projectId")||r.searchParams.set("projectId",t),r.toString()}return e},isCaipNetwork(e){return"chainNamespace"in e&&"caipNetworkId"in e},getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:H.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${H.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,n){const r=e.rpcUrls?.default?.http?.[0];return sf.includes(t)?iv(t,n):r||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:n,customRpcUrls:r}){const s=this.getChainNamespace(e),i=this.getCaipNetworkId(e),o=e.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(e,i,n),c=e?.rpcUrls?.chainDefault?.http?.[0]||o,l=r?.[i]?.map(h=>h.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...e,chainNamespace:s,caipNetworkId:i,assets:{imageId:zc.NetworkImageIds[e.id],imageUrl:t?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(e,{customNetworkImageUrls:t,projectId:n,customRpcUrls:r}){return e.map(s=>vo.extendCaipNetwork(s,{customNetworkImageUrls:t,customRpcUrls:r,projectId:n}))},getViemTransport(e,t,n){const r=[];return n?.forEach(s=>{r.push(su(s.url,s.config))}),sf.includes(e.caipNetworkId)&&r.push(su(iv(e.caipNetworkId,t),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),e?.rpcUrls?.default?.http?.forEach(s=>{r.push(su(s))}),rv(r)},extendWagmiTransports(e,t,n){if(sf.includes(e.caipNetworkId)){const r=this.getDefaultRpcUrl(e,e.caipNetworkId,t);return rv([n,su(r)])}return n},getUnsupportedNetwork(e){return{id:e.split(":")[1],caipNetworkId:e,name:H.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(e){const t=W.getActiveCaipNetworkId(),n=T.getAllRequestedCaipNetworks(),r=Array.from(T.state.chains?.keys()||[]),s=t?.split(":")[0],i=s?r.includes(s):!1,o=n?.find(c=>c.caipNetworkId===t);return i&&!o&&t?this.getUnsupportedNetwork(t):o||e||n?.[0]}},Yu={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},nn=Ze({providers:{...Yu},providerIds:{...Yu}}),it={state:nn,subscribeKey(e,t){return Ht(nn,e,t)},subscribe(e){return Pt(nn,()=>{e(nn)})},subscribeProviders(e){return Pt(nn.providers,()=>e(nn.providers))},setProvider(e,t){e&&t&&(nn.providers[e]=$i(t))},getProvider(e){if(e)return nn.providers[e]},setProviderId(e,t){t&&(nn.providerIds[e]=t)},getProviderId(e){if(e)return nn.providerIds[e]},reset(){nn.providers={...Yu},nn.providerIds={...Yu}},resetChain(e){nn.providers[e]=void 0,nn.providerIds[e]=void 0}},Uz={VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},Rp={filterOutDuplicatesByRDNS(e){const t=z.state.enableEIP6963?J.state.connectors:[],n=W.getRecentWallets(),r=t.map(a=>a.info?.rdns).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&ce.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return e.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&t.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(e){const t=J.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),n=W.getRecentWallets(),r=t.map(a=>a.explorerId),s=n.map(a=>a.id),i=r.concat(s);return e.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(e){const t=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(t)},markWalletsAsInstalled(e){const{connectors:t}=J.state,{featuredWalletIds:n}=z.state,r=t.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return e.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n?.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(e,t){const n=e?.connectMethodsOrder||z.state.features?.connectMethodsOrder,r=t||J.state.connectors;if(n)return n;const{injected:s,announced:i}=bu.getConnectorsByType(r,he.state.recommended,he.state.featured),o=s.filter(bu.showConnector),a=i.filter(bu.showConnector);return o.length||a.length?["wallet","email","social"]:Uz.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(e){const t=!!e.rdns&&he.state.excludedWallets.some(r=>r.rdns===e.rdns),n=!!e.name&&he.state.excludedWallets.some(r=>Cn.isLowerCaseMatch(r.name,e.name));return t||n},markWalletsWithDisplayIndex(e){return e.map((t,n)=>({...t,display_index:n}))}},bu={getConnectorsByType(e,t,n){const{customWallets:r}=z.state,s=W.getRecentWallets(),i=Rp.filterOutDuplicateWallets(t),o=Rp.filterOutDuplicateWallets(n),a=e.filter(d=>d.type==="MULTI_CHAIN"),c=e.filter(d=>d.type==="ANNOUNCED"),l=e.filter(d=>d.type==="INJECTED"),u=e.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(e){const t=e.info?.rdns,n=!!t&&he.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===t),r=!!e.name&&he.state.excludedWallets.some(s=>Cn.isLowerCaseMatch(s.name,e.name));return!(e.type==="INJECTED"&&(e.name==="Browser Wallet"&&(!ce.isMobile()||ce.isMobile()&&!t&&!X.checkInstalled())||n||r)||(e.type==="ANNOUNCED"||e.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(T.state.chains.values()).some(n=>J.getConnectorId(n.namespace)===H.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:e,featured:t,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=z.state.features?.connectorTypeOrder??[]}){const d=[{type:"walletConnect",isEnabled:z.state.enableWalletConnect},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:t.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:e.length>0}].filter(g=>g.isEnabled),h=new Set(d.map(g=>g.type)),p=c.filter(g=>h.has(g)).map(g=>({type:g,isEnabled:!0})),f=d.filter(({type:g})=>!p.some(({type:b})=>b===g));return Array.from(new Set([...p,...f].map(({type:g})=>g)))},getAuthName({email:e,socialUsername:t,socialProvider:n}){return t?n&&n==="discord"&&t.endsWith("0")?t.slice(0,-1):t:e.length>30?`${e.slice(0,-3)}...`:e},async fetchProviderData(e){try{if(e.name==="Browser Wallet"&&!ce.isMobile())return{accounts:[],chainId:void 0};if(e.id===H.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[t,n]=await Promise.all([e.provider?.request({method:"eth_accounts"}),e.provider?.request({method:"eth_chainId"}).then(r=>Number(r))]);return{accounts:t,chainId:n}}catch(t){return console.warn(`Failed to fetch provider data for ${e.name}`,t),{accounts:[],chainId:void 0}}}};const vu=globalThis,rw=vu.ShadowRoot&&(vu.ShadyCSS===void 0||vu.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,sw=Symbol(),ov=new WeakMap;let sA=class{constructor(t,n,r){if(this._$cssResult$=!0,r!==sw)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o;const n=this.t;if(rw&&t===void 0){const r=n!==void 0&&n.length===1;r&&(t=ov.get(n)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),r&&ov.set(n,t))}return t}toString(){return this.cssText}};const Un=e=>new sA(typeof e=="string"?e:e+"",void 0,sw),$o=(e,...t)=>{const n=e.length===1?e[0]:t.reduce(((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+e[i+1]),e[0]);return new sA(n,e,sw)},Rz=(e,t)=>{if(rw)e.adoptedStyleSheets=t.map((n=>n instanceof CSSStyleSheet?n:n.styleSheet));else for(const n of t){const r=document.createElement("style"),s=vu.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,e.appendChild(r)}},av=rw?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let n="";for(const r of t.cssRules)n+=r.cssText;return Un(n)})(e):e;const{is:Mz,defineProperty:Lz,getOwnPropertyDescriptor:Bz,getOwnPropertyNames:jz,getOwnPropertySymbols:Fz,getPrototypeOf:zz}=Object,xd=globalThis,cv=xd.trustedTypes,Hz=cv?cv.emptyScript:"",qz=xd.reactiveElementPolyfillSupport,nc=(e,t)=>e,Mp={toAttribute(e,t){switch(t){case Boolean:e=e?Hz:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=e!==null;break;case Number:n=e===null?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},iA=(e,t)=>!Mz(e,t),lv={attribute:!0,type:String,converter:Mp,reflect:!1,useDefault:!1,hasChanged:iA};Symbol.metadata??=Symbol("metadata"),xd.litPropertyMetadata??=new WeakMap;let Eo=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,n=lv){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(t,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(t,r,n);s!==void 0&&Lz(this.prototype,t,s)}}static getPropertyDescriptor(t,n,r){const{get:s,set:i}=Bz(this.prototype,t)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(t,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??lv}static _$Ei(){if(this.hasOwnProperty(nc("elementProperties")))return;const t=zz(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(nc("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(nc("properties"))){const n=this.properties,r=[...jz(n),...Fz(n)];for(const s of r)this.createProperty(s,n[s])}const t=this[Symbol.metadata];if(t!==null){const n=litPropertyMetadata.get(t);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const n=[];if(Array.isArray(t)){const r=new Set(t.flat(1/0).reverse());for(const s of r)n.unshift(av(s))}else t!==void 0&&n.push(av(t));return n}static _$Eu(t,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(t.set(r,this[r]),delete this[r]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Rz(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,n,r){this._$AK(t,r)}_$ET(t,n){const r=this.constructor.elementProperties.get(t),s=this.constructor._$Eu(t,r);if(s!==void 0&&r.reflect===!0){const i=(r.converter?.toAttribute!==void 0?r.converter:Mp).toAttribute(n,r.type);this._$Em=t,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(t,n){const r=this.constructor,s=r._$Eh.get(t);if(s!==void 0&&this._$Em!==s){const i=r.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:Mp;this._$Em=s;const a=o.fromAttribute(n,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(t,n,r){if(t!==void 0){const s=this.constructor,i=this[t];if(r??=s.getPropertyOptions(t),!((r.hasChanged??iA)(i,n)||r.useDefault&&r.reflect&&i===this._$Ej?.get(t)&&!this.hasAttribute(s._$Eu(t,r))))return;this.C(t,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(t,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,o??n??this[t]),i!==!0||o!==void 0)||(this._$AL.has(t)||(this.hasUpdated||r||(n=void 0),this._$AL.set(t,n)),s===!0&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,i]of r){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),this._$EO?.forEach((r=>r.hostUpdate?.())),this.update(n)):this._$EM()}catch(r){throw t=!1,this._$EM(),r}t&&this._$AE(n)}willUpdate(t){}_$AE(t){this._$EO?.forEach((n=>n.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((n=>this._$ET(n,this[n]))),this._$EM()}updated(t){}firstUpdated(t){}};Eo.elementStyles=[],Eo.shadowRootOptions={mode:"open"},Eo[nc("elementProperties")]=new Map,Eo[nc("finalized")]=new Map,qz?.({ReactiveElement:Eo}),(xd.reactiveElementVersions??=[]).push("2.1.1");const iw=globalThis,Zu=iw.trustedTypes,uv=Zu?Zu.createPolicy("lit-html",{createHTML:e=>e}):void 0,oA="$lit$",Is=`lit$${Math.random().toFixed(9).slice(2)}$`,aA="?"+Is,Wz=`<${aA}>`,ki=document,Hc=()=>ki.createComment(""),qc=e=>e===null||typeof e!="object"&&typeof e!="function",ow=Array.isArray,Vz=e=>ow(e)||typeof e?.[Symbol.iterator]=="function",of=`[ 	
\f\r]`,ka=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,dv=/-->/g,hv=/>/g,ti=RegExp(`>|${of}(?:([^\\s"'>=/]+)(${of}*=${of}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),fv=/'/g,pv=/"/g,cA=/^(?:script|style|textarea|title)$/i,lA=e=>(t,...n)=>({_$litType$:e,strings:t,values:n}),AW=lA(1),IW=lA(2),Go=Symbol.for("lit-noChange"),Et=Symbol.for("lit-nothing"),gv=new WeakMap,yi=ki.createTreeWalker(ki,129);function uA(e,t){if(!ow(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return uv!==void 0?uv.createHTML(t):t}const Kz=(e,t)=>{const n=e.length-1,r=[];let s,i=t===2?"<svg>":t===3?"<math>":"",o=ka;for(let a=0;a<n;a++){const c=e[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===ka?u[1]==="!--"?o=dv:u[1]!==void 0?o=hv:u[2]!==void 0?(cA.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=ti):u[3]!==void 0&&(o=ti):o===ti?u[0]===">"?(o=s??ka,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?ti:u[3]==='"'?pv:fv):o===pv||o===fv?o=ti:o===dv||o===hv?o=ka:(o=ti,s=void 0);const p=o===ti&&e[a+1].startsWith("/>")?" ":"";i+=o===ka?c+Wz:d>=0?(r.push(l),c.slice(0,d)+oA+c.slice(d)+Is+p):c+Is+(d===-2?a:p)}return[uA(e,i+(e[n]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),r]};let Lp=class dA{constructor({strings:t,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=t.length-1,c=this.parts,[l,u]=Kz(t,n);if(this.el=dA.createElement(l,r),yi.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=yi.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(oA)){const h=u[o++],p=s.getAttribute(d).split(Is),f=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:f[2],strings:p,ctor:f[1]==="."?Yz:f[1]==="?"?Zz:f[1]==="@"?Jz:_d}),s.removeAttribute(d)}else d.startsWith(Is)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(cA.test(s.tagName)){const d=s.textContent.split(Is),h=d.length-1;if(h>0){s.textContent=Zu?Zu.emptyScript:"";for(let p=0;p<h;p++)s.append(d[p],Hc()),yi.nextNode(),c.push({type:2,index:++i});s.append(d[h],Hc())}}}else if(s.nodeType===8)if(s.data===aA)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Is,d+1))!==-1;)c.push({type:7,index:i}),d+=Is.length-1}i++}}static createElement(t,n){const r=ki.createElement("template");return r.innerHTML=t,r}};function Yo(e,t,n=e,r){if(t===Go)return t;let s=r!==void 0?n._$Co?.[r]:n._$Cl;const i=qc(t)?void 0:t._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(e),s._$AT(e,n,r)),r!==void 0?(n._$Co??=[])[r]=s:n._$Cl=s),s!==void 0&&(t=Yo(e,s._$AS(e,t.values),s,r)),t}let Gz=class{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:n},parts:r}=this._$AD,s=(t?.creationScope??ki).importNode(n,!0);yi.currentNode=s;let i=yi.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new hl(i,i.nextSibling,this,t):c.type===1?l=new c.ctor(i,c.name,c.strings,this,t):c.type===6&&(l=new Xz(i,this,t)),this._$AV.push(l),c=r[++a]}o!==c?.index&&(i=yi.nextNode(),o++)}return yi.currentNode=ki,s}p(t){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(t,r,n),n+=r.strings.length-2):r._$AI(t[n])),n++}};class hl{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,n,r,s){this.type=2,this._$AH=Et,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&t?.nodeType===11&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=Yo(this,t,n),qc(t)?t===Et||t==null||t===""?(this._$AH!==Et&&this._$AR(),this._$AH=Et):t!==this._$AH&&t!==Go&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):Vz(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==Et&&qc(this._$AH)?this._$AA.nextSibling.data=t:this.T(ki.createTextNode(t)),this._$AH=t}$(t){const{values:n,_$litType$:r}=t,s=typeof r=="number"?this._$AC(t):(r.el===void 0&&(r.el=Lp.createElement(uA(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(n);else{const i=new Gz(s,this),o=i.u(this.options);i.p(n),this.T(o),this._$AH=i}}_$AC(t){let n=gv.get(t.strings);return n===void 0&&gv.set(t.strings,n=new Lp(t)),n}k(t){ow(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of t)s===n.length?n.push(r=new hl(this.O(Hc()),this.O(Hc()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(t=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);t!==this._$AB;){const r=t.nextSibling;t.remove(),t=r}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}}let _d=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,n,r,s,i){this.type=1,this._$AH=Et,this._$AN=void 0,this.element=t,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Et}_$AI(t,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)t=Yo(this,t,n,0),o=!qc(t)||t!==this._$AH&&t!==Go,o&&(this._$AH=t);else{const a=t;let c,l;for(t=i[0],c=0;c<i.length-1;c++)l=Yo(this,a[r+c],n,c),l===Go&&(l=this._$AH[c]),o||=!qc(l)||l!==this._$AH[c],l===Et?t=Et:t!==Et&&(t+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(t)}j(t){t===Et?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}};class Yz extends _d{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Et?void 0:t}}class Zz extends _d{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==Et)}}class Jz extends _d{constructor(t,n,r,s,i){super(t,n,r,s,i),this.type=5}_$AI(t,n=this){if((t=Yo(this,t,n,0)??Et)===Go)return;const r=this._$AH,s=t===Et&&r!==Et||t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive,i=t!==Et&&(r===Et||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}let Xz=class{constructor(t,n,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){Yo(this,t)}};const Qz=iw.litHtmlPolyfillSupport;Qz?.(Lp,hl),(iw.litHtmlVersions??=[]).push("3.3.1");const eH=(e,t,n)=>{const r=n?.renderBefore??t;let s=r._$litPart$;if(s===void 0){const i=n?.renderBefore??null;r._$litPart$=s=new hl(t.insertBefore(Hc(),i),i,void 0,n??{})}return s._$AI(e),s};const aw=globalThis;class Eu extends Eo{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=eH(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Go}}Eu._$litElement$=!0,Eu.finalized=!0,aw.litElementHydrateSupport?.({LitElement:Eu});const tH=aw.litElementPolyfillSupport;tH?.({LitElement:Eu});(aw.litElementVersions??=[]).push("4.2.1");let rc,$s,ks;function _W(e,t){rc=document.createElement("style"),$s=document.createElement("style"),ks=document.createElement("style"),rc.textContent=ko(e).core.cssText,$s.textContent=ko(e).dark.cssText,ks.textContent=ko(e).light.cssText,document.head.appendChild(rc),document.head.appendChild($s),document.head.appendChild(ks),hA(t)}function hA(e){$s&&ks&&(e==="light"?($s.removeAttribute("media"),ks.media="enabled"):(ks.removeAttribute("media"),$s.media="enabled"))}function nH(e){rc&&$s&&ks&&(rc.textContent=ko(e).core.cssText,$s.textContent=ko(e).dark.cssText,ks.textContent=ko(e).light.cssText)}function ko(e){return{core:$o`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${Un(e?.["--w3m-color-mix-strength"]?`${e["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${Un(e?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${Un(e?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${Un(e?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${Un(e?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:$o`
      :root {
        --w3m-color-mix: ${Un(e?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${Un(Ts(e,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${Un(Ts(e,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:$o`
      :root {
        --w3m-color-mix: ${Un(e?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${Un(Ts(e,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${Un(Ts(e,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const TW=$o`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,OW=$o`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,DW=$o`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,Cu={hexStringToNumber(e){const t=e.startsWith("0x")?e.slice(2):e;return parseInt(t,16)},numberToHexString(e){return`0x${e.toString(16)}`},async getUserInfo(e){const[t,n]=await Promise.all([Cu.getAddresses(e),Cu.getChainId(e)]);return{chainId:n,addresses:t}},async getChainId(e){const t=await e.request({method:"eth_chainId"});return Number(t)},async getAddress(e){const[t]=await e.request({method:"eth_accounts"});return t},async getAddresses(e){return await e.request({method:"eth_accounts"})},async addEthereumChain(e,t){const n=t.rpcUrls.chainDefault?.http||[];await e.request({method:"wallet_addEthereumChain",params:[{chainId:Cu.numberToHexString(t.id),rpcUrls:[...n],chainName:t.name,nativeCurrency:{name:t.nativeCurrency.name,decimals:t.nativeCurrency.decimals,symbol:t.nativeCurrency.symbol},blockExplorerUrls:[t.blockExplorers?.default.url],iconUrls:[zc.NetworkImageIds[t.id]]}]})}},wo={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}};function fl(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const wv=fl({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),mv=fl({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});fl({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});const rH=fl({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),sH=fl({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0}),iH={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Xr={getMethodsByChainNamespace(e){return iH[e]||[]},createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};const n={...e},r=new Set;if(t.methods&&Object.keys(t.methods).forEach(s=>r.add(s)),t.chains&&Object.keys(t.chains).forEach(s=>r.add(s)),t.events&&Object.keys(t.events).forEach(s=>r.add(s)),t.rpcMap&&Object.keys(t.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),t.methods&&Object.entries(t.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),t.chains&&Object.entries(t.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),t.events&&Object.entries(t.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),t.rpcMap){const s=new Set;Object.entries(t.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(e,t){const n=e.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case wv.caipNetworkId:u.chains.push(wv.deprecatedCaipNetworkId);break;case mv.caipNetworkId:u.chains.push(mv.deprecatedCaipNetworkId);break}return u?.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,t)},resolveReownName:async e=>{const t=await tc.resolveName(e);return(Object.values(t?.addresses)||[])[0]?.address||!1},getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const n=t.chains||[],r=t.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(e){return typeof e=="object"&&e!==null&&"id"in e&&"topic"in e&&"params"in e&&typeof e.params=="object"&&e.params!==null&&"chainId"in e.params&&"event"in e.params&&typeof e.params.event=="object"&&e.params.event!==null},isOriginAllowed(e,t,n){for(const r of[...t,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(e))return!0}else try{if(new URL(r).origin===e)return!0}catch{if(r===e)return!0}return!1},listenWcProvider({universalProvider:e,namespace:t,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&e.on("connect",()=>{const a=Xr.getWalletConnectAccounts(e,t);n(a)}),r&&e.on("disconnect",()=>{r()}),s&&e.on("session_event",a=>{if(Xr.isSessionEventData(a)){const{name:c,data:l}=a.params.event;if(c==="accountsChanged"&&Array.isArray(l)){const u=l.filter(d=>ce.isCaipAddress(d)).map(d=>En.parseCaipAddress(d)).filter(d=>d.chainNamespace===t);s(u)}}}),i&&e.on("chainChanged",a=>{i(a)}),o&&e.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(e,t){const n=new Set,r=e?.session?.namespaces?.[t]?.accounts?.map(s=>En.parseCaipAddress(s)).filter(({address:s})=>n.has(s.toLowerCase())?!1:(n.add(s.toLowerCase()),!0));return r&&r.length>0?r:[]}};class oH{constructor(t){this.namespace=t.namespace}async syncConnections(t){switch(this.namespace){case H.CHAIN.EVM:await this.syncEVMConnections(t);break;case H.CHAIN.SOLANA:await this.syncSolanaConnections(t);break;case H.CHAIN.BITCOIN:await this.syncBitcoinConnections(t);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:t,caipNetworks:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(t.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===H.CONNECTOR_ID.WALLET_CONNECT){const c=Xr.getWalletConnectAccounts(r,this.namespace),l=n.find(u=>u.chainNamespace===this.namespace&&u.id.toString()===c[0]?.chainId?.toString());c.length>0&&i({connectorId:a.id,accounts:c.map(u=>({address:u.address})),caipNetwork:l})}else{const{accounts:c,chainId:l}=await bu.fetchProviderData(a);if(c.length>0&&l){const u=n.find(d=>d.chainNamespace===this.namespace&&d.id.toString()===l.toString());i({connectorId:a.id,accounts:c.map(d=>({address:d})),caipNetwork:u}),a.provider&&a.id!==H.CONNECTOR_ID.AUTH&&a.id!==H.CONNECTOR_ID.WALLET_CONNECT&&o(a.id,a.provider)}}}))}async syncSolanaConnections({connectors:t,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(t.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===H.CONNECTOR_ID.WALLET_CONNECT){const c=Xr.getWalletConnectAccounts(r,this.namespace);c.length>0&&i({connectorId:a.id,accounts:c.map(l=>({address:l.address})),caipNetwork:n})}else{const c=await a.connect({chainId:n?.id});c&&(i({connectorId:a.id,accounts:[{address:c}],caipNetwork:n}),o(a.id,a.provider))}}))}async syncBitcoinConnections({connectors:t,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(t.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===H.CONNECTOR_ID.WALLET_CONNECT){const h=Xr.getWalletConnectAccounts(r,this.namespace);h.length>0&&i({connectorId:a.id,accounts:h.map(p=>({address:p.address})),caipNetwork:n});return}const c=await a.connect();let u=(await a.getAccountAddresses())?.map(h=>ce.createAccount(H.CHAIN.BITCOIN,h.address,h.purpose||"payment",h.publicKey,h.path));if(u&&u.length>1&&(u=[{namespace:H.CHAIN.BITCOIN,publicKey:u[wo.ACCOUNT_INDEXES.PAYMENT]?.publicKey??"",path:u[wo.ACCOUNT_INDEXES.PAYMENT]?.path??"",address:u[wo.ACCOUNT_INDEXES.PAYMENT]?.address??"",type:"payment"},{namespace:H.CHAIN.BITCOIN,publicKey:u[wo.ACCOUNT_INDEXES.ORDINAL]?.publicKey??"",path:u[wo.ACCOUNT_INDEXES.ORDINAL]?.path??"",address:u[wo.ACCOUNT_INDEXES.ORDINAL]?.address??"",type:"ordinal"}]),!(a.chains.find(h=>h.id===n?.id)||a.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(o(a.id,a.provider),i({connectorId:a.id,accounts:u.map(h=>({address:h.address,type:h.type})),caipNetwork:n}))}))}getConnection({address:t,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>Cn.isLowerCaseMatch(l.connectorId,n));if(!o)return null;const a=s.find(l=>Cn.isLowerCaseMatch(l.id,o.connectorId)),c=t?o.accounts.find(l=>Cn.isLowerCaseMatch(l.address,t)):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>Cn.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(c=>Cn.isLowerCaseMatch(c.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const Fa={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class fA{constructor({provider:t,namespace:n}){this.id=H.CONNECTOR_ID.WALLET_CONNECT,this.name=zc.ConnectorNamesMap[H.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=zc.ConnectorImageIds[H.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=T.getCaipNetworks.bind(T),this.caipNetworks=this.getCaipNetworks(),this.provider=t,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=z.state.universalProviderConfigOverride,s=Xr.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const t=this.chains.map(n=>n.caipNetworkId);return Cr.universalProviderAuthenticate({universalProvider:this.provider,chains:t,methods:aH})}}const aH=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],cH=[H.CONNECTOR_ID.AUTH,H.CONNECTOR_ID.WALLET_CONNECT];class lH{constructor(t){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>T.getCaipNetworks(n),this.getConnectorId=n=>J.getConnectorId(n),t&&this.construct(t),t?.namespace&&(this.connectionManager=new oH({namespace:t.namespace}))}construct(t){this.projectId=t.projectId,this.namespace=t.namespace,this.adapterType=t.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:t,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===n?.toString());t&&r&&this.addConnection({connectorId:H.CONNECTOR_ID.AUTH,accounts:t,caipNetwork:r})}setAuthProvider(t){t.onConnect(this.onAuthConnected.bind(this)),t.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:H.CONNECTOR_ID.AUTH,type:"AUTH",name:H.CONNECTOR_NAMES.AUTH,provider:t,imageId:zc.ConnectorImageIds[H.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...t){const n=new Set;this.availableConnectors=[...t,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...t){const n=new Set;this.availableConnections=[...t,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(t){this.availableConnections=this.availableConnections.filter(n=>!Cn.isLowerCaseMatch(n.connectorId,t)),this.emit("connections",this.availableConnections)}clearConnections(t=!1){this.availableConnections=[],t&&this.emit("connections",this.availableConnections)}setStatus(t,n){ae.setStatus(t,n)}on(t,n){this.eventListeners.has(t)||this.eventListeners.set(t,new Set),this.eventListeners.get(t)?.add(n)}off(t,n){const r=this.eventListeners.get(t);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(t=>{t.clear()})}emit(t,n){const r=this.eventListeners.get(t);r&&r.forEach(s=>s(n))}async connectWalletConnect(t){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(t){const{caipNetwork:n,providerType:r}=t;if(!t.provider)return;const s="provider"in t.provider?t.provider.provider:t.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=Or(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const t=this.connectors.find(n=>n instanceof fA);if(!t)throw new Error("WalletConnectConnector not found");return t}onConnect(t,n){if(t.length>0){const{address:r,chainId:s}=ce.getAccount(t[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:t.map(a=>{const{address:c}=ce.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(t,n,r=!0){if(t.length>0){const{address:s}=ce.getAccount(t[0]),i=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});s&&Cn.isLowerCaseMatch(this.getConnectorId(H.CHAIN.EVM),n)&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:n,accounts:t.map(o=>{const{address:a}=ce.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(t){this.removeProviderListeners(t),this.deleteConnection(t),Cn.isLowerCaseMatch(this.getConnectorId(H.CHAIN.EVM),t)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(t,n){const r=typeof t=="string"&&t.startsWith("0x")?Cu.hexStringToNumber(t).toString():t.toString(),s=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),Cn.isLowerCaseMatch(this.getConnectorId(H.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(t,n){if(cH.includes(t))return;const r=o=>this.onAccountsChanged(o,t),s=o=>this.onChainChanged(o,t),i=()=>this.onDisconnect(t);this.providerHandlers[t]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[t]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(t){if(this.providerHandlers[t]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[t];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[t]=null}}emitFirstAvailableConnection(){const t=this.connectionManager?.getConnection({connections:this.connections,connectors:this.connectors});if(t){const[n]=t.accounts;this.emit("accountChanged",{address:n?.address,chainId:t.caipNetwork?.id,connector:t.connector})}}}class uH extends lH{async setUniversalProvider(t){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new fA({provider:t,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(t){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(t.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(t){console.warn("UniversalAdapter:disconnect - error",t)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:t}){const r=this.provider?.session?.namespaces?.[t]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:r.map(s=>ce.createAccount(t,s,t==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(t){if(!(t.caipNetwork&&Le.BALANCE_SUPPORTED_CHAINS.includes(t.caipNetwork?.chainNamespace))||t.caipNetwork?.testnet)return{balance:"0.00",symbol:t.caipNetwork?.nativeCurrency.symbol||""};if(ae.state.balanceLoading&&t.chainId===T.state.activeCaipNetwork?.id)return{balance:ae.state.balance||"0.00",symbol:ae.state.balanceSymbol||""};const s=(await ae.fetchTokenBalance()).find(i=>i.chainId===`${t.caipNetwork?.chainNamespace}:${t.chainId}`&&i.symbol===t.caipNetwork?.nativeCurrency.symbol);return{balance:s?.quantity.numeric||"0.00",symbol:s?.symbol||t.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(t){const{provider:n,message:r,address:s}=t;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return T.state.activeCaipNetwork?.chainNamespace===H.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:ra.encode(new TextEncoder().encode(r)),pubkey:s}},T.state.activeCaipNetwork?.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},T.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(t){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(t){const{caipNetwork:n}=t,r=this.getWalletConnectConnector();if(n.chainNamespace===H.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:ev(n.id)}]})}catch(s){if(s.code===Fa.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===Fa.ERROR_INVALID_CHAIN_ID||s.code===Fa.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===Fa.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:ev(n.id),rpcUrls:[n?.rpcUrls.chainDefault?.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}const dH=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture"],iu={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return!!e.isEnabled&&t.includes("email")},processFallback:e=>e===void 0?Le.DEFAULT_REMOTE_FEATURES.email:!!e},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return e.isEnabled&&t.length>0?t.filter(n=>n!=="email"):!1},processFallback:e=>e===void 0?Le.DEFAULT_REMOTE_FEATURES.socials:typeof e=="boolean"?e?Le.DEFAULT_REMOTE_FEATURES.socials:!1:e},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return e.isEnabled&&t.length>0?t:!1},processFallback:e=>e===void 0?Le.DEFAULT_REMOTE_FEATURES.swaps:typeof e=="boolean"?e?Le.DEFAULT_REMOTE_FEATURES.swaps:!1:e},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return e.isEnabled&&t.length>0?t:!1},processFallback:e=>e===void 0?Le.DEFAULT_REMOTE_FEATURES.onramp:typeof e=="boolean"?e?Le.DEFAULT_REMOTE_FEATURES.onramp:!1:e},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>e===void 0?Le.DEFAULT_REMOTE_FEATURES.activity:!!e},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>e===void 0?Le.DEFAULT_REMOTE_FEATURES.reownBranding:!!e},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>e.isEnabled&&(e.config??[]),processFallback:e=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:()=>Le.DEFAULT_REMOTE_FEATURES.multiWallet}},hH={localSettingsOverridden:new Set,getApiConfig(e,t){return t?.find(n=>n.id===e)},addWarning(e,t){if(e!==void 0){const n=iu[t],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${t}")`:`"features.${t}"`;this.localSettingsOverridden.add(r)}},processFeature(e,t,n,r,s){const i=iu[e],o=t[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return a?.config===null?this.processFallbackFeature(e,o):a?.config?(o!==void 0&&this.addWarning(o,e),this.processApiFeature(e,a)):!1}return this.processFallbackFeature(e,o)},processApiFeature(e,t){return iu[e].processApi(t)},processFallbackFeature(e,t){return iu[e].processFallback(t)},async fetchRemoteFeatures(e){const t=e.basic??!1,n=e.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await he.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!t?Le.DEFAULT_REMOTE_FEATURES:Le.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of dH){const a=this.processFeature(o,n,r,s,t);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Le.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;Ft.open({debugMessage:kn.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class fH{constructor(t){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{if(n){const s=T.getCaipNetworks(n)?.find(a=>a.id===r);if(s)return s;const i=T.getNetworkData(n)?.caipNetwork;return i||T.getRequestedCaipNetworks(n).filter(a=>a.chainNamespace===n)?.[0]}return T.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>T.getCaipNetworks(n),this.getActiveChainNamespace=()=>T.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{T.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>T.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>T.state.activeChain===n||!n?T.state.activeCaipAddress:T.state.chains.get(n)?.accountState?.caipAddress,this.setClientId=n=>{fe.setClientId(n)},this.getProvider=n=>it.getProvider(n),this.getProviderType=n=>it.getProviderId(n),this.getPreferredAccountType=n=>Or(n),this.setCaipAddress=(n,r)=>{ae.setCaipAddress(n,r)},this.setBalance=(n,r,s)=>{ae.setBalance(n,r,s)},this.setProfileName=(n,r)=>{ae.setProfileName(n,r)},this.setProfileImage=(n,r)=>{ae.setProfileImage(n,r)},this.setUser=(n,r)=>{ae.setUser(n,r)},this.resetAccount=n=>{ae.resetAccount(n)},this.setCaipNetwork=n=>{T.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{T.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{ae.setStatus(n,r),J.isConnected()?W.setConnectionStatus("connected"):W.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>T.state.chains.get(n)?.accountState?.address,this.setConnectors=n=>{const r=[...J.state.allConnectors,...n];J.setConnectors(r)},this.setConnections=(n,r)=>{W.setConnections(n,r),X.setConnections(n,r)},this.fetchIdentity=n=>fe.fetchIdentity(n),this.getReownName=n=>tc.getNamesForAddress(n),this.getConnectors=()=>J.getConnectors(),this.getConnectorImage=n=>W2.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?Gu.getConnectionsData(n).connections:(Ft.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?Gu.getConnectionsData(n).recentConnections:(Ft.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){Ft.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await X.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){Ft.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}W.deleteAddressFromConnection(n),X.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=it.getProviderId(r),i=n?{...n,type:s}:void 0;ae.setConnectedWalletInfo(i,r)},this.getIsConnectedState=()=>!!T.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{ae.addAddressLabel(n,r,s)},this.removeAddressLabel=(n,r)=>{ae.removeAddressLabel(n,r)},this.getAddress=n=>T.state.activeChain===n||!n?ae.state.address:T.state.chains.get(n)?.accountState?.address,this.setApprovedCaipNetworksData=n=>T.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{T.resetNetwork(n)},this.addConnector=n=>{J.addConnector(n)},this.resetWcConnection=()=>{X.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{ae.setAddressExplorerUrl(n,r)},this.setSmartAccountDeployed=(n,r)=>{ae.setSmartAccountDeployed(n,r)},this.setPreferredAccountType=(n,r)=>{T.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{z.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=t,this.version=t.sdkVersion,this.caipNetworks=this.extendCaipNetworks(t),this.chainNamespaces=this.getChainNamespacesSet(t.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(t),this.chainAdapters=this.createAdapters(t.adapters),this.readyPromise=this.initialize(t)}getChainNamespacesSet(t,n){const r=t?.map(i=>i.namespace).filter(i=>!!i);if(r?.length)return[...new Set(r)];const s=n?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(t){this.initializeProjectSettings(t),this.initControllers(t),await this.initChainAdapters(),this.sendInitializeEvent(t),z.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await hH.fetchRemoteFeatures(t),z.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&Up.setOnrampProviders(this.remoteFeatures.onramp),(z.state.remoteFeatures?.email||Array.isArray(z.state.remoteFeatures?.socials)&&z.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){try{const t=await he.fetchAllowedOrigins();if(!t||!ce.isClient()){Ft.open(kn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}const n=window.location.origin;Xr.isOriginAllowed(n,t,Fa.DEFAULT_ALLOWED_ANCESTORS)||Ft.open(kn.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(t){if(!(t instanceof Error)){Ft.open(kn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}switch(t.message){case"RATE_LIMITED":Ft.open(kn.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=t.cause instanceof Error?t.cause:t;Ft.open({displayMessage:kn.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:kn.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}default:Ft.open(kn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(t){const{...n}=t;delete n.adapters,delete n.universalProvider,ze.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:t.networks.map(r=>r.id),siweConfig:{options:t.siweConfig?.options||{}}}})}initControllers(t){this.initializeOptionsController(t),this.initializeChainController(t),this.initializeThemeController(t),this.initializeConnectionController(t),this.initializeConnectorController()}initializeThemeController(t){t.themeMode&&yn.setThemeMode(t.themeMode),t.themeVariables&&yn.setThemeVariables(t.themeVariables)}initializeChainController(t){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");T.initialize(t.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&T.setActiveCaipNetwork(n)}initializeConnectionController(t){X.initialize(t.adapters??[]),X.setWcBasic(t.basic??!1)}initializeConnectorController(){J.initialize(this.chainNamespaces)}initializeProjectSettings(t){z.setProjectId(t.projectId),z.setSdkVersion(t.sdkVersion)}initializeOptionsController(t){z.setDebug(t.debug!==!1),z.setEnableWalletConnect(t.enableWalletConnect!==!1),z.setEnableWalletGuide(t.enableWalletGuide!==!1),z.setEnableWallets(t.enableWallets!==!1),z.setEIP6963Enabled(t.enableEIP6963!==!1),z.setEnableNetworkSwitch(t.enableNetworkSwitch!==!1),z.setEnableReconnect(t.enableReconnect!==!1),z.setEnableAuthLogger(t.enableAuthLogger!==!1),z.setCustomRpcUrls(t.customRpcUrls),z.setEnableEmbedded(t.enableEmbedded),z.setAllWallets(t.allWallets),z.setIncludeWalletIds(t.includeWalletIds),z.setExcludeWalletIds(t.excludeWalletIds),z.setFeaturedWalletIds(t.featuredWalletIds),z.setTokens(t.tokens),z.setTermsConditionsUrl(t.termsConditionsUrl),z.setPrivacyPolicyUrl(t.privacyPolicyUrl),z.setCustomWallets(t.customWallets),z.setFeatures(t.features),z.setAllowUnsupportedChain(t.allowUnsupportedChain),z.setUniversalProviderConfigOverride(t.universalProviderConfigOverride),z.setPreferUniversalLinks(t.experimental_preferUniversalLinks),z.setDefaultAccountTypes(t.defaultAccountTypes);const n=this.getDefaultMetaData();if(!t.metadata&&n&&(t.metadata=n),z.setMetadata(t.metadata),z.setDisableAppend(t.disableAppend),z.setEnableEmbedded(t.enableEmbedded),z.setSIWX(t.siwx),!t.projectId){Ft.open(kn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(t.adapters?.find(s=>s.namespace===H.CHAIN.EVM)&&t.siweConfig){if(t.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");z.setSIWX(t.siweConfig.mapToSIWX())}}getDefaultMetaData(){return ce.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(t){const n=this.getActiveChainNamespace();if(n){const r=vo.getUnsupportedNetwork(`${n}:${t}`);T.setActiveCaipNetwork(r)}}getDefaultNetwork(){return vo.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(t,n){return vo.extendCaipNetwork(t,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(t){return vo.extendCaipNetworks(t.networks,{customNetworkImageUrls:t.chainImages,customRpcUrls:t.customRpcUrls,projectId:t.projectId})}extendDefaultCaipNetwork(t){const n=t.networks.find(s=>s.id===t.defaultNetwork?.id);return n?vo.extendCaipNetwork(n,{customNetworkImageUrls:t.chainImages,customRpcUrls:t.customRpcUrls,projectId:t.projectId}):void 0}async disconnectNamespace(t,n){try{this.setLoading(!0,t);let r={connections:[]};const s=this.getAdapter(t);return(T.state.chains.get(t)?.accountState?.caipAddress||!z.state.enableReconnect)&&s?.disconnect&&(r=await s.disconnect({id:n})),this.setLoading(!1,t),r}catch(r){throw this.setLoading(!1,t),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const t=T.state.activeChain,n=this.getAdapter(t),r=this.getCaipNetwork(t)?.id,s=X.getConnections(t),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),W.setConnectedNamespaces([...T.state.chains.keys()]),await this.syncWalletConnectAccount(),await Cr.initializeIfEnabled()},connectExternal:async({id:t,address:n,info:r,type:s,provider:i,chain:o,caipNetwork:a,socialUri:c})=>{const l=T.state.activeChain,u=o||l,d=this.getAdapter(u);if(o&&o!==l&&!a){const f=this.getCaipNetworks().find(g=>g.chainNamespace===o);f&&this.setCaipNetwork(f)}if(!u)throw new Error("connectExternal: namespace not found");if(!d)throw new Error("connectExternal: adapter not found");const h=this.getCaipNetwork(u),p=await d.connect({id:t,address:n,info:r,type:s,provider:i,socialUri:c,chainId:a?.id||h?.id,rpcUrl:a?.rpcUrls?.default?.http?.[0]||h?.rpcUrls?.default?.http?.[0]});if(p)return W.addConnectedNamespace(u),this.syncProvider({...p,chainNamespace:u}),this.setStatus("connected",u),this.syncConnectedWalletInfo(u),W.removeDisconnectedConnectorId(t,u),{address:p.address}},reconnectExternal:async({id:t,info:n,type:r,provider:s})=>{const i=T.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:t,info:n,type:r,provider:s,chainId:this.getCaipNetwork()?.id}),W.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async t=>{const{id:n,chainNamespace:r,initialDisconnect:s}=t||{},i=r||T.state.activeChain,o=J.getConnectorId(i),a=n===H.CONNECTOR_ID.AUTH||o===H.CONNECTOR_ID.AUTH,c=n===H.CONNECTOR_ID.WALLET_CONNECT||o===H.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(T.state.chains.keys());let u=r?[r]:l;(c||a)&&(u=l);const d=u.map(async f=>{const g=J.getConnectorId(f),w=await this.disconnectNamespace(f,n||g);w&&(a&&W.deleteConnectedSocialProvider(),w.connections.forEach(b=>{W.addDisconnectedConnectorId(b.connectorId,f)})),s&&this.onDisconnectNamespace({chainNamespace:f,closeModal:!1})}),h=await Promise.allSettled(d);ke.resetSend(),X.resetWcConnection(),Cr.getSIWX()?.signOutOnDisconnect&&await Cr.clearSessions(),J.setFilterByNamespace(void 0),X.syncStorageConnections();const p=h.filter(f=>f.status==="rejected");if(p.length>0)throw new Error(p.map(f=>f.reason.message).join(", "));ze.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:t=>t?t.some(n=>!!window.ethereum?.[String(n)]):!!window.ethereum,signMessage:async t=>{const n=T.state.activeChain,r=this.getAdapter(T.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");return(await r?.signMessage({message:t,address:ae.state.address,provider:it.getProvider(n)}))?.signature||""},sendTransaction:async t=>{const n=t.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Le.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=it.getProvider(n);return(await r?.sendTransaction({...t,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async t=>{const n=t.chainNamespace;if(n===H.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=it.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas({...t,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const t=T.state.activeChain;if(!t)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:ae.state.address,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:t}),ae.state.profileImage||!1},getEnsAddress:async t=>await Xr.resolveReownName(t),writeContract:async t=>{const n=T.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=it.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract({...t,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(t,n)=>{const r=this.getAdapter(T.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:t,decimals:n})??0n},formatUnits:(t,n)=>{const r=this.getAdapter(T.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:t,decimals:n})??"0"},getCapabilities:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await n?.getCapabilities(t)},grantPermissions:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await n?.grantPermissions(t)},revokePermissions:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n?.revokePermissions?await n.revokePermissions(t):"0x"},walletGetAssets:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await n?.walletGetAssets(t)??{}},updateBalance:t=>{const n=this.getCaipNetwork(t);!n||!ae.state.address||this.updateNativeBalance(ae.state.address,n?.id,t)}},this.networkControllerClient={switchCaipNetwork:async t=>await this.switchCaipNetwork(t),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},X.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(it.getProviderId(T.state.activeChain)===si.CONNECTOR_TYPE_WALLET_CONNECT){const n=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(t){if(!t)return;const n=t.chainNamespace;if(this.getAddressByChainNamespace(t.chainNamespace)){const s=it.getProvider(n),i=it.getProviderId(n);if(t.chainNamespace===T.state.activeChain)await this.getAdapter(n)?.switchNetwork({caipNetwork:t,provider:s,providerType:i});else if(this.setCaipNetwork(t),i===si.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:t.id,chainNamespace:n})}}else this.setCaipNetwork(t)}getChainsFromNamespaces(t={}){return Object.values(t).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=En.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(t){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{const s=t?.find(i=>i.namespace===r);return s?(s.construct({namespace:r,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),n[r]=s):n[r]=new uH({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(t){this.onConnectors(t),this.listenAdapter(t),await this.chainAdapters?.[t].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(t)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async t=>{await this.initChainAdapter(t)}))}onConnectors(t){this.getAdapter(t)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(t){const n=this.getAdapter(t);if(!n)return;const r=W.getConnectionStatus();z.state.enableReconnect===!1?this.setStatus("disconnected",t):r==="connected"?this.setStatus("connecting",t):r==="disconnected"?(W.clearAddressCache(),this.setStatus(r,t)):this.setStatus(r,t),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=T.state.activeChain===t,c=T.state.chains.get(t)?.accountState?.address;if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:t})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(X.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:t,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,t)}),n.on("pendingTransactions",()=>{const s=ae.state.address,i=T.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{const a=T.state.activeChain===t;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o.provider,chainNamespace:t}),this.syncConnectedWalletInfo(t)),a&&i?this.syncAccount({address:s,chainId:i,chainNamespace:t}):a&&T.state.activeCaipNetwork?.id?this.syncAccount({address:s,chainId:T.state.activeCaipNetwork?.id,chainNamespace:t}):this.syncAccountInfo(s,i,t),W.addConnectedNamespace(t)})}async createUniversalProviderForAdapter(t){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[t]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(t=>this.syncNamespaceConnection(t)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(t=>X.disconnect({namespace:t,initialDisconnect:!0})))}catch(t){console.error("Error disconnecting existing connections:",t)}}async syncNamespaceConnection(t){try{t===H.CHAIN.EVM&&ce.isSafeApp()&&J.setConnectorId(H.CONNECTOR_ID.SAFE,t);const n=J.getConnectorId(t);switch(this.setStatus("connecting",t),n){case H.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case H.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(t)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",t)}}onDisconnectNamespace(t){const{chainNamespace:n,closeModal:r}=t||{};T.resetAccount(n),T.resetNetwork(n),W.removeConnectedNamespace(n);const s=Array.from(T.state.chains.keys());(n?[n]:s).forEach(o=>W.addDisconnectedConnectorId(J.getConnectorId(o)||"",o)),J.removeConnectorId(n),it.resetChain(n),this.setUser(void 0,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(void 0,n),r!==!1&&Ae.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(t=>{const n=this.getCaipAddress(t),r=this.getCaipNetwork(t);return this.chainAdapters?.[t].syncConnections({connectToFirstConnector:!n,caipNetwork:r,getConnectorStorageInfo(s){const o=W.getConnections()[t]??[];return{hasDisconnected:W.isConnectorDisconnected(s,t),hasConnected:o.some(a=>Cn.isLowerCaseMatch(a.connectorId,s))}}})}))}async syncAdapterConnection(t){const n=this.getAdapter(t),r=J.getConnectorId(t),s=this.getCaipNetwork(t),o=J.getConnectors(t).find(a=>a.id===r);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${t}`);if(!s?.id)throw new Error("CaipNetwork not found");const a=await n?.syncConnection({namespace:t,id:o.id,chainId:s.id,rpcUrl:s?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:t}),await this.syncAccount({...a,chainNamespace:t}),this.setStatus("connected",t)):this.setStatus("disconnected",t)}catch{this.onDisconnectNamespace({chainNamespace:t,closeModal:!1})}}async syncWalletConnectAccount(){const t=Object.keys(this.universalProvider?.session?.namespaces||{}),n=this.chainNamespaces.map(async r=>{const s=this.getAdapter(r);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=T.state.activeCaipNetwork?.id,a=i.find(c=>{const{chainId:l}=En.parseCaipAddress(c);return l===o?.toString()})||i[0];if(a){const c=En.validateCaipAddress(a),{chainId:l,address:u}=En.parseCaipAddress(c);if(it.setProviderId(r,si.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&T.state.activeCaipNetwork&&s.namespace!==H.CHAIN.EVM){const d=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:T.state.activeCaipNetwork});it.setProvider(r,d)}else it.setProvider(r,this.universalProvider);J.setConnectorId(H.CONNECTOR_ID.WALLET_CONNECT,r),W.addConnectedNamespace(r),await this.syncAccount({address:u,chainId:l,chainNamespace:r})}else t.includes(r)&&this.setStatus("disconnected",r);this.syncConnectedWalletInfo(r),await T.setApprovedCaipNetworksData(r)});await Promise.all(n)}syncProvider({type:t,provider:n,id:r,chainNamespace:s}){it.setProviderId(s,t),it.setProvider(s,n),J.setConnectorId(r,s)}async syncAccount(t){const n=t.chainNamespace===T.state.activeChain,r=T.getCaipNetworkByNamespace(t.chainNamespace,t.chainId),{address:s,chainId:i,chainNamespace:o}=t,{chainId:a}=W.getActiveNetworkProps(),c=i||a,l=T.state.activeCaipNetwork?.name===H.UNSUPPORTED_NETWORK_NAME,u=T.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(f=>f.id.toString()===c.toString()),h=this.getCaipNetworks().find(f=>f.chainNamespace===o);if(!u&&!d&&!h){const f=this.getApprovedCaipNetworkIds()||[],g=f.find(b=>En.parseCaipNetworkId(b)?.chainId===c.toString()),w=f.find(b=>En.parseCaipNetworkId(b)?.chainNamespace===o);d=this.getCaipNetworks().find(b=>b.caipNetworkId===g),h=this.getCaipNetworks().find(b=>b.caipNetworkId===w||"deprecatedCaipNetworkId"in b&&b.deprecatedCaipNetworkId===w)}const p=d||h;p?.chainNamespace===T.state.activeChain?z.state.enableNetworkSwitch&&!z.state.allowUnsupportedChain&&T.state.activeCaipNetwork?.name===H.UNSUPPORTED_NETWORK_NAME?T.showUnsupportedChainUI():this.setCaipNetwork(p):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o),Cn.isLowerCaseMatch(s,ae.state.address)||this.syncAccountInfo(s,p?.id,o),n?await this.syncBalance({address:s,chainId:p?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r?.id,chainNamespace:o})}}async syncAccountInfo(t,n,r){const s=this.getCaipAddress(r),i=n||s?.split(":")[1];if(!i)return;const o=`${r}:${i}:${t}`;this.setCaipAddress(o,r),await this.syncIdentity({address:t,chainId:i,chainNamespace:r})}async syncReownName(t,n){try{const r=await this.getReownName(t);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(t){const n=J.getConnectorId(t),r=it.getProviderId(t);if(r===si.CONNECTOR_TYPE_ANNOUNCED||r===si.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{const a=o.id===n,c=o.info?.rdns===n,l=o.connectors?.some(u=>u.id===n||u.info?.rdns===n);return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},t)}}}else if(r===si.CONNECTOR_TYPE_WALLET_CONNECT){const s=it.getProvider(t);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},t)}else if(n&&(n===H.CONNECTOR_ID.COINBASE_SDK||n===H.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===n),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},t)}}async syncBalance(t){!B2.getNetworksByNamespace(this.getCaipNetworks(),t.chainNamespace).find(r=>r.id.toString()===t.chainId?.toString())||!t.chainId||await this.updateNativeBalance(t.address,t.chainId,t.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(t,n,r){const s=this.getAdapter(r),i=T.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:t,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){const t=$z.createLogger((r,...s)=>{r&&this.handleAlertError(r),console.error(...s)}),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:t};z.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await M2.init(n),z.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(t=>{Xr.listenWcProvider({universalProvider:this.universalProvider,namespace:t,onDisplayUri:n=>{X.setUri(n)},onConnect:()=>{X.finalizeWcConnection()},onDisconnect:()=>{T.state.noAdapters&&this.resetAccount(t),X.resetWcConnection()},onChainChanged:n=>{const r=T.state.activeChain,s=r&&J.state.activeConnectorIds[r]===H.CONNECTOR_ID.WALLET_CONNECT;if(r===t&&(T.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=T.state.activeChain,s=r&&J.state.activeConnectorIds[r]===H.CONNECTOR_ID.WALLET_CONNECT;if(r===t&&(T.state.noAdapters||s)&&n.length>0){const i=n[0];this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&ce.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(t){ze.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:t instanceof Error?t.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",t)}return this.universalProvider}handleAlertError(t){const n=Object.entries(kn.UniversalProviderErrors).find(([,{message:a}])=>t.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=kn.ALERT_ERRORS[o];a&&(Ft.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(t){if(t)return this.chainAdapters?.[t]}createAdapter(t){if(!t)return;const n=t.namespace;if(!n)return;this.createClients();const r=t;r.namespace=n,r.construct({namespace:n,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(t){if(await this.injectModalUi(),t?.uri&&X.setUri(t.uri),t?.arguments)switch(t?.view){case"Swap":return Ae.open({...t,data:{swap:t.arguments}})}return Ae.open(t)}async close(){await this.injectModalUi(),Ae.close()}setLoading(t,n){Ae.setLoading(t,n)}async disconnect(t){await X.disconnect({namespace:t})}getSIWX(){return z.state.siwx}getError(){return""}getChainId(){return T.state.activeCaipNetwork?.id}async switchNetwork(t){const n=this.getCaipNetworks().find(r=>r.id===t.id);if(!n){Ft.open(kn.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await T.switchActiveNetwork(n)}getWalletProvider(){return T.state.activeChain?it.state.providers[T.state.activeChain]:null}getWalletProviderType(){return it.getProviderId(T.state.activeChain)}subscribeProviders(t){return it.subscribeProviders(t)}getThemeMode(){return yn.state.themeMode}getThemeVariables(){return yn.state.themeVariables}setThemeMode(t){yn.setThemeMode(t),hA(yn.state.themeMode)}setTermsConditionsUrl(t){z.setTermsConditionsUrl(t)}setPrivacyPolicyUrl(t){z.setPrivacyPolicyUrl(t)}setThemeVariables(t){yn.setThemeVariables(t),nH(yn.state.themeVariables)}subscribeTheme(t){return yn.subscribe(t)}subscribeConnections(t){return this.remoteFeatures.multiWallet?X.subscribe(t):(Ft.open(H.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(t){return t?T.state.chains.get(t)?.accountState?.connectedWalletInfo:ae.state.connectedWalletInfo}getAccount(t){const n=t||T.state.activeChain,r=J.getAuthConnector(n),s=T.getAccountData(n),i=W.getConnectedConnectorId(T.state.activeChain),o=X.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u})=>ce.createAccount(n,l,u||"eoa")));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:ce.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===H.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:W.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:Or(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(t,n){const r=()=>{const s=this.getAccount(n);s&&t(s)};n?T.subscribeChainProp("accountState",r,n):T.subscribe(r),J.subscribe(r)}subscribeNetwork(t){return T.subscribe(({activeCaipNetwork:n})=>{t({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})})}subscribeWalletInfo(t,n){return n?ae.subscribeKey("connectedWalletInfo",t,n):ae.subscribeKey("connectedWalletInfo",t)}subscribeShouldUpdateToAddress(t){ae.subscribeKey("shouldUpdateToAddress",t)}subscribeCaipNetworkChange(t){T.subscribeKey("activeCaipNetwork",t)}getState(){return Yr.state}getRemoteFeatures(){return z.state.remoteFeatures}subscribeState(t){return Yr.subscribe(t)}subscribeRemoteFeatures(t){return z.subscribeKey("remoteFeatures",t)}showErrorMessage(t){Ir.showError(t)}showSuccessMessage(t){Ir.showSuccess(t)}getEvent(){return{...ze.state}}subscribeEvents(t){return ze.subscribe(t)}replace(t){pe.replace(t)}redirect(t){pe.push(t)}popTransactionStack(t){pe.popTransactionStack(t)}isOpen(){return Ae.state.open}isTransactionStackEmpty(){return pe.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(t){z.setFeatures(t)}updateRemoteFeatures(t){z.setRemoteFeatures(t)}updateOptions(t){const r={...z.state||{},...t};z.setOptions(r)}setConnectMethodsOrder(t){z.setConnectMethodsOrder(t)}setWalletFeaturesOrder(t){z.setWalletFeaturesOrder(t)}setCollapseWallets(t){z.setCollapseWallets(t)}setSocialsOrder(t){z.setSocialsOrder(t)}getConnectMethodsOrder(){return Rp.getConnectOrderMethod(z.state.features,J.getConnectors())}addNetwork(t,n){if(this.chainAdapters&&!this.chainAdapters[t])throw new Error(`Adapter for namespace ${t} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||T.addNetwork(r)}removeNetwork(t,n){if(this.chainAdapters&&!this.chainAdapters[t])throw new Error(`Adapter for namespace ${t} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&T.removeNetwork(t,n)}}let yv=!1;class pH extends fH{async open(t){J.isConnected()||await super.open(t)}async close(){await super.close(),this.options.manualWCControl&&X.finalizeWcConnection()}async syncIdentity(t){return Promise.resolve()}async syncBalance(t){return Promise.resolve()}async injectModalUi(){if(!yv&&ce.isClient()){if(await ic(()=>import("./basic-BEPEehjQ.js"),__vite__mapDeps([0,1])),await ic(()=>import("./w3m-modal-BO978Jc9.js"),__vite__mapDeps([2,1])),!document.querySelector("w3m-modal")){const n=document.createElement("w3m-modal");!z.state.disableAppend&&!z.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",n)}yv=!0}}}const gH="1.7.17";function wH(e){return new pH({...e,basic:!0,sdkVersion:`html-core-${gH}`})}class cw{constructor({appKit:t,provider:n,config:r}){this.appKit=t,this.provider=n,this.config=r}static async init(t){const n=await X7.init({projectId:t.projectId,metadata:t.metadata}),r={networks:t.networks.flatMap(i=>i.chains),projectId:t.projectId,metadata:t.metadata,universalProvider:n,manualWCControl:!0},s=wH(r);return new cw({appKit:s,provider:n,config:t})}async connect(){const t=this.config?.networks.reduce((n,r)=>(n[r.namespace]={...r||{},methods:r?.methods||[],events:r?.events||[],chains:r?.chains?.map(s=>s.caipNetworkId)||[]},n),{});try{await this.appKit.open();const n=await this.provider.connect({optionalNamespaces:t});if(!n)throw new Error("Error connecting to wallet: No session found");return await this.appKit.close(),{session:n}}catch(n){throw await this.appKit.close(),new Error(`Error connecting to wallet: ${n instanceof Error?n.message:"Unknown error"}`)}}async disconnect(){await this.appKit.disconnect(),await this.provider.disconnect()}async request(t,n){return await this.provider.request(t,n)}}var pA=Object.defineProperty,mH=Object.defineProperties,yH=Object.getOwnPropertyDescriptors,Ju=Object.getOwnPropertySymbols,gA=Object.prototype.hasOwnProperty,wA=Object.prototype.propertyIsEnumerable,bv=(e,t,n)=>t in e?pA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ct=(e,t)=>{for(var n in t||(t={}))gA.call(t,n)&&bv(e,n,t[n]);if(Ju)for(var n of Ju(t))wA.call(t,n)&&bv(e,n,t[n]);return e},or=(e,t)=>mH(e,yH(t)),bH=(e,t)=>{var n={};for(var r in e)gA.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Ju)for(var r of Ju(e))t.indexOf(r)<0&&wA.call(e,r)&&(n[r]=e[r]);return n},vH=(e,t)=>{for(var n in t)pA(e,n,{get:t[n],enumerable:!0})},li=class mA extends Error{constructor(t,n,r,s){super(t),this.message=t,this.code=n,this.data=r,this.cause=s,this.name="JsonRpcError",this.message=t,this.code=n,this.data=r,this.cause=s}static fromResponse(t){return new mA(t.message,t.code,t.data)}toString(){return`${this.name} (${this.code}): ${this.message}${this.data?`: ${JSON.stringify(this.data)}`:""}`}},EH=(e=>(e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError",e[e.UserRejection=-32e3]="UserRejection",e[e.MethodAddressMismatch=-32001]="MethodAddressMismatch",e[e.MethodAccessDenied=-32002]="MethodAccessDenied",e[e.UnknownError=-31e3]="UnknownError",e[e.UserCanceled=-31001]="UserCanceled",e))(EH||{}),yA="asigna-stx",af=(e,t)=>new Promise(n=>{function r(s){s.data.source===yA&&s.data[t]&&(n(s.data[t]),window.removeEventListener("message",r))}window.addEventListener("message",r),window.top.postMessage(AH(e,t),"*")}),CH={authenticationRequest:async e=>af(e,"authenticationRequest"),transactionRequest:async e=>af(e,"transactionRequest"),request:async(e,t)=>af(t,e)},AH=(e,t)=>({source:yA,[t]:e}),IH=()=>{typeof window>"u"||window.top!==window.self&&(window.AsignaProvider=CH)};IH();var SH=[{id:"LeatherProvider",name:"Leather",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iMjYuODM4NyIgZmlsbD0iIzEyMTAwRiIvPgo8cGF0aCBkPSJNNzQuOTE3MSA1Mi43MTE0QzgyLjQ3NjYgNTEuNTQwOCA5My40MDg3IDQzLjU4MDQgOTMuNDA4NyAzNy4zNzYxQzkzLjQwODcgMzUuNTAzMSA5MS44OTY4IDM0LjIxNTQgODkuNjg3MSAzNC4yMTU0Qzg1LjUwMDQgMzQuMjE1NCA3OC40MDYxIDQwLjUzNjggNzQuOTE3MSA1Mi43MTE0Wk0zOS45MTEgODMuNDk5MUMzMC4wMjU2IDgzLjQ5OTEgMjkuMjExNSA5My4zMzI0IDM5LjA5NjkgOTMuMzMyNEM0My41MTYzIDkzLjMzMjQgNDguODY2MSA5MS41NzY0IDUxLjY1NzMgODguNDE1N0M0Ny41ODY4IDg0LjkwMzggNDQuMjE0MSA4My40OTkxIDM5LjkxMSA4My40OTkxWk0xMDIuODI5IDc5LjI4NDhDMTAzLjQxIDk1Ljc5MDcgOTUuMDM2OSAxMDUuMDM5IDgwLjg0ODQgMTA1LjAzOUM3Mi40NzQ4IDEwNS4wMzkgNjguMjg4MSAxMDEuODc4IDU5LjMzMyA5Ni4wMjQ5QzU0LjY4MSAxMDEuMTc2IDQ1Ljg0MjMgMTA1LjAzOSAzOC41MTU0IDEwNS4wMzlDMTMuMjc4NSAxMDUuMDM5IDE0LjMyNTIgNzIuODQ2MyA0MC4wMjczIDcyLjg0NjNDNDUuMzc3MSA3Mi44NDYzIDQ5LjkxMjggNzQuMjUxMSA1NS43Mjc3IDc3Ljg4TDU5LjU2NTYgNjQuNDE3N0M0My43NDg5IDYwLjA4NjQgMzUuODQwNSA0Ny45MTE4IDQzLjYzMjYgMzAuNDY5M0g1Ni4xOTI5QzQ5LjIxNSA0Mi4wNTg2IDUzLjk4MzIgNTEuNjU3OCA2Mi44MjIgNTIuNzExNEM2Ny41OTAzIDM1LjczNzIgNzcuODI0NiAyMi41MDkgOTEuNDMxNiAyMi41MDlDOTkuMTA3NCAyMi41MDkgMTA1LjE1NSAyNy41NDI4IDEwNS4xNTUgMzYuNjczN0MxMDUuMTU1IDUxLjMwNjYgODYuMDgxOSA2My4yNDcxIDcxLjY2MDcgNjQuNDE3N0w2NS43Mjk1IDg1LjM3MjFDNzIuNDc0OCA5My4yMTUzIDkxLjE5OSAxMDAuODI0IDkxLjE5OSA3OS4yODQ4SDEwMi44MjlaIiBmaWxsPSIjRjVGMUVEIi8+Cjwvc3ZnPgo=",webUrl:"https://leather.io",chromeWebStoreUrl:"https://chrome.google.com/webstore/detail/hiro-wallet/ldinpeekobnhjjdofggfgjlcehhmanlj",mozillaAddOnsUrl:"https://leather.io/install-extension"},{id:"XverseProviders.BitcoinProvider",name:"Xverse Wallet",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNjAwIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGZpbGw9IiMxNzE3MTciIGQ9Ik0wIDBoNjAwdjYwMEgweiIvPjxwYXRoIGZpbGw9IiNGRkYiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTQ0MCA0MzUuNHYtNTFjMC0yLS44LTMuOS0yLjItNS4zTDIyMCAxNjIuMmE3LjYgNy42IDAgMCAwLTUuNC0yLjJoLTUxLjFjLTIuNSAwLTQuNiAyLTQuNiA0LjZ2NDcuM2MwIDIgLjggNCAyLjIgNS40bDc4LjIgNzcuOGE0LjYgNC42IDAgMCAxIDAgNi41bC03OSA3OC43Yy0xIC45LTEuNCAyLTEuNCAzLjJ2NTJjMCAyLjQgMiA0LjUgNC42IDQuNUgyNDljMi42IDAgNC42LTIgNC42LTQuNlY0MDVjMC0xLjIuNS0yLjQgMS40LTMuM2w0Mi40LTQyLjJhNC42IDQuNiAwIDAgMSA2LjQgMGw3OC43IDc4LjRhNy42IDcuNiAwIDAgMCA1LjQgMi4yaDQ3LjVjMi41IDAgNC42LTIgNC42LTQuNloiLz48cGF0aCBmaWxsPSIjRUU3QTMwIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGQ9Ik0zMjUuNiAyMjcuMmg0Mi44YzIuNiAwIDQuNiAyLjEgNC42IDQuNnY0Mi42YzAgNCA1IDYuMSA4IDMuMmw1OC43LTU4LjVjLjgtLjggMS4zLTIgMS4zLTMuMnYtNTEuMmMwLTIuNi0yLTQuNi00LjYtNC42TDM4NCAxNjBjLTEuMiAwLTIuNC41LTMuMyAxLjNsLTU4LjQgNTguMWE0LjYgNC42IDAgMCAwIDMuMiA3LjhaIi8+PC9nPjwvc3ZnPg==",webUrl:"https://xverse.app",chromeWebStoreUrl:"https://chrome.google.com/webstore/detail/xverse-wallet/idnnbdplmphpflfnlkomgpfbpcgelopg",googlePlayStoreUrl:"https://play.google.com/store/apps/details?id=com.secretkeylabs.xverse",iOSAppStoreUrl:"https://apps.apple.com/app/xverse-bitcoin-web3-wallet/id1552272513",mozillaAddOnsUrl:"https://www.xverse.app/download"},{id:"AsignaProvider",name:"Asigna Multisig",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMDEwMCIgZD0iTTAgMGgzMnYzMkgweiIvPjxwYXRoIGZpbGw9InVybCgjYSkiIGQ9Ik0xNS4xMSA1LjU1YTMgMyAwIDAgMC0xLjgyIDEuM2wtLjA1LjA4LS40My43Mi0uMDcuMTEtLjUuODUtLjA1LjA5LTEuMjkgMi4xOC0uMDQuMDctLjQ3LjgtLjA2LjEtLjQ2Ljc4LS4wNy4xMS0xLjYzIDIuNzYtLjA3LjExLS4zOC42Ni0uMDUuMDgtLjczIDEuMjQtLjM1LjYtLjQuNjctLjA1LjA5TDUuMSAyMC43bC0uMTEuMTgtLjE0LjIzLS4wNy4xMy0uMzMuNTUtLjA0LjA3di4wMWExLjI2IDEuMjYgMCAwIDAtLjE0LjQ3IDEuMzEgMS4zMSAwIDAgMCAxLjI0IDEuNGgxLjVsLjA1LS4wNi4wNC0uMDYuODctMS4yMS4wNS0uMDguNzctMS4wNy4wNS0uMDcuNC0uNTcuMDUtLjA2LjI0LS4zNGExLjUyIDEuNTIgMCAwIDEgMS4zOS0uNjIgMS41IDEuNSAwIDAgMSAuNjQuMiAxLjQ3IDEuNDcgMCAwIDEgLjczIDEuMjcgMS40NCAxLjQ0IDAgMCAxLS4yNy44NGwtLjYzLjg4LS4wNS4wNy0uMzIuNDUtLjA2LjA4LS4wOC4xMi0uMTIuMTYtLjA1LjA4aDIuMTNhMi4zMiAyLjMyIDAgMCAwIDEuNzctLjk2bDEuMTgtMS42My43Ny0xLjA4IDEuMy0xLjhhMS4yNCAxLjI0IDAgMCAxIC41NS0uNDNsLjA4LS4wM2ExLjMgMS4zIDAgMCAxIC4zLS4wNiAxLjI4IDEuMjggMCAwIDEgMS4xNS41NGwuMTEuMmExLjEzIDEuMTMgMCAwIDEgLjEuNDEgMS4xOSAxLjE5IDAgMCAxLS4yMy43N2wtLjAzLjA1LS41Ny44LS43Ljk4LS4yNy4zN2ExLjIyIDEuMjIgMCAwIDAtLjIuNSAxLjA1IDEuMDUgMCAwIDAtLjAyLjIzdi4wNmExLjE3IDEuMTcgMCAwIDAgLjE0LjQzbC4wMi4wNS4wNy4xYTEuNDQgMS40NCAwIDAgMCAuMS4xMWwuMDUuMDYuMDEuMDFhMS44IDEuOCAwIDAgMCAuMTQuMWMwIC4wMi4wMi4wMy4wNC4wM2ExIDEgMCAwIDAgLjA4LjA1bC4wNy4wNGExLjI1IDEuMjUgMCAwIDAgLjUuMWg2LjljLjEgMCAuMi0uMDEuMjktLjAzbC4wNi0uMDJhMS4yNyAxLjI3IDAgMCAwIC4yNy0uMS41Ny41NyAwIDAgMCAuMDctLjAzIDEuMjEgMS4yMSAwIDAgMCAuMjYtLjE5bC4wOC0uMDdhLjkyLjkyIDAgMCAwIC4xNS0uMTkgMS41NSAxLjU1IDAgMCAwIC4wOS0uMTdsLjAyLS4wNWExLjIyIDEuMjIgMCAwIDAgLjA4LS4yNnYtLjA0bC4wMi0uMDh2LS4wOGExLjMyIDEuMzIgMCAwIDAtLjItLjc0bC0xLjYtMi42NC0uMDYtLjEtLjItLjMyLS4zMy0uNTR2LS4wMWwtLjA1LS4wOC0xLjMtMi4xNS0uMDctLjEtLjA0LS4wNi0uOC0xLjMyLS4wNC0uMDctLjItLjM0LS4xLS4xNC0uMS0uMTYtLjUzLS45LS4xMy0uMi0uMDktLjE0LTIuMTctMy41Ny0uMDQtLjA3LS43Mi0xLjE5LS4wNS0uMDctLjQtLjY1YTIuNjUgMi42NSAwIDAgMC0uMy0uNCAyLjk2IDIuOTYgMCAwIDAtLjk3LS43NCAzLjA0IDMuMDQgMCAwIDAtMS4zLS4zYy0uMjUgMC0uNS4wNC0uNzQuMVoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMTkgMTYuM2E1LjQ1IDUuNDUgMCAwIDAtLjgzIDEuNTZsLS4wNC4xNWExLjM2IDEuMzYgMCAwIDEgLjI4LS4xNiAxLjI0IDEuMjQgMCAwIDEgLjM4LS4wOGguMWExLjI4IDEuMjggMCAwIDEgMS4wNS41NGMuMDQuMDYuMDguMTMuMS4yYTEuMjQgMS4yNCAwIDAgMSAuMDkuMjcgMS4xOSAxLjE5IDAgMCAxLS4yLjkxbC0uMDQuMDUtLjU3Ljc5LS43Ljk5LS4yNy4zN2ExLjIzIDEuMjMgMCAwIDAtLjIuNDIgMS4wNiAxLjA2IDAgMCAwLS4wMi4zMXYuMDZhMS4xNyAxLjE3IDAgMCAwIC4xNi40Ny45My45MyAwIDAgMCAuMDcuMSAxLjUgMS41IDAgMCAwIC4xLjEybC4wNS4wNmguMDFhMS45NCAxLjk0IDAgMCAwIC4wOS4wOCAxIDEgMCAwIDAgLjE3LjFsLjA3LjA0YTEuMjUgMS4yNSAwIDAgMCAuNS4xaDYuOWMuMSAwIC4yIDAgLjI4LS4wMmwuMDctLjAyYTEuMzIgMS4zMiAwIDAgMCAuMzQtLjEzbC4xNi0uMS4wMy0uMDNhMS4yOSAxLjI5IDAgMCAwIC4yLS4yIDIuNDMgMi40MyAwIDAgMCAuMTItLjE3Yy4wMy0uMDMuMDUtLjA4LjA3LS4xMmwuMDItLjA1YTEuMjEgMS4yMSAwIDAgMCAuMDktLjN2LS4wOGwuMDEtLjA5YTEuMzIgMS4zMiAwIDAgMC0uMi0uNzNsLTEuNi0yLjY0LS4wNi0uMS0uMi0uMzItLjMzLS41NHYtLjAybC0uMDUtLjA3LTEuMy0yLjE1LS4xMi0uMDctLjA3LS4wNGE0Ljk0IDQuOTQgMCAwIDAtMi40Ni0uNjdjLTEuMDMgMC0xLjc2LjU3LTIuMjYgMS4yWiIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi4yOSAyMS4wOGMwIC4yOS0uMDkuNTgtLjI3Ljg0bC0xLjMxIDEuODRIN2wyLjUyLTMuNTNhMS41NCAxLjU0IDAgMCAxIDIuMS0uMzZjLjQzLjI4LjY2Ljc0LjY2IDEuMloiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTEuMTYgMjEuMjVhLjU2LjU2IDAgMCAxLS41Ny41NS41Ni41NiAwIDAgMS0uNTctLjU2LjU2LjU2IDAgMCAxIC41Ny0uNTUuNTYuNTYgMCAwIDEgLjU3LjU2WiIvPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9IjE1LjIzIiB4Mj0iMTkuMyIgeTE9IjI1Ljc4IiB5Mj0iNi4xMSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiM2NTIyRjQiLz48c3RvcCBvZmZzZXQ9Ii41NSIgc3RvcC1jb2xvcj0iIzlCNkJGRiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI0E1ODVGRiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJiIiB4MT0iMjIuNTkiIHgyPSIyNC44IiB5MT0iMjQuNzEiIHkyPSIxNS41MyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiM0MjFGOEIiLz48c3RvcCBvZmZzZXQ9Ii41NSIgc3RvcC1jb2xvcj0iIzcyMzBGRiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk3NzNGRiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjwvc3ZnPg==",webUrl:"https://asigna.io",chromeWebStoreUrl:"https://stx.asigna.io/"},{id:"FordefiProviders.UtxoProvider",name:"Fordefi",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDIiIGhlaWdodD0iNDIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZmlsbD0iIzEwMTExNCIgZD0iTTAgMGg0MnY0MkgweiIvPgogIDxwYXRoIGQ9Ik0xOS40NyAyNi44OUg1djMuNTdhNC41NyA0LjU3IDAgMCAwIDQuNTggNC41N2g1LjgzbDQuMDYtOC4xNFoiIGZpbGw9IiM3OTk0RkYiLz4KICA8cGF0aCBkPSJNNSAxNy40aDI3LjU4bC0zLjIgNi43OEg1VjE3LjRaIiBmaWxsPSIjNDg2REZGIi8+CiAgPHBhdGggZD0iTTE0LjY3IDdINXY3LjY4aDMzVjdoLTkuNjd2NS43NGgtMlY3aC05LjY3djUuNzRoLTEuOTlWN1oiIGZpbGw9IiM1Q0QxRkEiLz4KPC9zdmc+Cg==",webUrl:"https://www.fordefi.com/",chromeWebStoreUrl:"https://chromewebstore.google.com/detail/fordefi/hcmehenccjdmfbojapcbcofkgdpbnlle"}],vv={id:"WalletConnectProvider",name:"WalletConnect",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIiBmaWxsPSJub25lIj48bWFzayBpZD0iYSIgd2lkdGg9IjQwMCIgaGVpZ2h0PSI0MDAiIHg9IjAiIHk9IjAiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHN0eWxlPSJtYXNrLXR5cGU6bHVtaW5hbmNlIj48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMCAwaDQwMHY0MDBIMFYwWiIvPjwvbWFzaz48ZyBtYXNrPSJ1cmwoI2EpIj48cGF0aCBmaWxsPSIjMzM5NkZGIiBkPSJNNDAwIDQwMEgwVjBoNDAwdjQwMFoiLz48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTIyLjUyIDE0OC45N2M0Mi43OS00MS43MyAxMTIuMTctNDEuNzMgMTU0Ljk2IDBsNS4xNSA1LjAyYTUuMjUgNS4yNSAwIDAgMSAwIDcuNTVsLTE3LjYyIDE3LjE4YTIuNzkgMi43OSAwIDAgMS0zLjg3IDBsLTcuMDktNi45Yy0yOS44NS0yOS4xMi03OC4yNS0yOS4xMi0xMDguMSAwbC03LjYgNy40YTIuNzkgMi43OSAwIDAgMS0zLjg3IDBsLTE3LjYxLTE3LjE5YTUuMjUgNS4yNSAwIDAgMSAwLTcuNTVsNS42NS01LjUxWm0xOTEuNCAzNS41MiAxNS42OCAxNS4zYTUuMjUgNS4yNSAwIDAgMSAwIDcuNTVsLTcwLjcgNjguOTRhNS41OCA1LjU4IDAgMCAxLTcuNzUgMGwtNTAuMTgtNDguOTNhMS40IDEuNCAwIDAgMC0xLjk0IDBsLTUwLjE4IDQ4LjkzYTUuNTggNS41OCAwIDAgMS03Ljc0IDBsLTcwLjctNjguOTRhNS4yNSA1LjI1IDAgMCAxIDAtNy41NmwxNS42Ny0xNS4yOWE1LjU4IDUuNTggMCAwIDEgNy43NSAwbDUwLjE4IDQ4Ljk0Yy41NC41MiAxLjQuNTIgMS45NCAwbDUwLjE4LTQ4Ljk0YTUuNTggNS41OCAwIDAgMSA3Ljc0IDBsNTAuMTggNDguOTRjLjU0LjUyIDEuNC41MiAxLjk0IDBsNTAuMTgtNDguOTRhNS41OCA1LjU4IDAgMCAxIDcuNzUgMFoiLz48L2c+PC9zdmc+",webUrl:"https://walletconnect.com/",chromeWebStoreUrl:""};function NH(){return td(Lv())||window.StacksProvider||window.BlockstackProvider}function ou(e,t){var n,r;return e instanceof t||((r=(n=e?.constructor)==null?void 0:n.name)==null?void 0:r.toLowerCase())===t.name}function xH(e){return e?typeof e=="string"?e:ou(e,q1)?"mainnet":ou(e,W1)?"testnet":ou(e,V1)||ou(e,wg)?"devnet":"coreApiUrl"in e?e.coreApiUrl:"url"in e?e.url:"transactionVersion"in e?e.transactionVersion===Si.Mainnet?"mainnet":"testnet":"mainnet":"mainnet"}function Co(e){if(typeof e.type=="string")return e;switch(e.type){case Ne.BoolFalse:return E0(!1);case Ne.BoolTrue:return E0(!0);case Ne.Int:return W_(e.value);case Ne.UInt:return V_(e.value);case Ne.Buffer:return X_(e.buffer);case Ne.StringASCII:return Z_(e.data);case Ne.StringUTF8:return J_(e.data);case Ne.List:return Y_(e.list.map(Co));case Ne.Tuple:return r3(Object.fromEntries(Object.entries(e.data).map(([n,r])=>[n,Co(r)])));case Ne.OptionalNone:return Q_();case Ne.OptionalSome:return e3(Co(e.value));case Ne.ResponseErr:return n3(Co(e.value));case Ne.ResponseOk:return t3(Co(e.value));case Ne.PrincipalContract:return K_(v0(e.address),e.contractName.content);case Ne.PrincipalStandard:return G_(v0(e.address));default:let t=e;throw new Error(`Unknown clarity type: ${t}`)}}var _H="stx_callContract",TH=e=>{var t;let n=(t=e.functionArgs)==null?void 0:t.map(r=>typeof r=="string"?s3(r):Co(r)).map(r=>kf(r));return or(Ct({},e),{contract:`${e.contractAddress}.${e.contractName}`,functionArgs:n,network:xH(e.network),postConditionMode:$H(e.postConditionMode),postConditions:PH(e.postConditions),address:e.stxAddress})},OH=e=>({txId:e.txid,txRaw:e.transaction,stacksTransaction:z_(e.transaction)});function DH(e,t=NH()){HH(_H,TH,OH)(e,t)}function PH(e){if(typeof e<"u")return e.map(t=>typeof t=="string"?t:typeof t.type=="string"?or(Ct({},t),{amount:"amount"in t?t.amount.toString():void 0}):we(N3(t)))}function $H(e){if(typeof e<"u"){if(typeof e=="string")return e;switch(e){case xi.Allow:return"allow";case xi.Deny:return"deny";default:let t=e;throw new Error(`Unknown post condition mode: ${t}. Should be one of: 'allow', 'deny'`)}}}var lw="@stacks/connect",kH={addresses:{stx:[],btc:[]},version:"0.0.1"},Ev=e=>[...new Map(e.map(t=>[t.address,t])).values()].map(t=>{var n=bH(t,[]);return"publicKey"in n&&delete n.publicKey,"derivationPath"in n&&delete n.derivationPath,"tweakedPublicKey"in n&&delete n.tweakedPublicKey,n});function UH(e){try{let t=uw()||kH,n=or(Ct({},t),{updatedAt:Date.now(),addresses:Ct(Ct({},t.addresses),e.addresses&&{stx:e.addresses.stx&&Ev([...t.addresses.stx,...e.addresses.stx]),btc:e.addresses.btc&&Ev([...t.addresses.btc,...e.addresses.btc])})});localStorage.setItem(lw,we(Zo(JSON.stringify(n))))}catch(t){console.warn("Failed to store data in localStorage:",t)}}function RH(){try{localStorage.removeItem(lw)}catch(e){console.warn("Failed to clear localStorage:",e)}}function uw(){try{let e=localStorage.getItem(lw);return e?JSON.parse(Qu(Ve(e))):null}catch(e){return console.warn("Failed to get data from localStorage:",e),null}}function bA(){let e=Bv();e&&"disconnect"in e&&e.disconnect(),nS(),RH(),new JH().store.deleteSessionData()}function Td(){let e=uw();return e?.addresses.stx.length>0||e?.addresses.btc.length>0}var MH={};vH(MH,{Chains:()=>rr,Default:()=>vA,Networks:()=>Wc});var LH=["stx_signMessage","stx_signTransaction","stx_signStructuredMessage","stx_getAccounts","stx_getAddresses","stx_updateProfile","stx_transferStx","stx_transferSip10Ft","stx_transferSip9Nft","stx_callContract","stx_deployContract","sendTransfer","signPsbt","getAddresses"],rr;(e=>{(t=>(t.Mainnet={id:1,chainNamespace:"stacks",caipNetworkId:"stacks:1",name:"Stacks",nativeCurrency:{name:"STX",symbol:"STX",decimals:6},rpcUrls:{default:{http:["https://api.mainnet.hiro.so"]}}},t.Testnet={id:2,chainNamespace:"stacks",caipNetworkId:"stacks:2147483648",name:"Stacks Testnet",nativeCurrency:{name:"STX",symbol:"STX",decimals:6},rpcUrls:{default:{http:["https://api.testnet.hiro.so"]}}}))(e.Stacks||(e.Stacks={})),(t=>(t.Mainnet=rH,t.Testnet=sH))(e.Bitcoin||(e.Bitcoin={}))})(rr||(rr={}));var Wc;(e=>(e.Stacks={namespace:"stacks",chains:[rr.Stacks.Mainnet,rr.Stacks.Testnet],methods:LH,events:["stx_chainChanged","stx_accountsChanged"]},e.Bitcoin={namespace:"bip122",chains:[rr.Bitcoin.Mainnet],methods:["signMessage","sendTransfer","signPsbt","getAccountAddresses"],events:["bip122_addressesChanged"]}))(Wc||(Wc={}));var vA={metadata:{name:"Universal Connector",description:"Universal Connector",url:"https://appkit.reown.com",icons:["https://appkit.reown.com/icon.png"]},networks:[Wc.Stacks,Wc.Bitcoin]};function Cv(e){return{jsonrpc:"2.0",id:1,result:e}}var BH=class{constructor(e){this.connector=e}async connect(){try{let{session:e}=await this.connector.connect();return e}catch(e){throw console.error(">> WalletConnectProvider connect error",e),e}}get stacksAddresses(){var e,t,n,r;let s=(e=this.connector.provider)==null?void 0:e.session;if(!((n=(t=s?.namespaces)==null?void 0:t.stacks)!=null&&n.accounts))return[];let i=(r=s?.sessionProperties)==null?void 0:r.stacks_getAddresses,o=JSON.parse(i||"[]"),a=[...s.namespaces.stacks.accounts.map(c=>({address:c.split(":")[2],publicKey:""}))||[],...o||[]].sort(c=>c.publicKey?1:-1);return Array.from(new Map(a.map(c=>[c.address,c])).values())}get btcAddresses(){var e,t,n;let r=(e=this.connector.provider)==null?void 0:e.session;if(!((n=(t=r?.namespaces)==null?void 0:t.bip122)!=null&&n.accounts))return[];let s=r?.sessionProperties.bip122_getAccountAddresses,i=JSON.parse(s||"{}"),o=r.namespaces.bip122.accounts.map(c=>({address:c.split(":")[2],publicKey:""})),a=[...i?.payment.map(c=>or(Ct({},c),{purpose:"payment"}))||[],...i?.ordinal.map(c=>or(Ct({},c),{purpose:"ordinal"}))||[],...o||[]].sort(c=>c.publicKey?1:-1).sort((c,l)=>c?.address.length-l?.address.length);return Array.from(new Map(a.map(c=>[c.address,c])).values())}async getAddresses(){var e;let t=(e=this.connector.provider)==null?void 0:e.session;t||(t=await this.connect());let n=this.stacksAddresses,r=this.btcAddresses;return{addresses:[...n,...r]}}validateRpcMethod(e){var t,n,r,s;if(["getAddresses","stx_getAccounts","stx_getAddresses"].includes(e))return;if(!((t=this.connector.provider)!=null&&t.session))throw new Error("WalletConnectProvider not connected. Please connect first.");let i=(n=this.connector.provider)==null?void 0:n.session.namespaces,o=((r=i.stacks)==null?void 0:r.methods)||[],a=((s=i.bip122)==null?void 0:s.methods)||[];if(![...o,...a].includes(e))throw new Error(`WalletConnectProvider does not support method ${e}. Please use a supported method.`)}getTargetCaipNetworkId(e,t){var n,r,s,i,o,a,c,l;let u=["getAddresses","stx_getAccounts","stx_getAddresses"],d="network"in t?t.network:void 0;if(d)return{mainnet:rr.Stacks.Mainnet.caipNetworkId,testnet:rr.Stacks.Testnet.caipNetworkId}[d];if(u.includes(e)||(i=(s=(r=(n=this.connector.provider)==null?void 0:n.session)==null?void 0:r.namespaces)==null?void 0:s.stacks)!=null&&i.methods.includes(e))return rr.Stacks.Mainnet.caipNetworkId;if((l=(c=(a=(o=this.connector.provider)==null?void 0:o.session)==null?void 0:a.namespaces)==null?void 0:c.bip122)!=null&&l.methods.includes(e))return rr.Bitcoin.Mainnet.caipNetworkId;throw new Error(`WalletConnectProvider does not support method ${e}. Please use a supported method.`)}async request(e,t){var n,r,s,i;try{this.validateRpcMethod(e);let o=this.getTargetCaipNetworkId(e,t);switch(e){case"getAddresses":case"stx_getAddresses":case"stx_getAccounts":let a=await this.getAddresses();return Cv(a);case"stx_signMessage":let c=((i=(s=(r=(n=this.connector.provider)==null?void 0:n.session)==null?void 0:r.namespaces)==null?void 0:s.stacks)==null?void 0:i.accounts[0]).split(":")[2],l=await this.connector.request({method:e,params:Ct({address:c},t)},o);return Cv(l);default:return await this.connector.request({method:e,params:t},o)}}catch(o){throw console.error(">> WalletConnectProvider request error",o),o}}async disconnect(){await this.connector.disconnect()}};async function Av(e){if(window.WalletConnectProvider)return;let{projectId:t,config:n}=typeof e=="string"?{projectId:e,config:void 0}:{projectId:e.projectId,config:e},r=await cw.init(or(Ct(Ct({},vA),n),{projectId:t})),s=new BH(r);window.WalletConnectProvider=s}async function Bp(e,t,n){var r;try{let s=await e.request(t,n);if(!s)throw new li("Provider did not return a response",-31e3);if("error"in s)throw li.fromResponse(s.error);return s.result}catch(s){if(s instanceof li)throw s;if("jsonrpc"in s)throw li.fromResponse(s.error);let i=(r=s.code)!=null?r:-31e3;throw new li(s.message,i,s.data,s)}}function jH(e){return e?async function(t,n,r){let s=await Bp(t,n,r);if((n==="getAddresses"||n==="wallet_connect")&&"addresses"in s){let{stx:i,btc:o}=YH(s.addresses).reduce((a,c)=>(a[c.address.startsWith("S")?"stx":"btc"].push(c),a),{stx:[],btc:[]});UH({addresses:{stx:i,btc:o}})}return s}:Bp}async function FH(...e){var t;let{options:n,method:r,params:s}=zH(e),i=Object.assign({provider:null,defaultProviders:SH,forceWalletSelect:!1,persistWalletSelect:!0,enableOverrides:!0,enableLocalStorage:!0},VH(n));i!=null&&i.walletConnect?(await Av(i.walletConnect).catch(console.error),i.defaultProviders=[...i.defaultProviders,vv]):i!=null&&i.walletConnectProjectId&&(await Av(i.walletConnectProjectId).catch(console.error),i.defaultProviders=[...i.defaultProviders,vv]),i.provider=(t=i.provider)!=null?t:Bv();let o=KH(i.enableOverrides,jH(i.enableLocalStorage));if(i.provider&&!i.forceWalletSelect){let{method:a,params:c}=jp(i.provider,r,s,i.enableOverrides);return await o(i.provider,a,Fp(c))}if(typeof window<"u")return GS(),new Promise((a,c)=>{let l=document.createElement("connect-modal");l.defaultProviders=Iv(i.approvedProviderIds,i.defaultProviders),l.installedProviders=Iv(i.approvedProviderIds,sS(i.defaultProviders));let u=document.body.style.overflow;document.body.style.overflow="hidden";let d=()=>{l.remove(),document.body.style.overflow=u};l.callback=p=>{d();let f=td(p),{method:g,params:w}=jp(f,r,s,i.enableOverrides),b=GH(i.persistWalletSelect,p);a(o(f,g,Fp(w)).then(b))},l.cancelCallback=()=>{d(),c(new li("User canceled the request",-31001))},document.body.appendChild(l);let h=p=>{p.key==="Escape"&&(document.removeEventListener("keydown",h),l.remove(),c(new li("User canceled the request",-31001)))};document.addEventListener("keydown",h)})}function zH(e){return typeof e[0]=="string"?{method:e[0],params:e[1]}:{options:e[0],method:e[1],params:e[2]}}function Iv(e,t){return e?t.filter(n=>e.includes(n.id)):t}function EA(e){let t=e&&"network"in e?{network:e.network}:void 0;return FH(or(Ct({},e),{forceWalletSelect:!0}),"getAddresses",t)}function HH(e,t,n){return(r,s)=>{if(!s)throw new Error("[Connect] No installed Stacks wallet found");let i=t(r),o=r,{method:a,params:c}=jp(s,e,i);Bp(s,a,Fp(c)).then(l=>{var u;let d=n(l);(u=o.onFinish)==null||u.call(o,d)}).catch(o.onCancel)}}function au(e){return qH(e)||WH(e)}function qH(e){return"signMultipleTransactions"in e&&"createRepeatInscriptions"in e&&!(e!=null&&e.isLeather)&&!(e!=null&&e.isFordefi)}function WH(e){return"isFordefi"in e&&!!e.isFordefi}function Sv(e){return"isLeather"in e&&!!e.isLeather}function VH(e){if(e===void 0)return{};let t={};for(let[n,r]of Object.entries(e))r!==void 0&&(t[n]=r);return t}function KH(e,t){return e?async(n,r,s)=>{let i=await t(n,r,s),o=Ct({},i);return i!==null&&"txId"in i&&i.txId&&!("txid"in o)&&(o.txid=i.txId),i!==null&&"hex"in i&&i.hex&&typeof i.hex=="string"&&!("psbt"in o)&&(o.psbt=Mv.encode(Ve(i.hex))),o}:t}function jp(e,t,n,r=!0){if(!r)return{method:t,params:n};if(au(e)&&["getAddresses","stx_getAddresses"].includes(t))return{method:"wallet_connect",params:n};if(au(e)&&t==="sendTransfer"){let s=or(Ct({},n),{recipients:n.recipients.map(i=>or(Ct({},i),{amount:Number(i.amount)})),network:void 0});return{method:t,params:s}}if(au(e)&&t==="signPsbt"){let s=n.signInputs;if(!s)return{method:t,params:n};let i={};for(let a of s)typeof a!="number"&&a.address&&(i[a.address]||(i[a.address]=[]),i[a.address].push(a.index));let o={psbt:n.psbt,signInputs:i,broadcast:n.broadcast};return{method:t,params:o}}if(!au(e)&&t==="stx_signMessage"){let s=Ct({},n);return delete s.publicKey,{method:t,params:s}}if(Sv(e)&&t==="sendTransfer"){let s=or(Ct({},n),{recipients:n.recipients.map(i=>or(Ct({},i),{amount:i.amount.toString()}))});return{method:t,params:s}}if(Sv(e)&&t==="signPsbt"){let s={hex:we(Mv.decode(n.psbt)),signAtIndex:n.signInputs.map(i=>typeof i=="number"?i:i.index),allowedSighash:n.allowedSighash,broadcast:n.broadcast,network:n.network};return{method:t,params:s}}return{method:t,params:n}}var Nv=["stx-postcondition","ft-postcondition","nft-postcondition"];function Fp(e){if(!e||typeof e!="object")return e;let t=Ct({},e);for(let[n,r]of Object.entries(e)){if(typeof r=="bigint"){t[n]=r.toString();continue}if(r){if(Array.isArray(r)){t[n]=r.map(s=>typeof s=="bigint"?s.toString():!s||typeof s!="object"||!("type"in s)?s:Nv.includes(s.type)?b0(s):kf(s));continue}typeof r=="object"&&"type"in r&&(t[n]=Nv.includes(r.type)?b0(r):kf(r))}}return JSON.parse(JSON.stringify(t))}function GH(e,t){return function(n){if(e)try{tS(t)}catch{}return n}}function YH(e){return e.slice().sort((t,n)=>{let r="purpose"in t&&t.purpose==="payment",s="purpose"in n&&n.purpose==="payment";return r&&!s?-1:!r&&s?1:0})}typeof window<"u"&&(window.__CONNECT_VERSION__="__VERSION__");var ZH="blockstack-session",JH=class{constructor(e){e!=null&&e.appConfig&&(this.appConfig=e.appConfig),typeof window>"u"&&typeof self>"u"?this.store=new XH:this.store=new QH}makeAuthRequestToken(){}generateAndStoreTransitKey(){}getAuthResponseToken(){}isSignInPending(){return!1}isUserSignedIn(){return!!this.store.getSessionData().userData}async handlePendingSignIn(){return Promise.resolve(this.loadUserData())}loadUserData(){let e=this.store.getSessionData().userData;if(!e)throw new Hp("No user data found. Did the user sign in?");return e}encryptContent(){}decryptContent(){}signUserOut(e){this.store.deleteSessionData(),e&&typeof location<"u"&&location.href&&(location.href=e)}},CA=class{constructor(e){e&&this.setSessionData(e)}getSessionData(){throw new Error("Abstract class")}setSessionData(e){throw new Error("Abstract class")}deleteSessionData(){throw new Error("Abstract class")}},XH=class extends CA{constructor(e){super(e),this.sessionData||this.setSessionData({})}getSessionData(){if(!this.sessionData)throw new Hp("No session data was found.");return this.sessionData}setSessionData(e){return this.sessionData=e,!0}deleteSessionData(){return this.setSessionData({}),!0}},QH=class extends CA{constructor(e){var t;super(e),this.key=typeof((t=e?.storeOptions)==null?void 0:t.localStorageKey)=="string"?e.storeOptions.localStorageKey:ZH,localStorage.getItem(this.key)||this.setSessionData({})}getSessionData(){let e=localStorage.getItem(this.key);if(!e)throw new Hp("No session data was found in localStorage");return JSON.parse(e)}setSessionData(e){return localStorage.setItem(this.key,JSON.stringify(e)),!0}deleteSessionData(){return localStorage.removeItem(this.key),this.setSessionData({}),!0}},eq=(e=>(e.ContractCall="contract_call",e.ContractDeploy="smart_contract",e.STXTransfer="token_transfer",e))(eq||{}),tq=(e=>(e.BUFFER="buffer",e.UINT="uint",e.INT="int",e.PRINCIPAL="principal",e.BOOL="bool",e))(tq||{}),nq=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.ALL=1]="ALL",e[e.NONE=2]="NONE",e[e.SINGLE=3]="SINGLE",e[e.ANYONECANPAY=128]="ANYONECANPAY",e))(nq||{});console.log(" System initializing...");const rq="SP1ZGGS886YCZHMFXJR1EK61ZP34FNWNSX32N685T",sq="aura-nft",cf={fire:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/images/fire.png",water:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/images/water.png",stone:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/images/stone.png"},cu={fire:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/metadata/fire.json",water:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/metadata/water.json",stone:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/metadata/stone.json"},iq=Qv;let zp=null,To=null;const te={connectBtn:document.getElementById("connectWalletBtn"),walletStatus:document.getElementById("walletStatus"),statusChip:document.querySelector(".status-chip"),heroImage:document.getElementById("heroImage"),heroCaption:document.getElementById("heroCaption"),scanSection:document.getElementById("scanSection"),btcAddress:document.getElementById("btcAddress"),scanButton:document.getElementById("scanButton"),loading:document.getElementById("loading"),resultArea:document.getElementById("result-area"),auraTitle:document.getElementById("auraTitle"),cardImage:document.getElementById("cardImage"),txData:document.getElementById("txData"),descData:document.getElementById("descData"),mintBtn:document.getElementById("mintBtn"),txStatus:document.getElementById("txStatus")};function AA(){te.scanSection&&(te.scanSection.style.display="block",te.scanSection.scrollIntoView({behavior:"smooth",block:"start"}))}function Vc(e=!1){if(Td()){const n=uw().addresses.stx[0].address;console.log(" User Connected:",n),te.walletStatus&&(te.walletStatus.textContent="",te.walletStatus.style.color="#9ae6b4",te.walletStatus.style.display="none"),te.statusChip&&(te.statusChip.style.display="none"),te.connectBtn.textContent="Disconnect",te.connectBtn.classList.add("danger-btn"),te.scanSection&&(te.scanSection.style.display="block"),e&&AA()}else console.log(" User Not Connected"),te.walletStatus&&(te.walletStatus.textContent="Wallet not connected.",te.walletStatus.style.color="#ff6b6b",te.walletStatus.style.display="block"),te.statusChip&&(te.statusChip.style.display="inline-block"),te.connectBtn.textContent="Connect Stacks Wallet",te.connectBtn.classList.remove("danger-btn"),te.mintBtn&&(te.mintBtn.disabled=!0),te.scanSection&&(te.scanSection.style.display="none"),te.resultArea&&(te.resultArea.style.display="none")}te.connectBtn&&te.connectBtn.addEventListener("click",()=>{console.log(" Connect button clicked"),Td()?(bA(),Vc()):EA({appDetails:{name:"Bitcoin Aura",icon:window.location.origin+"/img/collection2.png"},onFinish:()=>{console.log(" Auth finished"),Vc(!0),AA()}})});async function oq(){console.log(" Scan started...");const e=te.btcAddress.value.trim();if(!e){alert("Please enter a Bitcoin address first!");return}te.loading.style.display="block",te.resultArea.style.display="none",te.txStatus.textContent="";try{const t=await aq(e);let n="",r="",s="",i="";t===0?(n="BUY YOUR FIRST BTC",r="",s="You have no on-chain activity yet. Start with your first Bitcoin transaction.",i="#f7931a",To=cu.stone):t>=50?(n="FIRE TRADER",r=cf.fire,s=" You are hyperactive! Gas fees are not a problem for you.",i="#ff4500",To=cu.fire):t>=10?(n="WATER FLOW",r=cf.water,s=" Balanced. You know when to hold and when to spend.",i="#00bfff",To=cu.water):(n="STONE HODLER",r=cf.stone,s=" Stillness is gold. Your hands are diamond strong.",i="#808080",To=cu.stone),zp=n,te.auraTitle.innerText=n,te.auraTitle.style.color=i,r?(te.cardImage.src=r,te.cardImage.style.display="block",te.heroImage&&(te.heroImage.style.display="block")):(te.cardImage.style.display="none",te.heroImage&&(te.heroImage.style.display="none")),te.txData.innerText=`Total On-Chain Transactions: ${t}`,te.descData.innerText=s;const o=t!==0;te.txData&&(te.txData.style.display=o?"block":"none"),te.descData&&(te.descData.style.display=o?"block":"none"),te.loading.style.display="none",te.resultArea.style.display="flex",te.mintBtn&&(t===0?te.mintBtn.style.display="none":(te.mintBtn.style.display="block",te.mintBtn.disabled=!1,te.mintBtn.textContent="MINT TO STACKS"))}catch(t){console.error(t),te.loading.style.display="none",alert("Error: "+t.message+". API might be unreachable; try again.")}}async function aq(e){const t=encodeURIComponent(e),n=location.hostname==="localhost"||location.hostname==="127.0.0.1";try{const s=new AbortController,i=setTimeout(()=>s.abort(),3e3),o=await fetch(`/api/txcount?address=${t}`,{signal:s.signal,headers:{Accept:"application/json"},cache:"no-store"});if(clearTimeout(i),o.ok){const a=await o.json();if(typeof a.totalTx=="number")return a.totalTx}}catch(s){console.warn("Proxy /api/txcount failed, falling back to client fetch",s)}const r=[{url:`https://blockstream.info/api/address/${t}`,parser:s=>(s.chain_stats?.tx_count||0)+(s.mempool_stats?.tx_count||0)},{url:`https://api.blockcypher.com/v1/btc/main/addrs/${t}`,parser:s=>(typeof s.n_tx=="number"?s.n_tx:0)+(typeof s.unconfirmed_n_tx=="number"?s.unconfirmed_n_tx:0)},{url:`https://blockchain.info/rawaddr/${t}?cors=true`,parser:s=>typeof s.n_tx=="number"?s.n_tx:0},...n?[{url:`https://mempool.space/api/address/${t}`,parser:s=>(s.chain_stats?.tx_count||0)+(s.mempool_stats?.tx_count||0)}]:[]];for(const s of r){const i=new AbortController,o=setTimeout(()=>i.abort(),6e3);try{const a=await fetch(s.url,{signal:i.signal,mode:"cors",headers:{Accept:"application/json"},cache:"no-store"});if(!a.ok)throw new Error(`HTTP ${a.status}`);const c=await a.json(),l=s.parser(c);if(clearTimeout(o),typeof l!="number"||Number.isNaN(l))throw new Error("Invalid response");return l}catch(a){clearTimeout(o),console.warn("Fetch failed on",s.url,a)}}throw new Error("Failed to fetch address data (all sources failed)")}te.scanButton&&te.scanButton.addEventListener("click",oq);async function cq(){if(!zp||!To){alert("Scan your aura first!");return}if(!Td()){alert("Connect your wallet first!");return}te.txStatus.textContent="Preparing transaction...",te.txStatus.style.color="yellow";const e=[ku(zp),ku(To)];try{await DH({network:iq,contractAddress:rq,contractName:sq,functionName:"mint",functionArgs:e,postConditionMode:xi.Deny,appDetails:{name:"Bitcoin Aura",icon:window.location.origin+"/img/collection2.png"},onFinish:t=>{const n=`https://explorer.hiro.so/txid/${t.txId}?chain=mainnet`;te.txStatus.innerHTML=` Mint Sent! <a href="${n}" target="_blank" style="color: #45b5ff;">View Transaction</a>`,te.txStatus.style.color="#9ae6b4",te.scanButton&&(te.scanButton.textContent="Scan Another Wallet Aura")},onCancel:()=>{te.txStatus.textContent="Mint cancelled.",te.txStatus.style.color="orange"}})}catch(t){te.txStatus.textContent=`Mint failed: ${t.message}`,te.txStatus.style.color="red"}}te.mintBtn&&te.mintBtn.addEventListener("click",cq);te.connectBtn&&te.connectBtn.addEventListener("click",()=>{Td()?(bA(),Vc()):EA({appDetails:{name:"Bitcoin Aura",icon:window.location.origin+"/img/collection2.png"},onFinish:()=>Vc()})});Vc();export{g8 as $,he as A,Cr as B,J as C,Ft as D,ze as E,Uz as F,ae as G,Cn as H,_W as I,iA as J,Mp as K,Go as L,Ae as M,p8 as N,z as O,En as P,Yq as Q,pe as R,W as S,yn as T,Dm as U,FE as V,Rp as W,gc as X,c8 as Y,jE as Z,ic as _,TW as a,Zq as a0,Gq as a1,Bu as a2,Xq as a3,Jq as a4,Eu as b,ce as c,X as d,OW as e,H as f,uq as g,_S as h,$o as i,bu as j,W2 as k,T as l,er as m,Ir as n,Le as o,sd as p,IW as q,lq as r,vo as s,Et as t,DW as u,Ze as v,_n as w,AW as x,Ht as y,Pt as z};
