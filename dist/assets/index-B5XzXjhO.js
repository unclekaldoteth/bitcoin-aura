const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/basic-BmnceGGO.js","assets/index-DICZDjgl.js","assets/w3m-modal-DnaL-6Xa.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();const kv={MISSING_PARAMETER:"missing_parameter",REMOTE_SERVICE_ERROR:"remote_service_error",INVALID_STATE:"invalid_state",NO_SESSION_DATA:"no_session_data",DOES_NOT_EXIST:"does_not_exist",FAILED_DECRYPTION_ERROR:"failed_decryption_error",INVALID_DID_ERROR:"invalid_did_error",NOT_ENOUGH_FUNDS_ERROR:"not_enough_error",INVALID_AMOUNT_ERROR:"invalid_amount_error",LOGIN_FAILED_ERROR:"login_failed",SIGNATURE_VERIFICATION_ERROR:"signature_verification_failure",CONFLICT_ERROR:"conflict_error",NOT_ENOUGH_PROOF_ERROR:"not_enough_proof_error",BAD_PATH_ERROR:"bad_path_error",VALIDATION_ERROR:"validation_error",PAYLOAD_TOO_LARGE_ERROR:"payload_too_large_error",PRECONDITION_FAILED_ERROR:"precondition_failed_error",UNKNOWN:"unknown"};Object.freeze(kv);class FI extends Error{constructor(t){super();let n=t.message,r=`Error Code: ${t.code}`,s=this.stack;if(s)r+=`Stack Trace:
${s}`;else try{throw new Error}catch(i){s=i.stack}n+=`
If you believe this exception is caused by a bug in stacks.js,
      please file a bug report: https://github.com/blockstack/stacks.js/issues

${r}`,this.message=n,this.code=t.code,this.parameter=t.parameter?t.parameter:void 0}toString(){return`${super.toString()}
    code: ${this.code} param: ${this.parameter?this.parameter:"n/a"}`}}class Jp extends FI{constructor(t){super({code:kv.INVALID_STATE,message:t}),this.message=t,this.name="NoSessionDataError"}}function zs(e,t){return Xp(Kt(e),t)}function Kt(e){if(typeof e=="bigint")return e;if(typeof e=="string")return BigInt(e);if(typeof e=="number"){if(!Number.isInteger(e))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");if(e>Number.MAX_SAFE_INTEGER)throw new RangeError(`Invalid value. Values of type 'number' must be less than or equal to ${Number.MAX_SAFE_INTEGER}. For larger values, try using a BigInt instead.`);return BigInt(e)}if(hn(e,Uint8Array))return BigInt(`0x${we(e)}`);throw new TypeError("intToBigInt: Invalid value type. Must be a number, bigint, BigInt-compatible string, or Uint8Array.")}function HI(e){return/^0x/i.test(e)?e.slice(2):e}function $w(e){if(typeof e!="string")throw new TypeError(`hexToBigInt: expected string, got ${typeof e}`);return BigInt(`0x${e}`)}function tl(e,t=8){return(typeof e=="bigint"?e:Kt(e)).toString(16).padStart(t*2,"0")}function od(e){return parseInt(e,16)}function Xp(e,t=16){const n=tl(e,t);return Ve(n)}function zI(e,t){if(e<-(BigInt(1)<<t-BigInt(1))||(BigInt(1)<<t-BigInt(1))-BigInt(1)<e)throw`Unable to represent integer in width: ${t}`;return e>=BigInt(0)?BigInt(e):e+(BigInt(1)<<t)}function qI(e,t){return e&BigInt(1)<<t}function yf(e){return WI(BigInt(`0x${we(e)}`),BigInt(e.byteLength*8))}function WI(e,t){return qI(e,t-BigInt(1))?e-(BigInt(1)<<t):e}const VI=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function we(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(const n of e)t+=VI[n];return t}function Ve(e){if(typeof e!="string")throw new TypeError(`hexToBytes: expected string, got ${typeof e}`);e=HI(e),e=e.length%2?`0${e}`:e;const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=n*2,s=e.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function ia(e){return new TextEncoder().encode(e)}function ad(e){return new TextDecoder().decode(e)}function KI(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return new Uint8Array(t)}function GI(e){return String.fromCharCode.apply(null,e)}function YI(e){return!Number.isInteger(e)||e<0||e>255}function Pw(e){if(e.some(YI))throw new Error("Some values are invalid bytes.");return new Uint8Array(e)}function cd(...e){if(!e.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];const t=e.reduce((r,s)=>r+s.length,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}function at(e){return cd(...e.map(t=>typeof t=="number"?Pw([t]):t instanceof Array?Pw(t):t))}function hn(e,t){return e instanceof t||e?.constructor?.name?.toLowerCase()===t.name}const ZI="https://api.mainnet.hiro.so",JI="https://api.testnet.hiro.so",XI="http://localhost:3999",QI=33,Zd=32;function eS(e){if(e.length<Zd*2*2+1)throw new Error("Invalid signature");const t=e.slice(0,2),n=e.slice(2,2+Zd*2),r=e.slice(2+Zd*2);return{recoveryId:od(t),r:n,s:r}}function Uv(e){const t=typeof e=="string"?Ve(e):e;if(t.length!=32&&t.length!=33)throw new Error(`Improperly formatted private-key. Private-key byte length should be 32 or 33. Length provided: ${t.length}`);if(t.length==33&&t[32]!==1)throw new Error("Improperly formatted private-key. 33 bytes indicate compressed key, but the last byte must be == 01");return t}function tS(e,t){return(e[t+0]<<8|e[t+1])>>>0}function nS(e,t,n=0){return e[n+0]=t>>>8,e[n+1]=t>>>0,e}function rS(e,t){return e[t]}function sS(e,t,n=0){return e[n]=t,e}function iS(e,t){return e[t]*2**24+e[t+1]*2**16+e[t+2]*2**8+e[t+3]}function ki(e,t,n=0){return e[n+3]=t,t>>>=8,e[n+2]=t,t>>>=8,e[n+1]=t,t>>>=8,e[n]=t,e}function Rv(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function oS(e,...t){if(!Rv(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Bv(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function fc(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function Qp(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function bf(e){if(!Array.isArray(e))throw new Error("array expected")}function $u(e,t){if(!Bv(!0,t))throw new Error(`${e}: array of strings expected`)}function aS(e,t){if(!Bv(!1,t))throw new Error(`${e}: array of numbers expected`)}function Mv(...e){const t=i=>i,n=(i,o)=>a=>i(o(a)),r=e.map(i=>i.encode).reduceRight(n,t),s=e.map(i=>i.decode).reduce(n,t);return{encode:r,decode:s}}function Lv(e){const t=typeof e=="string"?e.split(""):e,n=t.length;$u("alphabet",t);const r=new Map(t.map((s,i)=>[s,i]));return{encode:s=>(bf(s),s.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:s=>(bf(s),s.map(i=>{fc("alphabet.decode",i);const o=r.get(i);if(o===void 0)throw new Error(`Unknown letter: "${i}". Allowed: ${e}`);return o}))}}function jv(e=""){return fc("join",e),{encode:t=>($u("join.decode",t),t.join(e)),decode:t=>(fc("join.decode",t),t.split(e))}}function Fv(e,t="="){return Qp(e),fc("padding",t),{encode(n){for($u("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){$u("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}const Hv=(e,t)=>t===0?e:Hv(t,e%t),Pu=(e,t)=>e+(t-Hv(e,t)),Jd=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function kw(e,t,n,r){if(bf(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Pu(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Pu(t,n)}`);let s=0,i=0;const o=Jd[t],a=Jd[n]-1,c=[];for(const l of e){if(Qp(l),l>=o)throw new Error(`convertRadix2: invalid data word=${l} from=${t}`);if(s=s<<t|l,i+t>32)throw new Error(`convertRadix2: carry overflow pos=${i} from=${t}`);for(i+=t;i>=n;i-=n)c.push((s>>i-n&a)>>>0);const u=Jd[i];if(u===void 0)throw new Error("invalid carry");s&=u-1}if(s=s<<n-i&a,!r&&i>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&i>0&&c.push(s>>>0),c}function zv(e,t=!1){if(Qp(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Pu(8,e)>32||Pu(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!Rv(n))throw new Error("radix2.encode input should be Uint8Array");return kw(Array.from(n),8,e,!t)},decode:n=>(aS("radix2.decode",n),Uint8Array.from(kw(n,e,8,t)))}}const cS=Mv(zv(5),Lv("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Fv(5),jv("")),lS=typeof Uint8Array.from([]).toBase64=="function"&&typeof Uint8Array.fromBase64=="function",uS=(e,t)=>{fc("base64",e);const n=/^[A-Za-z0-9=+/]+$/,r="base64";if(e.length>0&&!n.test(e))throw new Error("invalid base64");return Uint8Array.fromBase64(e,{alphabet:r,lastChunkHandling:"strict"})},qv=lS?{encode(e){return oS(e),e.toBase64()},decode(e){return uS(e)}}:Mv(zv(6),Lv("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Fv(6),jv("")),eg="STX_PROVIDER",Wv=()=>typeof window>"u"?null:window.localStorage.getItem(eg),dS=e=>{typeof window<"u"&&window.localStorage.setItem(eg,e)},hS=()=>{typeof window<"u"&&window.localStorage.removeItem(eg)},fS=()=>{if(typeof window>"u")return[];const e=window.webbtc_stx_providers||[],t=window.wbip_providers||[];return[...e,...t]},pS=(e=[])=>{if(typeof window>"u")return[];const n=fS().filter(r=>e.find(i=>i.id===r.id)?!1:!!ld(r.id));return e.concat(n)},Vv=()=>{const e=Wv();return ld(e)},ld=e=>e?.split(".").reduce((t,n)=>t?.[n],window),gS="modulepreload",wS=function(e){return"/"+e},Uw={},pc=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let c=function(l){return Promise.all(l.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=c(n.map(l=>{if(l=wS(l),l in Uw)return;Uw[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":gS,u||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),u)return new Promise((p,f)=>{h.addEventListener("load",p),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})},mS="connect-ui",ku={hydratedSelectorName:"hydrated",lazyLoad:!0,updatable:!0,watchCallback:!1};var yS=Object.defineProperty,bS=(e,t)=>{for(var n in t)yS(e,n,{get:t[n],enumerable:!0})},vS="http://www.w3.org/2000/svg",ES="http://www.w3.org/1999/xhtml",dr=e=>{if(e.__stencil__getHostRef)return e.__stencil__getHostRef()},Sq=(e,t)=>{e.__stencil__getHostRef=()=>t,t.$lazyInstance$=e},CS=(e,t)=>{const n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};n.$onReadyPromise$=new Promise(s=>n.$onReadyResolve$=s),e["s-p"]=[],e["s-rc"]=[];const r=n;return e.__stencil__getHostRef=()=>r,r},Rw=(e,t)=>t in e,qo=(e,t)=>(0,console.error)(e,t),Xd=new Map,AS=(e,t,n)=>{const r=e.$tagName$.replace(/-/g,"_"),s=e.$lazyBundleId$;if(!s)return;const i=Xd.get(s);if(i)return i[r];{const o=a=>(Xd.set(s,a),a[r]);switch(s){case"connect-modal":return pc(()=>import("./connect-modal.entry-_TvgFon9.js"),[]).then(o,qo)}}return pc(()=>import(`./${s}.entry.js`),[]).then(o=>(Xd.set(s,o),o[r]),o=>{qo(o,t.$hostElement$)})},Uu=new Map,IS="{visibility:hidden}.hydrated{visibility:inherit}",Kv="slot-fb{display:contents}slot-fb[hidden]{display:none}",Dt=typeof window<"u"?window:{},_t={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,n,r)=>e.addEventListener(t,n,r),rel:(e,t,n,r)=>e.removeEventListener(t,n,r),ce:(e,t)=>new CustomEvent(e,t)},SS=e=>Promise.resolve(e),tg=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),vf=tg?!!Dt.document&&Object.getOwnPropertyDescriptor(Dt.document.adoptedStyleSheets,"length").writable:!1,Ef=!1,Bw=[],Gv=[],xS=(e,t)=>n=>{e.push(n),Ef||(Ef=!0,_t.$flags$&4?ng(Cf):_t.raf(Cf))},Mw=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(n){qo(n)}e.length=0},Cf=()=>{Mw(Bw),Mw(Gv),(Ef=Bw.length>0)&&_t.raf(Cf)},ng=e=>SS().then(e),NS=xS(Gv),rg=e=>(e=typeof e,e==="object"||e==="function");function Yv(e){var t,n,r;return(r=(n=(t=e.head)==null?void 0:t.querySelector('meta[name="csp-nonce"]'))==null?void 0:n.getAttribute("content"))!=null?r:void 0}var _S=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),TS={};bS(TS,{err:()=>Zv,map:()=>OS,ok:()=>Af,unwrap:()=>DS,unwrapErr:()=>$S});var Af=e=>({isOk:!0,isErr:!1,value:e}),Zv=e=>({isOk:!1,isErr:!0,value:e});function OS(e,t){if(e.isOk){const n=t(e.value);return n instanceof Promise?n.then(r=>Af(r)):Af(n)}if(e.isErr){const n=e.value;return Zv(n)}throw"should never get here"}var DS=e=>{if(e.isOk)return e.value;throw e.value},$S=e=>{if(e.isErr)return e.value;throw e.value};var Ca;function PS(e){var t;const n=this.attachShadow({mode:"open"});Ca===void 0&&(Ca=(t=void 0)!=null?t:null),Ca&&(vf?n.adoptedStyleSheets.push(Ca):n.adoptedStyleSheets=[...n.adoptedStyleSheets,Ca])}var rs=(e,t="")=>()=>{},kS=(e,t)=>()=>{},Po=new WeakMap,US=(e,t,n)=>{let r=Uu.get(e);tg&&n?(r=r||new CSSStyleSheet,typeof r=="string"?r=t:r.replaceSync(t)):r=t,Uu.set(e,r)},RS=(e,t,n)=>{var r;const s=Jv(t),i=Uu.get(s);if(!Dt.document)return s;if(e=e.nodeType===11?e:Dt.document,i)if(typeof i=="string"){e=e.head||e;let o=Po.get(e),a;if(o||Po.set(e,o=new Set),!o.has(s)){{a=Dt.document.createElement("style"),a.innerHTML=i;const c=(r=_t.$nonce$)!=null?r:Yv(Dt.document);if(c!=null&&a.setAttribute("nonce",c),!(t.$flags$&1))if(e.nodeName==="HEAD"){const l=e.querySelectorAll("link[rel=preconnect]"),u=l.length>0?l[l.length-1].nextSibling:e.querySelector("style");e.insertBefore(a,u?.parentNode===e?u:null)}else if("host"in e)if(tg){const l=new CSSStyleSheet;l.replaceSync(i),vf?e.adoptedStyleSheets.unshift(l):e.adoptedStyleSheets=[l,...e.adoptedStyleSheets]}else{const l=e.querySelector("style");l?l.innerHTML=i+l.innerHTML:e.prepend(a)}else e.append(a);t.$flags$&1&&e.insertBefore(a,null)}t.$flags$&4&&(a.innerHTML+=Kv),o&&o.add(s)}}else e.adoptedStyleSheets.includes(i)||(vf?e.adoptedStyleSheets.push(i):e.adoptedStyleSheets=[...e.adoptedStyleSheets,i]);return s},BS=e=>{const t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,s=rs("attachStyles",t.$tagName$),i=RS(n.shadowRoot?n.shadowRoot:n.getRootNode(),t);r&10&&(n["s-sc"]=i,n.classList.add(i+"-h")),s()},Jv=(e,t)=>"sc-"+e.$tagName$,MS=(e,t,...n)=>{let r=null,s=null,i=!1,o=!1;const a=[],c=u=>{for(let d=0;d<u.length;d++)r=u[d],Array.isArray(r)?c(r):r!=null&&typeof r!="boolean"&&((i=typeof e!="function"&&!rg(r))&&(r=String(r)),i&&o?a[a.length-1].$text$+=r:a.push(i?If(null,r):r),o=i)};if(c(n),t){t.key&&(s=t.key);{const u=t.className||t.class;u&&(t.class=typeof u!="object"?u:Object.keys(u).filter(d=>u[d]).join(" "))}}const l=If(e,null);return l.$attrs$=t,a.length>0&&(l.$children$=a),l.$key$=s,l},If=(e,t)=>{const n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return n.$attrs$=null,n.$key$=null,n},LS={},jS=e=>e&&e.$tag$===LS,sg=e=>{const t=_S(e);return new RegExp(`(^|[^@]|@(?!supports\\s+selector\\s*\\([^{]*?${t}))(${t}\\b)`,"g")};sg("::slotted");sg(":host");sg(":host-context");var Sf=(e,t,n)=>{if(typeof e=="string"&&(t&16||t&8)&&(e.startsWith("{")&&e.endsWith("}")||e.startsWith("[")&&e.endsWith("]")))try{return JSON.parse(e)}catch{}return e!=null&&!rg(e),e},xq=e=>{var t;return(t=dr(e))==null?void 0:t.$hostElement$},FS=(e,t,n)=>{const r=_t.ce(t,n);return e.dispatchEvent(r),r},Lw=(e,t,n,r,s,i,o)=>{if(n===r)return;let a=Rw(e,t),c=t.toLowerCase();if(t==="class"){const l=e.classList,u=jw(n);let d=jw(r);l.remove(...u.filter(h=>h&&!d.includes(h))),l.add(...d.filter(h=>h&&!u.includes(h)))}else if(t!=="key")if(!a&&t[0]==="o"&&t[1]==="n"){if(t[2]==="-"?t=t.slice(3):Rw(Dt,c)?t=c.slice(2):t=c[2]+t.slice(3),n||r){const l=t.endsWith(Xv);t=t.replace(zS,""),n&&_t.rel(e,t,n,l),r&&_t.ael(e,t,r,l)}}else{const l=rg(r);if((a||l&&r!==null)&&!s)try{if(e.tagName.includes("-"))e[t]!==r&&(e[t]=r);else{const u=r??"";t==="list"?a=!1:(n==null||e[t]!=u)&&(typeof e.__lookupSetter__(t)=="function"?e[t]=u:e.setAttribute(t,u))}}catch{}r==null||r===!1?(r!==!1||e.getAttribute(t)==="")&&e.removeAttribute(t):(!a||i&4||s)&&!l&&e.nodeType===1&&(r=r===!0?"":r,e.setAttribute(t,r))}},HS=/\s/,jw=e=>(typeof e=="object"&&e&&"baseVal"in e&&(e=e.baseVal),!e||typeof e!="string"?[]:e.split(HS)),Xv="Capture",zS=new RegExp(Xv+"$"),Qv=(e,t,n,r)=>{const s=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,i=e&&e.$attrs$||{},o=t.$attrs$||{};for(const a of Fw(Object.keys(i)))a in o||Lw(s,a,i[a],void 0,n,t.$flags$);for(const a of Fw(Object.keys(o)))Lw(s,a,i[a],o[a],n,t.$flags$)};function Fw(e){return e.includes("ref")?[...e.filter(t=>t!=="ref"),"ref"]:e}var ig,En=!1,Ru=(e,t,n)=>{const r=t.$children$[n];let s=0,i,o;if(r.$text$!==null)i=r.$elm$=Dt.document.createTextNode(r.$text$);else{if(En||(En=r.$tag$==="svg"),!Dt.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(i=r.$elm$=Dt.document.createElementNS(En?vS:ES,r.$tag$),En&&r.$tag$==="foreignObject"&&(En=!1),Qv(null,r,En),r.$children$)for(s=0;s<r.$children$.length;++s)o=Ru(e,r,s),o&&i.appendChild(o);r.$tag$==="svg"?En=!1:i.tagName==="foreignObject"&&(En=!0)}return i["s-hn"]=ig,i},e1=(e,t,n,r,s,i)=>{let o=e,a;for(o.shadowRoot&&o.tagName===ig&&(o=o.shadowRoot);s<=i;++s)r[s]&&(a=Ru(null,n,s),a&&(r[s].$elm$=a,yu(o,a,t)))},t1=(e,t,n)=>{for(let r=t;r<=n;++r){const s=e[r];if(s){const i=s.$elm$;i&&i.remove()}}},qS=(e,t,n,r,s=!1)=>{let i=0,o=0,a=0,c=0,l=t.length-1,u=t[0],d=t[l],h=r.length-1,p=r[0],f=r[h],g,w;for(;i<=l&&o<=h;)if(u==null)u=t[++i];else if(d==null)d=t[--l];else if(p==null)p=r[++o];else if(f==null)f=r[--h];else if(Pl(u,p,s))No(u,p,s),u=t[++i],p=r[++o];else if(Pl(d,f,s))No(d,f,s),d=t[--l],f=r[--h];else if(Pl(u,f,s))No(u,f,s),yu(e,u.$elm$,d.$elm$.nextSibling),u=t[++i],f=r[--h];else if(Pl(d,p,s))No(d,p,s),yu(e,d.$elm$,u.$elm$),d=t[--l],p=r[++o];else{for(a=-1,c=i;c<=l;++c)if(t[c]&&t[c].$key$!==null&&t[c].$key$===p.$key$){a=c;break}a>=0?(w=t[a],w.$tag$!==p.$tag$?g=Ru(t&&t[o],n,a):(No(w,p,s),t[a]=void 0,g=w.$elm$),p=r[++o]):(g=Ru(t&&t[o],n,o),p=r[++o]),g&&yu(u.$elm$.parentNode,g,u.$elm$)}i>l?e1(e,r[h+1]==null?null:r[h+1].$elm$,n,r,o,h):o>h&&t1(t,i,l)},Pl=(e,t,n=!1)=>e.$tag$===t.$tag$?n?(n&&!e.$key$&&t.$key$&&(e.$key$=t.$key$),!0):e.$key$===t.$key$:!1,No=(e,t,n=!1)=>{const r=t.$elm$=e.$elm$,s=e.$children$,i=t.$children$,o=t.$tag$,a=t.$text$;a===null?(En=o==="svg"?!0:o==="foreignObject"?!1:En,Qv(e,t,En),s!==null&&i!==null?qS(r,s,t,i,n):i!==null?(e.$text$!==null&&(r.textContent=""),e1(r,null,t,i,0,i.length-1)):!n&&ku.updatable&&s!==null&&t1(s,0,s.length-1),En&&o==="svg"&&(En=!1)):e.$text$!==a&&(r.data=a)},yu=(e,t,n)=>e?.insertBefore(t,n),WS=(e,t,n=!1)=>{const r=e.$hostElement$,s=e.$vnode$||If(null,null),o=jS(t)?t:MS(null,null,t);if(ig=r.tagName,n&&o.$attrs$)for(const a of Object.keys(o.$attrs$))r.hasAttribute(a)&&!["key","ref","style","class"].includes(a)&&(o.$attrs$[a]=r[a]);o.$tag$=null,o.$flags$|=4,e.$vnode$=o,o.$elm$=s.$elm$=r.shadowRoot||r,No(s,o,n)},n1=(e,t)=>{if(t&&!e.$onRenderResolve$&&t["s-p"]){const n=t["s-p"].push(new Promise(r=>e.$onRenderResolve$=()=>{t["s-p"].splice(n-1,1),r()}))}},og=(e,t)=>{if(e.$flags$|=16,e.$flags$&4){e.$flags$|=512;return}n1(e,e.$ancestorComponent$);const n=()=>VS(e,t);if(t){queueMicrotask(()=>{n()});return}return NS(n)},VS=(e,t)=>{const n=e.$hostElement$,r=rs("scheduleUpdate",e.$cmpMeta$.$tagName$),s=e.$lazyInstance$;if(!s)throw new Error(`Can't render component <${n.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let i;return t?i=Bs(s,"componentWillLoad",void 0,n):i=Bs(s,"componentWillUpdate",void 0,n),i=Hw(i,()=>Bs(s,"componentWillRender",void 0,n)),r(),Hw(i,()=>GS(e,s,t))},Hw=(e,t)=>KS(e)?e.then(t).catch(n=>{console.error(n),t()}):t(),KS=e=>e instanceof Promise||e&&e.then&&typeof e.then=="function",GS=async(e,t,n)=>{var r;const s=e.$hostElement$,i=rs("update",e.$cmpMeta$.$tagName$),o=s["s-rc"];n&&BS(e);const a=rs("render",e.$cmpMeta$.$tagName$);YS(e,t,s,n),o&&(o.map(c=>c()),s["s-rc"]=void 0),a(),i();{const c=(r=s["s-p"])!=null?r:[],l=()=>ZS(e);c.length===0?l():(Promise.all(c).then(l),e.$flags$|=4,c.length=0)}},YS=(e,t,n,r)=>{try{t=t.render(),e.$flags$&=-17,e.$flags$|=2,WS(e,t,r)}catch(s){qo(s,e.$hostElement$)}return null},ZS=e=>{const t=e.$cmpMeta$.$tagName$,n=e.$hostElement$,r=rs("postUpdate",t),s=e.$lazyInstance$,i=e.$ancestorComponent$;Bs(s,"componentDidRender",void 0,n),e.$flags$&64?(Bs(s,"componentDidUpdate",void 0,n),r()):(e.$flags$|=64,JS(n),Bs(s,"componentDidLoad",void 0,n),r(),e.$onReadyResolve$(n),i||r1()),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),e.$flags$&512&&ng(()=>og(e,!1)),e.$flags$&=-517},r1=e=>{ng(()=>FS(Dt,"appload",{detail:{namespace:mS}}))},Bs=(e,t,n,r)=>{if(e&&e[t])try{return e[t](n)}catch(s){qo(s,r)}},JS=e=>{var t;return e.classList.add((t=ku.hydratedSelectorName)!=null?t:"hydrated")},XS=(e,t)=>dr(e).$instanceValues$.get(t),Qd=(e,t,n,r)=>{const s=dr(e);if(!s)return;if(!s)throw new Error(`Couldn't find host element for "${r.$tagName$}" as it is unknown to this Stencil runtime. This usually happens when integrating a 3rd party Stencil component with another Stencil component or application. Please reach out to the maintainers of the 3rd party Stencil component or report this on the Stencil Discord server (https://chat.stenciljs.com) or comment on this similar [GitHub issue](https://github.com/stenciljs/core/issues/5457).`);const i=s.$instanceValues$.get(t),o=s.$flags$,a=s.$lazyInstance$;n=Sf(n,r.$members$[t][0]);const c=Number.isNaN(i)&&Number.isNaN(n),l=n!==i&&!c;if((!(o&8)||i===void 0)&&l&&(s.$instanceValues$.set(t,n),a&&(o&18)===2)){if(a.componentShouldUpdate&&a.componentShouldUpdate(n,i,t)===!1)return;og(s,!1)}},s1=(e,t,n)=>{var r,s;const i=e.prototype;if(t.$members$||ku.watchCallback){const o=Object.entries((r=t.$members$)!=null?r:{});if(o.map(([a,[c]])=>{if(c&31||n&2&&c&32){const{get:l,set:u}=Object.getOwnPropertyDescriptor(i,a)||{};l&&(t.$members$[a][0]|=2048),u&&(t.$members$[a][0]|=4096),(n&1||!l)&&Object.defineProperty(i,a,{get(){{if((t.$members$[a][0]&2048)===0)return XS(this,a);const d=dr(this),h=d?d.$lazyInstance$:i;return h?h[a]:void 0}},configurable:!0,enumerable:!0}),Object.defineProperty(i,a,{set(d){const h=dr(this);if(h){if(u){const p=c&32?this[a]:h.$hostElement$[a];typeof p>"u"&&h.$instanceValues$.get(a)?d=h.$instanceValues$.get(a):!h.$instanceValues$.get(a)&&p&&h.$instanceValues$.set(a,p),u.apply(this,[Sf(d,c)]),d=c&32?this[a]:h.$hostElement$[a],Qd(this,a,d,t);return}{if((n&1)===0||(t.$members$[a][0]&4096)===0){Qd(this,a,d,t),n&1&&!h.$lazyInstance$&&h.$onReadyPromise$.then(()=>{t.$members$[a][0]&4096&&h.$lazyInstance$[a]!==h.$instanceValues$.get(a)&&(h.$lazyInstance$[a]=d)});return}const p=()=>{const f=h.$lazyInstance$[a];!h.$instanceValues$.get(a)&&f&&h.$instanceValues$.set(a,f),h.$lazyInstance$[a]=Sf(d,c),Qd(this,a,h.$lazyInstance$[a],t)};h.$lazyInstance$?p():h.$onReadyPromise$.then(()=>p())}}}})}}),n&1){const a=new Map;i.attributeChangedCallback=function(c,l,u){_t.jmp(()=>{var d;const h=a.get(c);if(this.hasOwnProperty(h)&&ku.lazyLoad)u=this[h],delete this[h];else{if(i.hasOwnProperty(h)&&typeof this[h]=="number"&&this[h]==u)return;if(h==null){const f=dr(this),g=f?.$flags$;if(f&&g&&!(g&8)&&g&128&&u!==l){const w=f.$lazyInstance$,b=(d=t.$watchers$)==null?void 0:d[c];b?.forEach(I=>{w[I]!=null&&w[I].call(w,u,l,c)})}return}}const p=Object.getOwnPropertyDescriptor(i,h);u=u===null&&typeof this[h]=="boolean"?!1:u,u!==this[h]&&(!p.get||p.set)&&(this[h]=u)})},e.observedAttributes=Array.from(new Set([...Object.keys((s=t.$watchers$)!=null?s:{}),...o.filter(([c,l])=>l[0]&31).map(([c,l])=>{const u=l[1]||c;return a.set(u,c),u})]))}}return e},QS=async(e,t,n,r)=>{let s;if((t.$flags$&32)===0){if(t.$flags$|=32,n.$lazyBundleId$){const c=AS(n,t);if(c&&"then"in c){const u=kS();s=await c,u()}else s=c;if(!s)throw new Error(`Constructor for "${n.$tagName$}#${t.$modeName$}" was not found`);s.isProxied||(s1(s,n,2),s.isProxied=!0);const l=rs("createInstance",n.$tagName$);t.$flags$|=8;try{new s(t)}catch(u){qo(u,e)}t.$flags$&=-9,l(),xf(t.$lazyInstance$,e)}else{s=e.constructor;const c=e.localName;customElements.whenDefined(c).then(()=>t.$flags$|=128)}if(s&&s.style){let c;typeof s.style=="string"&&(c=s.style);const l=Jv(n);if(!Uu.has(l)){const u=rs("registerStyles",n.$tagName$);US(l,c,!!(n.$flags$&1)),u()}}}const i=t.$ancestorComponent$,o=()=>og(t,!0);i&&i["s-rc"]?i["s-rc"].push(o):o()},xf=(e,t)=>{Bs(e,"connectedCallback",void 0,t)},ex=e=>{if((_t.$flags$&1)===0){const t=dr(e);if(!t)return;const n=t.$cmpMeta$,r=rs("connectedCallback",n.$tagName$);if(t.$flags$&1)t?.$lazyInstance$?xf(t.$lazyInstance$,e):t?.$onReadyPromise$&&t.$onReadyPromise$.then(()=>xf(t.$lazyInstance$,e));else{t.$flags$|=1;{let s=e;for(;s=s.parentNode||s.host;)if(s["s-p"]){n1(t,t.$ancestorComponent$=s);break}}n.$members$&&Object.entries(n.$members$).map(([s,[i]])=>{if(i&31&&e.hasOwnProperty(s)){const o=e[s];delete e[s],e[s]=o}}),QS(e,t,n)}r()}},zw=(e,t)=>{Bs(e,"disconnectedCallback",void 0,t||e)},tx=async e=>{if((_t.$flags$&1)===0){const t=dr(e);t?.$lazyInstance$?zw(t.$lazyInstance$,e):t?.$onReadyPromise$&&t.$onReadyPromise$.then(()=>zw(t.$lazyInstance$,e))}Po.has(e)&&Po.delete(e),e.shadowRoot&&Po.has(e.shadowRoot)&&Po.delete(e.shadowRoot)},nx=(e,t={})=>{var n;if(!Dt.document){console.warn("Stencil: No document found. Skipping bootstrapping lazy components.");return}const r=rs(),s=[],i=t.exclude||[],o=Dt.customElements,a=Dt.document.head,c=a.querySelector("meta[charset]"),l=Dt.document.createElement("style"),u=[];let d,h=!0;Object.assign(_t,t),_t.$resourcesUrl$=new URL(t.resourcesUrl||"./",Dt.document.baseURI).href;let p=!1;if(e.map(f=>{f[1].map(g=>{const w={$flags$:g[0],$tagName$:g[1],$members$:g[2],$listeners$:g[3]};w.$flags$&4&&(p=!0),w.$members$=g[2];const b=w.$tagName$,I=class extends HTMLElement{constructor(y){if(super(y),this.hasRegisteredEventListeners=!1,y=this,CS(y,w),w.$flags$&1){if(!y.shadowRoot)PS.call(y,w);else if(y.shadowRoot.mode!=="open")throw new Error(`Unable to re-use existing shadow root for ${w.$tagName$}! Mode is set to ${y.shadowRoot.mode} but Stencil only supports open shadow roots.`)}}connectedCallback(){dr(this)&&(this.hasRegisteredEventListeners||(this.hasRegisteredEventListeners=!0),d&&(clearTimeout(d),d=null),h?u.push(this):_t.jmp(()=>ex(this)))}disconnectedCallback(){_t.jmp(()=>tx(this)),_t.raf(()=>{var y;const m=dr(this);if(!m)return;const v=u.findIndex(C=>C===this);v>-1&&u.splice(v,1),((y=m?.$vnode$)==null?void 0:y.$elm$)instanceof Node&&!m.$vnode$.$elm$.isConnected&&delete m.$vnode$.$elm$})}componentOnReady(){var y;return(y=dr(this))==null?void 0:y.$onReadyPromise$}};w.$lazyBundleId$=f[0],!i.includes(b)&&!o.get(b)&&(s.push(b),o.define(b,s1(I,w,1)))})}),s.length>0&&(p&&(l.textContent+=Kv),l.textContent+=s.sort()+IS,l.innerHTML.length)){l.setAttribute("data-styles","");const f=(n=_t.$nonce$)!=null?n:Yv(Dt.document);f!=null&&l.setAttribute("nonce",f),a.insertBefore(l,c?c.nextSibling:a.firstChild)}h=!1,u.length?u.map(f=>f.connectedCallback()):_t.jmp(()=>d=setTimeout(r1,30)),r()};const rx=()=>{},sx=async(e,t)=>{if(!(typeof window>"u"))return await rx(),nx([["connect-modal",[[257,"connect-modal",{defaultProviders:[16,"default-providers"],installedProviders:[16,"installed-providers"],callback:[16],cancelCallback:[16,"cancel-callback"]}]]]],t)};(function(){if(typeof window<"u"&&window.Reflect!==void 0&&window.customElements!==void 0){var e=HTMLElement;window.HTMLElement=function(){return Reflect.construct(e,[],this.constructor)},HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}})();function ix(e){const t=Object.values(e).filter(r=>typeof r=="number"),n=new Set(t);return r=>n.has(r)}const qw=new Map;function i1(e,t){const n=qw.get(e);if(n!==void 0)return n(t);const r=ix(e);return qw.set(e,r),i1(e,t)}class Ye{constructor(t){this.consumed=0,this.source=typeof t=="string"?Ve(t):t}readBytes(t){const n=this.source.subarray(this.consumed,this.consumed+t);return this.consumed+=t,n}readUInt32BE(){return iS(this.readBytes(4),0)}readUInt8(){return rS(this.readBytes(1),0)}readUInt16BE(){return tS(this.readBytes(2),0)}readBigUIntLE(t){const n=this.readBytes(t).slice().reverse(),r=we(n);return BigInt(`0x${r}`)}readBigUIntBE(t){const n=this.readBytes(t),r=we(n);return BigInt(`0x${r}`)}get readOffset(){return this.consumed}set readOffset(t){this.consumed=t}get internalBytes(){return this.source}readUInt8Enum(t,n){const r=this.readUInt8();if(i1(t,r))return r;throw n(r)}}var gc;(function(e){e[e.Mainnet=1]="Mainnet",e[e.Testnet=2147483648]="Testnet"})(gc||(gc={}));var Bu;(function(e){e[e.Mainnet=385875968]="Mainnet",e[e.Testnet=4278190080]="Testnet"})(Bu||(Bu={}));gc.Mainnet;var Ui;(function(e){e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet"})(Ui||(Ui={}));var Ri;(function(e){e[e.MainnetSingleSig=22]="MainnetSingleSig",e[e.MainnetMultiSig=20]="MainnetMultiSig",e[e.TestnetSingleSig=26]="TestnetSingleSig",e[e.TestnetMultiSig=21]="TestnetMultiSig"})(Ri||(Ri={}));Ui.Mainnet;const o1={chainId:gc.Mainnet,transactionVersion:Ui.Mainnet,peerNetworkId:Bu.Mainnet,magicBytes:"X2",bootAddress:"SP000000000000000000002Q6VF78",addressVersion:{singleSig:Ri.MainnetSingleSig,multiSig:Ri.MainnetMultiSig},client:{baseUrl:ZI}},Nf={chainId:gc.Testnet,transactionVersion:Ui.Testnet,peerNetworkId:Bu.Testnet,magicBytes:"T2",bootAddress:"ST000000000000000000002AMW42H",addressVersion:{singleSig:Ri.TestnetSingleSig,multiSig:Ri.TestnetMultiSig},client:{baseUrl:JI}},bu={...Nf,addressVersion:{...Nf.addressVersion},magicBytes:"id",client:{baseUrl:XI}},ox={...bu,addressVersion:{...bu.addressVersion},client:{...bu.client}};function ax(e){switch(e){case"mainnet":return o1;case"testnet":return Nf;case"devnet":return bu;case"mocknet":return ox;default:throw new Error(`Unknown network name: ${e}`)}}function cx(e){return typeof e=="string"?ax(e):e}const lx=128,ux=128,a1=16,_i=32,_f=80,ud=65,dx=32,hx=64,Mu=34,fx=1+16*1024*1024,px=165,gx=16,wx=16,mx=20,yx=wx+2+mx,bx=yx+4,vx=fx+(px+gx*bx);var Be;(function(e){e[e.TokenTransfer=0]="TokenTransfer",e[e.SmartContract=1]="SmartContract",e[e.VersionedSmartContract=6]="VersionedSmartContract",e[e.ContractCall=2]="ContractCall",e[e.PoisonMicroblock=3]="PoisonMicroblock",e[e.Coinbase=4]="Coinbase",e[e.CoinbaseToAltRecipient=5]="CoinbaseToAltRecipient",e[e.TenureChange=7]="TenureChange",e[e.NakamotoCoinbase=8]="NakamotoCoinbase"})(Be||(Be={}));var Tf;(function(e){e[e.Clarity1=1]="Clarity1",e[e.Clarity2=2]="Clarity2",e[e.Clarity3=3]="Clarity3",e[e.Clarity4=4]="Clarity4"})(Tf||(Tf={}));var bn;(function(e){e[e.OnChainOnly=1]="OnChainOnly",e[e.OffChainOnly=2]="OffChainOnly",e[e.Any=3]="Any"})(bn||(bn={}));const eh=["onChainOnly","offChainOnly","any"];eh[0]+"",bn.OnChainOnly,eh[1]+"",bn.OffChainOnly,eh[2]+"",bn.Any,bn.OnChainOnly+"",bn.OnChainOnly,bn.OffChainOnly+"",bn.OffChainOnly,bn.Any+"",bn.Any;var qs;(function(e){e[e.Allow=1]="Allow",e[e.Deny=2]="Deny"})(qs||(qs={}));var Tt;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(Tt||(Tt={}));var st;(function(e){e[e.Standard=4]="Standard",e[e.Sponsored=5]="Sponsored"})(st||(st={}));var We;(function(e){e[e.P2PKH=0]="P2PKH",e[e.P2SH=1]="P2SH",e[e.P2WPKH=2]="P2WPKH",e[e.P2WSH=3]="P2WSH",e[e.P2SHNonSequential=5]="P2SHNonSequential",e[e.P2WSHNonSequential=7]="P2WSHNonSequential"})(We||(We={}));var rt;(function(e){e[e.Compressed=0]="Compressed",e[e.Uncompressed=1]="Uncompressed"})(rt||(rt={}));var Lu;(function(e){e[e.Equal=1]="Equal",e[e.Greater=2]="Greater",e[e.GreaterEqual=3]="GreaterEqual",e[e.Less=4]="Less",e[e.LessEqual=5]="LessEqual"})(Lu||(Lu={}));var Of;(function(e){e[e.Sends=16]="Sends",e[e.DoesNotSend=17]="DoesNotSend"})(Of||(Of={}));var _n;(function(e){e[e.Origin=1]="Origin",e[e.Standard=2]="Standard",e[e.Contract=3]="Contract"})(_n||(_n={}));var Ww;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(Ww||(Ww={}));var Df;(function(e){e[e.BlockFound=0]="BlockFound",e[e.Extended=1]="Extended"})(Df||(Df={}));var sr;(function(e){e[e.PublicKeyCompressed=0]="PublicKeyCompressed",e[e.PublicKeyUncompressed=1]="PublicKeyUncompressed",e[e.SignatureCompressed=2]="SignatureCompressed",e[e.SignatureUncompressed=3]="SignatureUncompressed"})(sr||(sr={}));var Vw;(function(e){e.Serialization="Serialization",e.Deserialization="Deserialization",e.SignatureValidation="SignatureValidation",e.FeeTooLow="FeeTooLow",e.BadNonce="BadNonce",e.NotEnoughFunds="NotEnoughFunds",e.NoSuchContract="NoSuchContract",e.NoSuchPublicFunction="NoSuchPublicFunction",e.BadFunctionArgument="BadFunctionArgument",e.ContractAlreadyExists="ContractAlreadyExists",e.PoisonMicroblocksDoNotConflict="PoisonMicroblocksDoNotConflict",e.PoisonMicroblockHasUnknownPubKeyHash="PoisonMicroblockHasUnknownPubKeyHash",e.PoisonMicroblockIsInvalid="PoisonMicroblockIsInvalid",e.BadAddressVersionByte="BadAddressVersionByte",e.NoCoinbaseViaMempool="NoCoinbaseViaMempool",e.ServerFailureNoSuchChainTip="ServerFailureNoSuchChainTip",e.ServerFailureDatabase="ServerFailureDatabase",e.ServerFailureOther="ServerFailureOther"})(Vw||(Vw={}));let dd=class extends Error{constructor(t){super(t),this.message=t,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},ko=class extends dd{constructor(t){super(t)}};class xn extends dd{constructor(t){super(t)}}class ju extends dd{constructor(t){super(t)}}class bi extends dd{constructor(t){super(t)}}function $f(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Ex(e){if(typeof e!="boolean")throw new Error(`Expected boolean, not ${e}`)}function c1(e,...t){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function Cx(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");$f(e.outputLen),$f(e.blockLen)}function Ax(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Ix(e,t){c1(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}const vi={number:$f,bool:Ex,bytes:c1,hash:Cx,exists:Ax,output:Ix};const th=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),gr=(e,t)=>e<<32-t|e>>>t,Sx=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Sx)throw new Error("Non little-endian hardware is not supported");Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function xx(e){if(typeof e!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function ag(e){if(typeof e=="string"&&(e=xx(e)),!(e instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}let l1=class{clone(){return this._cloneInto()}};function Wi(e){const t=r=>e().update(ag(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class u1 extends l1{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,vi.hash(t);const r=ag(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?t.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(t){return vi.exists(this),this.iHash.update(t),this}digestInto(t){vi.exists(this),vi.bytes(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const d1=(e,t,n)=>new u1(e,t).update(n).digest();d1.create=(e,t)=>new u1(e,t);function Nx(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}class cg extends l1{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=th(this.buffer)}update(t){vi.exists(this);const{view:n,buffer:r,blockLen:s}=this;t=ag(t);const i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=th(t);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){vi.exists(this),vi.output(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;Nx(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=th(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.length=s,t.pos=a,t.finished=i,t.destroyed=o,s%n&&t.buffer.set(r),t}}const _x=(e,t,n)=>e&t^~e&n,Tx=(e,t,n)=>e&t^e&n^t&n,Ox=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),us=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ds=new Uint32Array(64);class h1 extends cg{constructor(){super(64,32,8,!1),this.A=us[0]|0,this.B=us[1]|0,this.C=us[2]|0,this.D=us[3]|0,this.E=us[4]|0,this.F=us[5]|0,this.G=us[6]|0,this.H=us[7]|0}get(){const{A:t,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[t,n,r,s,i,o,a,c]}set(t,n,r,s,i,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)ds[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=ds[d-15],p=ds[d-2],f=gr(h,7)^gr(h,18)^h>>>3,g=gr(p,17)^gr(p,19)^p>>>10;ds[d]=g+ds[d-7]+f+ds[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=gr(a,6)^gr(a,11)^gr(a,25),p=u+h+_x(a,c,l)+Ox[d]+ds[d]|0,g=(gr(r,2)^gr(r,13)^gr(r,22))+Tx(r,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=r,r=p+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){ds.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Dx extends h1{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const lg=Wi(()=>new h1);Wi(()=>new Dx);const $x={},Px=Object.freeze(Object.defineProperty({__proto__:null,default:$x},Symbol.toStringTag,{value:"Module"}));const Ne=BigInt(0),tt=BigInt(1),Ds=BigInt(2),Ja=BigInt(3),Kw=BigInt(8),ct=Object.freeze({a:Ne,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:tt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Gw=(e,t)=>(e+t/Ds)/t,kl={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){const{n:t}=ct,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-tt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=n,o=BigInt("0x100000000000000000000000000000000"),a=Gw(i*e,t),c=Gw(-r*e,t);let l=re(e-a*n-c*s,t),u=re(-a*r-c*i,t);const d=l>o,h=u>o;if(d&&(l=t-l),h&&(u=t-u),l>o||u>o)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:d,k1:l,k2neg:h,k2:u}}},ar=32,Wo=32,kx=32,Yw=ar+1,Zw=2*ar+1;function Jw(e){const{a:t,b:n}=ct,r=re(e*e),s=re(r*e);return re(s+t*e+n)}const Ul=ct.a===Ne;class f1 extends Error{constructor(t){super(t)}}function Xw(e){if(!(e instanceof Ue))throw new TypeError("JacobianPoint expected")}class Ue{constructor(t,n,r){this.x=t,this.y=n,this.z=r}static fromAffine(t){if(!(t instanceof Ge))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(Ge.ZERO)?Ue.ZERO:new Ue(t.x,t.y,tt)}static toAffineBatch(t){const n=Lx(t.map(r=>r.z));return t.map((r,s)=>r.toAffine(n[s]))}static normalizeZ(t){return Ue.toAffineBatch(t).map(Ue.fromAffine)}equals(t){Xw(t);const{x:n,y:r,z:s}=this,{x:i,y:o,z:a}=t,c=re(s*s),l=re(a*a),u=re(n*l),d=re(i*c),h=re(re(r*a)*l),p=re(re(o*s)*c);return u===d&&h===p}negate(){return new Ue(this.x,re(-this.y),this.z)}double(){const{x:t,y:n,z:r}=this,s=re(t*t),i=re(n*n),o=re(i*i),a=t+i,c=re(Ds*(re(a*a)-s-o)),l=re(Ja*s),u=re(l*l),d=re(u-Ds*c),h=re(l*(c-d)-Kw*o),p=re(Ds*n*r);return new Ue(d,h,p)}add(t){Xw(t);const{x:n,y:r,z:s}=this,{x:i,y:o,z:a}=t;if(i===Ne||o===Ne)return this;if(n===Ne||r===Ne)return t;const c=re(s*s),l=re(a*a),u=re(n*l),d=re(i*c),h=re(re(r*a)*l),p=re(re(o*s)*c),f=re(d-u),g=re(p-h);if(f===Ne)return g===Ne?this.double():Ue.ZERO;const w=re(f*f),b=re(f*w),I=re(u*w),y=re(g*g-b-Ds*I),m=re(g*(I-y)-h*b),v=re(s*a*f);return new Ue(y,m,v)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){const n=Ue.ZERO;if(typeof t=="bigint"&&t===Ne)return n;let r=t0(t);if(r===tt)return this;if(!Ul){let d=n,h=this;for(;r>Ne;)r&tt&&(d=d.add(h)),h=h.double(),r>>=tt;return d}let{k1neg:s,k1:i,k2neg:o,k2:a}=kl.splitScalar(r),c=n,l=n,u=this;for(;i>Ne||a>Ne;)i&tt&&(c=c.add(u)),a&tt&&(l=l.add(u)),u=u.double(),i>>=tt,a>>=tt;return s&&(c=c.negate()),o&&(l=l.negate()),l=new Ue(re(l.x*kl.beta),l.y,l.z),c.add(l)}precomputeWindow(t){const n=Ul?128/t+1:256/t+1,r=[];let s=this,i=s;for(let o=0;o<n;o++){i=s,r.push(i);for(let a=1;a<2**(t-1);a++)i=i.add(s),r.push(i);s=i.double()}return r}wNAF(t,n){!n&&this.equals(Ue.BASE)&&(n=Ge.BASE);const r=n&&n._WINDOW_SIZE||1;if(256%r)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let s=n&&Pf.get(n);s||(s=this.precomputeWindow(r),n&&r!==1&&(s=Ue.normalizeZ(s),Pf.set(n,s)));let i=Ue.ZERO,o=Ue.BASE;const a=1+(Ul?128/r:256/r),c=2**(r-1),l=BigInt(2**r-1),u=2**r,d=BigInt(r);for(let h=0;h<a;h++){const p=h*c;let f=Number(t&l);t>>=d,f>c&&(f-=u,t+=tt);const g=p,w=p+Math.abs(f)-1,b=h%2!==0,I=f<0;f===0?o=o.add(Rl(b,s[g])):i=i.add(Rl(I,s[w]))}return{p:i,f:o}}multiply(t,n){let r=t0(t),s,i;if(Ul){const{k1neg:o,k1:a,k2neg:c,k2:l}=kl.splitScalar(r);let{p:u,f:d}=this.wNAF(a,n),{p:h,f:p}=this.wNAF(l,n);u=Rl(o,u),h=Rl(c,h),h=new Ue(re(h.x*kl.beta),h.y,h.z),s=u.add(h),i=d.add(p)}else{const{p:o,f:a}=this.wNAF(r,n);s=o,i=a}return Ue.normalizeZ([s,i])[0]}toAffine(t){const{x:n,y:r,z:s}=this,i=this.equals(Ue.ZERO);t==null&&(t=i?Kw:nl(s));const o=t,a=re(o*o),c=re(a*o),l=re(n*a),u=re(r*c),d=re(s*o);if(i)return Ge.ZERO;if(d!==tt)throw new Error("invZ was invalid");return new Ge(l,u)}}Ue.BASE=new Ue(ct.Gx,ct.Gy,tt);Ue.ZERO=new Ue(Ne,tt,Ne);function Rl(e,t){const n=t.negate();return e?n:t}const Pf=new WeakMap;class Ge{constructor(t,n){this.x=t,this.y=n}_setWindowSize(t){this._WINDOW_SIZE=t,Pf.delete(this)}hasEvenY(){return this.y%Ds===Ne}static fromCompressedHex(t){const n=t.length===32,r=Ms(n?t:t.subarray(1));if(!nh(r))throw new Error("Point is not on curve");const s=Jw(r);let i=Mx(s);const o=(i&tt)===tt;n?o&&(i=re(-i)):(t[0]&1)===1!==o&&(i=re(-i));const a=new Ge(r,i);return a.assertValidity(),a}static fromUncompressedHex(t){const n=Ms(t.subarray(1,ar+1)),r=Ms(t.subarray(ar+1,ar*2+1)),s=new Ge(n,r);return s.assertValidity(),s}static fromHex(t){const n=wc(t),r=n.length,s=n[0];if(r===ar)return this.fromCompressedHex(n);if(r===Yw&&(s===2||s===3))return this.fromCompressedHex(n);if(r===Zw&&s===4)return this.fromUncompressedHex(n);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Yw} compressed bytes or ${Zw} uncompressed bytes, not ${r}`)}static fromPrivateKey(t){return Ge.BASE.multiply(Hu(t))}static fromSignature(t,n,r){const{r:s,s:i}=zx(n);if(![0,1,2,3].includes(r))throw new Error("Cannot recover: invalid recovery bit");const o=p1(wc(t)),{n:a}=ct,c=r===2||r===3?s+a:s,l=nl(c,a),u=re(-o*l,a),d=re(i*l,a),h=r&1?"03":"02",p=Ge.fromHex(h+Lo(c)),f=Ge.BASE.multiplyAndAddUnsafe(p,u,d);if(!f)throw new Error("Cannot recover signature: point at infinify");return f.assertValidity(),f}toRawBytes(t=!1){return Ti(this.toHex(t))}toHex(t=!1){const n=Lo(this.x);return t?`${this.hasEvenY()?"02":"03"}${n}`:`04${n}${Lo(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const t="Point is not on elliptic curve",{x:n,y:r}=this;if(!nh(n)||!nh(r))throw new Error(t);const s=re(r*r),i=Jw(n);if(re(s-i)!==Ne)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new Ge(this.x,re(-this.y))}double(){return Ue.fromAffine(this).double().toAffine()}add(t){return Ue.fromAffine(this).add(Ue.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return Ue.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,n,r){const s=Ue.fromAffine(this),i=n===Ne||n===tt||this!==Ge.BASE?s.multiplyUnsafe(n):s.multiply(n),o=Ue.fromAffine(t).multiplyUnsafe(r),a=i.add(o);return a.equals(Ue.ZERO)?void 0:a.toAffine()}}Ge.BASE=new Ge(ct.Gx,ct.Gy);Ge.ZERO=new Ge(Ne,Ne);function Qw(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function e0(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${Vo(e)}`);const t=e[1],n=e.subarray(2,t+2);if(!t||n.length!==t)throw new Error("Invalid signature integer: wrong length");if(n[0]===0&&n[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Ms(n),left:e.subarray(t+2)}}function Ux(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${Vo(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");const{data:t,left:n}=e0(e.subarray(2)),{data:r,left:s}=e0(n);if(s.length)throw new Error(`Invalid signature: left bytes after parsing: ${Vo(s)}`);return{r:t,s:r}}class Tr{constructor(t,n){this.r=t,this.s=n,this.assertValidity()}static fromCompact(t){const n=t instanceof Uint8Array,r="Signature.fromCompact";if(typeof t!="string"&&!n)throw new TypeError(`${r}: Expected string or Uint8Array`);const s=n?Vo(t):t;if(s.length!==128)throw new Error(`${r}: Expected 64-byte hex`);return new Tr(Fu(s.slice(0,64)),Fu(s.slice(64,128)))}static fromDER(t){const n=t instanceof Uint8Array;if(typeof t!="string"&&!n)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r,s}=Ux(n?t:Ti(t));return new Tr(r,s)}static fromHex(t){return this.fromDER(t)}assertValidity(){const{r:t,s:n}=this;if(!mc(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!mc(n))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const t=ct.n>>tt;return this.s>t}normalizeS(){return this.hasHighS()?new Tr(this.r,re(-this.s,ct.n)):this}toDERRawBytes(){return Ti(this.toDERHex())}toDERHex(){const t=Qw(Aa(this.s)),n=Qw(Aa(this.r)),r=t.length/2,s=n.length/2,i=Aa(r),o=Aa(s);return`30${Aa(s+r+4)}02${o}${n}02${i}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Ti(this.toCompactHex())}toCompactHex(){return Lo(this.r)+Lo(this.s)}}function _s(...e){if(!e.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];const t=e.reduce((r,s)=>r+s.length,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}const Rx=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Vo(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let n=0;n<e.length;n++)t+=Rx[e[n]];return t}const Bx=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Lo(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(Ne<=e&&e<Bx))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function kf(e){const t=Ti(Lo(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function Aa(e){const t=e.toString(16);return t.length&1?`0${t}`:t}function Fu(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function Ti(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);const t=new Uint8Array(e.length/2);for(let n=0;n<t.length;n++){const r=n*2,s=e.slice(r,r+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");t[n]=i}return t}function Ms(e){return Fu(Vo(e))}function wc(e){return e instanceof Uint8Array?Uint8Array.from(e):Ti(e)}function t0(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&mc(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function re(e,t=ct.P){const n=e%t;return n>=Ne?n:t+n}function Pn(e,t){const{P:n}=ct;let r=e;for(;t-- >Ne;)r*=r,r%=n;return r}function Mx(e){const{P:t}=ct,n=BigInt(6),r=BigInt(11),s=BigInt(22),i=BigInt(23),o=BigInt(44),a=BigInt(88),c=e*e*e%t,l=c*c*e%t,u=Pn(l,Ja)*l%t,d=Pn(u,Ja)*l%t,h=Pn(d,Ds)*c%t,p=Pn(h,r)*h%t,f=Pn(p,s)*p%t,g=Pn(f,o)*f%t,w=Pn(g,a)*g%t,b=Pn(w,o)*f%t,I=Pn(b,Ja)*l%t,y=Pn(I,i)*p%t,m=Pn(y,n)*c%t,v=Pn(m,Ds);if(v*v%t!==e)throw new Error("Cannot find square root");return v}function nl(e,t=ct.P){if(e===Ne||t<=Ne)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let n=re(e,t),r=t,s=Ne,i=tt;for(;n!==Ne;){const a=r/n,c=r%n,l=s-i*a;r=n,n=c,s=i,i=l}if(r!==tt)throw new Error("invert: does not exist");return re(s,t)}function Lx(e,t=ct.P){const n=new Array(e.length),r=e.reduce((i,o,a)=>o===Ne?i:(n[a]=i,re(i*o,t)),tt),s=nl(r,t);return e.reduceRight((i,o,a)=>o===Ne?i:(n[a]=re(i*n[a],t),re(i*o,t)),s),n}function jx(e){const t=e.length*8-Wo*8,n=Ms(e);return t>0?n>>BigInt(t):n}function p1(e,t=!1){const n=jx(e);if(t)return n;const{n:r}=ct;return n>=r?n-r:n}let jo,Xa;class Fx{constructor(t,n){if(this.hashLen=t,this.qByteLen=n,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof n!="number"||n<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return $s.hmacSha256(this.k,...t)}hmacSync(...t){return Xa(this.k,...t)}checkSync(){if(typeof Xa!="function")throw new f1("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0;const n=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);const r=this.v.slice();n.push(r),t+=this.v.length}return _s(...n)}generateSync(){this.checkSync(),this.incr();let t=0;const n=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);const r=this.v.slice();n.push(r),t+=this.v.length}return _s(...n)}}function mc(e){return Ne<e&&e<ct.n}function nh(e){return Ne<e&&e<ct.P}function Hx(e,t,n,r=!0){const{n:s}=ct,i=p1(e,!0);if(!mc(i))return;const o=nl(i,s),a=Ge.BASE.multiply(i),c=re(a.x,s);if(c===Ne)return;const l=re(o*re(t+n*c,s),s);if(l===Ne)return;let u=new Tr(c,l),d=(a.x===u.r?0:2)|Number(a.y&tt);return r&&u.hasHighS()&&(u=u.normalizeS(),d^=1),{sig:u,recovery:d}}function Hu(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*Wo)throw new Error("Expected 32 bytes of private key");t=Fu(e)}else if(e instanceof Uint8Array){if(e.length!==Wo)throw new Error("Expected 32 bytes of private key");t=Ms(e)}else throw new TypeError("Expected valid private key");if(!mc(t))throw new Error("Expected private key: 0 < key < n");return t}function zx(e){if(e instanceof Tr)return e.assertValidity(),e;try{return Tr.fromDER(e)}catch{return Tr.fromCompact(e)}}function qx(e,t=!1){return Ge.fromPrivateKey(e).toRawBytes(t)}function g1(e){const t=e.length>ar?e.slice(0,ar):e;return Ms(t)}function Wx(e){const t=g1(e),n=re(t,ct.n);return w1(n<Ne?t:n)}function w1(e){return kf(e)}function Vx(e,t,n){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);const r=wc(e),s=Hu(t),i=[w1(s),Wx(r)];if(n!=null){n===!0&&(n=$s.randomBytes(ar));const c=wc(n);if(c.length!==ar)throw new Error(`sign: Expected ${ar} bytes of extra data`);i.push(c)}const o=_s(...i),a=g1(r);return{seed:o,m:a,d:s}}function Kx(e,t){const{sig:n,recovery:r}=e,{der:s,recovered:i}=Object.assign({canonical:!0,der:!0},t),o=s?n.toDERRawBytes():n.toCompactRawBytes();return i?[o,r]:o}function Gx(e,t,n={}){const{seed:r,m:s,d:i}=Vx(e,t,n.extraEntropy),o=new Fx(kx,Wo);o.reseedSync(r);let a;for(;!(a=Hx(o.generateSync(),s,i,n.canonical));)o.reseedSync();return Kx(a,n)}Ge.BASE._setWindowSize(8);const gn={node:Px,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Bl={},$s={bytesToHex:Vo,hexToBytes:Ti,concatBytes:_s,mod:re,invert:nl,isValidPrivateKey(e){try{return Hu(e),!0}catch{return!1}},_bigintTo32Bytes:kf,_normalizePrivateKey:Hu,hashToPrivateKey:e=>{e=wc(e);const t=Wo+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");const n=re(Ms(e),ct.n-tt)+tt;return kf(n)},randomBytes:(e=32)=>{if(gn.web)return gn.web.getRandomValues(new Uint8Array(e));if(gn.node){const{randomBytes:t}=gn.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>$s.hashToPrivateKey($s.randomBytes(Wo+8)),precompute(e=8,t=Ge.BASE){const n=t===Ge.BASE?t:new Ge(t.x,t.y);return n._setWindowSize(e),n.multiply(Ja),n},sha256:async(...e)=>{if(gn.web){const t=await gn.web.subtle.digest("SHA-256",_s(...e));return new Uint8Array(t)}else if(gn.node){const{createHash:t}=gn.node,n=t("sha256");return e.forEach(r=>n.update(r)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(gn.web){const n=await gn.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),r=_s(...t),s=await gn.web.subtle.sign("HMAC",n,r);return new Uint8Array(s)}else if(gn.node){const{createHmac:n}=gn.node,r=n("sha256",e);return t.forEach(s=>r.update(s)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let n=Bl[e];if(n===void 0){const r=await $s.sha256(Uint8Array.from(e,s=>s.charCodeAt(0)));n=_s(r,r),Bl[e]=n}return $s.sha256(n,...t)},taggedHashSync:(e,...t)=>{if(typeof jo!="function")throw new f1("sha256Sync is undefined, you need to set it");let n=Bl[e];if(n===void 0){const r=jo(Uint8Array.from(e,s=>s.charCodeAt(0)));n=_s(r,r),Bl[e]=n}return jo(n,...t)},_JacobianPoint:Ue};Object.defineProperties($s,{sha256Sync:{configurable:!1,get(){return jo},set(e){jo||(jo=e)}},hmacSha256Sync:{configurable:!1,get(){return Xa},set(e){Xa||(Xa=e)}}});var Ht=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Yx(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var rh={},sh={},ih={},Ia={},n0;function Zx(){return n0||(n0=1,Object.defineProperty(Ia,"__esModule",{value:!0}),Ia.crypto=void 0,Ia.crypto={node:void 0,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0}),Ia}var r0;function oa(){return r0||(r0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomBytes=e.wrapConstructorWithOpts=e.wrapConstructor=e.checkOpts=e.Hash=e.concatBytes=e.toBytes=e.utf8ToBytes=e.asyncLoop=e.nextTick=e.hexToBytes=e.bytesToHex=e.isLE=e.rotr=e.createView=e.u32=e.u8=void 0;const t=Zx(),n=m=>new Uint8Array(m.buffer,m.byteOffset,m.byteLength);e.u8=n;const r=m=>new Uint32Array(m.buffer,m.byteOffset,Math.floor(m.byteLength/4));e.u32=r;const s=m=>new DataView(m.buffer,m.byteOffset,m.byteLength);e.createView=s;const i=(m,v)=>m<<32-v|m>>>v;if(e.rotr=i,e.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,!e.isLE)throw new Error("Non little-endian hardware is not supported");const o=Array.from({length:256},(m,v)=>v.toString(16).padStart(2,"0"));function a(m){if(!(m instanceof Uint8Array))throw new Error("Uint8Array expected");let v="";for(let C=0;C<m.length;C++)v+=o[m[C]];return v}e.bytesToHex=a;function c(m){if(typeof m!="string")throw new TypeError("hexToBytes: expected string, got "+typeof m);if(m.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const v=new Uint8Array(m.length/2);for(let C=0;C<v.length;C++){const O=C*2,D=m.slice(O,O+2),S=Number.parseInt(D,16);if(Number.isNaN(S)||S<0)throw new Error("Invalid byte sequence");v[C]=S}return v}e.hexToBytes=c;const l=async()=>{};e.nextTick=l;async function u(m,v,C){let O=Date.now();for(let D=0;D<m;D++){C(D);const S=Date.now()-O;S>=0&&S<v||(await(0,e.nextTick)(),O+=S)}}e.asyncLoop=u;function d(m){if(typeof m!="string")throw new TypeError(`utf8ToBytes expected string, got ${typeof m}`);return new TextEncoder().encode(m)}e.utf8ToBytes=d;function h(m){if(typeof m=="string"&&(m=d(m)),!(m instanceof Uint8Array))throw new TypeError(`Expected input type is Uint8Array (got ${typeof m})`);return m}e.toBytes=h;function p(...m){if(!m.every(O=>O instanceof Uint8Array))throw new Error("Uint8Array list expected");if(m.length===1)return m[0];const v=m.reduce((O,D)=>O+D.length,0),C=new Uint8Array(v);for(let O=0,D=0;O<m.length;O++){const S=m[O];C.set(S,D),D+=S.length}return C}e.concatBytes=p;class f{clone(){return this._cloneInto()}}e.Hash=f;const g=m=>Object.prototype.toString.call(m)==="[object Object]"&&m.constructor===Object;function w(m,v){if(v!==void 0&&(typeof v!="object"||!g(v)))throw new TypeError("Options should be object or undefined");return Object.assign(m,v)}e.checkOpts=w;function b(m){const v=O=>m().update(h(O)).digest(),C=m();return v.outputLen=C.outputLen,v.blockLen=C.blockLen,v.create=()=>m(),v}e.wrapConstructor=b;function I(m){const v=(O,D)=>m(D).update(h(O)).digest(),C=m({});return v.outputLen=C.outputLen,v.blockLen=C.blockLen,v.create=O=>m(O),v}e.wrapConstructorWithOpts=I;function y(m=32){if(t.crypto.web)return t.crypto.web.getRandomValues(new Uint8Array(m));if(t.crypto.node)return new Uint8Array(t.crypto.node.randomBytes(m).buffer);throw new Error("The environment doesn't have randomBytes function")}e.randomBytes=y})(ih)),ih}var s0;function m1(){return s0||(s0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.c32decode=e.c32normalize=e.c32encode=e.c32=void 0;const t=oa();e.c32="0123456789ABCDEFGHJKMNPQRSTVWXYZ";const n="0123456789abcdef";function r(o,a){if(!o.match(/^[0-9a-fA-F]*$/))throw new Error("Not a hex-encoded string");o.length%2!==0&&(o=`0${o}`),o=o.toLowerCase();let c=[],l=0;for(let p=o.length-1;p>=0;p--)if(l<4){const f=n.indexOf(o[p])>>l;let g=0;p!==0&&(g=n.indexOf(o[p-1]));const w=1+l,b=g%(1<<w)<<5-w,I=e.c32[f+b];l=w,c.unshift(I)}else l=0;let u=0;for(let p=0;p<c.length&&c[p]==="0";p++)u++;c=c.slice(u);const d=new TextDecoder().decode((0,t.hexToBytes)(o)).match(/^\u0000*/),h=d?d[0].length:0;for(let p=0;p<h;p++)c.unshift(e.c32[0]);if(a){const p=a-c.length;for(let f=0;f<p;f++)c.unshift(e.c32[0])}return c.join("")}e.c32encode=r;function s(o){return o.toUpperCase().replace(/O/g,"0").replace(/L|I/g,"1")}e.c32normalize=s;function i(o,a){if(o=s(o),!o.match(`^[${e.c32}]*$`))throw new Error("Not a c32-encoded string");const c=o.match(`^${e.c32[0]}*`),l=c?c[0].length:0;let u=[],d=0,h=0;for(let g=o.length-1;g>=0;g--){h===4&&(u.unshift(n[d]),h=0,d=0);const b=(e.c32.indexOf(o[g])<<h)+d,I=n[b%16];if(h+=1,d=b>>4,d>1<<h)throw new Error("Panic error in decoding.");u.unshift(I)}u.unshift(n[d]),u.length%2===1&&u.unshift("0");let p=0;for(let g=0;g<u.length&&u[g]==="0";g++)p++;u=u.slice(p-p%2);let f=u.join("");for(let g=0;g<l;g++)f=`00${f}`;if(a){const g=a*2-f.length;for(let w=0;w<g;w+=2)f=`00${f}`}return f}e.c32decode=i})(sh)),sh}var ti={},ni={},Sa={},Rt={},i0;function Jx(){if(i0)return Rt;i0=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.output=Rt.exists=Rt.hash=Rt.bytes=Rt.bool=Rt.number=void 0;function e(a){if(!Number.isSafeInteger(a)||a<0)throw new Error(`Wrong positive integer: ${a}`)}Rt.number=e;function t(a){if(typeof a!="boolean")throw new Error(`Expected boolean, not ${a}`)}Rt.bool=t;function n(a,...c){if(!(a instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(c.length>0&&!c.includes(a.length))throw new TypeError(`Expected Uint8Array of length ${c}, not of length=${a.length}`)}Rt.bytes=n;function r(a){if(typeof a!="function"||typeof a.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");e(a.outputLen),e(a.blockLen)}Rt.hash=r;function s(a,c=!0){if(a.destroyed)throw new Error("Hash instance has been destroyed");if(c&&a.finished)throw new Error("Hash#digest() has already been called")}Rt.exists=s;function i(a,c){n(a);const l=c.outputLen;if(a.length<l)throw new Error(`digestInto() expects output buffer of length at least ${l}`)}Rt.output=i;const o={number:e,bool:t,bytes:n,hash:r,exists:s,output:i};return Rt.default=o,Rt}var o0;function Xx(){if(o0)return Sa;o0=1,Object.defineProperty(Sa,"__esModule",{value:!0}),Sa.SHA2=void 0;const e=Jx(),t=oa();function n(s,i,o,a){if(typeof s.setBigUint64=="function")return s.setBigUint64(i,o,a);const c=BigInt(32),l=BigInt(4294967295),u=Number(o>>c&l),d=Number(o&l),h=a?4:0,p=a?0:4;s.setUint32(i+h,u,a),s.setUint32(i+p,d,a)}class r extends t.Hash{constructor(i,o,a,c){super(),this.blockLen=i,this.outputLen=o,this.padOffset=a,this.isLE=c,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(i),this.view=(0,t.createView)(this.buffer)}update(i){e.default.exists(this);const{view:o,buffer:a,blockLen:c}=this;i=(0,t.toBytes)(i);const l=i.length;for(let u=0;u<l;){const d=Math.min(c-this.pos,l-u);if(d===c){const h=(0,t.createView)(i);for(;c<=l-u;u+=c)this.process(h,u);continue}a.set(i.subarray(u,u+d),this.pos),this.pos+=d,u+=d,this.pos===c&&(this.process(o,0),this.pos=0)}return this.length+=i.length,this.roundClean(),this}digestInto(i){e.default.exists(this),e.default.output(i,this),this.finished=!0;const{buffer:o,view:a,blockLen:c,isLE:l}=this;let{pos:u}=this;o[u++]=128,this.buffer.subarray(u).fill(0),this.padOffset>c-u&&(this.process(a,0),u=0);for(let g=u;g<c;g++)o[g]=0;n(a,c-8,BigInt(this.length*8),l),this.process(a,0);const d=(0,t.createView)(i),h=this.outputLen;if(h%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const p=h/4,f=this.get();if(p>f.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<p;g++)d.setUint32(4*g,f[g],l)}digest(){const{buffer:i,outputLen:o}=this;this.digestInto(i);const a=i.slice(0,o);return this.destroy(),a}_cloneInto(i){i||(i=new this.constructor),i.set(...this.get());const{blockLen:o,buffer:a,length:c,finished:l,destroyed:u,pos:d}=this;return i.length=c,i.pos=d,i.finished=l,i.destroyed=u,c%o&&i.buffer.set(a),i}}return Sa.SHA2=r,Sa}var a0;function y1(){if(a0)return ni;a0=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.sha224=ni.sha256=void 0;const e=Xx(),t=oa(),n=(l,u,d)=>l&u^~l&d,r=(l,u,d)=>l&u^l&d^u&d,s=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),i=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),o=new Uint32Array(64);class a extends e.SHA2{constructor(){super(64,32,8,!1),this.A=i[0]|0,this.B=i[1]|0,this.C=i[2]|0,this.D=i[3]|0,this.E=i[4]|0,this.F=i[5]|0,this.G=i[6]|0,this.H=i[7]|0}get(){const{A:u,B:d,C:h,D:p,E:f,F:g,G:w,H:b}=this;return[u,d,h,p,f,g,w,b]}set(u,d,h,p,f,g,w,b){this.A=u|0,this.B=d|0,this.C=h|0,this.D=p|0,this.E=f|0,this.F=g|0,this.G=w|0,this.H=b|0}process(u,d){for(let m=0;m<16;m++,d+=4)o[m]=u.getUint32(d,!1);for(let m=16;m<64;m++){const v=o[m-15],C=o[m-2],O=(0,t.rotr)(v,7)^(0,t.rotr)(v,18)^v>>>3,D=(0,t.rotr)(C,17)^(0,t.rotr)(C,19)^C>>>10;o[m]=D+o[m-7]+O+o[m-16]|0}let{A:h,B:p,C:f,D:g,E:w,F:b,G:I,H:y}=this;for(let m=0;m<64;m++){const v=(0,t.rotr)(w,6)^(0,t.rotr)(w,11)^(0,t.rotr)(w,25),C=y+v+n(w,b,I)+s[m]+o[m]|0,D=((0,t.rotr)(h,2)^(0,t.rotr)(h,13)^(0,t.rotr)(h,22))+r(h,p,f)|0;y=I,I=b,b=w,w=g+C|0,g=f,f=p,p=h,h=C+D|0}h=h+this.A|0,p=p+this.B|0,f=f+this.C|0,g=g+this.D|0,w=w+this.E|0,b=b+this.F|0,I=I+this.G|0,y=y+this.H|0,this.set(h,p,f,g,w,b,I,y)}roundClean(){o.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class c extends a{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}return ni.sha256=(0,t.wrapConstructor)(()=>new a),ni.sha224=(0,t.wrapConstructor)(()=>new c),ni}var c0;function b1(){if(c0)return ti;c0=1,Object.defineProperty(ti,"__esModule",{value:!0}),ti.c32checkDecode=ti.c32checkEncode=void 0;const e=y1(),t=oa(),n=m1();function r(o){const a=(0,e.sha256)((0,e.sha256)((0,t.hexToBytes)(o)));return(0,t.bytesToHex)(a.slice(0,4))}function s(o,a){if(o<0||o>=32)throw new Error("Invalid version (must be between 0 and 31)");if(!a.match(/^[0-9a-fA-F]*$/))throw new Error("Invalid data (not a hex string)");a=a.toLowerCase(),a.length%2!==0&&(a=`0${a}`);let c=o.toString(16);c.length===1&&(c=`0${c}`);const l=r(`${c}${a}`),u=(0,n.c32encode)(`${a}${l}`);return`${n.c32[o]}${u}`}ti.c32checkEncode=s;function i(o){o=(0,n.c32normalize)(o);const a=(0,n.c32decode)(o.slice(1)),c=o[0],l=n.c32.indexOf(c),u=a.slice(-8);let d=l.toString(16);if(d.length===1&&(d=`0${d}`),r(`${d}${a.substring(0,a.length-8)}`)!==u)throw new Error("Invalid c32check string: checksum mismatch");return[l,a.substring(0,a.length-8)]}return ti.c32checkDecode=i,ti}var oh={},ri={},ah,l0;function Qx(){if(l0)return ah;l0=1;function e(t){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=t.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;for(var g=0,w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=f.charCodeAt(g);if(m>255)return;var v=n[m];if(v===255)return;for(var C=0,O=I-1;(v!==0||C<b)&&O!==-1;O--,C++)v+=a*y[O]>>>0,y[O]=v%256>>>0,v=v/256>>>0;if(v!==0)throw new Error("Non-zero carry");b=C,g++}for(var D=I-b;D!==I&&y[D]===0;)D++;for(var S=new Uint8Array(w+(I-D)),E=w;D!==I;)S[E++]=y[D++];return S}function p(f){var g=h(f);if(g)return g;throw new Error("Non-base"+a+" character")}return{encode:d,decodeUnsafe:h,decode:p}}return ah=e,ah}var u0;function eN(){if(u0)return ri;u0=1,Object.defineProperty(ri,"__esModule",{value:!0}),ri.decode=ri.encode=void 0;const e=y1(),t=oa(),n=Qx(),r="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function s(o,a="00"){const c=typeof o=="string"?(0,t.hexToBytes)(o):o,l=typeof a=="string"?(0,t.hexToBytes)(a):o;if(!(c instanceof Uint8Array)||!(l instanceof Uint8Array))throw new TypeError("Argument must be of type Uint8Array or string");const u=(0,e.sha256)((0,e.sha256)(new Uint8Array([...l,...c])));return n(r).encode([...l,...c,...u.slice(0,4)])}ri.encode=s;function i(o){const a=n(r).decode(o),c=a.slice(0,1),l=a.slice(1,-4),u=(0,e.sha256)((0,e.sha256)(new Uint8Array([...c,...l])));return a.slice(-4).forEach((d,h)=>{if(d!==u[h])throw new Error("Invalid checksum")}),{prefix:c,data:l}}return ri.decode=i,ri}var d0;function tN(){return d0||(d0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.c32ToB58=e.b58ToC32=e.c32addressDecode=e.c32address=e.versions=void 0;const t=b1(),n=eN(),r=oa();e.versions={mainnet:{p2pkh:22,p2sh:20},testnet:{p2pkh:26,p2sh:21}};const s={};s[0]=e.versions.mainnet.p2pkh,s[5]=e.versions.mainnet.p2sh,s[111]=e.versions.testnet.p2pkh,s[196]=e.versions.testnet.p2sh;const i={};i[e.versions.mainnet.p2pkh]=0,i[e.versions.mainnet.p2sh]=5,i[e.versions.testnet.p2pkh]=111,i[e.versions.testnet.p2sh]=196;function o(u,d){if(!d.match(/^[0-9a-fA-F]{40}$/))throw new Error("Invalid argument: not a hash160 hex string");return`S${(0,t.c32checkEncode)(u,d)}`}e.c32address=o;function a(u){if(u.length<=5)throw new Error("Invalid c32 address: invalid length");if(u[0]!="S")throw new Error('Invalid c32 address: must start with "S"');return(0,t.c32checkDecode)(u.slice(1))}e.c32addressDecode=a;function c(u,d=-1){const h=n.decode(u),p=(0,r.bytesToHex)(h.data),f=parseInt((0,r.bytesToHex)(h.prefix),16);let g;return d<0?(g=f,s[f]!==void 0&&(g=s[f])):g=d,o(g,p)}e.b58ToC32=c;function l(u,d=-1){const h=a(u),p=h[0],f=h[1];let g;d<0?(g=p,i[p]!==void 0&&(g=i[p])):g=d;let w=g.toString(16);return w.length===1&&(w=`0${w}`),n.encode(f,w)}e.c32ToB58=l})(oh)),oh}var h0;function nN(){return h0||(h0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.b58ToC32=e.c32ToB58=e.versions=e.c32normalize=e.c32addressDecode=e.c32address=e.c32checkDecode=e.c32checkEncode=e.c32decode=e.c32encode=void 0;const t=m1();Object.defineProperty(e,"c32encode",{enumerable:!0,get:function(){return t.c32encode}}),Object.defineProperty(e,"c32decode",{enumerable:!0,get:function(){return t.c32decode}}),Object.defineProperty(e,"c32normalize",{enumerable:!0,get:function(){return t.c32normalize}});const n=b1();Object.defineProperty(e,"c32checkEncode",{enumerable:!0,get:function(){return n.c32checkEncode}}),Object.defineProperty(e,"c32checkDecode",{enumerable:!0,get:function(){return n.c32checkDecode}});const r=tN();Object.defineProperty(e,"c32address",{enumerable:!0,get:function(){return r.c32address}}),Object.defineProperty(e,"c32addressDecode",{enumerable:!0,get:function(){return r.c32addressDecode}}),Object.defineProperty(e,"c32ToB58",{enumerable:!0,get:function(){return r.c32ToB58}}),Object.defineProperty(e,"b58ToC32",{enumerable:!0,get:function(){return r.b58ToC32}}),Object.defineProperty(e,"versions",{enumerable:!0,get:function(){return r.versions}})})(rh)),rh}var ug=nN();const rN=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),v1=Uint8Array.from({length:16},(e,t)=>t),sN=v1.map(e=>(9*e+5)%16);let dg=[v1],hg=[sN];for(let e=0;e<4;e++)for(let t of[dg,hg])t.push(t[e].map(n=>rN[n]));const E1=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>new Uint8Array(e)),iN=dg.map((e,t)=>e.map(n=>E1[t][n])),oN=hg.map((e,t)=>e.map(n=>E1[t][n])),aN=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),cN=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),Ml=(e,t)=>e<<t|e>>>32-t;function f0(e,t,n,r){return e===0?t^n^r:e===1?t&n|~t&r:e===2?(t|~n)^r:e===3?t&r|n&~r:t^(n|~r)}const Ll=new Uint32Array(16);class lN extends cg{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:n,h2:r,h3:s,h4:i}=this;return[t,n,r,s,i]}set(t,n,r,s,i){this.h0=t|0,this.h1=n|0,this.h2=r|0,this.h3=s|0,this.h4=i|0}process(t,n){for(let p=0;p<16;p++,n+=4)Ll[p]=t.getUint32(n,!0);let r=this.h0|0,s=r,i=this.h1|0,o=i,a=this.h2|0,c=a,l=this.h3|0,u=l,d=this.h4|0,h=d;for(let p=0;p<5;p++){const f=4-p,g=aN[p],w=cN[p],b=dg[p],I=hg[p],y=iN[p],m=oN[p];for(let v=0;v<16;v++){const C=Ml(r+f0(p,i,a,l)+Ll[b[v]]+g,y[v])+d|0;r=d,d=l,l=Ml(a,10)|0,a=i,i=C}for(let v=0;v<16;v++){const C=Ml(s+f0(f,o,c,u)+Ll[I[v]]+w,m[v])+h|0;s=h,h=u,u=Ml(c,10)|0,c=o,o=C}}this.set(this.h1+a+u|0,this.h2+l+h|0,this.h3+d+s|0,this.h4+r+o|0,this.h0+i+c|0)}roundClean(){Ll.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}}const uN=Wi(()=>new lN),jl=BigInt(2**32-1),Uf=BigInt(32);function C1(e,t=!1){return t?{h:Number(e&jl),l:Number(e>>Uf&jl)}:{h:Number(e>>Uf&jl)|0,l:Number(e&jl)|0}}function dN(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:i,l:o}=C1(e[s],t);[n[s],r[s]]=[i,o]}return[n,r]}const hN=(e,t)=>BigInt(e>>>0)<<Uf|BigInt(t>>>0),fN=(e,t,n)=>e>>>n,pN=(e,t,n)=>e<<32-n|t>>>n,gN=(e,t,n)=>e>>>n|t<<32-n,wN=(e,t,n)=>e<<32-n|t>>>n,mN=(e,t,n)=>e<<64-n|t>>>n-32,yN=(e,t,n)=>e>>>n-32|t<<64-n,bN=(e,t)=>t,vN=(e,t)=>e,EN=(e,t,n)=>e<<n|t>>>32-n,CN=(e,t,n)=>t<<n|e>>>32-n,AN=(e,t,n)=>t<<n-32|e>>>64-n,IN=(e,t,n)=>e<<n-32|t>>>64-n;function SN(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const xN=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),NN=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,_N=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),TN=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,ON=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),DN=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,me={fromBig:C1,split:dN,toBig:hN,shrSH:fN,shrSL:pN,rotrSH:gN,rotrSL:wN,rotrBH:mN,rotrBL:yN,rotr32H:bN,rotr32L:vN,rotlSH:EN,rotlSL:CN,rotlBH:AN,rotlBL:IN,add:SN,add3L:xN,add3H:NN,add4L:_N,add4H:TN,add5H:DN,add5L:ON},[$N,PN]=me.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),hs=new Uint32Array(80),fs=new Uint32Array(80);class fd extends cg{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:f,Hh:g,Hl:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=f|0,this.Hh=g|0,this.Hl=w|0}process(t,n){for(let y=0;y<16;y++,n+=4)hs[y]=t.getUint32(n),fs[y]=t.getUint32(n+=4);for(let y=16;y<80;y++){const m=hs[y-15]|0,v=fs[y-15]|0,C=me.rotrSH(m,v,1)^me.rotrSH(m,v,8)^me.shrSH(m,v,7),O=me.rotrSL(m,v,1)^me.rotrSL(m,v,8)^me.shrSL(m,v,7),D=hs[y-2]|0,S=fs[y-2]|0,E=me.rotrSH(D,S,19)^me.rotrBH(D,S,61)^me.shrSH(D,S,6),N=me.rotrSL(D,S,19)^me.rotrBL(D,S,61)^me.shrSL(D,S,6),$=me.add4L(O,N,fs[y-7],fs[y-16]),B=me.add4H($,C,E,hs[y-7],hs[y-16]);hs[y]=B|0,fs[y]=$|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:f,Gh:g,Gl:w,Hh:b,Hl:I}=this;for(let y=0;y<80;y++){const m=me.rotrSH(d,h,14)^me.rotrSH(d,h,18)^me.rotrBH(d,h,41),v=me.rotrSL(d,h,14)^me.rotrSL(d,h,18)^me.rotrBL(d,h,41),C=d&p^~d&g,O=h&f^~h&w,D=me.add5L(I,v,O,PN[y],fs[y]),S=me.add5H(D,b,m,C,$N[y],hs[y]),E=D|0,N=me.rotrSH(r,s,28)^me.rotrBH(r,s,34)^me.rotrBH(r,s,39),$=me.rotrSL(r,s,28)^me.rotrBL(r,s,34)^me.rotrBL(r,s,39),B=r&i^r&a^i&a,R=s&o^s&c^o&c;b=g|0,I=w|0,g=p|0,w=f|0,p=d|0,f=h|0,{h:d,l:h}=me.add(l|0,u|0,S|0,E|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=me.add3L(E,$,R);r=me.add3H(A,S,N,B),s=A|0}({h:r,l:s}=me.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=me.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=me.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=me.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=me.add(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:f}=me.add(this.Fh|0,this.Fl|0,p|0,f|0),{h:g,l:w}=me.add(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:I}=me.add(this.Hh|0,this.Hl|0,b|0,I|0),this.set(r,s,i,o,a,c,l,u,d,h,p,f,g,w,b,I)}roundClean(){hs.fill(0),fs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class kN extends fd{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class UN extends fd{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class RN extends fd{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}Wi(()=>new fd);Wi(()=>new kN);const BN=Wi(()=>new UN);Wi(()=>new RN);var qa={exports:{}};qa.exports;var p0;function MN(){return p0||(p0=1,(function(e,t){var n=200,r="__lodash_hash_undefined__",s=9007199254740991,i="[object Arguments]",o="[object Array]",a="[object Boolean]",c="[object Date]",l="[object Error]",u="[object Function]",d="[object GeneratorFunction]",h="[object Map]",p="[object Number]",f="[object Object]",g="[object Promise]",w="[object RegExp]",b="[object Set]",I="[object String]",y="[object Symbol]",m="[object WeakMap]",v="[object ArrayBuffer]",C="[object DataView]",O="[object Float32Array]",D="[object Float64Array]",S="[object Int8Array]",E="[object Int16Array]",N="[object Int32Array]",$="[object Uint8Array]",B="[object Uint8ClampedArray]",R="[object Uint16Array]",A="[object Uint32Array]",_=/[\\^$.*+?()[\]{}|]/g,k=/\w*$/,M=/^\[object .+?Constructor\]$/,U=/^(?:0|[1-9]\d*)$/,P={};P[i]=P[o]=P[v]=P[C]=P[a]=P[c]=P[O]=P[D]=P[S]=P[E]=P[N]=P[h]=P[p]=P[f]=P[w]=P[b]=P[I]=P[y]=P[$]=P[B]=P[R]=P[A]=!0,P[l]=P[u]=P[m]=!1;var H=typeof Ht=="object"&&Ht&&Ht.Object===Object&&Ht,Y=typeof self=="object"&&self&&self.Object===Object&&self,J=H||Y||Function("return this")(),K=t&&!t.nodeType&&t,ne=K&&!0&&e&&!e.nodeType&&e,ue=ne&&ne.exports===K;function _e(x,L){return x.set(L[0],L[1]),x}function Ie(x,L){return x.add(L),x}function be(x,L){for(var F=-1,oe=x?x.length:0;++F<oe&&L(x[F],F,x)!==!1;);return x}function nt(x,L){for(var F=-1,oe=L.length,It=x.length;++F<oe;)x[It+F]=L[F];return x}function lt(x,L,F,oe){for(var It=-1,Yt=x?x.length:0;++It<Yt;)F=L(F,x[It],It,x);return F}function Br(x,L){for(var F=-1,oe=Array(x);++F<x;)oe[F]=L(F);return oe}function eo(x,L){return x?.[L]}function Mr(x){var L=!1;if(x!=null&&typeof x.toString!="function")try{L=!!(x+"")}catch{}return L}function to(x){var L=-1,F=Array(x.size);return x.forEach(function(oe,It){F[++L]=[It,oe]}),F}function ma(x,L){return function(F){return x(L(F))}}function Al(x){var L=-1,F=Array(x.size);return x.forEach(function(oe){F[++L]=oe}),F}var Ld=Array.prototype,Il=Function.prototype,Ys=Object.prototype,Zs=J["__core-js_shared__"],ya=(function(){var x=/[^.]+$/.exec(Zs&&Zs.keys&&Zs.keys.IE_PROTO||"");return x?"Symbol(src)_1."+x:""})(),ba=Il.toString,Yn=Ys.hasOwnProperty,Js=Ys.toString,Sl=RegExp("^"+ba.call(Yn).replace(_,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xl=ue?J.Buffer:void 0,Nl=J.Symbol,_l=J.Uint8Array,jd=ma(Object.getPrototypeOf,Object),k2=Object.create,U2=Ys.propertyIsEnumerable,R2=Ld.splice,yw=Object.getOwnPropertySymbols,B2=xl?xl.isBuffer:void 0,M2=ma(Object.keys,Object),Fd=so(J,"DataView"),va=so(J,"Map"),Hd=so(J,"Promise"),zd=so(J,"Set"),qd=so(J,"WeakMap"),Ea=so(Object,"create"),L2=ei(Fd),j2=ei(va),F2=ei(Hd),H2=ei(zd),z2=ei(qd),bw=Nl?Nl.prototype:void 0,vw=bw?bw.valueOf:void 0;function Xs(x){var L=-1,F=x?x.length:0;for(this.clear();++L<F;){var oe=x[L];this.set(oe[0],oe[1])}}function q2(){this.__data__=Ea?Ea(null):{}}function W2(x){return this.has(x)&&delete this.__data__[x]}function V2(x){var L=this.__data__;if(Ea){var F=L[x];return F===r?void 0:F}return Yn.call(L,x)?L[x]:void 0}function K2(x){var L=this.__data__;return Ea?L[x]!==void 0:Yn.call(L,x)}function G2(x,L){var F=this.__data__;return F[x]=Ea&&L===void 0?r:L,this}Xs.prototype.clear=q2,Xs.prototype.delete=W2,Xs.prototype.get=V2,Xs.prototype.has=K2,Xs.prototype.set=G2;function Lr(x){var L=-1,F=x?x.length:0;for(this.clear();++L<F;){var oe=x[L];this.set(oe[0],oe[1])}}function Y2(){this.__data__=[]}function Z2(x){var L=this.__data__,F=Tl(L,x);if(F<0)return!1;var oe=L.length-1;return F==oe?L.pop():R2.call(L,F,1),!0}function J2(x){var L=this.__data__,F=Tl(L,x);return F<0?void 0:L[F][1]}function X2(x){return Tl(this.__data__,x)>-1}function Q2(x,L){var F=this.__data__,oe=Tl(F,x);return oe<0?F.push([x,L]):F[oe][1]=L,this}Lr.prototype.clear=Y2,Lr.prototype.delete=Z2,Lr.prototype.get=J2,Lr.prototype.has=X2,Lr.prototype.set=Q2;function no(x){var L=-1,F=x?x.length:0;for(this.clear();++L<F;){var oe=x[L];this.set(oe[0],oe[1])}}function eI(){this.__data__={hash:new Xs,map:new(va||Lr),string:new Xs}}function tI(x){return Ol(this,x).delete(x)}function nI(x){return Ol(this,x).get(x)}function rI(x){return Ol(this,x).has(x)}function sI(x,L){return Ol(this,x).set(x,L),this}no.prototype.clear=eI,no.prototype.delete=tI,no.prototype.get=nI,no.prototype.has=rI,no.prototype.set=sI;function ro(x){this.__data__=new Lr(x)}function iI(){this.__data__=new Lr}function oI(x){return this.__data__.delete(x)}function aI(x){return this.__data__.get(x)}function cI(x){return this.__data__.has(x)}function lI(x,L){var F=this.__data__;if(F instanceof Lr){var oe=F.__data__;if(!va||oe.length<n-1)return oe.push([x,L]),this;F=this.__data__=new no(oe)}return F.set(x,L),this}ro.prototype.clear=iI,ro.prototype.delete=oI,ro.prototype.get=aI,ro.prototype.has=cI,ro.prototype.set=lI;function uI(x,L){var F=Kd(x)||kI(x)?Br(x.length,String):[],oe=F.length,It=!!oe;for(var Yt in x)Yn.call(x,Yt)&&!(It&&(Yt=="length"||OI(Yt,oe)))&&F.push(Yt);return F}function Ew(x,L,F){var oe=x[L];(!(Yn.call(x,L)&&Sw(oe,F))||F===void 0&&!(L in x))&&(x[L]=F)}function Tl(x,L){for(var F=x.length;F--;)if(Sw(x[F][0],L))return F;return-1}function dI(x,L){return x&&Cw(L,Gd(L),x)}function Wd(x,L,F,oe,It,Yt,jr){var Zt;if(oe&&(Zt=Yt?oe(x,It,Yt,jr):oe(x)),Zt!==void 0)return Zt;if(!Dl(x))return x;var _w=Kd(x);if(_w){if(Zt=NI(x),!L)return II(x,Zt)}else{var io=Qs(x),Tw=io==u||io==d;if(RI(x))return mI(x,L);if(io==f||io==i||Tw&&!Yt){if(Mr(x))return Yt?x:{};if(Zt=_I(Tw?{}:x),!L)return SI(x,dI(Zt,x))}else{if(!P[io])return Yt?x:{};Zt=TI(x,io,Wd,L)}}jr||(jr=new ro);var Ow=jr.get(x);if(Ow)return Ow;if(jr.set(x,Zt),!_w)var Dw=F?xI(x):Gd(x);return be(Dw||x,function(Yd,$l){Dw&&($l=Yd,Yd=x[$l]),Ew(Zt,$l,Wd(Yd,L,F,oe,$l,x,jr))}),Zt}function hI(x){return Dl(x)?k2(x):{}}function fI(x,L,F){var oe=L(x);return Kd(x)?oe:nt(oe,F(x))}function pI(x){return Js.call(x)}function gI(x){if(!Dl(x)||$I(x))return!1;var L=Nw(x)||Mr(x)?Sl:M;return L.test(ei(x))}function wI(x){if(!Iw(x))return M2(x);var L=[];for(var F in Object(x))Yn.call(x,F)&&F!="constructor"&&L.push(F);return L}function mI(x,L){if(L)return x.slice();var F=new x.constructor(x.length);return x.copy(F),F}function Vd(x){var L=new x.constructor(x.byteLength);return new _l(L).set(new _l(x)),L}function yI(x,L){var F=L?Vd(x.buffer):x.buffer;return new x.constructor(F,x.byteOffset,x.byteLength)}function bI(x,L,F){var oe=L?F(to(x),!0):to(x);return lt(oe,_e,new x.constructor)}function vI(x){var L=new x.constructor(x.source,k.exec(x));return L.lastIndex=x.lastIndex,L}function EI(x,L,F){var oe=L?F(Al(x),!0):Al(x);return lt(oe,Ie,new x.constructor)}function CI(x){return vw?Object(vw.call(x)):{}}function AI(x,L){var F=L?Vd(x.buffer):x.buffer;return new x.constructor(F,x.byteOffset,x.length)}function II(x,L){var F=-1,oe=x.length;for(L||(L=Array(oe));++F<oe;)L[F]=x[F];return L}function Cw(x,L,F,oe){F||(F={});for(var It=-1,Yt=L.length;++It<Yt;){var jr=L[It],Zt=void 0;Ew(F,jr,Zt===void 0?x[jr]:Zt)}return F}function SI(x,L){return Cw(x,Aw(x),L)}function xI(x){return fI(x,Gd,Aw)}function Ol(x,L){var F=x.__data__;return DI(L)?F[typeof L=="string"?"string":"hash"]:F.map}function so(x,L){var F=eo(x,L);return gI(F)?F:void 0}var Aw=yw?ma(yw,Object):LI,Qs=pI;(Fd&&Qs(new Fd(new ArrayBuffer(1)))!=C||va&&Qs(new va)!=h||Hd&&Qs(Hd.resolve())!=g||zd&&Qs(new zd)!=b||qd&&Qs(new qd)!=m)&&(Qs=function(x){var L=Js.call(x),F=L==f?x.constructor:void 0,oe=F?ei(F):void 0;if(oe)switch(oe){case L2:return C;case j2:return h;case F2:return g;case H2:return b;case z2:return m}return L});function NI(x){var L=x.length,F=x.constructor(L);return L&&typeof x[0]=="string"&&Yn.call(x,"index")&&(F.index=x.index,F.input=x.input),F}function _I(x){return typeof x.constructor=="function"&&!Iw(x)?hI(jd(x)):{}}function TI(x,L,F,oe){var It=x.constructor;switch(L){case v:return Vd(x);case a:case c:return new It(+x);case C:return yI(x,oe);case O:case D:case S:case E:case N:case $:case B:case R:case A:return AI(x,oe);case h:return bI(x,oe,F);case p:case I:return new It(x);case w:return vI(x);case b:return EI(x,oe,F);case y:return CI(x)}}function OI(x,L){return L=L??s,!!L&&(typeof x=="number"||U.test(x))&&x>-1&&x%1==0&&x<L}function DI(x){var L=typeof x;return L=="string"||L=="number"||L=="symbol"||L=="boolean"?x!=="__proto__":x===null}function $I(x){return!!ya&&ya in x}function Iw(x){var L=x&&x.constructor,F=typeof L=="function"&&L.prototype||Ys;return x===F}function ei(x){if(x!=null){try{return ba.call(x)}catch{}try{return x+""}catch{}}return""}function PI(x){return Wd(x,!0,!0)}function Sw(x,L){return x===L||x!==x&&L!==L}function kI(x){return UI(x)&&Yn.call(x,"callee")&&(!U2.call(x,"callee")||Js.call(x)==i)}var Kd=Array.isArray;function xw(x){return x!=null&&BI(x.length)&&!Nw(x)}function UI(x){return MI(x)&&xw(x)}var RI=B2||jI;function Nw(x){var L=Dl(x)?Js.call(x):"";return L==u||L==d}function BI(x){return typeof x=="number"&&x>-1&&x%1==0&&x<=s}function Dl(x){var L=typeof x;return!!x&&(L=="object"||L=="function")}function MI(x){return!!x&&typeof x=="object"}function Gd(x){return xw(x)?uI(x):wI(x)}function LI(){return[]}function jI(){return!1}e.exports=PI})(qa,qa.exports)),qa.exports}var LN=MN();const jN=hd(LN);var Ce;(function(e){e.Int="int",e.UInt="uint",e.Buffer="buffer",e.BoolTrue="true",e.BoolFalse="false",e.PrincipalStandard="address",e.PrincipalContract="contract",e.ResponseOk="ok",e.ResponseErr="err",e.OptionalNone="none",e.OptionalSome="some",e.List="list",e.Tuple="tuple",e.StringASCII="ascii",e.StringUTF8="utf8"})(Ce||(Ce={}));var pt;(function(e){e[e.int=0]="int",e[e.uint=1]="uint",e[e.buffer=2]="buffer",e[e.true=3]="true",e[e.false=4]="false",e[e.address=5]="address",e[e.contract=6]="contract",e[e.ok=7]="ok",e[e.err=8]="err",e[e.none=9]="none",e[e.some=10]="some",e[e.list=11]="list",e[e.tuple=12]="tuple",e[e.ascii=13]="ascii",e[e.utf8=14]="utf8"})(pt||(pt={}));function fg(e){return pt[e]}const A1=()=>({type:Ce.BoolTrue}),I1=()=>({type:Ce.BoolFalse}),FN=e=>e?A1():I1(),S1=e=>{if(e.byteLength>1048576)throw new Error("Cannot construct clarity buffer that is greater than 1MB");return{type:Ce.Buffer,value:we(e)}},g0=BigInt("0xffffffffffffffffffffffffffffffff"),HN=BigInt(0),w0=BigInt("0x7fffffffffffffffffffffffffffffff"),m0=BigInt("-170141183460469231731687303715884105728"),x1=e=>{typeof e=="string"&&e.toLowerCase().startsWith("0x")&&(e=yf(Ve(e))),hn(e,Uint8Array)&&(e=yf(e));const t=Kt(e);if(t>w0)throw new RangeError(`Cannot construct clarity integer from value greater than ${w0}`);if(t<m0)throw new RangeError(`Cannot construct clarity integer form value less than ${m0}`);return{type:Ce.Int,value:t}},N1=e=>{const t=Kt(e);if(t<HN)throw new RangeError("Cannot construct unsigned clarity integer from negative value");if(t>g0)throw new RangeError(`Cannot construct unsigned clarity integer greater than ${g0}`);return{type:Ce.UInt,value:t}};function _1(e){return{type:Ce.List,value:e}}function pg(){return{type:Ce.OptionalNone}}function gg(e){return{type:Ce.OptionalSome,value:e}}var se;(function(e){e[e.Address=0]="Address",e[e.Principal=1]="Principal",e[e.LengthPrefixedString=2]="LengthPrefixedString",e[e.MemoString=3]="MemoString",e[e.Asset=4]="Asset",e[e.PostCondition=5]="PostCondition",e[e.PublicKey=6]="PublicKey",e[e.LengthPrefixedList=7]="LengthPrefixedList",e[e.Payload=8]="Payload",e[e.MessageSignature=9]="MessageSignature",e[e.StructuredDataSignature=10]="StructuredDataSignature",e[e.TransactionAuthField=11]="TransactionAuthField"})(se||(se={}));function zN(){return{type:se.Address,version:Ri.MainnetSingleSig,hash160:"0".repeat(40)}}function y0(e){if(e&&z1(e,Mu))throw new Error(`Memo exceeds maximum length of ${Mu} bytes`);return{type:se.MemoString,content:e}}function wg(e,t){return{type:se.LengthPrefixedList,lengthPrefixBytes:t||4,values:e}}function Rf(e){if(Ve(e).byteLength!=ud)throw Error("Invalid signature");return{type:se.MessageSignature,data:e}}function qN(e,t,n){return typeof e=="string"&&(e=o_(e)),typeof n=="string"&&(n=y0(n)),{type:se.Payload,payloadType:Be.TokenTransfer,recipient:e,amount:Kt(t),memo:n??y0("")}}function WN(e,t,n,r){return typeof t=="string"&&(t=fr(t)),typeof n=="string"&&(n=fr(n)),{type:se.Payload,payloadType:Be.ContractCall,contractAddress:typeof e=="string"?Ks(e):e,contractName:t,functionName:n,functionArgs:r}}function VN(e){return fr(e,4,1e5)}function b0(e,t,n){return typeof e=="string"&&(e=fr(e)),typeof t=="string"&&(t=VN(t)),typeof n=="number"?{type:se.Payload,payloadType:Be.VersionedSmartContract,clarityVersion:n,contractName:e,codeBody:t}:{type:se.Payload,payloadType:Be.SmartContract,contractName:e,codeBody:t}}function KN(){return{type:se.Payload,payloadType:Be.PoisonMicroblock}}function v0(e,t){if(e.byteLength!=_i)throw Error(`Coinbase buffer size must be ${_i} bytes`);return t!=null?{type:se.Payload,payloadType:Be.CoinbaseToAltRecipient,coinbaseBytes:e,recipient:t}:{type:se.Payload,payloadType:Be.Coinbase,coinbaseBytes:e}}function GN(e,t,n){if(e.byteLength!=_i)throw Error(`Coinbase buffer size must be ${_i} bytes`);if(n.byteLength!=_f)throw Error(`VRF proof buffer size must be ${_f} bytes`);return{type:se.Payload,payloadType:Be.NakamotoCoinbase,coinbaseBytes:e,recipient:t.type===Ce.OptionalSome?t.value:void 0,vrfProof:n}}function YN(e,t,n,r,s,i,o){return{type:se.Payload,payloadType:Be.TenureChange,tenureHash:e,previousTenureHash:t,burnViewHash:n,previousTenureEnd:r,previousTenureBlocks:s,cause:i,publicKeyHash:o}}function fr(e,t,n){const r=t||1,s=n||lx;if(z1(e,s))throw new Error(`String length exceeds maximum bytes ${s}`);return{type:se.LengthPrefixedString,content:e,lengthPrefixBytes:r,maxLengthBytes:s}}function ZN(e,t,n){return{type:se.Asset,address:Ks(e),contractName:fr(t),assetName:fr(n)}}function Ks(e){const t=ug.c32addressDecode(e);return{type:se.Address,version:t[0],hash160:t[1]}}function JN(e,t){const n=Ks(e),r=fr(t);return{type:se.Principal,prefix:_n.Contract,address:n,contractName:r}}function XN(e){const t=Ks(e);return{type:se.Principal,prefix:_n.Standard,address:t}}function Uo(e,t){return{pubKeyEncoding:e,type:se.TransactionAuthField,contents:t}}function Yr(e){switch(e.type){case se.Address:return rl(e);case se.Principal:return T1(e);case se.LengthPrefixedString:return Go(e);case se.MemoString:return e_(e);case se.Asset:return D1(e);case se.PostCondition:return P1(e);case se.PublicKey:return Lf(e);case se.LengthPrefixedList:return mg(e);case se.Payload:return k1(e);case se.TransactionAuthField:return i_(e);case se.MessageSignature:return yg(e)}}function rl(e){const t=[];return t.push(Ve(tl(e.version,1))),t.push(Ve(e.hash160)),at(t)}function Ko(e){const t=hn(e,Ye)?e:new Ye(e),n=od(we(t.readBytes(1))),r=we(t.readBytes(20));return{type:se.Address,version:n,hash160:r}}function T1(e){const t=[];return t.push(e.prefix),(e.prefix===_n.Standard||e.prefix===_n.Contract)&&t.push(rl(e.address)),e.prefix===_n.Contract&&t.push(Go(e.contractName)),at(t)}function QN(e){const t=hn(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(_n,i=>{throw new xn(`Unexpected Principal payload type: ${i}`)});if(n===_n.Origin)return{type:se.Principal,prefix:n};const r=Ko(t);if(n===_n.Standard)return{type:se.Principal,prefix:n,address:r};const s=Hn(t);return{type:se.Principal,prefix:n,address:r,contractName:s}}function Go(e){const t=[],n=ia(e.content),r=n.byteLength;return t.push(Ve(tl(r,e.lengthPrefixBytes))),t.push(n),at(t)}function Hn(e,t,n){t=t||1;const r=hn(e,Ye)?e:new Ye(e),s=od(we(r.readBytes(t))),i=ad(r.readBytes(s));return fr(i,t,n??128)}function e_(e){const t=[],n=ia(e.content),r=C_(we(n),Mu*2);return t.push(Ve(r)),at(t)}function O1(e){const t=hn(e,Ye)?e:new Ye(e);let n=ad(t.readBytes(Mu));return n=n.replace(/\u0000*$/,""),{type:se.MemoString,content:n}}function D1(e){const t=[];return t.push(rl(e.address)),t.push(Go(e.contractName)),t.push(Go(e.assetName)),at(t)}function Bf(e){const t=hn(e,Ye)?e:new Ye(e);return{type:se.Asset,address:Ko(t),contractName:Hn(t),assetName:Hn(t)}}function mg(e){const t=e.values,n=[];n.push(Ve(tl(t.length,e.lengthPrefixBytes)));for(const r of t)n.push(Yr(r));return at(n)}function $1(e,t,n){const r=hn(e,Ye)?e:new Ye(e),s=od(we(r.readBytes(4))),i=[];for(let o=0;o<s;o++)switch(t){case se.Address:i.push(Ko(r));break;case se.LengthPrefixedString:i.push(Hn(r));break;case se.MemoString:i.push(O1(r));break;case se.Asset:i.push(Bf(r));break;case se.PostCondition:i.push(n_(r));break;case se.PublicKey:i.push(jf(r));break;case se.TransactionAuthField:i.push(s_(r));break}return wg(i,n)}function t_(e){return we(P1(e))}function P1(e){const t=[];if(t.push(e.conditionType),t.push(T1(e.principal)),(e.conditionType===Tt.Fungible||e.conditionType===Tt.NonFungible)&&t.push(D1(e.asset)),e.conditionType===Tt.NonFungible&&t.push(Nr(e.assetName)),t.push(e.conditionCode),e.conditionType===Tt.STX||e.conditionType===Tt.Fungible){if(e.amount>BigInt("0xffffffffffffffff"))throw new ko("The post-condition amount may not be larger than 8 bytes");t.push(zs(e.amount,8))}return at(t)}function n_(e){const t=hn(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(Tt,a=>{throw new xn(`Could not read ${a} as PostConditionType`)}),r=QN(t);let s,i,o;switch(n){case Tt.STX:return s=t.readUInt8Enum(Lu,c=>{throw new xn(`Could not read ${c} as FungibleConditionCode`)}),o=BigInt(`0x${we(t.readBytes(8))}`),{type:se.PostCondition,conditionType:Tt.STX,principal:r,conditionCode:s,amount:o};case Tt.Fungible:return i=Bf(t),s=t.readUInt8Enum(Lu,c=>{throw new xn(`Could not read ${c} as FungibleConditionCode`)}),o=BigInt(`0x${we(t.readBytes(8))}`),{type:se.PostCondition,conditionType:Tt.Fungible,principal:r,conditionCode:s,amount:o,asset:i};case Tt.NonFungible:i=Bf(t);const a=ir(t);return s=t.readUInt8Enum(Of,c=>{throw new xn(`Could not read ${c} as FungibleConditionCode`)}),{type:se.PostCondition,conditionType:Tt.NonFungible,principal:r,conditionCode:s,asset:i,assetName:a}}}function k1(e){const t=[];switch(t.push(e.payloadType),e.payloadType){case Be.TokenTransfer:t.push(Nr(e.recipient)),t.push(zs(e.amount,8)),t.push(Yr(e.memo));break;case Be.ContractCall:t.push(Yr(e.contractAddress)),t.push(Yr(e.contractName)),t.push(Yr(e.functionName));const n=new Uint8Array(4);ki(n,e.functionArgs.length,0),t.push(n),e.functionArgs.forEach(r=>{t.push(Nr(r))});break;case Be.SmartContract:t.push(Yr(e.contractName)),t.push(Yr(e.codeBody));break;case Be.VersionedSmartContract:t.push(e.clarityVersion),t.push(Yr(e.contractName)),t.push(Yr(e.codeBody));break;case Be.PoisonMicroblock:break;case Be.Coinbase:t.push(e.coinbaseBytes);break;case Be.CoinbaseToAltRecipient:t.push(e.coinbaseBytes),t.push(Nr(e.recipient));break;case Be.NakamotoCoinbase:t.push(e.coinbaseBytes),t.push(Nr(e.recipient?gg(e.recipient):pg())),t.push(e.vrfProof);break;case Be.TenureChange:t.push(Ve(e.tenureHash)),t.push(Ve(e.previousTenureHash)),t.push(Ve(e.burnViewHash)),t.push(Ve(e.previousTenureEnd)),t.push(ki(new Uint8Array(4),e.previousTenureBlocks)),t.push(sS(new Uint8Array(1),e.cause)),t.push(Ve(e.publicKeyHash));break}return at(t)}function r_(e){const t=hn(e,Ye)?e:new Ye(e);switch(t.readUInt8Enum(Be,r=>{throw new Error(`Cannot recognize PayloadType: ${r}`)})){case Be.TokenTransfer:const r=ir(t),s=Kt(t.readBytes(8)),i=O1(t);return qN(r,s,i);case Be.ContractCall:const o=Ko(t),a=Hn(t),c=Hn(t),l=[],u=t.readUInt32BE();for(let m=0;m<u;m++){const v=ir(t);l.push(v)}return WN(o,a,c,l);case Be.SmartContract:const d=Hn(t),h=Hn(t,4,1e5);return b0(d,h);case Be.VersionedSmartContract:{const m=t.readUInt8Enum(Tf,O=>{throw new Error(`Cannot recognize ClarityVersion: ${O}`)}),v=Hn(t),C=Hn(t,4,vx);return b0(v,C,m)}case Be.PoisonMicroblock:return KN();case Be.Coinbase:{const m=t.readBytes(_i);return v0(m)}case Be.CoinbaseToAltRecipient:{const m=t.readBytes(_i),v=ir(t);return v0(m,v)}case Be.NakamotoCoinbase:{const m=t.readBytes(_i),v=ir(t),C=t.readBytes(_f);return GN(m,v,C)}case Be.TenureChange:const p=we(t.readBytes(20)),f=we(t.readBytes(20)),g=we(t.readBytes(20)),w=we(t.readBytes(32)),b=t.readUInt32BE(),I=t.readUInt8Enum(Df,m=>{throw new Error(`Cannot recognize TenureChangeCause: ${m}`)}),y=we(t.readBytes(20));return YN(p,f,g,w,b,I,y)}}function Mf(e){const t=hn(e,Ye)?e:new Ye(e);return Rf(we(t.readBytes(ud)))}function s_(e){const t=hn(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(sr,r=>{throw new xn(`Could not read ${r} as AuthFieldType`)});switch(n){case sr.PublicKeyCompressed:return Uo(rt.Compressed,jf(t));case sr.PublicKeyUncompressed:return Uo(rt.Uncompressed,aa(P_(jf(t).data)));case sr.SignatureCompressed:return Uo(rt.Compressed,Mf(t));case sr.SignatureUncompressed:return Uo(rt.Uncompressed,Mf(t));default:throw new Error(`Unknown auth field type: ${JSON.stringify(n)}`)}}function yg(e){return Ve(e.data)}function i_(e){const t=[];switch(e.contents.type){case se.PublicKey:t.push(e.pubKeyEncoding===rt.Compressed?sr.PublicKeyCompressed:sr.PublicKeyUncompressed),t.push(Ve($_(e.contents.data)));break;case se.MessageSignature:t.push(e.pubKeyEncoding===rt.Compressed?sr.SignatureCompressed:sr.SignatureUncompressed),t.push(yg(e.contents));break}return at(t)}function Lf(e){return e.data.slice()}function jf(e){const t=hn(e,Ye)?e:new Ye(e),n=t.readUInt8(),r=n===4?hx:dx;return aa(at([n,t.readBytes(r)]))}function bg(e,t,n,r){if(r.length===0)throw Error("Invalid number of public keys");if((t===We.P2PKH||t===We.P2WPKH)&&(r.length!==1||n!==1))throw Error("Invalid number of public keys or signatures");if((t===We.P2WPKH||t===We.P2WSH||t===We.P2WSHNonSequential)&&!r.map(s=>s.data).every(ca))throw Error("Public keys must be compressed for segwit");switch(t){case We.P2PKH:return Fl(e,A_(r[0].data));case We.P2WPKH:return Fl(e,I_(r[0].data));case We.P2SH:case We.P2SHNonSequential:return Fl(e,S_(n,r.map(Lf)));case We.P2WSH:case We.P2WSHNonSequential:return Fl(e,x_(n,r.map(Lf)))}}function Fl(e,t){return{type:se.Address,version:e,hash160:t}}function vg(e){return ug.c32address(e.version,e.hash160)}function E0(e){const[t,n,r]=e.split(/\.|::/);return ZN(t,n,r)}function ch(e){if(e.includes(".")){const[t,n]=e.split(".");return JN(t,n)}else return XN(e)}function o_(e){if(e.includes(".")){const[t,n]=e.split(".");return R1(t,n)}else return U1(e)}function U1(e){const t=Ks(e);return{type:Ce.PrincipalStandard,value:vg(t)}}function a_(e){return{type:Ce.PrincipalStandard,value:vg(e)}}function R1(e,t){const n=Ks(e),r=fr(t);return B1(n,r)}function B1(e,t){if(ia(t.content).byteLength>=128)throw new Error("Contract name must be less than 128 bytes");return{type:Ce.PrincipalContract,value:`${vg(e)}.${t.content}`}}function M1(e){return{type:Ce.ResponseErr,value:e}}function L1(e){return{type:Ce.ResponseOk,value:e}}const Ls=e=>({type:Ce.StringASCII,value:e}),j1=e=>({type:Ce.StringUTF8,value:e});function F1(e){for(const t in e)if(!N_(t))throw new Error(`"${t}" is not a valid Clarity name`);return{type:Ce.Tuple,value:e}}function ir(e){let t;if(typeof e=="string"){const r=e.slice(0,2).toLowerCase()==="0x";t=new Ye(Ve(r?e.slice(2):e))}else e instanceof Uint8Array?t=new Ye(e):t=e;switch(t.readUInt8Enum(pt,r=>{throw new xn(`Cannot recognize Clarity Type: ${r}`)})){case pt.int:return x1(yf(t.readBytes(16)));case pt.uint:return N1(t.readBytes(16));case pt.buffer:const r=t.readUInt32BE();return S1(t.readBytes(r));case pt.true:return A1();case pt.false:return I1();case pt.address:const s=Ko(t);return a_(s);case pt.contract:const i=Ko(t),o=Hn(t);return B1(i,o);case pt.ok:return L1(ir(t));case pt.err:return M1(ir(t));case pt.none:return pg();case pt.some:return gg(ir(t));case pt.list:const a=t.readUInt32BE(),c=[];for(let g=0;g<a;g++)c.push(ir(t));return _1(c);case pt.tuple:const l=t.readUInt32BE(),u={};for(let g=0;g<l;g++){const w=Hn(t).content;if(w===void 0)throw new xn('"content" is undefined');u[w]=ir(t)}return F1(u);case pt.ascii:const d=t.readUInt32BE(),h=GI(t.readBytes(d));return Ls(h);case pt.utf8:const p=t.readUInt32BE(),f=ad(t.readBytes(p));return j1(f);default:throw new xn("Unable to deserialize Clarity Value from Uint8Array. Could not find valid Clarity Type.")}}function Ur(e,t){return at([fg(e),t])}function c_(e){return new Uint8Array([fg(e.type)])}function l_(e){return e.type===Ce.OptionalNone?new Uint8Array([fg(e.type)]):Ur(e.type,Nr(e.value))}function u_(e){const t=new Uint8Array(4);return ki(t,Math.ceil(e.value.length/2),0),Ur(e.type,cd(t,Ve(e.value)))}function d_(e){const t=Xp(zI(BigInt(e.value),BigInt(ux)),a1);return Ur(e.type,t)}function h_(e){const t=Xp(BigInt(e.value),a1);return Ur(e.type,t)}function f_(e){return Ur(e.type,rl(Ks(e.value)))}function p_(e){const[t,n]=__(e.value);return Ur(e.type,cd(rl(Ks(t)),Go(fr(n))))}function g_(e){return Ur(e.type,Nr(e.value))}function w_(e){const t=[],n=new Uint8Array(4);ki(n,e.value.length,0),t.push(n);for(const r of e.value){const s=Nr(r);t.push(s)}return Ur(e.type,at(t))}function m_(e){const t=[],n=new Uint8Array(4);ki(n,Object.keys(e.value).length,0),t.push(n);const r=Object.keys(e.value).sort((s,i)=>s.localeCompare(i));for(const s of r){const i=fr(s);t.push(Go(i));const o=Nr(e.value[s]);t.push(o)}return Ur(e.type,at(t))}function H1(e,t){const n=[],r=t=="ascii"?KI(e.value):ia(e.value),s=new Uint8Array(4);return ki(s,r.length,0),n.push(s),n.push(r),Ur(e.type,at(n))}function y_(e){return H1(e,"ascii")}function b_(e){return H1(e,"utf8")}function v_(e){return we(Nr(e))}function Nr(e){switch(e.type){case Ce.BoolTrue:case Ce.BoolFalse:return c_(e);case Ce.OptionalNone:case Ce.OptionalSome:return l_(e);case Ce.Buffer:return u_(e);case Ce.UInt:return h_(e);case Ce.Int:return d_(e);case Ce.PrincipalStandard:return f_(e);case Ce.PrincipalContract:return p_(e);case Ce.ResponseOk:case Ce.ResponseErr:return g_(e);case Ce.List:return w_(e);case Ce.Tuple:return m_(e);case Ce.StringASCII:return y_(e);case Ce.StringUTF8:return b_(e);default:throw new ko("Unable to serialize. Invalid Clarity Value.")}}const E_=e=>e.length%2?`0${e}`:e,C_=(e,t)=>e.padEnd(t,"0"),z1=(e,t)=>e?ia(e).length>t:!1;function Ff(e){return jN(e)}const yc=e=>uN(lg(e)),Eg=e=>we(BN(e)),A_=e=>we(yc(e)),I_=e=>{const t=yc(e),n=cd(new Uint8Array([0]),new Uint8Array([t.length]),t),r=yc(n);return we(r)},S_=(e,t)=>{if(e>15||t.length>15)throw Error("P2SH multisig address can only contain up to 15 public keys");const n=[];n.push(80+e),t.forEach(i=>{n.push(i.length),n.push(i)}),n.push(80+t.length),n.push(174);const r=at(n),s=yc(r);return we(s)},x_=(e,t)=>{if(e>15||t.length>15)throw Error("P2WSH multisig address can only contain up to 15 public keys");const n=[];n.push(80+e),t.forEach(c=>{n.push(c.length),n.push(c)}),n.push(80+t.length),n.push(174);const r=at(n),s=lg(r),i=[];i.push(0),i.push(s.length),i.push(s);const o=at(i),a=yc(o);return we(a)};function N_(e){return/^[a-zA-Z]([a-zA-Z0-9]|[-_!?+<>=/*])*$|^[-+=/*]$|^[<>]=?$/.test(e)&&e.length<128}function __(e){const[t,n]=e.split(".");if(!t||!n)throw new Error(`Invalid contract identifier: ${e}`);return[t,n]}$s.hmacSha256Sync=(e,...t)=>{const n=d1.create(lg,e);return t.forEach(r=>n.update(r)),n.digest()};function aa(e){return e=typeof e=="string"?Ve(e):e,{type:se.PublicKey,data:e}}function T_(e,t,n=rt.Compressed){const r=eS(t),s=new Tr($w(r.r),$w(r.s)),i=Ge.fromSignature(e,s,r.recoveryId),o=n===rt.Compressed;return i.toHex(o)}function O_(e){return typeof e=="string"?e:we(e)}const Cg=O_;function q1(e){return(typeof e=="string"?e.length/2:e.byteLength)===QI}function ca(e){return!Cg(e).startsWith("04")}function D_(e){e=Uv(e);const t=q1(e);return we(qx(e.slice(0,32),t))}function $_(e){return Ge.fromHex(Cg(e)).toHex(!0)}function P_(e){return Ge.fromHex(Cg(e)).toHex(!1)}function k_(e,t){e=Uv(e);const[n,r]=Gx(t,e.slice(0,32),{canonical:!0,recovered:!0});if(r==null)throw new Error("No signature recoveryId received");return tl(r,1)+Tr.fromHex(n).toCompactHex()}function Ag(){return{type:se.MessageSignature,data:we(new Uint8Array(ud))}}function W1(e,t,n,r){const s=bg(0,e,1,[aa(t)]).hash160,i=ca(t)?rt.Compressed:rt.Uncompressed;return{hashMode:e,signer:s,nonce:Kt(n),fee:Kt(r),keyEncoding:i,signature:Ag()}}function bc(e){return"signature"in e}function C0(e){return e===We.P2SH||e===We.P2WSH}function U_(e){return e===We.P2SHNonSequential||e===We.P2WSHNonSequential}function A0(e){const t=Ff(e);return t.nonce=0,t.fee=0,bc(t)?t.signature=Ag():t.fields=[],{...t,nonce:BigInt(0),fee:BigInt(0)}}function R_(e){const t=[e.hashMode,Ve(e.signer),zs(e.nonce,8),zs(e.fee,8),e.keyEncoding,yg(e.signature)];return at(t)}function B_(e){const t=[e.hashMode,Ve(e.signer),zs(e.nonce,8),zs(e.fee,8)],n=wg(e.fields);t.push(mg(n));const r=new Uint8Array(2);return nS(r,e.signaturesRequired,0),t.push(r),at(t)}function M_(e,t){const n=we(t.readBytes(20)),r=BigInt(`0x${we(t.readBytes(8))}`),s=BigInt(`0x${we(t.readBytes(8))}`),i=t.readUInt8Enum(rt,a=>{throw new xn(`Could not parse ${a} as PubKeyEncoding`)});if(e===We.P2WPKH&&i!=rt.Compressed)throw new xn("Failed to parse singlesig spending condition: incomaptible hash mode and key encoding");const o=Mf(t);return{hashMode:e,signer:n,nonce:r,fee:s,keyEncoding:i,signature:o}}function L_(e,t){const n=we(t.readBytes(20)),r=BigInt("0x"+we(t.readBytes(8))),s=BigInt("0x"+we(t.readBytes(8))),i=$1(t,se.TransactionAuthField).values;let o=!1,a=0;for(const l of i)switch(l.contents.type){case se.PublicKey:ca(l.contents.data)||(o=!0);break;case se.MessageSignature:if(l.pubKeyEncoding===rt.Uncompressed&&(o=!0),a+=1,a===65536)throw new bi("Failed to parse multisig spending condition: too many signatures");break}const c=t.readUInt16BE();if(o&&(e===We.P2WSH||e===We.P2WSHNonSequential))throw new bi("Uncompressed keys are not allowed in this hash mode");return{hashMode:e,signer:n,nonce:r,fee:s,fields:i,signaturesRequired:c}}function lh(e){return bc(e)?R_(e):B_(e)}function uh(e){const t=e.readUInt8Enum(We,n=>{throw new xn(`Could not parse ${n} as AddressHashMode`)});return t===We.P2PKH||t===We.P2WPKH?M_(t,e):L_(t,e)}function V1(e,t,n,r){const i=e+we(new Uint8Array([t]))+we(zs(n,8))+we(zs(r,8));if(Ve(i).byteLength!==49)throw Error("Invalid signature hash length");return Eg(Ve(i))}function K1(e,t,n){const r=33+ud,s=ca(t.data)?rt.Compressed:rt.Uncompressed,i=e+E_(s.toString(16))+n,o=Ve(i);if(o.byteLength>r)throw Error("Invalid signature hash length");return Eg(o)}function j_(e,t,n,r,s){const i=V1(e,t,n,r),o=k_(s,i),a=aa(D_(s)),c=K1(i,a,o);return{nextSig:o,nextSigHash:c}}function G1(e,t,n,r,s,i){const o=V1(e,t,n,r),a=aa(T_(o,i,s)),c=K1(o,a,i);return{pubKey:a,nextSigHash:c}}function F_(){const e=W1(We.P2PKH,"",0,0);return e.signer=zN().hash160,e.keyEncoding=rt.Compressed,e.signature=Ag(),e}function I0(e,t,n){return bc(e)?H_(e,t,n):z_(e,t,n)}function H_(e,t,n){const{pubKey:r,nextSigHash:s}=G1(t,n,e.fee,e.nonce,e.keyEncoding,e.signature.data),i=bg(0,e.hashMode,1,[r]).hash160;if(i!==e.signer)throw new bi(`Signer hash does not equal hash of public key(s): ${i} != ${e.signer}`);return s}function z_(e,t,n){const r=[];let s=t,i=!1,o=0;for(const c of e.fields)switch(c.contents.type){case se.PublicKey:ca(c.contents.data)||(i=!0),r.push(c.contents);break;case se.MessageSignature:c.pubKeyEncoding===rt.Uncompressed&&(i=!0);const{pubKey:l,nextSigHash:u}=G1(s,n,e.fee,e.nonce,c.pubKeyEncoding,c.contents.data);if(C0(e.hashMode)&&(s=u),r.push(l),o+=1,o===65536)throw new bi("Too many signatures");break}if(C0(e.hashMode)&&o!==e.signaturesRequired||U_(e.hashMode)&&o<e.signaturesRequired)throw new bi("Incorrect number of signatures");if(i&&(e.hashMode===We.P2WSH||e.hashMode===We.P2WSHNonSequential))throw new bi("Uncompressed keys are not allowed in this hash mode");const a=bg(0,e.hashMode,e.signaturesRequired,r).hash160;if(a!==e.signer)throw new bi(`Signer hash does not equal hash of public key(s): ${a} != ${e.signer}`);return s}function Y1(e){return{authType:st.Standard,spendingCondition:e}}function Z1(e,t){return{authType:st.Sponsored,spendingCondition:e,sponsorSpendingCondition:t||W1(We.P2PKH,"0".repeat(66),0,0)}}function S0(e){if(e.spendingCondition)switch(e.authType){case st.Standard:return Y1(A0(e.spendingCondition));case st.Sponsored:return Z1(A0(e.spendingCondition),F_());default:throw new ju("Unexpected authorization type for signing")}throw new Error("Authorization missing SpendingCondition")}function q_(e,t){switch(e.authType){case st.Standard:return I0(e.spendingCondition,t,st.Standard);case st.Sponsored:return I0(e.spendingCondition,t,st.Standard);default:throw new ju("Invalid origin auth type")}}function W_(e,t){switch(e.authType){case st.Standard:const n={...e.spendingCondition,fee:Kt(t)};return{...e,spendingCondition:n};case st.Sponsored:const r={...e.sponsorSpendingCondition,fee:Kt(t)};return{...e,sponsorSpendingCondition:r}}}function V_(e,t){const n={...e.spendingCondition,nonce:Kt(t)};return{...e,spendingCondition:n}}function K_(e,t){const n={...e.sponsorSpendingCondition,nonce:Kt(t)};return{...e,sponsorSpendingCondition:n}}function G_(e,t){const n={...t,nonce:Kt(t.nonce),fee:Kt(t.fee)};return{...e,sponsorSpendingCondition:n}}function Y_(e){const t=[];switch(t.push(e.authType),e.authType){case st.Standard:t.push(lh(e.spendingCondition));break;case st.Sponsored:t.push(lh(e.spendingCondition)),t.push(lh(e.sponsorSpendingCondition));break}return at(t)}function Z_(e){const t=e.readUInt8Enum(st,r=>{throw new xn(`Could not parse ${r} as AuthType`)});let n;switch(t){case st.Standard:return n=uh(e),Y1(n);case st.Sponsored:n=uh(e);const r=uh(e);return Z1(n,r)}}class J_{constructor({auth:t,payload:n,postConditions:r=wg([]),postConditionMode:s=qs.Deny,transactionVersion:i,chainId:o,network:a="mainnet"}){a=cx(a),this.transactionVersion=i??a.transactionVersion,this.chainId=o??a.chainId,this.auth=t,"amount"in n?this.payload={...n,amount:Kt(n.amount)}:this.payload=n,this.postConditionMode=s,this.postConditions=r,this.anchorMode=bn.Any}signBegin(){const t=Ff(this);return t.auth=S0(t.auth),t.txid()}verifyBegin(){const t=Ff(this);return t.auth=S0(t.auth),t.txid()}verifyOrigin(){return q_(this.auth,this.verifyBegin())}signNextOrigin(t,n){if(this.auth.spendingCondition===void 0)throw new Error('"auth.spendingCondition" is undefined');if(this.auth.authType===void 0)throw new Error('"auth.authType" is undefined');return this.signAndAppend(this.auth.spendingCondition,t,st.Standard,n)}signNextSponsor(t,n){if(this.auth.authType===st.Sponsored)return this.signAndAppend(this.auth.sponsorSpendingCondition,t,st.Sponsored,n);throw new Error('"auth.sponsorSpendingCondition" is undefined')}appendPubkey(t){const n=typeof t=="object"&&"type"in t?t:aa(t),r=this.auth.spendingCondition;if(r&&!bc(r)){const s=ca(n.data);r.fields.push(Uo(s?rt.Compressed:rt.Uncompressed,n))}else throw new Error("Can't append public key to a singlesig condition")}signAndAppend(t,n,r,s){const{nextSig:i,nextSigHash:o}=j_(n,r,t.fee,t.nonce,s);if(bc(t))t.signature=Rf(i);else{const a=q1(s);t.fields.push(Uo(a?rt.Compressed:rt.Uncompressed,Rf(i)))}return o}txid(){const t=this.serializeBytes();return Eg(t)}setSponsor(t){if(this.auth.authType!=st.Sponsored)throw new ju("Cannot sponsor sign a non-sponsored transaction");this.auth=G_(this.auth,t)}setFee(t){this.auth=W_(this.auth,t)}setNonce(t){this.auth=V_(this.auth,t)}setSponsorNonce(t){if(this.auth.authType!=st.Sponsored)throw new ju("Cannot sponsor sign a non-sponsored transaction");this.auth=K_(this.auth,t)}serialize(){return we(this.serializeBytes())}serializeBytes(){if(this.transactionVersion===void 0)throw new ko('"transactionVersion" is undefined');if(this.chainId===void 0)throw new ko('"chainId" is undefined');if(this.auth===void 0)throw new ko('"auth" is undefined');if(this.payload===void 0)throw new ko('"payload" is undefined');const t=[];t.push(this.transactionVersion);const n=new Uint8Array(4);return ki(n,this.chainId,0),t.push(n),t.push(Y_(this.auth)),t.push(this.anchorMode),t.push(this.postConditionMode),t.push(mg(this.postConditions)),t.push(k1(this.payload)),at(t)}}function X_(e){const t=hn(e,Ye)?e:new Ye(e),n=t.readUInt8Enum(Ui,u=>{throw new Error(`Could not parse ${u} as TransactionVersion`)}),r=t.readUInt32BE(),s=Z_(t),i=t.readUInt8Enum(bn,u=>{throw new Error(`Could not parse ${u} as AnchorMode`)}),o=t.readUInt8Enum(qs,u=>{throw new Error(`Could not parse ${u} as PostConditionMode`)}),a=$1(t,se.PostCondition),c=r_(t),l=new J_({transactionVersion:n,chainId:r,auth:s,payload:c,postConditions:a,postConditionMode:o});return l.anchorMode=i,l}var Hf;(function(e){e[e.eq=1]="eq",e[e.gt=2]="gt",e[e.lt=4]="lt",e[e.gte=3]="gte",e[e.lte=5]="lte",e[e.sent=16]="sent",e[e["not-sent"]=17]="not-sent"})(Hf||(Hf={}));function Q_(e){switch(e.type){case"stx-postcondition":return{type:se.PostCondition,conditionType:Tt.STX,principal:e.address==="origin"?{type:se.Principal,prefix:_n.Origin}:ch(e.address),conditionCode:dh(e.condition),amount:BigInt(e.amount)};case"ft-postcondition":return{type:se.PostCondition,conditionType:Tt.Fungible,principal:e.address==="origin"?{type:se.Principal,prefix:_n.Origin}:ch(e.address),conditionCode:dh(e.condition),amount:BigInt(e.amount),asset:E0(e.asset)};case"nft-postcondition":return{type:se.PostCondition,conditionType:Tt.NonFungible,principal:e.address==="origin"?{type:se.Principal,prefix:_n.Origin}:ch(e.address),conditionCode:dh(e.condition),asset:E0(e.asset),assetName:e.assetId};default:throw new Error("Invalid post condition type")}}function dh(e){return Hf[e]}function x0(e){const t=Q_(e);return t_(t)}const e3="0123456789ABCDEFGHJKMNPQRSTVWXYZ";function N0(e){const t="version"in e?e.version:e3.indexOf(e.versionChar.toUpperCase()),n=ug.c32address(t,e.hash160);return e.contractName?`${n}.${e.contractName}`:n}const _0=FN,t3=x1,n3=N1,r3=R1,s3=U1,i3=_1,o3=Ls,a3=j1,c3=S1,l3=pg,u3=gg,d3=L1,h3=M1,f3=F1,zf=v_,p3=ir;var hh={},T0;function g3(){return T0||(T0=1,(function(){(function(e){(function(t){var n=typeof globalThis<"u"&&globalThis||typeof e<"u"&&e||typeof Ht<"u"&&Ht||{},r={searchParams:"URLSearchParams"in n,iterable:"Symbol"in n&&"iterator"in Symbol,blob:"FileReader"in n&&"Blob"in n&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in n,arrayBuffer:"ArrayBuffer"in n};function s(E){return E&&DataView.prototype.isPrototypeOf(E)}if(r.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(E){return E&&i.indexOf(Object.prototype.toString.call(E))>-1};function a(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(E)||E==="")throw new TypeError('Invalid character in header field name: "'+E+'"');return E.toLowerCase()}function c(E){return typeof E!="string"&&(E=String(E)),E}function l(E){var N={next:function(){var $=E.shift();return{done:$===void 0,value:$}}};return r.iterable&&(N[Symbol.iterator]=function(){return N}),N}function u(E){this.map={},E instanceof u?E.forEach(function(N,$){this.append($,N)},this):Array.isArray(E)?E.forEach(function(N){if(N.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+N.length);this.append(N[0],N[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(N){this.append(N,E[N])},this)}u.prototype.append=function(E,N){E=a(E),N=c(N);var $=this.map[E];this.map[E]=$?$+", "+N:N},u.prototype.delete=function(E){delete this.map[a(E)]},u.prototype.get=function(E){return E=a(E),this.has(E)?this.map[E]:null},u.prototype.has=function(E){return this.map.hasOwnProperty(a(E))},u.prototype.set=function(E,N){this.map[a(E)]=c(N)},u.prototype.forEach=function(E,N){for(var $ in this.map)this.map.hasOwnProperty($)&&E.call(N,this.map[$],$,this)},u.prototype.keys=function(){var E=[];return this.forEach(function(N,$){E.push($)}),l(E)},u.prototype.values=function(){var E=[];return this.forEach(function(N){E.push(N)}),l(E)},u.prototype.entries=function(){var E=[];return this.forEach(function(N,$){E.push([$,N])}),l(E)},r.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);function d(E){if(!E._noBody){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}}function h(E){return new Promise(function(N,$){E.onload=function(){N(E.result)},E.onerror=function(){$(E.error)}})}function p(E){var N=new FileReader,$=h(N);return N.readAsArrayBuffer(E),$}function f(E){var N=new FileReader,$=h(N),B=/charset=([A-Za-z0-9_-]+)/.exec(E.type),R=B?B[1]:"utf-8";return N.readAsText(E,R),$}function g(E){for(var N=new Uint8Array(E),$=new Array(N.length),B=0;B<N.length;B++)$[B]=String.fromCharCode(N[B]);return $.join("")}function w(E){if(E.slice)return E.slice(0);var N=new Uint8Array(E.byteLength);return N.set(new Uint8Array(E)),N.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(E){this.bodyUsed=this.bodyUsed,this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:r.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:r.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:r.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():r.arrayBuffer&&r.blob&&s(E)?(this._bodyArrayBuffer=w(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||o(E))?this._bodyArrayBuffer=w(E):this._bodyText=E=Object.prototype.toString.call(E):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},r.blob&&(this.blob=function(){var E=d(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var E=d(this);return E||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(r.blob)return this.blob().then(p);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var E=d(this);if(E)return E;if(this._bodyBlob)return f(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(g(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r.formData&&(this.formData=function(){return this.text().then(v)}),this.json=function(){return this.text().then(JSON.parse)},this}var I=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function y(E){var N=E.toUpperCase();return I.indexOf(N)>-1?N:E}function m(E,N){if(!(this instanceof m))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');N=N||{};var $=N.body;if(E instanceof m){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,N.headers||(this.headers=new u(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!$&&E._bodyInit!=null&&($=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=N.credentials||this.credentials||"same-origin",(N.headers||!this.headers)&&(this.headers=new u(N.headers)),this.method=y(N.method||this.method||"GET"),this.mode=N.mode||this.mode||null,this.signal=N.signal||this.signal||(function(){if("AbortController"in n){var A=new AbortController;return A.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&$)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody($),(this.method==="GET"||this.method==="HEAD")&&(N.cache==="no-store"||N.cache==="no-cache")){var B=/([?&])_=[^&]*/;if(B.test(this.url))this.url=this.url.replace(B,"$1_="+new Date().getTime());else{var R=/\?/;this.url+=(R.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};function v(E){var N=new FormData;return E.trim().split("&").forEach(function($){if($){var B=$.split("="),R=B.shift().replace(/\+/g," "),A=B.join("=").replace(/\+/g," ");N.append(decodeURIComponent(R),decodeURIComponent(A))}}),N}function C(E){var N=new u,$=E.replace(/\r?\n[\t ]+/g," ");return $.split("\r").map(function(B){return B.indexOf(`
`)===0?B.substr(1,B.length):B}).forEach(function(B){var R=B.split(":"),A=R.shift().trim();if(A){var _=R.join(":").trim();try{N.append(A,_)}catch(k){console.warn("Response "+k.message)}}}),N}b.call(m.prototype);function O(E,N){if(!(this instanceof O))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(N||(N={}),this.type="default",this.status=N.status===void 0?200:N.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=N.statusText===void 0?"":""+N.statusText,this.headers=new u(N.headers),this.url=N.url||"",this._initBody(E)}b.call(O.prototype),O.prototype.clone=function(){return new O(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},O.error=function(){var E=new O(null,{status:200,statusText:""});return E.ok=!1,E.status=0,E.type="error",E};var D=[301,302,303,307,308];O.redirect=function(E,N){if(D.indexOf(N)===-1)throw new RangeError("Invalid status code");return new O(null,{status:N,headers:{location:E}})},t.DOMException=n.DOMException;try{new t.DOMException}catch{t.DOMException=function(N,$){this.message=N,this.name=$;var B=Error(N);this.stack=B.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function S(E,N){return new Promise(function($,B){var R=new m(E,N);if(R.signal&&R.signal.aborted)return B(new t.DOMException("Aborted","AbortError"));var A=new XMLHttpRequest;function _(){A.abort()}A.onload=function(){var U={statusText:A.statusText,headers:C(A.getAllResponseHeaders()||"")};R.url.indexOf("file://")===0&&(A.status<200||A.status>599)?U.status=200:U.status=A.status,U.url="responseURL"in A?A.responseURL:U.headers.get("X-Request-URL");var P="response"in A?A.response:A.responseText;setTimeout(function(){$(new O(P,U))},0)},A.onerror=function(){setTimeout(function(){B(new TypeError("Network request failed"))},0)},A.ontimeout=function(){setTimeout(function(){B(new TypeError("Network request timed out"))},0)},A.onabort=function(){setTimeout(function(){B(new t.DOMException("Aborted","AbortError"))},0)};function k(U){try{return U===""&&n.location.href?n.location.href:U}catch{return U}}if(A.open(R.method,k(R.url),!0),R.credentials==="include"?A.withCredentials=!0:R.credentials==="omit"&&(A.withCredentials=!1),"responseType"in A&&(r.blob?A.responseType="blob":r.arrayBuffer&&(A.responseType="arraybuffer")),N&&typeof N.headers=="object"&&!(N.headers instanceof u||n.Headers&&N.headers instanceof n.Headers)){var M=[];Object.getOwnPropertyNames(N.headers).forEach(function(U){M.push(a(U)),A.setRequestHeader(U,c(N.headers[U]))}),R.headers.forEach(function(U,P){M.indexOf(P)===-1&&A.setRequestHeader(P,U)})}else R.headers.forEach(function(U,P){A.setRequestHeader(P,U)});R.signal&&(R.signal.addEventListener("abort",_),A.onreadystatechange=function(){A.readyState===4&&R.signal.removeEventListener("abort",_)}),A.send(typeof R._bodyInit>"u"?null:R._bodyInit)})}return S.polyfill=!0,n.fetch||(n.fetch=S,n.Headers=u,n.Request=m,n.Response=O),t.Headers=u,t.Request=m,t.Response=O,t.fetch=S,Object.defineProperty(t,"__esModule",{value:!0}),t})({})})(typeof self<"u"?self:hh)})()),hh}g3();const w3={referrerPolicy:"origin",headers:{"x-hiro-product":"stacksjs"}};async function m3(e,t){const n={};return Object.assign(n,w3,t),await fetch(e,n)}function y3(e){let t=m3,n=[];return e.length>0&&typeof e[0]=="function"&&(t=e.shift()),e.length>0&&(n=e),{fetchLib:t,middlewares:n}}function b3(...e){const{fetchLib:t,middlewares:n}=y3(e);return async(s,i)=>{let o={url:s,init:i??{}};for(const c of n)typeof c.pre=="function"&&(o=await Promise.resolve(c.pre({fetch:t,...o}))??o);let a=await t(o.url,o.init);for(const c of n)typeof c.post=="function"&&(a=await Promise.resolve(c.post({fetch:t,url:o.url,init:o.init,response:a?.clone()??a}))??a);return a}}var Yo;(function(e){e[e.Testnet=2147483648]="Testnet",e[e.Mainnet=1]="Mainnet"})(Yo||(Yo={}));var Bi;(function(e){e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet"})(Bi||(Bi={}));var O0;(function(e){e[e.Mainnet=385875968]="Mainnet",e[e.Testnet=4278190080]="Testnet"})(O0||(O0={}));const v3="https://api.mainnet.hiro.so",E3="https://api.testnet.hiro.so",C3="http://localhost:3999",A3=["mainnet","testnet","devnet","mocknet"];class Zo{constructor(t){this.version=Bi.Mainnet,this.chainId=Yo.Mainnet,this.bnsLookupUrl="https://api.mainnet.hiro.so",this.broadcastEndpoint="/v2/transactions",this.transferFeeEstimateEndpoint="/v2/fees/transfer",this.transactionFeeEstimateEndpoint="/v2/fees/transaction",this.accountEndpoint="/v2/accounts",this.contractAbiEndpoint="/v2/contracts/interface",this.readOnlyFunctionCallEndpoint="/v2/contracts/call-read",this.isMainnet=()=>this.version===Bi.Mainnet,this.getBroadcastApiUrl=()=>`${this.coreApiUrl}${this.broadcastEndpoint}`,this.getTransferFeeEstimateApiUrl=()=>`${this.coreApiUrl}${this.transferFeeEstimateEndpoint}`,this.getTransactionFeeEstimateApiUrl=()=>`${this.coreApiUrl}${this.transactionFeeEstimateEndpoint}`,this.getAccountApiUrl=n=>`${this.coreApiUrl}${this.accountEndpoint}/${n}?proof=0`,this.getAccountExtendedBalancesApiUrl=n=>`${this.coreApiUrl}/extended/v1/address/${n}/balances`,this.getAbiApiUrl=(n,r)=>`${this.coreApiUrl}${this.contractAbiEndpoint}/${n}/${r}`,this.getReadOnlyFunctionCallApiUrl=(n,r,s)=>`${this.coreApiUrl}${this.readOnlyFunctionCallEndpoint}/${n}/${r}/${encodeURIComponent(s)}`,this.getInfoUrl=()=>`${this.coreApiUrl}/v2/info`,this.getBlockTimeInfoUrl=()=>`${this.coreApiUrl}/extended/v1/info/network_block_times`,this.getPoxInfoUrl=()=>`${this.coreApiUrl}/v2/pox`,this.getRewardsUrl=(n,r)=>{let s=`${this.coreApiUrl}/extended/v1/burnchain/rewards/${n}`;return r&&(s=`${s}?limit=${r.limit}&offset=${r.offset}`),s},this.getRewardsTotalUrl=n=>`${this.coreApiUrl}/extended/v1/burnchain/rewards/${n}/total`,this.getRewardHoldersUrl=(n,r)=>{let s=`${this.coreApiUrl}/extended/v1/burnchain/reward_slot_holders/${n}`;return r&&(s=`${s}?limit=${r.limit}&offset=${r.offset}`),s},this.getStackerInfoUrl=(n,r)=>`${this.coreApiUrl}${this.readOnlyFunctionCallEndpoint}
    ${n}/${r}/get-stacker-info`,this.getDataVarUrl=(n,r,s)=>`${this.coreApiUrl}/v2/data_var/${n}/${r}/${s}?proof=0`,this.getMapEntryUrl=(n,r,s)=>`${this.coreApiUrl}/v2/map_entry/${n}/${r}/${s}?proof=0`,this.coreApiUrl=t.url,this.fetchFn=t.fetchFn??b3()}getNameInfo(t){const n=`${this.bnsLookupUrl}/v1/names/${t}`;return this.fetchFn(n).then(r=>{if(r.status===404)throw new Error("Name not found");if(r.status!==200)throw new Error(`Bad response status: ${r.status}`);return r.json()}).then(r=>r.address?Object.assign({},r,{address:r.address}):r)}}Zo.fromName=e=>{switch(e){case"mainnet":return new J1;case"testnet":return new X1;case"devnet":return new Q1;case"mocknet":return new Ig;default:throw new Error(`Invalid network name provided. Must be one of the following: ${A3.join(", ")}`)}};Zo.fromNameOrNetwork=e=>typeof e!="string"&&"version"in e?e:Zo.fromName(e);class J1 extends Zo{constructor(t){super({url:t?.url??v3,fetchFn:t?.fetchFn}),this.version=Bi.Mainnet,this.chainId=Yo.Mainnet}}class X1 extends Zo{constructor(t){super({url:t?.url??E3,fetchFn:t?.fetchFn}),this.version=Bi.Testnet,this.chainId=Yo.Testnet}}class Ig extends Zo{constructor(t){super({url:t?.url??C3,fetchFn:t?.fetchFn}),this.version=Bi.Testnet,this.chainId=Yo.Testnet}}const Q1=Ig;function I3(e,t,n){return xg(eE(e),n)}function eE(e,t){let n=e;if(typeof n=="number"){if(!Number.isInteger(n))throw new RangeError("Invalid value. Values of type 'number' must be an integer.");if(n>Number.MAX_SAFE_INTEGER)throw new RangeError(`Invalid value. Values of type 'number' must be less than or equal to ${Number.MAX_SAFE_INTEGER}. For larger values, try using a BigInt instead.`);return BigInt(n)}if(typeof n=="string")if(n.toLowerCase().startsWith("0x")){let r=n.slice(2);r=r.padStart(r.length+r.length%2,"0"),n=vc(r)}else try{return BigInt(n)}catch(r){if(r instanceof SyntaxError)throw new RangeError(`Invalid value. String integer '${n}' is not finite.`)}if(typeof n=="bigint")return n;if(n instanceof Uint8Array)return BigInt(`0x${N3(n)}`);if(n!=null&&typeof n=="object"&&n.constructor.name==="BN")return BigInt(n.toString());throw new TypeError("Invalid value type. Must be a number, bigint, integer-string, hex-string, or Uint8Array.")}function Sg(e,t=8){return(typeof e=="bigint"?e:eE(e)).toString(16).padStart(t*2,"0")}function xg(e,t=16){const n=Sg(e,t);return vc(n)}function S3(e,t){if(e<-(BigInt(1)<<t-BigInt(1))||(BigInt(1)<<t-BigInt(1))-BigInt(1)<e)throw`Unable to represent integer in width: ${t}`;return e>=BigInt(0)?BigInt(e):e+(BigInt(1)<<t)}const x3=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function N3(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(const n of e)t+=x3[n];return t}function vc(e){if(typeof e!="string")throw new TypeError(`hexToBytes: expected string, got ${typeof e}`);e=e.startsWith("0x")||e.startsWith("0X")?e.slice(2):e;const t=e.length%2?`0${e}`:e,n=new Uint8Array(t.length/2);for(let r=0;r<n.length;r++){const s=r*2,i=t.slice(s,s+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");n[r]=o}return n}function Ng(e){return new TextEncoder().encode(e)}function _3(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n)&255);return new Uint8Array(t)}function T3(e){return!Number.isInteger(e)||e<0||e>255}function D0(e){if(e.some(T3))throw new Error("Some values are invalid bytes.");return new Uint8Array(e)}function _g(...e){if(!e.every(r=>r instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];const t=e.reduce((r,s)=>r+s.length,0),n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}function cs(e){return _g(...e.map(t=>typeof t=="number"?D0([t]):t instanceof Array?D0(t):t))}function pd(e,t,n=0){return e[n+3]=t,t>>>=8,e[n+2]=t,t>>>=8,e[n+1]=t,t>>>=8,e[n]=t,e}var qf;(function(e){e[e.Testnet=2147483648]="Testnet",e[e.Mainnet=1]="Mainnet"})(qf||(qf={}));qf.Mainnet;const O3=128,D3=128,tE=16;var Wf;(function(e){e[e.Address=0]="Address",e[e.Principal=1]="Principal",e[e.LengthPrefixedString=2]="LengthPrefixedString",e[e.MemoString=3]="MemoString",e[e.AssetInfo=4]="AssetInfo",e[e.PostCondition=5]="PostCondition",e[e.PublicKey=6]="PublicKey",e[e.LengthPrefixedList=7]="LengthPrefixedList",e[e.Payload=8]="Payload",e[e.MessageSignature=9]="MessageSignature",e[e.StructuredDataSignature=10]="StructuredDataSignature",e[e.TransactionAuthField=11]="TransactionAuthField"})(Wf||(Wf={}));var $0;(function(e){e[e.TokenTransfer=0]="TokenTransfer",e[e.SmartContract=1]="SmartContract",e[e.VersionedSmartContract=6]="VersionedSmartContract",e[e.ContractCall=2]="ContractCall",e[e.PoisonMicroblock=3]="PoisonMicroblock",e[e.Coinbase=4]="Coinbase",e[e.CoinbaseToAltRecipient=5]="CoinbaseToAltRecipient",e[e.TenureChange=7]="TenureChange",e[e.NakamotoCoinbase=8]="NakamotoCoinbase"})($0||($0={}));var P0;(function(e){e[e.Clarity1=1]="Clarity1",e[e.Clarity2=2]="Clarity2",e[e.Clarity3=3]="Clarity3"})(P0||(P0={}));var tr;(function(e){e[e.OnChainOnly=1]="OnChainOnly",e[e.OffChainOnly=2]="OffChainOnly",e[e.Any=3]="Any"})(tr||(tr={}));const fh=["onChainOnly","offChainOnly","any"];fh[0]+"",tr.OnChainOnly,fh[1]+"",tr.OffChainOnly,fh[2]+"",tr.Any,tr.OnChainOnly+"",tr.OnChainOnly,tr.OffChainOnly+"",tr.OffChainOnly,tr.Any+"",tr.Any;var Vf;(function(e){e[e.Mainnet=0]="Mainnet",e[e.Testnet=128]="Testnet"})(Vf||(Vf={}));Vf.Mainnet;var k0;(function(e){e[e.Allow=1]="Allow",e[e.Deny=2]="Deny"})(k0||(k0={}));var pi;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(pi||(pi={}));var U0;(function(e){e[e.Standard=4]="Standard",e[e.Sponsored=5]="Sponsored"})(U0||(U0={}));var R0;(function(e){e[e.SerializeP2PKH=0]="SerializeP2PKH",e[e.SerializeP2SH=1]="SerializeP2SH",e[e.SerializeP2WPKH=2]="SerializeP2WPKH",e[e.SerializeP2WSH=3]="SerializeP2WSH",e[e.SerializeP2SHNonSequential=5]="SerializeP2SHNonSequential",e[e.SerializeP2WSHNonSequential=7]="SerializeP2WSHNonSequential"})(R0||(R0={}));var B0;(function(e){e[e.MainnetSingleSig=22]="MainnetSingleSig",e[e.MainnetMultiSig=20]="MainnetMultiSig",e[e.TestnetSingleSig=26]="TestnetSingleSig",e[e.TestnetMultiSig=21]="TestnetMultiSig"})(B0||(B0={}));var M0;(function(e){e[e.Compressed=0]="Compressed",e[e.Uncompressed=1]="Uncompressed"})(M0||(M0={}));var L0;(function(e){e[e.Equal=1]="Equal",e[e.Greater=2]="Greater",e[e.GreaterEqual=3]="GreaterEqual",e[e.Less=4]="Less",e[e.LessEqual=5]="LessEqual"})(L0||(L0={}));var j0;(function(e){e[e.Sends=16]="Sends",e[e.DoesNotSend=17]="DoesNotSend"})(j0||(j0={}));var Kf;(function(e){e[e.Origin=1]="Origin",e[e.Standard=2]="Standard",e[e.Contract=3]="Contract"})(Kf||(Kf={}));var F0;(function(e){e[e.STX=0]="STX",e[e.Fungible=1]="Fungible",e[e.NonFungible=2]="NonFungible"})(F0||(F0={}));var H0;(function(e){e.Serialization="Serialization",e.Deserialization="Deserialization",e.SignatureValidation="SignatureValidation",e.FeeTooLow="FeeTooLow",e.BadNonce="BadNonce",e.NotEnoughFunds="NotEnoughFunds",e.NoSuchContract="NoSuchContract",e.NoSuchPublicFunction="NoSuchPublicFunction",e.BadFunctionArgument="BadFunctionArgument",e.ContractAlreadyExists="ContractAlreadyExists",e.PoisonMicroblocksDoNotConflict="PoisonMicroblocksDoNotConflict",e.PoisonMicroblockHasUnknownPubKeyHash="PoisonMicroblockHasUnknownPubKeyHash",e.PoisonMicroblockIsInvalid="PoisonMicroblockIsInvalid",e.BadAddressVersionByte="BadAddressVersionByte",e.NoCoinbaseViaMempool="NoCoinbaseViaMempool",e.ServerFailureNoSuchChainTip="ServerFailureNoSuchChainTip",e.TooMuchChaining="TooMuchChaining",e.ConflictingNonceInMempool="ConflictingNonceInMempool",e.BadTransactionVersion="BadTransactionVersion",e.TransferRecipientCannotEqualSender="TransferRecipientCannotEqualSender",e.TransferAmountMustBePositive="TransferAmountMustBePositive",e.ServerFailureDatabase="ServerFailureDatabase",e.EstimatorError="EstimatorError",e.TemporarilyBlacklisted="TemporarilyBlacklisted",e.ServerFailureOther="ServerFailureOther"})(H0||(H0={}));function $3(e,t,n){const s=O3;if(Y3(e,s))throw new Error(`String length exceeds maximum bytes ${s}`);return{type:Wf.LengthPrefixedString,content:e,lengthPrefixBytes:1,maxLengthBytes:s}}var xe;(function(e){e[e.Int=0]="Int",e[e.UInt=1]="UInt",e[e.Buffer=2]="Buffer",e[e.BoolTrue=3]="BoolTrue",e[e.BoolFalse=4]="BoolFalse",e[e.PrincipalStandard=5]="PrincipalStandard",e[e.PrincipalContract=6]="PrincipalContract",e[e.ResponseOk=7]="ResponseOk",e[e.ResponseErr=8]="ResponseErr",e[e.OptionalNone=9]="OptionalNone",e[e.OptionalSome=10]="OptionalSome",e[e.List=11]="List",e[e.Tuple=12]="Tuple",e[e.StringASCII=13]="StringASCII",e[e.StringUTF8=14]="StringUTF8"})(xe||(xe={}));class P3 extends Error{constructor(t){super(t),this.message=t,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class nE extends P3{constructor(t){super(t)}}function gd(e){const t=[];return t.push(vc(Sg(e.version,1))),t.push(vc(e.hash160)),cs(t)}function k3(e){const t=[];return t.push(e.prefix),t.push(gd(e.address)),e.prefix===Kf.Contract&&t.push(Ec(e.contractName)),cs(t)}function Ec(e){const t=[],n=Ng(e.content),r=n.byteLength;return t.push(vc(Sg(r,e.lengthPrefixBytes))),t.push(n),cs(t)}function U3(e){const t=[];return t.push(gd(e.address)),t.push(Ec(e.contractName)),t.push(Ec(e.assetName)),cs(t)}function R3(e){const t=[];if(t.push(e.conditionType),t.push(k3(e.principal)),(e.conditionType===pi.Fungible||e.conditionType===pi.NonFungible)&&t.push(U3(e.assetInfo)),e.conditionType===pi.NonFungible&&t.push(sl(e.assetName)),t.push(e.conditionCode),e.conditionType===pi.STX||e.conditionType===pi.Fungible){if(e.amount>BigInt("0xffffffffffffffff"))throw new nE("The post-condition amount may not be larger than 8 bytes");t.push(I3(e.amount,!1,8))}return cs(t)}function Rr(e,t){return cs([e,t])}function B3(e){return new Uint8Array([e.type])}function M3(e){return e.type===xe.OptionalNone?new Uint8Array([e.type]):Rr(e.type,sl(e.value))}function L3(e){const t=new Uint8Array(4);return pd(t,e.buffer.length,0),Rr(e.type,_g(t,e.buffer))}function j3(e){const t=xg(S3(e.value,BigInt(D3)),tE);return Rr(e.type,t)}function F3(e){const t=xg(e.value,tE);return Rr(e.type,t)}function H3(e){return Rr(e.type,gd(e.address))}function z3(e){return Rr(e.type,_g(gd(e.address),Ec(e.contractName)))}function q3(e){return Rr(e.type,sl(e.value))}function W3(e){const t=[],n=new Uint8Array(4);pd(n,e.list.length,0),t.push(n);for(const r of e.list){const s=sl(r);t.push(s)}return Rr(e.type,cs(t))}function V3(e){const t=[],n=new Uint8Array(4);pd(n,Object.keys(e.data).length,0),t.push(n);const r=Object.keys(e.data).sort((s,i)=>s.localeCompare(i));for(const s of r){const i=$3(s);t.push(Ec(i));const o=sl(e.data[s]);t.push(o)}return Rr(e.type,cs(t))}function rE(e,t){const n=[],r=t=="ascii"?_3(e.data):Ng(e.data),s=new Uint8Array(4);return pd(s,r.length,0),n.push(s),n.push(r),Rr(e.type,cs(n))}function K3(e){return rE(e,"ascii")}function G3(e){return rE(e,"utf8")}function sl(e){switch(e.type){case xe.BoolTrue:case xe.BoolFalse:return B3(e);case xe.OptionalNone:case xe.OptionalSome:return M3(e);case xe.Buffer:return L3(e);case xe.UInt:return F3(e);case xe.Int:return j3(e);case xe.PrincipalStandard:return H3(e);case xe.PrincipalContract:return z3(e);case xe.ResponseOk:case xe.ResponseErr:return q3(e);case xe.List:return W3(e);case xe.Tuple:return V3(e);case xe.StringASCII:return K3(e);case xe.StringUTF8:return G3(e);default:throw new nE("Unable to serialize. Invalid Clarity Value.")}}const Y3=(e,t)=>e?Ng(e).length>t:!1;var Hl={exports:{}},z0;function Z3(){if(z0)return Hl.exports;z0=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(v,C,O){return Function.prototype.apply.call(v,C,O)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(v){return Object.getOwnPropertyNames(v).concat(Object.getOwnPropertySymbols(v))}:n=function(v){return Object.getOwnPropertyNames(v)};function r(m){console&&console.warn&&console.warn(m)}var s=Number.isNaN||function(v){return v!==v};function i(){i.init.call(this)}Hl.exports=i,Hl.exports.once=b,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(m){if(typeof m!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof m)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(m){if(typeof m!="number"||m<0||s(m))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+m+".");o=m}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||s(v))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+v+".");return this._maxListeners=v,this};function c(m){return m._maxListeners===void 0?i.defaultMaxListeners:m._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(v){for(var C=[],O=1;O<arguments.length;O++)C.push(arguments[O]);var D=v==="error",S=this._events;if(S!==void 0)D=D&&S.error===void 0;else if(!D)return!1;if(D){var E;if(C.length>0&&(E=C[0]),E instanceof Error)throw E;var N=new Error("Unhandled error."+(E?" ("+E.message+")":""));throw N.context=E,N}var $=S[v];if($===void 0)return!1;if(typeof $=="function")t($,this,C);else for(var B=$.length,R=f($,B),O=0;O<B;++O)t(R[O],this,C);return!0};function l(m,v,C,O){var D,S,E;if(a(C),S=m._events,S===void 0?(S=m._events=Object.create(null),m._eventsCount=0):(S.newListener!==void 0&&(m.emit("newListener",v,C.listener?C.listener:C),S=m._events),E=S[v]),E===void 0)E=S[v]=C,++m._eventsCount;else if(typeof E=="function"?E=S[v]=O?[C,E]:[E,C]:O?E.unshift(C):E.push(C),D=c(m),D>0&&E.length>D&&!E.warned){E.warned=!0;var N=new Error("Possible EventEmitter memory leak detected. "+E.length+" "+String(v)+" listeners added. Use emitter.setMaxListeners() to increase limit");N.name="MaxListenersExceededWarning",N.emitter=m,N.type=v,N.count=E.length,r(N)}return m}i.prototype.addListener=function(v,C){return l(this,v,C,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(v,C){return l(this,v,C,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(m,v,C){var O={fired:!1,wrapFn:void 0,target:m,type:v,listener:C},D=u.bind(O);return D.listener=C,O.wrapFn=D,D}i.prototype.once=function(v,C){return a(C),this.on(v,d(this,v,C)),this},i.prototype.prependOnceListener=function(v,C){return a(C),this.prependListener(v,d(this,v,C)),this},i.prototype.removeListener=function(v,C){var O,D,S,E,N;if(a(C),D=this._events,D===void 0)return this;if(O=D[v],O===void 0)return this;if(O===C||O.listener===C)--this._eventsCount===0?this._events=Object.create(null):(delete D[v],D.removeListener&&this.emit("removeListener",v,O.listener||C));else if(typeof O!="function"){for(S=-1,E=O.length-1;E>=0;E--)if(O[E]===C||O[E].listener===C){N=O[E].listener,S=E;break}if(S<0)return this;S===0?O.shift():g(O,S),O.length===1&&(D[v]=O[0]),D.removeListener!==void 0&&this.emit("removeListener",v,N||C)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(v){var C,O,D;if(O=this._events,O===void 0)return this;if(O.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):O[v]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete O[v]),this;if(arguments.length===0){var S=Object.keys(O),E;for(D=0;D<S.length;++D)E=S[D],E!=="removeListener"&&this.removeAllListeners(E);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(C=O[v],typeof C=="function")this.removeListener(v,C);else if(C!==void 0)for(D=C.length-1;D>=0;D--)this.removeListener(v,C[D]);return this};function h(m,v,C){var O=m._events;if(O===void 0)return[];var D=O[v];return D===void 0?[]:typeof D=="function"?C?[D.listener||D]:[D]:C?w(D):f(D,D.length)}i.prototype.listeners=function(v){return h(this,v,!0)},i.prototype.rawListeners=function(v){return h(this,v,!1)},i.listenerCount=function(m,v){return typeof m.listenerCount=="function"?m.listenerCount(v):p.call(m,v)},i.prototype.listenerCount=p;function p(m){var v=this._events;if(v!==void 0){var C=v[m];if(typeof C=="function")return 1;if(C!==void 0)return C.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function f(m,v){for(var C=new Array(v),O=0;O<v;++O)C[O]=m[O];return C}function g(m,v){for(;v+1<m.length;v++)m[v]=m[v+1];m.pop()}function w(m){for(var v=new Array(m.length),C=0;C<v.length;++C)v[C]=m[C].listener||m[C];return v}function b(m,v){return new Promise(function(C,O){function D(E){m.removeListener(v,S),O(E)}function S(){typeof m.removeListener=="function"&&m.removeListener("error",D),C([].slice.call(arguments))}y(m,v,S,{once:!0}),v!=="error"&&I(m,D,{once:!0})})}function I(m,v,C){typeof m.on=="function"&&y(m,"error",v,C)}function y(m,v,C,O){if(typeof m.on=="function")O.once?m.once(v,C):m.on(v,C);else if(typeof m.addEventListener=="function")m.addEventListener(v,function D(S){O.once&&m.removeEventListener(v,D),C(S)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof m)}return Hl.exports}var Vn=Z3();const Tg=hd(Vn);var ph={};var Gf=function(e,t){return Gf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},Gf(e,t)};function J3(e,t){Gf(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var Yf=function(){return Yf=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Yf.apply(this,arguments)};function X3(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function Q3(e,t,n,r){var s=arguments.length,i=s<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(i=(s<3?o(i):s>3?o(t,n,i):o(t,n))||i);return s>3&&i&&Object.defineProperty(t,n,i),i}function eT(e,t){return function(n,r){t(n,r,e)}}function tT(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function nT(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(e,t||[])).next())})}function rT(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=t.call(e,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function sT(e,t,n,r){r===void 0&&(r=n),e[r]=t[n]}function iT(e,t){for(var n in e)n!=="default"&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Zf(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function sE(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],o;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function oT(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(sE(arguments[t]));return e}function aT(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var r=Array(e),s=0,t=0;t<n;t++)for(var i=arguments[t],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function Cc(e){return this instanceof Cc?(this.v=e,this):new Cc(e)}function cT(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(p){return new Promise(function(f,g){i.push([h,p,f,g])>1||a(h,p)})})}function a(h,p){try{c(r[h](p))}catch(f){d(i[0][3],f)}}function c(h){h.value instanceof Cc?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,p){h(p),i.shift(),i.length&&a(i[0][0],i[0][1])}}function lT(e){var t,n;return t={},r("next"),r("throw",function(s){throw s}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(s,i){t[s]=e[s]?function(o){return(n=!n)?{value:Cc(e[s](o)),done:s==="return"}:i?i(o):o}:i}}function uT(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Zf=="function"?Zf(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=e[i]&&function(o){return new Promise(function(a,c){o=e[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function dT(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function hT(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function fT(e){return e&&e.__esModule?e:{default:e}}function pT(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function gT(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}const wT=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Yf},__asyncDelegator:lT,__asyncGenerator:cT,__asyncValues:uT,__await:Cc,__awaiter:nT,__classPrivateFieldGet:pT,__classPrivateFieldSet:gT,__createBinding:sT,__decorate:Q3,__exportStar:iT,__extends:J3,__generator:rT,__importDefault:fT,__importStar:hT,__makeTemplateObject:dT,__metadata:tT,__param:eT,__read:sE,__rest:X3,__spread:oT,__spreadArrays:aT,__values:Zf},Symbol.toStringTag,{value:"Module"})),il=Yx(wT);var gh={},xa={},q0;function mT(){if(q0)return xa;q0=1,Object.defineProperty(xa,"__esModule",{value:!0}),xa.delay=void 0;function e(t){return new Promise(n=>{setTimeout(()=>{n(!0)},t)})}return xa.delay=e,xa}var si={},wh={},ii={},W0;function yT(){return W0||(W0=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.ONE_THOUSAND=ii.ONE_HUNDRED=void 0,ii.ONE_HUNDRED=100,ii.ONE_THOUSAND=1e3),ii}var mh={},V0;function bT(){return V0||(V0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365})(mh)),mh}var K0;function iE(){return K0||(K0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=il;t.__exportStar(yT(),e),t.__exportStar(bT(),e)})(wh)),wh}var G0;function vT(){if(G0)return si;G0=1,Object.defineProperty(si,"__esModule",{value:!0}),si.fromMiliseconds=si.toMiliseconds=void 0;const e=iE();function t(r){return r*e.ONE_THOUSAND}si.toMiliseconds=t;function n(r){return Math.floor(r/e.ONE_THOUSAND)}return si.fromMiliseconds=n,si}var Y0;function ET(){return Y0||(Y0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=il;t.__exportStar(mT(),e),t.__exportStar(vT(),e)})(gh)),gh}var oo={},Z0;function CT(){if(Z0)return oo;Z0=1,Object.defineProperty(oo,"__esModule",{value:!0}),oo.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return oo.Watch=e,oo.default=e,oo}var yh={},Na={},J0;function AT(){if(J0)return Na;J0=1,Object.defineProperty(Na,"__esModule",{value:!0}),Na.IWatch=void 0;class e{}return Na.IWatch=e,Na}var X0;function IT(){return X0||(X0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),il.__exportStar(AT(),e)})(yh)),yh}var Q0;function ST(){return Q0||(Q0=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=il;t.__exportStar(ET(),e),t.__exportStar(CT(),e),t.__exportStar(IT(),e),t.__exportStar(iE(),e)})(ph)),ph}var Z=ST();class Vi{}let xT=class extends Vi{constructor(t){super()}};const em=Z.FIVE_SECONDS,Ki={pulse:"heartbeat_pulse"};let NT=class oE extends xT{constructor(t){super(t),this.events=new Vn.EventEmitter,this.interval=em,this.interval=t?.interval||em}static async init(t){const n=new oE(t);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Z.toMiliseconds(this.interval))}pulse(){this.events.emit(Ki.pulse)}};const _T=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,TT=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,OT=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function DT(e,t){if(e==="__proto__"||e==="constructor"&&t&&typeof t=="object"&&"prototype"in t){$T(e);return}return t}function $T(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function zl(e,t={}){if(typeof e!="string")return e;if(e[0]==='"'&&e[e.length-1]==='"'&&e.indexOf("\\")===-1)return e.slice(1,-1);const n=e.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!OT.test(e)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(_T.test(e)||TT.test(e)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,DT)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}function PT(e){return!e||typeof e.then!="function"?Promise.resolve(e):e}function bt(e,...t){try{return PT(e(...t))}catch(n){return Promise.reject(n)}}function kT(e){const t=typeof e;return e===null||t!=="object"&&t!=="function"}function UT(e){const t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}function vu(e){if(kT(e))return String(e);if(UT(e)||Array.isArray(e))return JSON.stringify(e);if(typeof e.toJSON=="function")return vu(e.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Jf="base64:";function RT(e){return typeof e=="string"?e:Jf+LT(e)}function BT(e){return typeof e!="string"||!e.startsWith(Jf)?e:MT(e.slice(Jf.length))}function MT(e){return globalThis.Buffer?Buffer.from(e,"base64"):Uint8Array.from(globalThis.atob(e),t=>t.codePointAt(0))}function LT(e){return globalThis.Buffer?Buffer.from(e).toString("base64"):globalThis.btoa(String.fromCodePoint(...e))}function sn(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function jT(...e){return sn(e.join(":"))}function ql(e){return e=sn(e),e?e+":":""}function FT(e,t){if(t===void 0)return!0;let n=0,r=e.indexOf(":");for(;r>-1;)n++,r=e.indexOf(":",r+1);return n<=t}function HT(e,t){return t?e.startsWith(t)&&e[e.length-1]!=="$":e[e.length-1]!=="$"}const zT="memory",qT=()=>{const e=new Map;return{name:zT,getInstance:()=>e,hasItem(t){return e.has(t)},getItem(t){return e.get(t)??null},getItemRaw(t){return e.get(t)??null},setItem(t,n){e.set(t,n)},setItemRaw(t,n){e.set(t,n)},removeItem(t){e.delete(t)},getKeys(){return[...e.keys()]},clear(){e.clear()},dispose(){e.clear()}}};function WT(e={}){const t={mounts:{"":e.driver||qT()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of t.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:t.mounts[u]};return{base:"",relativeKey:l,driver:t.mounts[""]}},r=(l,u)=>t.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:t.mounts[d]})),s=(l,u)=>{if(t.watching){u=sn(u);for(const d of t.watchListeners)d(l,u)}},i=async()=>{if(!t.watching){t.watching=!0;for(const l in t.mounts)t.unwatch[l]=await tm(t.mounts[l],s,l)}},o=async()=>{if(t.watching){for(const l in t.unwatch)await t.unwatch[l]();t.unwatch={},t.watching=!1}},a=(l,u,d)=>{const h=new Map,p=f=>{let g=h.get(f.base);return g||(g={driver:f.driver,base:f.base,items:[]},h.set(f.base,g)),g};for(const f of l){const g=typeof f=="string",w=sn(g?f:f.key),b=g?void 0:f.value,I=g||!f.options?u:{...u,...f.options},y=n(w);p(y).items.push({key:w,value:b,relativeKey:y.relativeKey,options:I})}return Promise.all([...h.values()].map(f=>d(f))).then(f=>f.flat())},c={hasItem(l,u={}){l=sn(l);const{relativeKey:d,driver:h}=n(l);return bt(h.hasItem,d,u)},getItem(l,u={}){l=sn(l);const{relativeKey:d,driver:h}=n(l);return bt(h.getItem,d,u).then(p=>zl(p))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?bt(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(p=>({key:jT(d.base,p.key),value:zl(p.value)}))):Promise.all(d.items.map(h=>bt(d.driver.getItem,h.relativeKey,h.options).then(p=>({key:h.key,value:zl(p)})))))},getItemRaw(l,u={}){l=sn(l);const{relativeKey:d,driver:h}=n(l);return h.getItemRaw?bt(h.getItemRaw,d,u):bt(h.getItem,d,u).then(p=>BT(p))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=sn(l);const{relativeKey:h,driver:p}=n(l);p.setItem&&(await bt(p.setItem,h,vu(u),d),p.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return bt(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:vu(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>bt(d.driver.setItem,h.relativeKey,vu(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=sn(l);const{relativeKey:h,driver:p}=n(l);if(p.setItemRaw)await bt(p.setItemRaw,h,u,d);else if(p.setItem)await bt(p.setItem,h,RT(u),d);else return;p.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=sn(l);const{relativeKey:d,driver:h}=n(l);h.removeItem&&(await bt(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await bt(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=sn(l);const{relativeKey:d,driver:h}=n(l),p=Object.create(null);if(h.getMeta&&Object.assign(p,await bt(h.getMeta,d,u)),!u.nativeOnly){const f=await bt(h.getItem,d+"$",u).then(g=>zl(g));f&&typeof f=="object"&&(typeof f.atime=="string"&&(f.atime=new Date(f.atime)),typeof f.mtime=="string"&&(f.mtime=new Date(f.mtime)),Object.assign(p,f))}return p},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=ql(l);const d=r(l,!0);let h=[];const p=[];let f=!0;for(const w of d){w.driver.flags?.maxDepth||(f=!1);const b=await bt(w.driver.getKeys,w.relativeBase,u);for(const I of b){const y=w.mountpoint+sn(I);h.some(m=>y.startsWith(m))||p.push(y)}h=[w.mountpoint,...h.filter(I=>!I.startsWith(w.mountpoint))]}const g=u.maxDepth!==void 0&&!f;return p.filter(w=>(!g||FT(w,u.maxDepth))&&HT(w,l))},async clear(l,u={}){l=ql(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return bt(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(p=>d.driver.removeItem(p,u)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(l=>nm(l)))},async watch(l){return await i(),t.watchListeners.push(l),async()=>{t.watchListeners=t.watchListeners.filter(u=>u!==l),t.watchListeners.length===0&&await o()}},async unwatch(){t.watchListeners=[],await o()},mount(l,u){if(l=ql(l),l&&t.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(t.mountpoints.push(l),t.mountpoints.sort((d,h)=>h.length-d.length)),t.mounts[l]=u,t.watching&&Promise.resolve(tm(u,s,l)).then(d=>{t.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=ql(l),!(!l||!t.mounts[l])&&(t.watching&&l in t.unwatch&&(t.unwatch[l]?.(),delete t.unwatch[l]),u&&await nm(t.mounts[l]),t.mountpoints=t.mountpoints.filter(d=>d!==l),delete t.mounts[l])},getMount(l=""){l=sn(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=sn(l),r(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function tm(e,t,n){return e.watch?e.watch((r,s)=>t(r,n+s)):()=>{}}async function nm(e){typeof e.dispose=="function"&&await bt(e.dispose)}function Gi(e){return new Promise((t,n)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>n(e.error)})}function aE(e,t){let n;const r=()=>{if(n)return n;const s=indexedDB.open(e);return s.onupgradeneeded=()=>s.result.createObjectStore(t),n=Gi(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(t,s).objectStore(t)))}let bh;function ol(){return bh||(bh=aE("keyval-store","keyval")),bh}function rm(e,t=ol()){return t("readonly",n=>Gi(n.get(e)))}function VT(e,t,n=ol()){return n("readwrite",r=>(r.put(t,e),Gi(r.transaction)))}function KT(e,t=ol()){return t("readwrite",n=>(n.delete(e),Gi(n.transaction)))}function GT(e=ol()){return e("readwrite",t=>(t.clear(),Gi(t.transaction)))}function YT(e,t){return e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Gi(e.transaction)}function ZT(e=ol()){return e("readonly",t=>{if(t.getAllKeys)return Gi(t.getAllKeys());const n=[];return YT(t,r=>n.push(r.key)).then(()=>n)})}const JT=e=>JSON.stringify(e,(t,n)=>typeof n=="bigint"?n.toString()+"n":n),XT=e=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=e.replace(t,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function Mi(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return XT(e)}catch{return e}}function ss(e){return typeof e=="string"?e:JT(e)||""}const QT="idb-keyval";var eO=(e={})=>{const t=e.base&&e.base.length>0?`${e.base}:`:"",n=s=>t+s;let r;return e.dbName&&e.storeName&&(r=aE(e.dbName,e.storeName)),{name:QT,options:e,async hasItem(s){return!(typeof await rm(n(s),r)>"u")},async getItem(s){return await rm(n(s),r)??null},setItem(s,i){return VT(n(s),i,r)},removeItem(s){return KT(n(s),r)},getKeys(){return ZT(r)},clear(){return GT(r)}}};const tO="WALLET_CONNECT_V2_INDEXED_DB",nO="keyvaluestorage";let rO=class{constructor(){this.indexedDb=WT({driver:eO({dbName:tO,storeName:nO})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const n=await this.indexedDb.getItem(t);if(n!==null)return n}async setItem(t,n){await this.indexedDb.setItem(t,ss(n))}async removeItem(t){await this.indexedDb.removeItem(t)}};var vh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Eu={exports:{}};(function(){let e;function t(){}e=t,e.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},e.prototype.setItem=function(n,r){this[n]=String(r)},e.prototype.removeItem=function(n){delete this[n]},e.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},e.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof vh<"u"&&vh.localStorage?Eu.exports=vh.localStorage:typeof window<"u"&&window.localStorage?Eu.exports=window.localStorage:Eu.exports=new t})();function sO(e){var t;return[e[0],Mi((t=e[1])!=null?t:"")]}let iO=class{constructor(){this.localStorage=Eu.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(sO)}async getItem(t){const n=this.localStorage.getItem(t);if(n!==null)return Mi(n)}async setItem(t,n){this.localStorage.setItem(t,ss(n))}async removeItem(t){this.localStorage.removeItem(t)}};const oO="wc_storage_version",sm=1,aO=async(e,t,n)=>{const r=oO,s=await t.getItem(r);if(s&&s>=sm){n(t);return}const i=await e.getKeys();if(!i.length){n(t);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await e.getItem(a);await t.setItem(a,l),o.push(a)}}await t.setItem(r,sm),n(t),cO(e,o)},cO=async(e,t)=>{t.length&&t.forEach(async n=>{await e.removeItem(n)})};let lO=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const t=new iO;this.storage=t;try{const n=new rO;aO(t,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,n){return await this.initialize(),this.storage.setItem(t,n)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),t())},20)})}};var Eh,im;function uO(){if(im)return Eh;im=1;function e(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}Eh=t;function t(n,r,s){var i=s&&s.stringify||e,o=1;if(typeof n=="object"&&n!==null){var a=r.length+o;if(a===1)return n;var c=new Array(a);c[0]=i(n);for(var l=1;l<a;l++)c[l]=i(r[l]);return c.join(" ")}if(typeof n!="string")return n;var u=r.length;if(u===0)return n;for(var d="",h=1-o,p=-1,f=n&&n.length||0,g=0;g<f;){if(n.charCodeAt(g)===37&&g+1<f){switch(p=p>-1?p:0,n.charCodeAt(g+1)){case 100:case 102:if(h>=u||r[h]==null)break;p<g&&(d+=n.slice(p,g)),d+=Number(r[h]),p=g+2,g++;break;case 105:if(h>=u||r[h]==null)break;p<g&&(d+=n.slice(p,g)),d+=Math.floor(Number(r[h])),p=g+2,g++;break;case 79:case 111:case 106:if(h>=u||r[h]===void 0)break;p<g&&(d+=n.slice(p,g));var w=typeof r[h];if(w==="string"){d+="'"+r[h]+"'",p=g+2,g++;break}if(w==="function"){d+=r[h].name||"<anonymous>",p=g+2,g++;break}d+=i(r[h]),p=g+2,g++;break;case 115:if(h>=u)break;p<g&&(d+=n.slice(p,g)),d+=String(r[h]),p=g+2,g++;break;case 37:p<g&&(d+=n.slice(p,g)),d+="%",p=g+2,g++,h--;break}++h}++g}return p===-1?n:(p<f&&(d+=n.slice(p)),d)}return Eh}var Ch,om;function dO(){if(om)return Ch;om=1;const e=uO();Ch=s;const t=v().console||{},n={mapHttpRequest:f,mapHttpResponse:f,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:f,res:f,err:h};function r(C,O){return Array.isArray(C)?C.filter(function(S){return S!=="!stdSerializers.err"}):C===!0?Object.keys(O):!1}function s(C){C=C||{},C.browser=C.browser||{};const O=C.browser.transmit;if(O&&typeof O.send!="function")throw Error("pino: transmit option must have a send function");const D=C.browser.write||t;C.browser.write&&(C.browser.asObject=!0);const S=C.serializers||{},E=r(C.browser.serialize,S);let N=C.browser.serialize;Array.isArray(C.browser.serialize)&&C.browser.serialize.indexOf("!stdSerializers.err")>-1&&(N=!1);const $=["error","fatal","warn","info","debug","trace"];typeof D=="function"&&(D.error=D.fatal=D.warn=D.info=D.debug=D.trace=D),C.enabled===!1&&(C.level="silent");const B=C.level||"info",R=Object.create(D);R.log||(R.log=w),Object.defineProperty(R,"levelVal",{get:_}),Object.defineProperty(R,"level",{get:k,set:M});const A={transmit:O,serialize:E,asObject:C.browser.asObject,levels:$,timestamp:p(C)};R.levels=s.levels,R.level=B,R.setMaxListeners=R.getMaxListeners=R.emit=R.addListener=R.on=R.prependListener=R.once=R.prependOnceListener=R.removeListener=R.removeAllListeners=R.listeners=R.listenerCount=R.eventNames=R.write=R.flush=w,R.serializers=S,R._serialize=E,R._stdErrSerialize=N,R.child=U,O&&(R._logEvent=d());function _(){return this.level==="silent"?1/0:this.levels.values[this.level]}function k(){return this._level}function M(P){if(P!=="silent"&&!this.levels.values[P])throw Error("unknown level "+P);this._level=P,i(A,R,"error","log"),i(A,R,"fatal","error"),i(A,R,"warn","error"),i(A,R,"info","log"),i(A,R,"debug","log"),i(A,R,"trace","log")}function U(P,H){if(!P)throw new Error("missing bindings for child Pino");H=H||{},E&&P.serializers&&(H.serializers=P.serializers);const Y=H.serializers;if(E&&Y){var J=Object.assign({},S,Y),K=C.browser.serialize===!0?Object.keys(J):E;delete P.serializers,c([P],K,J,this._stdErrSerialize)}function ne(ue){this._childLevel=(ue._childLevel|0)+1,this.error=l(ue,P,"error"),this.fatal=l(ue,P,"fatal"),this.warn=l(ue,P,"warn"),this.info=l(ue,P,"info"),this.debug=l(ue,P,"debug"),this.trace=l(ue,P,"trace"),J&&(this.serializers=J,this._serialize=K),O&&(this._logEvent=d([].concat(ue._logEvent.bindings,P)))}return ne.prototype=this,new ne(this)}return R}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=n,s.stdTimeFunctions=Object.assign({},{nullTime:b,epochTime:I,unixTime:y,isoTime:m});function i(C,O,D,S){const E=Object.getPrototypeOf(O);O[D]=O.levelVal>O.levels.values[D]?w:E[D]?E[D]:t[D]||t[S]||w,o(C,O,D)}function o(C,O,D){!C.transmit&&O[D]===w||(O[D]=(function(S){return function(){const N=C.timestamp(),$=new Array(arguments.length),B=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var R=0;R<$.length;R++)$[R]=arguments[R];if(C.serialize&&!C.asObject&&c($,this._serialize,this.serializers,this._stdErrSerialize),C.asObject?S.call(B,a(this,D,$,N)):S.apply(B,$),C.transmit){const A=C.transmit.level||O.level,_=s.levels.values[A],k=s.levels.values[D];if(k<_)return;u(this,{ts:N,methodLevel:D,methodValue:k,transmitValue:s.levels.values[C.transmit.level||O.level],send:C.transmit.send,val:O.levelVal},$)}}})(O[D]))}function a(C,O,D,S){C._serialize&&c(D,C._serialize,C.serializers,C._stdErrSerialize);const E=D.slice();let N=E[0];const $={};S&&($.time=S),$.level=s.levels.values[O];let B=(C._childLevel|0)+1;if(B<1&&(B=1),N!==null&&typeof N=="object"){for(;B--&&typeof E[0]=="object";)Object.assign($,E.shift());N=E.length?e(E.shift(),E):void 0}else typeof N=="string"&&(N=e(E.shift(),E));return N!==void 0&&($.msg=N),$}function c(C,O,D,S){for(const E in C)if(S&&C[E]instanceof Error)C[E]=s.stdSerializers.err(C[E]);else if(typeof C[E]=="object"&&!Array.isArray(C[E]))for(const N in C[E])O&&O.indexOf(N)>-1&&N in D&&(C[E][N]=D[N](C[E][N]))}function l(C,O,D){return function(){const S=new Array(1+arguments.length);S[0]=O;for(var E=1;E<S.length;E++)S[E]=arguments[E-1];return C[D].apply(this,S)}}function u(C,O,D){const S=O.send,E=O.ts,N=O.methodLevel,$=O.methodValue,B=O.val,R=C._logEvent.bindings;c(D,C._serialize||Object.keys(C.serializers),C.serializers,C._stdErrSerialize===void 0?!0:C._stdErrSerialize),C._logEvent.ts=E,C._logEvent.messages=D.filter(function(A){return R.indexOf(A)===-1}),C._logEvent.level.label=N,C._logEvent.level.value=$,S(N,C._logEvent,B),C._logEvent=d(R)}function d(C){return{ts:0,messages:[],bindings:C||[],level:{label:"",value:0}}}function h(C){const O={type:C.constructor.name,msg:C.message,stack:C.stack};for(const D in C)O[D]===void 0&&(O[D]=C[D]);return O}function p(C){return typeof C.timestamp=="function"?C.timestamp:C.timestamp===!1?b:I}function f(){return{}}function g(C){return C}function w(){}function b(){return!1}function I(){return Date.now()}function y(){return Math.round(Date.now()/1e3)}function m(){return new Date(Date.now()).toISOString()}function v(){function C(O){return typeof O<"u"&&O}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return C(self)||C(window)||C(this)||{}}}return Ch}var _o=dO();const al=hd(_o),hO={level:"info"},cl="custom_context",Og=1e3*1024;let fO=class{constructor(t){this.nodeValue=t,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},am=class{constructor(t){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=t,this.sizeInBytes=0}append(t){const n=new fO(t);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${t} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const t=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=t.size}toArray(){const t=[];let n=this.head;for(;n!==null;)t.push(n.value),n=n.next;return t}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let t=this.head;return{next:()=>{if(!t)return{done:!0,value:null};const n=t.value;return t=t.next,{done:!1,value:n}}}}},cE=class{constructor(t,n=Og){this.level=t??"error",this.levelValue=_o.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new am(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(t,n){n===_o.levels.values.error?console.error(t):n===_o.levels.values.warn?console.warn(t):n===_o.levels.values.debug?console.debug(t):n===_o.levels.values.trace?console.trace(t):console.log(t)}appendToLogs(t){this.logs.append(ss({timestamp:new Date().toISOString(),log:t}));const n=typeof t=="string"?JSON.parse(t).level:t.level;n>=this.levelValue&&this.forwardToConsole(t,n)}getLogs(){return this.logs}clearLogs(){this.logs=new am(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(t){const n=this.getLogArray();return n.push(ss({extraMetadata:t})),new Blob(n,{type:"application/json"})}},pO=class{constructor(t,n=Og){this.baseChunkLogger=new cE(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}downloadLogsBlobInBrowser(t){const n=URL.createObjectURL(this.logsToBlob(t)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},gO=class{constructor(t,n=Og){this.baseChunkLogger=new cE(t,n)}write(t){this.baseChunkLogger.appendToLogs(t)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(t){return this.baseChunkLogger.logsToBlob(t)}};var wO=Object.defineProperty,mO=Object.defineProperties,yO=Object.getOwnPropertyDescriptors,cm=Object.getOwnPropertySymbols,bO=Object.prototype.hasOwnProperty,vO=Object.prototype.propertyIsEnumerable,lm=(e,t,n)=>t in e?wO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,zu=(e,t)=>{for(var n in t||(t={}))bO.call(t,n)&&lm(e,n,t[n]);if(cm)for(var n of cm(t))vO.call(t,n)&&lm(e,n,t[n]);return e},qu=(e,t)=>mO(e,yO(t));function ll(e){return qu(zu({},e),{level:e?.level||hO.level})}function EO(e,t=cl){return e[t]||""}function CO(e,t,n=cl){return e[n]=t,e}function fn(e,t=cl){let n="";return typeof e.bindings>"u"?n=EO(e,t):n=e.bindings().context||"",n}function AO(e,t,n=cl){const r=fn(e,n);return r.trim()?`${r}/${t}`:t}function Gt(e,t,n=cl){const r=AO(e,t,n),s=e.child({context:r});return CO(s,r,n)}function IO(e){var t,n;const r=new pO((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:al(qu(zu({},e.opts),{level:"trace",browser:qu(zu({},(n=e.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function SO(e){var t;const n=new gO((t=e.opts)==null?void 0:t.level,e.maxSizeInBytes);return{logger:al(qu(zu({},e.opts),{level:"trace"}),n),chunkLoggerController:n}}function lE(e){return typeof e.loggerOverride<"u"&&typeof e.loggerOverride!="string"?{logger:e.loggerOverride,chunkLoggerController:null}:typeof window<"u"?IO(e):SO(e)}var xO=Object.defineProperty,NO=(e,t,n)=>t in e?xO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,um=(e,t,n)=>NO(e,typeof t!="symbol"?t+"":t,n);let _O=class extends Vi{constructor(t){super(),this.opts=t,um(this,"protocol","wc"),um(this,"version",2)}};var TO=Object.defineProperty,OO=(e,t,n)=>t in e?TO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,DO=(e,t,n)=>OO(e,t+"",n);let $O=class extends Vi{constructor(t,n){super(),this.core=t,this.logger=n,DO(this,"records",new Map)}},PO=class{constructor(t,n){this.logger=t,this.core=n}},kO=class extends Vi{constructor(t,n){super(),this.relayer=t,this.logger=n}},UO=class extends Vi{constructor(t){super()}},RO=class{constructor(t,n,r,s){this.core=t,this.logger=n,this.name=r}},BO=class extends Vi{constructor(t,n){super(),this.relayer=t,this.logger=n}},MO=class extends Vi{constructor(t,n){super(),this.core=t,this.logger=n}},LO=class{constructor(t,n,r){this.core=t,this.logger=n,this.store=r}},jO=class{constructor(t,n){this.projectId=t,this.logger=n}},FO=class{constructor(t,n,r){this.core=t,this.logger=n,this.telemetryEnabled=r}};var HO=Object.defineProperty,zO=(e,t,n)=>t in e?HO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,dm=(e,t,n)=>zO(e,typeof t!="symbol"?t+"":t,n);let qO=class{constructor(t){this.opts=t,dm(this,"protocol","wc"),dm(this,"version",2)}},WO=class{constructor(t){this.client=t}};function VO(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function uE(e,...t){if(!VO(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function hm(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function KO(e,t){uE(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const ao=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;const Ah=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function GO(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function dE(e){return typeof e=="string"&&(e=GO(e)),uE(e),e}let YO=class{clone(){return this._cloneInto()}};function ZO(e){const t=r=>e().update(dE(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function hE(e=32){if(ao&&typeof ao.getRandomValues=="function")return ao.getRandomValues(new Uint8Array(e));if(ao&&typeof ao.randomBytes=="function")return ao.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}function JO(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}let XO=class extends YO{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Ah(this.buffer)}update(t){hm(this);const{view:n,buffer:r,blockLen:s}=this;t=dE(t);const i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Ah(t);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){hm(this),KO(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;JO(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Ah(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.length=s,t.pos=a,t.finished=i,t.destroyed=o,s%n&&t.buffer.set(r),t}};const Wl=BigInt(2**32-1),Xf=BigInt(32);function fE(e,t=!1){return t?{h:Number(e&Wl),l:Number(e>>Xf&Wl)}:{h:Number(e>>Xf&Wl)|0,l:Number(e&Wl)|0}}function QO(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:i,l:o}=fE(e[s],t);[n[s],r[s]]=[i,o]}return[n,r]}const eD=(e,t)=>BigInt(e>>>0)<<Xf|BigInt(t>>>0),tD=(e,t,n)=>e>>>n,nD=(e,t,n)=>e<<32-n|t>>>n,rD=(e,t,n)=>e>>>n|t<<32-n,sD=(e,t,n)=>e<<32-n|t>>>n,iD=(e,t,n)=>e<<64-n|t>>>n-32,oD=(e,t,n)=>e>>>n-32|t<<64-n,aD=(e,t)=>t,cD=(e,t)=>e,lD=(e,t,n)=>e<<n|t>>>32-n,uD=(e,t,n)=>t<<n|e>>>32-n,dD=(e,t,n)=>t<<n-32|e>>>64-n,hD=(e,t,n)=>e<<n-32|t>>>64-n;function fD(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const pD=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),gD=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,wD=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),mD=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,yD=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),bD=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,ye={fromBig:fE,split:QO,toBig:eD,shrSH:tD,shrSL:nD,rotrSH:rD,rotrSL:sD,rotrBH:iD,rotrBL:oD,rotr32H:aD,rotr32L:cD,rotlSH:lD,rotlSL:uD,rotlBH:dD,rotlBL:hD,add:fD,add3L:pD,add3H:gD,add4L:wD,add4H:mD,add5H:bD,add5L:yD},[vD,ED]=ye.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ps=new Uint32Array(80),gs=new Uint32Array(80);let CD=class extends XO{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:f,Hh:g,Hl:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=f|0,this.Hh=g|0,this.Hl=w|0}process(t,n){for(let y=0;y<16;y++,n+=4)ps[y]=t.getUint32(n),gs[y]=t.getUint32(n+=4);for(let y=16;y<80;y++){const m=ps[y-15]|0,v=gs[y-15]|0,C=ye.rotrSH(m,v,1)^ye.rotrSH(m,v,8)^ye.shrSH(m,v,7),O=ye.rotrSL(m,v,1)^ye.rotrSL(m,v,8)^ye.shrSL(m,v,7),D=ps[y-2]|0,S=gs[y-2]|0,E=ye.rotrSH(D,S,19)^ye.rotrBH(D,S,61)^ye.shrSH(D,S,6),N=ye.rotrSL(D,S,19)^ye.rotrBL(D,S,61)^ye.shrSL(D,S,6),$=ye.add4L(O,N,gs[y-7],gs[y-16]),B=ye.add4H($,C,E,ps[y-7],ps[y-16]);ps[y]=B|0,gs[y]=$|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:f,Gh:g,Gl:w,Hh:b,Hl:I}=this;for(let y=0;y<80;y++){const m=ye.rotrSH(d,h,14)^ye.rotrSH(d,h,18)^ye.rotrBH(d,h,41),v=ye.rotrSL(d,h,14)^ye.rotrSL(d,h,18)^ye.rotrBL(d,h,41),C=d&p^~d&g,O=h&f^~h&w,D=ye.add5L(I,v,O,ED[y],gs[y]),S=ye.add5H(D,b,m,C,vD[y],ps[y]),E=D|0,N=ye.rotrSH(r,s,28)^ye.rotrBH(r,s,34)^ye.rotrBH(r,s,39),$=ye.rotrSL(r,s,28)^ye.rotrBL(r,s,34)^ye.rotrBL(r,s,39),B=r&i^r&a^i&a,R=s&o^s&c^o&c;b=g|0,I=w|0,g=p|0,w=f|0,p=d|0,f=h|0,{h:d,l:h}=ye.add(l|0,u|0,S|0,E|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=ye.add3L(E,$,R);r=ye.add3H(A,S,N,B),s=A|0}({h:r,l:s}=ye.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=ye.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=ye.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=ye.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=ye.add(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:f}=ye.add(this.Fh|0,this.Fl|0,p|0,f|0),{h:g,l:w}=ye.add(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:I}=ye.add(this.Hh|0,this.Hl|0,b|0,I|0),this.set(r,s,i,o,a,c,l,u,d,h,p,f,g,w,b,I)}roundClean(){ps.fill(0),gs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const AD=ZO(()=>new CD);const Dg=BigInt(0),pE=BigInt(1),ID=BigInt(2);function $g(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Pg(e){if(!$g(e))throw new Error("Uint8Array expected")}function Ih(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}const SD=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function kg(e){Pg(e);let t="";for(let n=0;n<e.length;n++)t+=SD[e[n]];return t}function gE(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Dg:BigInt("0x"+e)}const Fr={_0:48,_9:57,A:65,F:70,a:97,f:102};function fm(e){if(e>=Fr._0&&e<=Fr._9)return e-Fr._0;if(e>=Fr.A&&e<=Fr.F)return e-(Fr.A-10);if(e>=Fr.a&&e<=Fr.f)return e-(Fr.a-10)}function wE(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=fm(e.charCodeAt(i)),a=fm(e.charCodeAt(i+1));if(o===void 0||a===void 0){const c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function xD(e){return gE(kg(e))}function Cu(e){return Pg(e),gE(kg(Uint8Array.from(e).reverse()))}function mE(e,t){return wE(e.toString(16).padStart(t*2,"0"))}function Qf(e,t){return mE(e,t).reverse()}function Hr(e,t,n){let r;if(typeof t=="string")try{r=wE(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if($g(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}function pm(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];Pg(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}const Sh=e=>typeof e=="bigint"&&Dg<=e;function ND(e,t,n){return Sh(e)&&Sh(t)&&Sh(n)&&t<=e&&e<n}function _a(e,t,n,r){if(!ND(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function _D(e){let t;for(t=0;e>Dg;e>>=pE,t+=1);return t}const TD=e=>(ID<<BigInt(e-1))-pE,OD={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||$g(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Ug(e,t,n={}){const r=(s,i,o)=>{const a=OD[i];if(typeof a!="function")throw new Error("invalid validator function");const c=e[s];if(!(o&&c===void 0)&&!a(c,e))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(t))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return e}function gm(e){const t=new WeakMap;return(n,...r)=>{const s=t.get(n);if(s!==void 0)return s;const i=e(n,...r);return t.set(n,i),i}}const At=BigInt(0),ot=BigInt(1),gi=BigInt(2),DD=BigInt(3),ep=BigInt(4),wm=BigInt(5),mm=BigInt(8);function wt(e,t){const n=e%t;return n>=At?n:t+n}function $D(e,t,n){if(t<At)throw new Error("invalid exponent, negatives unsupported");if(n<=At)throw new Error("invalid modulus");if(n===ot)return At;let r=ot;for(;t>At;)t&ot&&(r=r*e%n),e=e*e%n,t>>=ot;return r}function wr(e,t,n){let r=e;for(;t-- >At;)r*=r,r%=n;return r}function ym(e,t){if(e===At)throw new Error("invert: expected non-zero number");if(t<=At)throw new Error("invert: expected positive modulus, got "+t);let n=wt(e,t),r=t,s=At,i=ot;for(;n!==At;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==ot)throw new Error("invert: does not exist");return wt(s,t)}function PD(e){const t=(e-ot)/gi;let n,r,s;for(n=e-ot,r=0;n%gi===At;n/=gi,r++);for(s=gi;s<e&&$D(s,t,e)!==e-ot;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(e+ot)/ep;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+ot)/gi;return function(o,a){if(o.pow(a,t)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let f=o.sqr(d);h<c&&!o.eql(f,o.ONE);h++)f=o.sqr(f);const p=o.pow(l,ot<<BigInt(c-h-1));l=o.sqr(p),u=o.mul(u,p),d=o.mul(d,l),c=h}return u}}function kD(e){if(e%ep===DD){const t=(e+ot)/ep;return function(n,r){const s=n.pow(r,t);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(e%mm===wm){const t=(e-wm)/mm;return function(n,r){const s=n.mul(r,gi),i=n.pow(s,t),o=n.mul(r,i),a=n.mul(n.mul(o,gi),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return PD(e)}const UD=(e,t)=>(wt(e,t)&ot)===ot,RD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function BD(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=RD.reduce((r,s)=>(r[s]="function",r),t);return Ug(e,n)}function MD(e,t,n){if(n<At)throw new Error("invalid exponent, negatives unsupported");if(n===At)return e.ONE;if(n===ot)return t;let r=e.ONE,s=t;for(;n>At;)n&ot&&(r=e.mul(r,s)),s=e.sqr(s),n>>=ot;return r}function LD(e,t){const n=new Array(t.length),r=t.reduce((i,o,a)=>e.is0(o)?i:(n[a]=i,e.mul(i,o)),e.ONE),s=e.inv(r);return t.reduceRight((i,o,a)=>e.is0(o)?i:(n[a]=e.mul(i,n[a]),e.mul(i,o)),s),n}function yE(e,t){const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function bE(e,t,n=!1,r={}){if(e<=At)throw new Error("invalid field: expected ORDER > 0, got "+e);const{nBitLength:s,nByteLength:i}=yE(e,t);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:e,isLE:n,BITS:s,BYTES:i,MASK:TD(s),ZERO:At,ONE:ot,create:c=>wt(c,e),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return At<=c&&c<e},is0:c=>c===At,isOdd:c=>(c&ot)===ot,neg:c=>wt(-c,e),eql:(c,l)=>c===l,sqr:c=>wt(c*c,e),add:(c,l)=>wt(c+l,e),sub:(c,l)=>wt(c-l,e),mul:(c,l)=>wt(c*l,e),pow:(c,l)=>MD(a,c,l),div:(c,l)=>wt(c*ym(l,e),e),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>ym(c,e),sqrt:r.sqrt||(c=>(o||(o=kD(e)),o(a,c))),invertBatch:c=>LD(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Qf(c,i):mE(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Cu(c):xD(c)}});return Object.freeze(a)}const bm=BigInt(0),Vl=BigInt(1);function xh(e,t){const n=t.negate();return e?n:t}function vE(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Nh(e,t){vE(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1);return{windows:n,windowSize:r}}function jD(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function FD(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const _h=new WeakMap,EE=new WeakMap;function Th(e){return EE.get(e)||1}function HD(e,t){return{constTimeNegate:xh,hasPrecomputes(n){return Th(n)!==1},unsafeLadder(n,r,s=e.ZERO){let i=n;for(;r>bm;)r&Vl&&(s=s.add(i)),i=i.double(),r>>=Vl;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Nh(r,t),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=Nh(n,t);let a=e.ZERO,c=e.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const p=h*o;let f=Number(s&l);s>>=d,f>o&&(f-=u,s+=Vl);const g=p,w=p+Math.abs(f)-1,b=h%2!==0,I=f<0;f===0?c=c.add(xh(b,r[g])):a=a.add(xh(I,r[w]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=e.ZERO){const{windows:o,windowSize:a}=Nh(n,t),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===bm)break;let p=Number(s&c);if(s>>=u,p>a&&(p-=l,s+=Vl),p===0)continue;let f=r[h+Math.abs(p)-1];p<0&&(f=f.negate()),i=i.add(f)}return i},getPrecomputes(n,r,s){let i=_h.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&_h.set(r,s(i))),i},wNAFCached(n,r,s){const i=Th(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Th(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){vE(r,t),EE.set(n,r),_h.delete(n)}}}function zD(e,t,n,r){if(jD(n,e),FD(r,t),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=e.ZERO,i=_D(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((t.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let p=0;p<r.length;p++){const f=r[p],g=Number(f>>BigInt(d)&BigInt(a));c[g]=c[g].add(n[p])}let h=s;for(let p=c.length-1,f=s;p>0;p--)f=f.add(c[p]),h=h.add(f);if(u=u.add(h),d!==0)for(let p=0;p<o;p++)u=u.double()}return u}function qD(e){return BD(e.Fp),Ug(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...yE(e.n,e.nBitLength),...e,p:e.Fp.ORDER})}const Zn=BigInt(0),Jt=BigInt(1),Kl=BigInt(2),WD=BigInt(8),VD={zip215:!0};function KD(e){const t=qD(e);return Ug(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function GD(e){const t=KD(e),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=t,l=Kl<<BigInt(a*8)-Jt,u=n.create,d=bE(t.n,t.nBitLength),h=t.uvRatio||((A,_)=>{try{return{isValid:!0,value:n.sqrt(A*n.inv(_))}}catch{return{isValid:!1,value:Zn}}}),p=t.adjustScalarBytes||(A=>A),f=t.domain||((A,_,k)=>{if(Ih("phflag",k),_.length||k)throw new Error("Contexts/pre-hash are not supported");return A});function g(A,_){_a("coordinate "+A,_,Zn,l)}function w(A){if(!(A instanceof y))throw new Error("ExtendedPoint expected")}const b=gm((A,_)=>{const{ex:k,ey:M,ez:U}=A,P=A.is0();_==null&&(_=P?WD:n.inv(U));const H=u(k*_),Y=u(M*_),J=u(U*_);if(P)return{x:Zn,y:Jt};if(J!==Jt)throw new Error("invZ was invalid");return{x:H,y:Y}}),I=gm(A=>{const{a:_,d:k}=t;if(A.is0())throw new Error("bad point: ZERO");const{ex:M,ey:U,ez:P,et:H}=A,Y=u(M*M),J=u(U*U),K=u(P*P),ne=u(K*K),ue=u(Y*_),_e=u(K*u(ue+J)),Ie=u(ne+u(k*u(Y*J)));if(_e!==Ie)throw new Error("bad point: equation left != right (1)");const be=u(M*U),nt=u(P*H);if(be!==nt)throw new Error("bad point: equation left != right (2)");return!0});class y{constructor(_,k,M,U){this.ex=_,this.ey=k,this.ez=M,this.et=U,g("x",_),g("y",k),g("z",M),g("t",U),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(_){if(_ instanceof y)throw new Error("extended point not allowed");const{x:k,y:M}=_||{};return g("x",k),g("y",M),new y(k,M,Jt,u(k*M))}static normalizeZ(_){const k=n.invertBatch(_.map(M=>M.ez));return _.map((M,U)=>M.toAffine(k[U])).map(y.fromAffine)}static msm(_,k){return zD(y,d,_,k)}_setWindowSize(_){C.setWindowSize(this,_)}assertValidity(){I(this)}equals(_){w(_);const{ex:k,ey:M,ez:U}=this,{ex:P,ey:H,ez:Y}=_,J=u(k*Y),K=u(P*U),ne=u(M*Y),ue=u(H*U);return J===K&&ne===ue}is0(){return this.equals(y.ZERO)}negate(){return new y(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:_}=t,{ex:k,ey:M,ez:U}=this,P=u(k*k),H=u(M*M),Y=u(Kl*u(U*U)),J=u(_*P),K=k+M,ne=u(u(K*K)-P-H),ue=J+H,_e=ue-Y,Ie=J-H,be=u(ne*_e),nt=u(ue*Ie),lt=u(ne*Ie),Br=u(_e*ue);return new y(be,nt,Br,lt)}add(_){w(_);const{a:k,d:M}=t,{ex:U,ey:P,ez:H,et:Y}=this,{ex:J,ey:K,ez:ne,et:ue}=_;if(k===BigInt(-1)){const Il=u((P-U)*(K+J)),Ys=u((P+U)*(K-J)),Zs=u(Ys-Il);if(Zs===Zn)return this.double();const ya=u(H*Kl*ue),ba=u(Y*Kl*ne),Yn=ba+ya,Js=Ys+Il,Sl=ba-ya,xl=u(Yn*Zs),Nl=u(Js*Sl),_l=u(Yn*Sl),jd=u(Zs*Js);return new y(xl,Nl,jd,_l)}const _e=u(U*J),Ie=u(P*K),be=u(Y*M*ue),nt=u(H*ne),lt=u((U+P)*(J+K)-_e-Ie),Br=nt-be,eo=nt+be,Mr=u(Ie-k*_e),to=u(lt*Br),ma=u(eo*Mr),Al=u(lt*Mr),Ld=u(Br*eo);return new y(to,ma,Ld,Al)}subtract(_){return this.add(_.negate())}wNAF(_){return C.wNAFCached(this,_,y.normalizeZ)}multiply(_){const k=_;_a("scalar",k,Jt,r);const{p:M,f:U}=this.wNAF(k);return y.normalizeZ([M,U])[0]}multiplyUnsafe(_,k=y.ZERO){const M=_;return _a("scalar",M,Zn,r),M===Zn?v:this.is0()||M===Jt?this:C.wNAFCachedUnsafe(this,M,y.normalizeZ,k)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return C.unsafeLadder(this,r).is0()}toAffine(_){return b(this,_)}clearCofactor(){const{h:_}=t;return _===Jt?this:this.multiplyUnsafe(_)}static fromHex(_,k=!1){const{d:M,a:U}=t,P=n.BYTES;_=Hr("pointHex",_,P),Ih("zip215",k);const H=_.slice(),Y=_[P-1];H[P-1]=Y&-129;const J=Cu(H),K=k?l:n.ORDER;_a("pointHex.y",J,Zn,K);const ne=u(J*J),ue=u(ne-Jt),_e=u(M*ne-U);let{isValid:Ie,value:be}=h(ue,_e);if(!Ie)throw new Error("Point.fromHex: invalid y coordinate");const nt=(be&Jt)===Jt,lt=(Y&128)!==0;if(!k&&be===Zn&&lt)throw new Error("Point.fromHex: x=0 and x_0=1");return lt!==nt&&(be=u(-be)),y.fromAffine({x:be,y:J})}static fromPrivateKey(_){return S(_).point}toRawBytes(){const{x:_,y:k}=this.toAffine(),M=Qf(k,n.BYTES);return M[M.length-1]|=_&Jt?128:0,M}toHex(){return kg(this.toRawBytes())}}y.BASE=new y(t.Gx,t.Gy,Jt,u(t.Gx*t.Gy)),y.ZERO=new y(Zn,Jt,Jt,Zn);const{BASE:m,ZERO:v}=y,C=HD(y,a*8);function O(A){return wt(A,r)}function D(A){return O(Cu(A))}function S(A){const _=n.BYTES;A=Hr("private key",A,_);const k=Hr("hashed private key",i(A),2*_),M=p(k.slice(0,_)),U=k.slice(_,2*_),P=D(M),H=m.multiply(P),Y=H.toRawBytes();return{head:M,prefix:U,scalar:P,point:H,pointBytes:Y}}function E(A){return S(A).pointBytes}function N(A=new Uint8Array,..._){const k=pm(..._);return D(i(f(k,Hr("context",A),!!s)))}function $(A,_,k={}){A=Hr("message",A),s&&(A=s(A));const{prefix:M,scalar:U,pointBytes:P}=S(_),H=N(k.context,M,A),Y=m.multiply(H).toRawBytes(),J=N(k.context,Y,P,A),K=O(H+J*U);_a("signature.s",K,Zn,r);const ne=pm(Y,Qf(K,n.BYTES));return Hr("result",ne,n.BYTES*2)}const B=VD;function R(A,_,k,M=B){const{context:U,zip215:P}=M,H=n.BYTES;A=Hr("signature",A,2*H),_=Hr("message",_),k=Hr("publicKey",k,H),P!==void 0&&Ih("zip215",P),s&&(_=s(_));const Y=Cu(A.slice(H,2*H));let J,K,ne;try{J=y.fromHex(k,P),K=y.fromHex(A.slice(0,H),P),ne=m.multiplyUnsafe(Y)}catch{return!1}if(!P&&J.isSmallOrder())return!1;const ue=N(U,K.toRawBytes(),J.toRawBytes(),_);return K.add(J.multiplyUnsafe(ue)).subtract(ne).clearCofactor().equals(y.ZERO)}return m._setWindowSize(8),{CURVE:t,getPublicKey:E,sign:$,verify:R,ExtendedPoint:y,utils:{getExtendedPublicKey:S,randomPrivateKey:()=>o(n.BYTES),precompute(A=8,_=y.BASE){return _._setWindowSize(A),_.multiply(BigInt(3)),_}}}}BigInt(0),BigInt(1);const Rg=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),vm=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const YD=BigInt(1),Em=BigInt(2);BigInt(3);const ZD=BigInt(5),JD=BigInt(8);function XD(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Rg,o=e*e%i*e%i,a=wr(o,Em,i)*o%i,c=wr(a,YD,i)*e%i,l=wr(c,ZD,i)*c%i,u=wr(l,t,i)*l%i,d=wr(u,n,i)*u%i,h=wr(d,r,i)*d%i,p=wr(h,s,i)*h%i,f=wr(p,s,i)*h%i,g=wr(f,t,i)*l%i;return{pow_p_5_8:wr(g,Em,i)*e%i,b2:o}}function QD(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function e$(e,t){const n=Rg,r=wt(t*t*t,n),s=wt(r*r*t,n),i=XD(e*s).pow_p_5_8;let o=wt(e*r*i,n);const a=wt(t*o*o,n),c=o,l=wt(o*vm,n),u=a===e,d=a===wt(-e,n),h=a===wt(-e*vm,n);return u&&(o=c),(d||h)&&(o=l),UD(o,n)&&(o=wt(-o,n)),{isValid:u||d,value:o}}const t$=bE(Rg,void 0,!0),n$={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:t$,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:JD,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:AD,randomBytes:hE,adjustScalarBytes:QD,uvRatio:e$},CE=GD(n$),r$="EdDSA",s$="JWT",Wu=".",wd="base64url",AE="utf8",IE="utf8",i$=":",o$="did",a$="key",Cm="base58btc",c$="z",l$="K36",u$=32;function Bg(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function SE(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Bg(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function xE(e,t){t||(t=e.reduce((s,i)=>s+i.length,0));const n=SE(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return Bg(n)}function d$(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=e.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=n[f.charCodeAt(g)];if(m===255)return;for(var v=0,C=I-1;(m!==0||v<b)&&C!==-1;C--,v++)m+=a*y[C]>>>0,y[C]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");b=v,g++}if(f[g]!==" "){for(var O=I-b;O!==I&&y[O]===0;)O++;for(var D=new Uint8Array(w+(I-O)),S=w;O!==I;)D[S++]=y[O++];return D}}}function p(f){var g=h(f);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var h$=d$,f$=h$;const NE=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},p$=e=>new TextEncoder().encode(e),g$=e=>new TextDecoder().decode(e);let w$=class{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},m$=class{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return _E(this,t)}},y$=class{constructor(t){this.decoders=t}or(t){return _E(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const _E=(e,t)=>new y$({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});let b$=class{constructor(t,n,r,s){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new w$(t,n,r),this.decoder=new m$(t,n,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const md=({name:e,prefix:t,encode:n,decode:r})=>new b$(e,t,n,r),ul=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:s}=f$(n,t);return md({prefix:e,name:t,encode:r,decode:i=>NE(s(i))})},v$=(e,t,n,r)=>{const s={};for(let u=0;u<t.length;++u)s[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},E$=(e,t,n)=>{const r=t[t.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,i+=t[s&a>>o];if(o&&(i+=t[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Pt=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>md({prefix:t,name:e,encode(s){return E$(s,r,n)},decode(s){return v$(s,r,n,e)}}),C$=md({prefix:"\0",name:"identity",encode:e=>g$(e),decode:e=>p$(e)});var A$=Object.freeze({__proto__:null,identity:C$});const I$=Pt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var S$=Object.freeze({__proto__:null,base2:I$});const x$=Pt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var N$=Object.freeze({__proto__:null,base8:x$});const _$=ul({prefix:"9",name:"base10",alphabet:"0123456789"});var T$=Object.freeze({__proto__:null,base10:_$});const O$=Pt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),D$=Pt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var $$=Object.freeze({__proto__:null,base16:O$,base16upper:D$});const P$=Pt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),k$=Pt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),U$=Pt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),R$=Pt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),B$=Pt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),M$=Pt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),L$=Pt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),j$=Pt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),F$=Pt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var H$=Object.freeze({__proto__:null,base32:P$,base32upper:k$,base32pad:U$,base32padupper:R$,base32hex:B$,base32hexupper:M$,base32hexpad:L$,base32hexpadupper:j$,base32z:F$});const z$=ul({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),q$=ul({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var W$=Object.freeze({__proto__:null,base36:z$,base36upper:q$});const V$=ul({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),K$=ul({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var G$=Object.freeze({__proto__:null,base58btc:V$,base58flickr:K$});const Y$=Pt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Z$=Pt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),J$=Pt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),X$=Pt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Q$=Object.freeze({__proto__:null,base64:Y$,base64pad:Z$,base64url:J$,base64urlpad:X$});const TE=Array.from(""),eP=TE.reduce((e,t,n)=>(e[n]=t,e),[]),tP=TE.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function nP(e){return e.reduce((t,n)=>(t+=eP[n],t),"")}function rP(e){const t=[];for(const n of e){const r=tP[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const sP=md({prefix:"",name:"base256emoji",encode:nP,decode:rP});var iP=Object.freeze({__proto__:null,base256emoji:sP}),oP=OE,Am=128,aP=-128,cP=Math.pow(2,31);function OE(e,t,n){t=t||[],n=n||0;for(var r=n;e>=cP;)t[n++]=e&255|Am,e/=128;for(;e&aP;)t[n++]=e&255|Am,e>>>=7;return t[n]=e|0,OE.bytes=n-r+1,t}var lP=tp,uP=128,Im=127;function tp(e,r){var n=0,r=r||0,s=0,i=r,o,a=e.length;do{if(i>=a)throw tp.bytes=0,new RangeError("Could not decode varint");o=e[i++],n+=s<28?(o&Im)<<s:(o&Im)*Math.pow(2,s),s+=7}while(o>=uP);return tp.bytes=i-r,n}var dP=Math.pow(2,7),hP=Math.pow(2,14),fP=Math.pow(2,21),pP=Math.pow(2,28),gP=Math.pow(2,35),wP=Math.pow(2,42),mP=Math.pow(2,49),yP=Math.pow(2,56),bP=Math.pow(2,63),vP=function(e){return e<dP?1:e<hP?2:e<fP?3:e<pP?4:e<gP?5:e<wP?6:e<mP?7:e<yP?8:e<bP?9:10},EP={encode:oP,decode:lP,encodingLength:vP},DE=EP;const Sm=(e,t,n=0)=>(DE.encode(e,t,n),t),xm=e=>DE.encodingLength(e),np=(e,t)=>{const n=t.byteLength,r=xm(e),s=r+xm(n),i=new Uint8Array(s+n);return Sm(e,i,0),Sm(n,i,r),i.set(t,s),new CP(e,n,t,i)};let CP=class{constructor(t,n,r,s){this.code=t,this.size=n,this.digest=r,this.bytes=s}};const $E=({name:e,code:t,encode:n})=>new AP(e,t,n);let AP=class{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?np(this.code,n):n.then(r=>np(this.code,r))}else throw Error("Unknown type, must be binary type")}};const PE=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),IP=$E({name:"sha2-256",code:18,encode:PE("SHA-256")}),SP=$E({name:"sha2-512",code:19,encode:PE("SHA-512")});var xP=Object.freeze({__proto__:null,sha256:IP,sha512:SP});const kE=0,NP="identity",UE=NE,_P=e=>np(kE,UE(e)),TP={code:kE,name:NP,encode:UE,digest:_P};var OP=Object.freeze({__proto__:null,identity:TP});new TextEncoder,new TextDecoder;const Nm={...A$,...S$,...N$,...T$,...$$,...H$,...W$,...G$,...Q$,...iP};({...xP,...OP});function RE(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const _m=RE("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Oh=RE("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=SE(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),BE={utf8:_m,"utf-8":_m,hex:Nm.base16,latin1:Oh,ascii:Oh,binary:Oh,...Nm};function yd(e,t="utf8"){const n=BE[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}function la(e,t="utf8"){const n=BE[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Bg(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}function Tm(e){return Mi(yd(la(e,wd),AE))}function Vu(e){return yd(la(ss(e),AE),wd)}function ME(e){const t=la(l$,Cm),n=c$+yd(xE([t,e]),Cm);return[o$,a$,n].join(i$)}function DP(e){return yd(e,wd)}function $P(e){return la(e,wd)}function PP(e){return la([Vu(e.header),Vu(e.payload)].join(Wu),IE)}function kP(e){return[Vu(e.header),Vu(e.payload),DP(e.signature)].join(Wu)}function rp(e){const t=e.split(Wu),n=Tm(t[0]),r=Tm(t[1]),s=$P(t[2]),i=la(t.slice(0,2).join(Wu),IE);return{header:n,payload:r,signature:s,data:i}}function Om(e=hE(u$)){const t=CE.getPublicKey(e);return{secretKey:xE([e,t]),publicKey:t}}async function UP(e,t,n,r,s=Z.fromMiliseconds(Date.now())){const i={alg:r$,typ:s$},o=ME(r.publicKey),a=s+n,c={iss:o,sub:e,aud:t,iat:s,exp:a},l=PP({header:i,payload:c}),u=CE.sign(l,r.secretKey.slice(0,32));return kP({header:i,payload:c,signature:u})}var Dm=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},RP=(function(){function e(t,n,r){this.name=t,this.version=n,this.os=r,this.type="browser"}return e})(),BP=(function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e})(),MP=(function(){function e(t,n,r,s){this.name=t,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return e})(),LP=(function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e})(),jP=(function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e})(),FP=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,HP=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,$m=3,zP=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",FP]],Pm=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function qP(e){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new jP:typeof navigator<"u"?VP(navigator.userAgent):GP()}function WP(e){return e!==""&&zP.reduce(function(t,n){var r=n[0],s=n[1];if(t)return t;var i=s.exec(e);return!!i&&[r,i]},!1)}function VP(e){var t=WP(e);if(!t)return null;var n=t[0],r=t[1];if(n==="searchbot")return new LP;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<$m&&(s=Dm(Dm([],s,!0),YP($m-s.length),!0)):s=[];var i=s.join("."),o=KP(e),a=HP.exec(e);return a&&a[1]?new MP(n,i,o,a[1]):new RP(n,i,o)}function KP(e){for(var t=0,n=Pm.length;t<n;t++){var r=Pm[t],s=r[0],i=r[1],o=i.exec(e);if(o)return s}return null}function GP(){var e=typeof process<"u"&&process.version;return e?new BP(process.version.slice(1)):null}function YP(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}var ze={},km;function LE(){if(km)return ze;km=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.getLocalStorage=ze.getLocalStorageOrThrow=ze.getCrypto=ze.getCryptoOrThrow=ze.getLocation=ze.getLocationOrThrow=ze.getNavigator=ze.getNavigatorOrThrow=ze.getDocument=ze.getDocumentOrThrow=ze.getFromWindowOrThrow=ze.getFromWindow=void 0;function e(h){let p;return typeof window<"u"&&typeof window[h]<"u"&&(p=window[h]),p}ze.getFromWindow=e;function t(h){const p=e(h);if(!p)throw new Error(`${h} is not defined in Window`);return p}ze.getFromWindowOrThrow=t;function n(){return t("document")}ze.getDocumentOrThrow=n;function r(){return e("document")}ze.getDocument=r;function s(){return t("navigator")}ze.getNavigatorOrThrow=s;function i(){return e("navigator")}ze.getNavigator=i;function o(){return t("location")}ze.getLocationOrThrow=o;function a(){return e("location")}ze.getLocation=a;function c(){return t("crypto")}ze.getCryptoOrThrow=c;function l(){return e("crypto")}ze.getCrypto=l;function u(){return t("localStorage")}ze.getLocalStorageOrThrow=u;function d(){return e("localStorage")}return ze.getLocalStorage=d,ze}var is=LE(),Ta={},Um;function ZP(){if(Um)return Ta;Um=1,Object.defineProperty(Ta,"__esModule",{value:!0}),Ta.getWindowMetadata=void 0;const e=LE();function t(){let n,r;try{n=e.getDocumentOrThrow(),r=e.getLocationOrThrow()}catch{return null}function s(){const p=n.getElementsByTagName("link"),f=[];for(let g=0;g<p.length;g++){const w=p[g],b=w.getAttribute("rel");if(b&&b.toLowerCase().indexOf("icon")>-1){const I=w.getAttribute("href");if(I)if(I.toLowerCase().indexOf("https:")===-1&&I.toLowerCase().indexOf("http:")===-1&&I.indexOf("//")!==0){let y=r.protocol+"//"+r.host;if(I.indexOf("/")===0)y+=I;else{const m=r.pathname.split("/");m.pop();const v=m.join("/");y+=v+"/"+I}f.push(y)}else if(I.indexOf("//")===0){const y=r.protocol+I;f.push(y)}else f.push(I)}}return f}function i(...p){const f=n.getElementsByTagName("meta");for(let g=0;g<f.length;g++){const w=f[g],b=["itemprop","property","name"].map(I=>w.getAttribute(I)).filter(I=>I?p.includes(I):!1);if(b.length&&b){const I=w.getAttribute("content");if(I)return I}}return""}function o(){let p=i("name","og:site_name","og:title","twitter:title");return p||(p=n.title),p}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=r.origin,d=s();return{description:l,url:u,icons:d,name:c}}return Ta.getWindowMetadata=t,Ta}var JP=ZP();function Ac(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function sp(e){return Ac(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const jE="2.31.0";let Dh={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:n})=>t?`${e??"https://viem.sh"}${t}${n?`#${n}`:""}`:void 0,version:`viem@${jE}`},bd=class ip extends Error{constructor(t,n={}){const r=n.cause instanceof ip?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof ip&&n.cause.docsPath||n.docsPath,i=Dh.getDocsUrl?.({...n,docsPath:s}),o=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...Dh.version?[`Version: ${Dh.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=t,this.version=jE}walk(t){return FE(this,t)}};function FE(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause!==void 0?FE(e.cause,t):t?null:e}let HE=class extends bd{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};function ua(e,{dir:t,size:n=32}={}){return typeof e=="string"?XP(e,{dir:t,size:n}):QP(e,{dir:t,size:n})}function XP(e,{dir:t,size:n=32}={}){if(n===null)return e;const r=e.replace("0x","");if(r.length>n*2)throw new HE({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function QP(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new HE({size:e.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=t==="right";r[i?s:n-s-1]=e[i?s:e.length-s-1]}return r}let ek=class extends bd{constructor({max:t,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}},tk=class extends bd{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}};function da(e,{size:t}){if(sp(e)>t)throw new tk({givenSize:sp(e),maxSize:t})}function op(e,t={}){const{signed:n}=t;t.size&&da(e,{size:t.size});const r=BigInt(e);if(!n)return r;const s=(e.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function nk(e,t={}){return Number(op(e,t))}const rk=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ap(e,t={}){return typeof e=="number"||typeof e=="bigint"?qE(e,t):typeof e=="string"?ok(e,t):typeof e=="boolean"?sk(e,t):zE(e,t)}function sk(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(da(n,{size:t.size}),ua(n,{size:t.size})):n}function zE(e,t={}){let n="";for(let s=0;s<e.length;s++)n+=rk[e[s]];const r=`0x${n}`;return typeof t.size=="number"?(da(r,{size:t.size}),ua(r,{dir:"right",size:t.size})):r}function qE(e,t={}){const{signed:n,size:r}=t,s=BigInt(e);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof e=="bigint"?"n":"";throw new ek({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${e}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?ua(a,{size:r}):a}const ik=new TextEncoder;function ok(e,t={}){const n=ik.encode(e);return zE(n,t)}const ak=new TextEncoder;function ck(e,t={}){return typeof e=="number"||typeof e=="bigint"?uk(e,t):typeof e=="boolean"?lk(e,t):Ac(e)?WE(e,t):VE(e,t)}function lk(e,t={}){const n=new Uint8Array(1);return n[0]=Number(e),typeof t.size=="number"?(da(n,{size:t.size}),ua(n,{size:t.size})):n}const zr={zero:48,nine:57,A:65,F:70,a:97,f:102};function Rm(e){if(e>=zr.zero&&e<=zr.nine)return e-zr.zero;if(e>=zr.A&&e<=zr.F)return e-(zr.A-10);if(e>=zr.a&&e<=zr.f)return e-(zr.a-10)}function WE(e,t={}){let n=e;t.size&&(da(n,{size:t.size}),n=ua(n,{dir:"right",size:t.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Rm(r.charCodeAt(a++)),l=Rm(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new bd(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function uk(e,t){const n=qE(e,t);return WE(n)}function VE(e,t={}){const n=ak.encode(e);return typeof t.size=="number"?(da(n,{size:t.size}),ua(n,{dir:"right",size:t.size})):n}const Gl=BigInt(2**32-1),Bm=BigInt(32);function dk(e,t=!1){return t?{h:Number(e&Gl),l:Number(e>>Bm&Gl)}:{h:Number(e>>Bm&Gl)|0,l:Number(e&Gl)|0}}function hk(e,t=!1){const n=e.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=dk(e[i],t);[r[i],s[i]]=[o,a]}return[r,s]}const fk=(e,t,n)=>e<<n|t>>>32-n,pk=(e,t,n)=>t<<n|e>>>32-n,gk=(e,t,n)=>t<<n-32|e>>>64-n,wk=(e,t,n)=>e<<n-32|t>>>64-n,co=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function mk(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ku(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function Ic(e,...t){if(!mk(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function uW(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Ku(e.outputLen),Ku(e.blockLen)}function Mm(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function yk(e,t){Ic(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function bk(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function KE(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function dW(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function hW(e,t){return e<<32-t|e>>>t}const vk=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Ek(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function Ck(e){for(let t=0;t<e.length;t++)e[t]=Ek(e[t]);return e}const Lm=vk?e=>e:Ck;function Ak(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function GE(e){return typeof e=="string"&&(e=Ak(e)),Ic(e),e}function fW(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];Ic(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}class Ik{}function Sk(e){const t=r=>e().update(GE(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function pW(e=32){if(co&&typeof co.getRandomValues=="function")return co.getRandomValues(new Uint8Array(e));if(co&&typeof co.randomBytes=="function")return Uint8Array.from(co.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const xk=BigInt(0),Oa=BigInt(1),Nk=BigInt(2),_k=BigInt(7),Tk=BigInt(256),Ok=BigInt(113),YE=[],ZE=[],JE=[];for(let e=0,t=Oa,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],YE.push(2*(5*r+n)),ZE.push((e+1)*(e+2)/2%64);let s=xk;for(let i=0;i<7;i++)t=(t<<Oa^(t>>_k)*Ok)%Tk,t&Nk&&(s^=Oa<<(Oa<<BigInt(i))-Oa);JE.push(s)}const XE=hk(JE,!0),Dk=XE[0],$k=XE[1],jm=(e,t,n)=>n>32?gk(e,t,n):fk(e,t,n),Fm=(e,t,n)=>n>32?wk(e,t,n):pk(e,t,n);function Pk(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=jm(l,u,1)^n[a],h=Fm(l,u,1)^n[a+1];for(let p=0;p<50;p+=10)e[o+p]^=d,e[o+p+1]^=h}let s=e[2],i=e[3];for(let o=0;o<24;o++){const a=ZE[o],c=jm(s,i,a),l=Fm(s,i,a),u=YE[o];s=e[u],i=e[u+1],e[u]=c,e[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=Dk[r],e[1]^=$k[r]}KE(n)}class Mg extends Ik{constructor(t,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Ku(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=bk(this.state)}clone(){return this._cloneInto()}keccak(){Lm(this.state32),Pk(this.state32,this.rounds),Lm(this.state32),this.posOut=0,this.pos=0}update(t){Mm(this),t=GE(t),Ic(t);const{blockLen:n,state:r}=this,s=t.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=t[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){Mm(this,!1),Ic(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=t.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return Ku(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(yk(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,KE(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return t||(t=new Mg(n,r,s,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}}const kk=(e,t,n)=>Sk(()=>new Mg(t,e,n)),Uk=kk(1,136,256/8);function QE(e,t){const n=t||"hex",r=Uk(Ac(e,{strict:!1})?ck(e):e);return n==="bytes"?r:ap(r)}let Rk=class extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const $h=new Rk(8192);function Bk(e,t){if($h.has(`${e}.${t}`))return $h.get(`${e}.${t}`);const n=e.substring(2).toLowerCase(),r=QE(VE(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return $h.set(`${e}.${t}`,i),i}function Mk(e){const t=QE(`0x${e.substring(4)}`).substring(26);return Bk(`0x${t}`)}async function Lk({hash:e,signature:t}){const n=Ac(e)?e:ap(e),{secp256k1:r}=await pc(async()=>{const{secp256k1:o}=await import("./secp256k1-DH7KP57t.js");return{secp256k1:o}},[]);return`0x${(()=>{if(typeof t=="object"&&"r"in t&&"s"in t){const{r:l,s:u,v:d,yParity:h}=t,p=Number(h??d),f=Hm(p);return new r.Signature(op(l),op(u)).addRecoveryBit(f)}const o=Ac(t)?t:ap(t);if(sp(o)!==65)throw new Error("invalid signature length");const a=nk(`0x${o.slice(130)}`),c=Hm(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function Hm(e){if(e===0||e===1)return e;if(e===27)return 0;if(e===28)return 1;throw new Error("Invalid yParityOrV value")}async function jk({hash:e,signature:t}){return Mk(await Lk({hash:e,signature:t}))}function Fk(e){if(e.length>=255)throw new TypeError("Alphabet too long");const t=new Uint8Array(256);for(let l=0;l<t.length;l++)t[l]=255;for(let l=0;l<e.length;l++){const u=e.charAt(l),d=u.charCodeAt(0);if(t[d]!==255)throw new TypeError(u+" is ambiguous");t[d]=l}const n=e.length,r=e.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const p=l.length;for(;h!==p&&l[h]===0;)h++,u++;const f=(p-h)*i+1>>>0,g=new Uint8Array(f);for(;h!==p;){let I=l[h],y=0;for(let m=f-1;(I!==0||y<d)&&m!==-1;m--,y++)I+=256*g[m]>>>0,g[m]=I%n>>>0,I=I/n>>>0;if(I!==0)throw new Error("Non-zero carry");d=y,h++}let w=f-d;for(;w!==f&&g[w]===0;)w++;let b=r.repeat(u);for(;w<f;++w)b+=e.charAt(g[w]);return b}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const p=(l.length-u)*s+1>>>0,f=new Uint8Array(p);for(;u<l.length;){const I=l.charCodeAt(u);if(I>255)return;let y=t[I];if(y===255)return;let m=0;for(let v=p-1;(y!==0||m<h)&&v!==-1;v--,m++)y+=n*f[v]>>>0,f[v]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");h=m,u++}let g=p-h;for(;g!==p&&f[g]===0;)g++;const w=new Uint8Array(d+(p-g));let b=d;for(;g!==p;)w[b++]=f[g++];return w}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var Hk="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const ha=Fk(Hk);function zk(e){const t=e.length;let n=0,r=0;for(;r<t;){let s=e.charCodeAt(r++);if((s&4294967168)===0){n++;continue}else if((s&4294965248)===0)n+=2;else{if(s>=55296&&s<=56319&&r<t){const i=e.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?n+=3:n+=4}}return n}function qk(e,t,n){const r=e.length;let s=n,i=0;for(;i<r;){let o=e.charCodeAt(i++);if((o&4294967168)===0){t[s++]=o;continue}else if((o&4294965248)===0)t[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=e.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(t[s++]=o>>12&15|224,t[s++]=o>>6&63|128):(t[s++]=o>>18&7|240,t[s++]=o>>12&63|128,t[s++]=o>>6&63|128)}t[s++]=o&63|128}}const Wk=new TextEncoder,Vk=50;function Kk(e,t,n){Wk.encodeInto(e,t.subarray(n))}function Gk(e,t,n){e.length>Vk?Kk(e,t,n):qk(e,t,n)}const Yk=4096;function eC(e,t,n){let r=t;const s=r+n,i=[];let o="";for(;r<s;){const a=e[r++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=e[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=e[r++]&63,l=e[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=e[r++]&63,l=e[r++]&63,u=e[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=Yk&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const Zk=new TextDecoder,Jk=200;function Xk(e,t,n){const r=e.subarray(t,t+n);return Zk.decode(r)}function Qk(e,t,n){return n>Jk?Xk(e,t,n):eC(e,t,n)}class Yl{constructor(t,n){this.type=t,this.data=n}}class Cn extends Error{constructor(t){super(t);const n=Object.create(Cn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Cn.name})}}const Da=4294967295;function e8(e,t,n){const r=n/4294967296,s=n;e.setUint32(t,r),e.setUint32(t+4,s)}function tC(e,t,n){const r=Math.floor(n/4294967296),s=n;e.setUint32(t,r),e.setUint32(t+4,s)}function nC(e,t){const n=e.getInt32(t),r=e.getUint32(t+4);return n*4294967296+r}function t8(e,t){const n=e.getUint32(t),r=e.getUint32(t+4);return n*4294967296+r}const n8=-1,r8=4294967296-1,s8=17179869184-1;function i8({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=s8)if(t===0&&e<=r8){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e),n}else{const n=e/4294967296,r=e&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,t<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,t),tC(r,4,e),n}}function o8(e){const t=e.getTime(),n=Math.floor(t/1e3),r=(t-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function a8(e){if(e instanceof Date){const t=o8(e);return i8(t)}else return null}function c8(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{const n=t.getUint32(0),r=t.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=nC(t,4),r=t.getUint32(0);return{sec:n,nsec:r}}default:throw new Cn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}function l8(e){const t=c8(e);return new Date(t.sec*1e3+t.nsec/1e6)}const u8={type:n8,encode:a8,decode:l8};class Gu{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(u8)}register({type:t,encode:n,decode:r}){if(t>=0)this.encoders[t]=n,this.decoders[t]=r;else{const s=-1-t;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(t,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(t,n);if(i!=null){const o=-1-r;return new Yl(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(t,n);if(i!=null){const o=r;return new Yl(o,i)}}}return t instanceof Yl?t:null}decode(t,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(t,n,r):new Yl(n,t)}}Gu.defaultCodec=new Gu;function d8(e){return e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer}function cp(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):d8(e)?new Uint8Array(e):Uint8Array.from(e)}const h8=100,f8=2048;let p8=class rC{constructor(t){this.entered=!1,this.extensionCodec=t?.extensionCodec??Gu.defaultCodec,this.context=t?.context,this.useBigInt64=t?.useBigInt64??!1,this.maxDepth=t?.maxDepth??h8,this.initialBufferSize=t?.initialBufferSize??f8,this.sortKeys=t?.sortKeys??!1,this.forceFloat32=t?.forceFloat32??!1,this.ignoreUndefined=t?.ignoreUndefined??!1,this.forceIntegerToFloat=t?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new rC({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(t){if(this.entered)return this.clone().encodeSharedRef(t);try{return this.entered=!0,this.reinitializeState(),this.doEncode(t,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(t){if(this.entered)return this.clone().encode(t);try{return this.entered=!0,this.reinitializeState(),this.doEncode(t,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(t,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);t==null?this.encodeNil():typeof t=="boolean"?this.encodeBoolean(t):typeof t=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(t):this.encodeNumber(t):typeof t=="string"?this.encodeString(t):this.useBigInt64&&typeof t=="bigint"?this.encodeBigInt64(t):this.encodeObject(t,n)}ensureBufferSizeToWrite(t){const n=this.pos+t;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(t){const n=new ArrayBuffer(t),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(t){t===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(t){!this.forceIntegerToFloat&&Number.isSafeInteger(t)?t>=0?t<128?this.writeU8(t):t<256?(this.writeU8(204),this.writeU8(t)):t<65536?(this.writeU8(205),this.writeU16(t)):t<4294967296?(this.writeU8(206),this.writeU32(t)):this.useBigInt64?this.encodeNumberAsFloat(t):(this.writeU8(207),this.writeU64(t)):t>=-32?this.writeU8(224|t+32):t>=-128?(this.writeU8(208),this.writeI8(t)):t>=-32768?(this.writeU8(209),this.writeI16(t)):t>=-2147483648?(this.writeU8(210),this.writeI32(t)):this.useBigInt64?this.encodeNumberAsFloat(t):(this.writeU8(211),this.writeI64(t)):this.encodeNumberAsFloat(t)}encodeNumberAsFloat(t){this.forceFloat32?(this.writeU8(202),this.writeF32(t)):(this.writeU8(203),this.writeF64(t))}encodeBigInt64(t){t>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(t)):(this.writeU8(211),this.writeBigInt64(t))}writeStringHeader(t){if(t<32)this.writeU8(160+t);else if(t<256)this.writeU8(217),this.writeU8(t);else if(t<65536)this.writeU8(218),this.writeU16(t);else if(t<4294967296)this.writeU8(219),this.writeU32(t);else throw new Error(`Too long string: ${t} bytes in UTF-8`)}encodeString(t){const r=zk(t);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),Gk(t,this.bytes,this.pos),this.pos+=r}encodeObject(t,n){const r=this.extensionCodec.tryToEncode(t,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(t))this.encodeArray(t,n);else if(ArrayBuffer.isView(t))this.encodeBinary(t);else if(typeof t=="object")this.encodeMap(t,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(t)}`)}encodeBinary(t){const n=t.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=cp(t);this.writeU8a(r)}encodeArray(t,n){const r=t.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of t)this.doEncode(s,n+1)}countWithoutUndefined(t,n){let r=0;for(const s of n)t[s]!==void 0&&r++;return r}encodeMap(t,n){const r=Object.keys(t);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(t,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=t[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(t){if(typeof t.data=="function"){const r=t.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(t.type),this.writeU8a(r);return}const n=t.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(t.type),this.writeU8a(t.data)}writeU8(t){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,t),this.pos++}writeU8a(t){const n=t.length;this.ensureBufferSizeToWrite(n),this.bytes.set(t,this.pos),this.pos+=n}writeI8(t){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,t),this.pos++}writeU16(t){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,t),this.pos+=2}writeI16(t){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,t),this.pos+=2}writeU32(t){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,t),this.pos+=4}writeI32(t){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,t),this.pos+=4}writeF32(t){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,t),this.pos+=4}writeF64(t){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,t),this.pos+=8}writeU64(t){this.ensureBufferSizeToWrite(8),e8(this.view,this.pos,t),this.pos+=8}writeI64(t){this.ensureBufferSizeToWrite(8),tC(this.view,this.pos,t),this.pos+=8}writeBigUint64(t){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,t),this.pos+=8}writeBigInt64(t){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,t),this.pos+=8}};function g8(e,t){return new p8(t).encodeSharedRef(e)}function Ph(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}const w8=16,m8=16;class y8{constructor(t=w8,n=m8){this.hit=0,this.miss=0,this.maxKeyLength=t,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(t){return t>0&&t<=this.maxKeyLength}find(t,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==t[n+a])continue e;return i.str}return null}store(t,n){const r=this.caches[t.length-1],s={bytes:t,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(t,n,r){const s=this.find(t,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=eC(t,n,r),o=Uint8Array.prototype.slice.call(t,n,n+r);return this.store(o,i),i}}const lp="array",Qa="map_key",sC="map_value",b8=e=>{if(typeof e=="string"||typeof e=="number")return e;throw new Cn("The type of key must be string or number but "+typeof e)};class v8{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(t){const n=this.getUninitializedStateFromPool();n.type=lp,n.position=0,n.size=t,n.array=new Array(t)}pushMapState(t){const n=this.getUninitializedStateFromPool();n.type=Qa,n.readCount=0,n.size=t,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const t={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(t)}return this.stack[this.stackHeadPosition]}release(t){if(this.stack[this.stackHeadPosition]!==t)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(t.type===lp){const r=t;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(t.type===Qa||t.type===sC){const r=t;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const $a=-1,Lg=new DataView(new ArrayBuffer(0)),E8=new Uint8Array(Lg.buffer);try{Lg.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const zm=new RangeError("Insufficient data"),C8=new y8;let A8=class iC{constructor(t){this.totalPos=0,this.pos=0,this.view=Lg,this.bytes=E8,this.headByte=$a,this.stack=new v8,this.entered=!1,this.extensionCodec=t?.extensionCodec??Gu.defaultCodec,this.context=t?.context,this.useBigInt64=t?.useBigInt64??!1,this.rawStrings=t?.rawStrings??!1,this.maxStrLength=t?.maxStrLength??Da,this.maxBinLength=t?.maxBinLength??Da,this.maxArrayLength=t?.maxArrayLength??Da,this.maxMapLength=t?.maxMapLength??Da,this.maxExtLength=t?.maxExtLength??Da,this.keyDecoder=t?.keyDecoder!==void 0?t.keyDecoder:C8,this.mapKeyConverter=t?.mapKeyConverter??b8}clone(){return new iC({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=$a,this.stack.reset()}setBuffer(t){const n=cp(t);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(t){if(this.headByte===$a&&!this.hasRemaining(1))this.setBuffer(t);else{const n=this.bytes.subarray(this.pos),r=cp(t),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(t){return this.view.byteLength-this.pos>=t}createExtraByteError(t){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${t}]`)}decode(t){if(this.entered)return this.clone().decode(t);try{this.entered=!0,this.reinitializeState(),this.setBuffer(t);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(t){if(this.entered){yield*this.clone().decodeMulti(t);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(t);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(t){if(this.entered)return this.clone().decodeAsync(t);try{this.entered=!0;let n=!1,r;for await(const a of t){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Ph(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(t){return this.decodeMultiAsync(t,!0)}decodeStream(t){return this.decodeMultiAsync(t,!1)}async*decodeMultiAsync(t,n){if(this.entered){yield*this.clone().decodeMultiAsync(t,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of t){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const t=this.readHeadByte();let n;if(t>=224)n=t-256;else if(t<192)if(t<128)n=t;else if(t<144){const s=t-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(t<160){const s=t-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=t-160;n=this.decodeString(s,0)}else if(t===192)n=null;else if(t===194)n=!1;else if(t===195)n=!0;else if(t===202)n=this.readF32();else if(t===203)n=this.readF64();else if(t===204)n=this.readU8();else if(t===205)n=this.readU16();else if(t===206)n=this.readU32();else if(t===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(t===208)n=this.readI8();else if(t===209)n=this.readI16();else if(t===210)n=this.readI32();else if(t===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(t===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(t===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(t===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(t===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(t===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(t===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(t===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(t===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(t===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(t===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(t===212)n=this.decodeExtension(1,0);else if(t===213)n=this.decodeExtension(2,0);else if(t===214)n=this.decodeExtension(4,0);else if(t===215)n=this.decodeExtension(8,0);else if(t===216)n=this.decodeExtension(16,0);else if(t===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(t===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(t===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new Cn(`Unrecognized type byte: ${Ph(t)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===lp)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===Qa){if(n==="__proto__")throw new Cn("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=sC;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=Qa;continue e}}return n}}readHeadByte(){return this.headByte===$a&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=$a}readArraySize(){const t=this.readHeadByte();switch(t){case 220:return this.readU16();case 221:return this.readU32();default:{if(t<160)return t-144;throw new Cn(`Unrecognized array type byte: ${Ph(t)}`)}}}pushMapState(t){if(t>this.maxMapLength)throw new Cn(`Max length exceeded: map length (${t}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(t)}pushArrayState(t){if(t>this.maxArrayLength)throw new Cn(`Max length exceeded: array length (${t}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(t)}decodeString(t,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(t,n):this.decodeBinary(t,n)}decodeUtf8String(t,n){if(t>this.maxStrLength)throw new Cn(`Max length exceeded: UTF-8 byte length (${t}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+t)throw zm;const r=this.pos+n;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(t)?s=this.keyDecoder.decode(this.bytes,r,t):s=Qk(this.bytes,r,t),this.pos+=n+t,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Qa:!1}decodeBinary(t,n){if(t>this.maxBinLength)throw new Cn(`Max length exceeded: bin length (${t}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(t+n))throw zm;const r=this.pos+n,s=this.bytes.subarray(r,r+t);return this.pos+=n+t,s}decodeExtension(t,n){if(t>this.maxExtLength)throw new Cn(`Max length exceeded: ext length (${t}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(t,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const t=this.view.getUint8(this.pos);return this.pos++,t}readI8(){const t=this.view.getInt8(this.pos);return this.pos++,t}readU16(){const t=this.view.getUint16(this.pos);return this.pos+=2,t}readI16(){const t=this.view.getInt16(this.pos);return this.pos+=2,t}readU32(){const t=this.view.getUint32(this.pos);return this.pos+=4,t}readI32(){const t=this.view.getInt32(this.pos);return this.pos+=4,t}readU64(){const t=t8(this.view,this.pos);return this.pos+=8,t}readI64(){const t=nC(this.view,this.pos);return this.pos+=8,t}readU64AsBigInt(){const t=this.view.getBigUint64(this.pos);return this.pos+=8,t}readI64AsBigInt(){const t=this.view.getBigInt64(this.pos);return this.pos+=8,t}readF32(){const t=this.view.getFloat32(this.pos);return this.pos+=4,t}readF64(){const t=this.view.getFloat64(this.pos);return this.pos+=8,t}};function I8(e,t){return new A8(t).decode(e)}function jg(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function oC(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?jg(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ec(e,t){t||(t=e.reduce((s,i)=>s+i.length,0));const n=oC(t);let r=0;for(const s of e)n.set(s,r),r+=s.length;return jg(n)}function S8(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=e.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=n[f.charCodeAt(g)];if(m===255)return;for(var v=0,C=I-1;(m!==0||v<b)&&C!==-1;C--,v++)m+=a*y[C]>>>0,y[C]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");b=v,g++}if(f[g]!==" "){for(var O=I-b;O!==I&&y[O]===0;)O++;for(var D=new Uint8Array(w+(I-O)),S=w;O!==I;)D[S++]=y[O++];return D}}}function p(f){var g=h(f);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var x8=S8,N8=x8;const _8=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},T8=e=>new TextEncoder().encode(e),O8=e=>new TextDecoder().decode(e);class D8{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class $8{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return aC(this,t)}}class P8{constructor(t){this.decoders=t}or(t){return aC(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const aC=(e,t)=>new P8({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class k8{constructor(t,n,r,s){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new D8(t,n,r),this.decoder=new $8(t,n,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const vd=({name:e,prefix:t,encode:n,decode:r})=>new k8(e,t,n,r),dl=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:s}=N8(n,t);return vd({prefix:e,name:t,encode:r,decode:i=>_8(s(i))})},U8=(e,t,n,r)=>{const s={};for(let u=0;u<t.length;++u)s[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},R8=(e,t,n)=>{const r=t[t.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,i+=t[s&a>>o];if(o&&(i+=t[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},kt=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>vd({prefix:t,name:e,encode(s){return R8(s,r,n)},decode(s){return U8(s,r,n,e)}}),B8=vd({prefix:"\0",name:"identity",encode:e=>O8(e),decode:e=>T8(e)}),M8=Object.freeze(Object.defineProperty({__proto__:null,identity:B8},Symbol.toStringTag,{value:"Module"})),L8=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),j8=Object.freeze(Object.defineProperty({__proto__:null,base2:L8},Symbol.toStringTag,{value:"Module"})),F8=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),H8=Object.freeze(Object.defineProperty({__proto__:null,base8:F8},Symbol.toStringTag,{value:"Module"})),z8=dl({prefix:"9",name:"base10",alphabet:"0123456789"}),q8=Object.freeze(Object.defineProperty({__proto__:null,base10:z8},Symbol.toStringTag,{value:"Module"})),W8=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),V8=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),K8=Object.freeze(Object.defineProperty({__proto__:null,base16:W8,base16upper:V8},Symbol.toStringTag,{value:"Module"})),G8=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Y8=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Z8=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),J8=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),X8=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Q8=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),e4=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),t4=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),n4=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),r4=Object.freeze(Object.defineProperty({__proto__:null,base32:G8,base32hex:X8,base32hexpad:e4,base32hexpadupper:t4,base32hexupper:Q8,base32pad:Z8,base32padupper:J8,base32upper:Y8,base32z:n4},Symbol.toStringTag,{value:"Module"})),s4=dl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),i4=dl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),o4=Object.freeze(Object.defineProperty({__proto__:null,base36:s4,base36upper:i4},Symbol.toStringTag,{value:"Module"})),a4=dl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),c4=dl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),l4=Object.freeze(Object.defineProperty({__proto__:null,base58btc:a4,base58flickr:c4},Symbol.toStringTag,{value:"Module"})),u4=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),d4=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),h4=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),f4=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),p4=Object.freeze(Object.defineProperty({__proto__:null,base64:u4,base64pad:d4,base64url:h4,base64urlpad:f4},Symbol.toStringTag,{value:"Module"})),cC=Array.from(""),g4=cC.reduce((e,t,n)=>(e[n]=t,e),[]),w4=cC.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function m4(e){return e.reduce((t,n)=>(t+=g4[n],t),"")}function y4(e){const t=[];for(const n of e){const r=w4[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const b4=vd({prefix:"",name:"base256emoji",encode:m4,decode:y4}),v4=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:b4},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const qm={...M8,...j8,...H8,...q8,...K8,...r4,...o4,...l4,...p4,...v4};function lC(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const Wm=lC("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),kh=lC("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=oC(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),uC={utf8:Wm,"utf-8":Wm,hex:qm.base16,latin1:kh,ascii:kh,binary:kh,...qm};function zn(e,t="utf8"){const n=uC[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?jg(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}function dn(e,t="utf8"){const n=uC[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):n.encoder.encode(e).substring(1)}const E4={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Uh,Vm;function dC(){if(Vm)return Uh;Vm=1;const e="Input must be an string, Buffer or Uint8Array";function t(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(e);return a}function n(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function r(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=r(a[u]).toUpperCase(),l+=" ",l+=r(a[u+1]).toUpperCase();else if(c===64)l+=r(a[u+1]).toUpperCase(),l+=r(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let h=0;h<a;h++)u[h]=h%256;const d=new Date().getTime();console.log("Generated random input in "+(d-l)+"ms"),l=d;for(let h=0;h<c;h++){const p=o(u),f=new Date().getTime(),g=f-l;l=f,console.log("Hashed in "+g+"ms: "+p.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Uh={normalizeInput:t,toHex:n,debugPrint:s,testSpeed:i},Uh}var Rh,Km;function C4(){if(Km)return Rh;Km=1;const e=dC();function t(b,I,y){const m=b[I]+b[y];let v=b[I+1]+b[y+1];m>=4294967296&&v++,b[I]=m,b[I+1]=v}function n(b,I,y,m){let v=b[I]+y;y<0&&(v+=4294967296);let C=b[I+1]+m;v>=4294967296&&C++,b[I]=v,b[I+1]=C}function r(b,I){return b[I]^b[I+1]<<8^b[I+2]<<16^b[I+3]<<24}function s(b,I,y,m,v,C){const O=l[v],D=l[v+1],S=l[C],E=l[C+1];t(c,b,I),n(c,b,O,D);let N=c[m]^c[b],$=c[m+1]^c[b+1];c[m]=$,c[m+1]=N,t(c,y,m),N=c[I]^c[y],$=c[I+1]^c[y+1],c[I]=N>>>24^$<<8,c[I+1]=$>>>24^N<<8,t(c,b,I),n(c,b,S,E),N=c[m]^c[b],$=c[m+1]^c[b+1],c[m]=N>>>16^$<<16,c[m+1]=$>>>16^N<<16,t(c,y,m),N=c[I]^c[y],$=c[I+1]^c[y+1],c[I]=$>>>31^N<<1,c[I+1]=N>>>31^$<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(b){return b*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(b,I){let y=0;for(y=0;y<16;y++)c[y]=b.h[y],c[y+16]=i[y];for(c[24]=c[24]^b.t,c[25]=c[25]^b.t/4294967296,I&&(c[28]=~c[28],c[29]=~c[29]),y=0;y<32;y++)l[y]=r(b.b,4*y);for(y=0;y<12;y++)s(0,8,16,24,a[y*16+0],a[y*16+1]),s(2,10,18,26,a[y*16+2],a[y*16+3]),s(4,12,20,28,a[y*16+4],a[y*16+5]),s(6,14,22,30,a[y*16+6],a[y*16+7]),s(0,10,20,30,a[y*16+8],a[y*16+9]),s(2,12,22,24,a[y*16+10],a[y*16+11]),s(4,14,16,26,a[y*16+12],a[y*16+13]),s(6,8,18,28,a[y*16+14],a[y*16+15]);for(y=0;y<16;y++)b.h[y]=b.h[y]^c[y]^c[y+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function h(b,I,y,m){if(b===0||b>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(I&&I.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(y&&y.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(m&&m.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const v={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:b};d.fill(0),d[0]=b,I&&(d[1]=I.length),d[2]=1,d[3]=1,y&&d.set(y,32),m&&d.set(m,48);for(let C=0;C<16;C++)v.h[C]=i[C]^r(d,C*4);return I&&(p(v,I),v.c=128),v}function p(b,I){for(let y=0;y<I.length;y++)b.c===128&&(b.t+=b.c,u(b,!1),b.c=0),b.b[b.c++]=I[y]}function f(b){for(b.t+=b.c;b.c<128;)b.b[b.c++]=0;u(b,!0);const I=new Uint8Array(b.outlen);for(let y=0;y<b.outlen;y++)I[y]=b.h[y>>2]>>8*(y&3);return I}function g(b,I,y,m,v){y=y||64,b=e.normalizeInput(b),m&&(m=e.normalizeInput(m)),v&&(v=e.normalizeInput(v));const C=h(y,I,m,v);return p(C,b),f(C)}function w(b,I,y,m,v){const C=g(b,I,y,m,v);return e.toHex(C)}return Rh={blake2b:g,blake2bHex:w,blake2bInit:h,blake2bUpdate:p,blake2bFinal:f},Rh}var Bh,Gm;function A4(){if(Gm)return Bh;Gm=1;const e=dC();function t(f,g){return f[g]^f[g+1]<<8^f[g+2]<<16^f[g+3]<<24}function n(f,g,w,b,I,y){o[f]=o[f]+o[g]+I,o[b]=r(o[b]^o[f],16),o[w]=o[w]+o[b],o[g]=r(o[g]^o[w],12),o[f]=o[f]+o[g]+y,o[b]=r(o[b]^o[f],8),o[w]=o[w]+o[b],o[g]=r(o[g]^o[w],7)}function r(f,g){return f>>>g^f<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(f,g){let w=0;for(w=0;w<8;w++)o[w]=f.h[w],o[w+8]=s[w];for(o[12]^=f.t,o[13]^=f.t/4294967296,g&&(o[14]=~o[14]),w=0;w<16;w++)a[w]=t(f.b,4*w);for(w=0;w<10;w++)n(0,4,8,12,a[i[w*16+0]],a[i[w*16+1]]),n(1,5,9,13,a[i[w*16+2]],a[i[w*16+3]]),n(2,6,10,14,a[i[w*16+4]],a[i[w*16+5]]),n(3,7,11,15,a[i[w*16+6]],a[i[w*16+7]]),n(0,5,10,15,a[i[w*16+8]],a[i[w*16+9]]),n(1,6,11,12,a[i[w*16+10]],a[i[w*16+11]]),n(2,7,8,13,a[i[w*16+12]],a[i[w*16+13]]),n(3,4,9,14,a[i[w*16+14]],a[i[w*16+15]]);for(w=0;w<8;w++)f.h[w]^=o[w]^o[w+8]}function l(f,g){if(!(f>0&&f<=32))throw new Error("Incorrect output length, should be in [1, 32]");const w=g?g.length:0;if(g&&!(w>0&&w<=32))throw new Error("Incorrect key length, should be in [1, 32]");const b={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:f};return b.h[0]^=16842752^w<<8^f,w>0&&(u(b,g),b.c=64),b}function u(f,g){for(let w=0;w<g.length;w++)f.c===64&&(f.t+=f.c,c(f,!1),f.c=0),f.b[f.c++]=g[w]}function d(f){for(f.t+=f.c;f.c<64;)f.b[f.c++]=0;c(f,!0);const g=new Uint8Array(f.outlen);for(let w=0;w<f.outlen;w++)g[w]=f.h[w>>2]>>8*(w&3)&255;return g}function h(f,g,w){w=w||32,f=e.normalizeInput(f);const b=l(w,g);return u(b,f),d(b)}function p(f,g,w){const b=h(f,g,w);return e.toHex(b)}return Bh={blake2s:h,blake2sHex:p,blake2sInit:l,blake2sUpdate:u,blake2sFinal:d},Bh}var Mh,Ym;function I4(){if(Ym)return Mh;Ym=1;const e=C4(),t=A4();return Mh={blake2b:e.blake2b,blake2bHex:e.blake2bHex,blake2bInit:e.blake2bInit,blake2bUpdate:e.blake2bUpdate,blake2bFinal:e.blake2bFinal,blake2s:t.blake2s,blake2sHex:t.blake2sHex,blake2sInit:t.blake2sInit,blake2sUpdate:t.blake2sUpdate,blake2sFinal:t.blake2sFinal},Mh}var S4=I4(),x4={};const N4=":";function Fo(e){const[t,n]=e.split(N4);return{namespace:t,reference:n}}function hC(e,t){return e.includes(":")?[e]:t.chains||[]}var _4=Object.defineProperty,T4=Object.defineProperties,O4=Object.getOwnPropertyDescriptors,Zm=Object.getOwnPropertySymbols,D4=Object.prototype.hasOwnProperty,$4=Object.prototype.propertyIsEnumerable,up=(e,t,n)=>t in e?_4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Jm=(e,t)=>{for(var n in t||(t={}))D4.call(t,n)&&up(e,n,t[n]);if(Zm)for(var n of Zm(t))$4.call(t,n)&&up(e,n,t[n]);return e},P4=(e,t)=>T4(e,O4(t)),Xm=(e,t,n)=>up(e,typeof t!="symbol"?t+"":t,n);const k4="ReactNative",Nn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},U4="js";function Yu(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Gs(){return!is.getDocument()&&!!is.getNavigator()&&navigator.product===k4}function R4(){return Gs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function B4(){return Gs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function fa(){return!Yu()&&!!is.getNavigator()&&!!is.getDocument()}function hl(){return Gs()?Nn.reactNative:Yu()?Nn.node:fa()?Nn.browser:Nn.unknown}function Qm(){var e;try{return Gs()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(e=global.Application)==null?void 0:e.applicationId:void 0}catch{return}}function M4(e,t){const n=new URLSearchParams(e);for(const r of Object.keys(t).sort())if(t.hasOwnProperty(r)){const s=t[r];s!==void 0&&n.set(r,s)}return n.toString()}function L4(e){var t,n;const r=fC();try{return e!=null&&e.url&&r.url&&new URL(e.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),e.url=r.url),(t=e?.icons)!=null&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(s=>s!=="")),P4(Jm(Jm({},r),e),{url:e?.url||r.url,name:e?.name||r.name,description:e?.description||r.description,icons:(n=e?.icons)!=null&&n.length&&e.icons.length>0?e.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),e||r}}function fC(){return JP.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function j4(){if(hl()===Nn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const e=qP();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function F4(){var e;const t=hl();return t===Nn.browser?[t,((e=is.getLocation())==null?void 0:e.host)||"unknown"].join(":"):t}function pC(e,t,n){const r=j4(),s=F4();return[[e,t].join("-"),[U4,n].join("-"),r,s].join("/")}function H4({protocol:e,version:t,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=pC(e,t,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=M4(l[1]||"",d);return l[0]+"?"+h}function Ei(e,t){return e.filter(n=>t.includes(n)).length===e.length}function dp(e){return Object.fromEntries(e.entries())}function hp(e){return new Map(Object.entries(e))}function di(e=Z.FIVE_MINUTES,t){const n=Z.toMiliseconds(e||Z.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(t);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function Ps(e,t,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),t);try{const o=await e;r(o)}catch(o){s(o)}clearTimeout(i)})}function gC(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function z4(e){return gC("topic",e)}function q4(e){return gC("id",e)}function wC(e){const[t,n]=e.split(":"),r={id:void 0,topic:void 0};if(t==="topic"&&typeof n=="string")r.topic=n;else if(t==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${n}`);return r}function gt(e,t){return Z.fromMiliseconds(Date.now()+Z.toMiliseconds(e))}function Is(e){return Date.now()>=Z.toMiliseconds(e)}function Re(e,t){return`${e}${t?`:${t}`:""}`}function Or(e=[],t=[]){return[...new Set([...e,...t])]}async function W4({id:e,topic:t,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s?.href;if(typeof i!="string")return;const o=V4(i,e,t),a=hl();if(a===Nn.browser){if(!((r=is.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}K4(o)}else a===Nn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function V4(e,t,n){const r=`requestId=${t}&sessionTopic=${n}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){const i=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${J4(r,!0)}`}else s=`${s}/wc?${r}`;return s}function K4(e){let t="_self";Z4()?t="_top":(Y4()||e.startsWith("https://")||e.startsWith("http://"))&&(t="_blank"),window.open(e,t,"noreferrer noopener")}async function G4(e,t){let n="";try{if(fa()&&(n=localStorage.getItem(t),n))return n;n=await e.getItem(t)}catch(r){console.error(r)}return n}function ey(e,t){if(!e.includes(t))return null;const n=e.split(/([&,?,=])/),r=n.indexOf(t);return n[r+2]}function ty(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function Fg(){return typeof process<"u"&&x4.IS_VITEST==="true"}function Y4(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function Z4(){try{return window.self!==window.top}catch{return!1}}function J4(e,t=!1){const n=Buffer.from(e).toString("base64");return t?n.replace(/[=]/g,""):n}function mC(e){return Buffer.from(e,"base64").toString("utf-8")}function X4(e){return new Promise(t=>setTimeout(t,e))}let Q4=class{constructor({limit:t}){Xm(this,"limit"),Xm(this,"set"),this.limit=t,this.set=new Set}add(t){if(!this.set.has(t)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(t)}}has(t){return this.set.has(t)}};const Zl=BigInt(2**32-1),ny=BigInt(32);function yC(e,t=!1){return t?{h:Number(e&Zl),l:Number(e>>ny&Zl)}:{h:Number(e>>ny&Zl)|0,l:Number(e&Zl)|0}}function bC(e,t=!1){const n=e.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=yC(e[i],t);[r[i],s[i]]=[o,a]}return[r,s]}const ry=(e,t,n)=>e>>>n,sy=(e,t,n)=>e<<32-n|t>>>n,Ss=(e,t,n)=>e>>>n|t<<32-n,xs=(e,t,n)=>e<<32-n|t>>>n,Wa=(e,t,n)=>e<<64-n|t>>>n-32,Va=(e,t,n)=>e>>>n-32|t<<64-n,e5=(e,t)=>t,t5=(e,t)=>e,n5=(e,t,n)=>e<<n|t>>>32-n,r5=(e,t,n)=>t<<n|e>>>32-n,s5=(e,t,n)=>t<<n-32|e>>>64-n,i5=(e,t,n)=>e<<n-32|t>>>64-n;function nr(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const Hg=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),zg=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,o5=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),a5=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,c5=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),l5=(e,t,n,r,s,i)=>t+n+r+s+i+(e/2**32|0)|0,lo=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function qg(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function os(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function qn(e,...t){if(!qg(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function Wg(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");os(e.outputLen),os(e.blockLen)}function Ws(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Vg(e,t){qn(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Sc(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Wn(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Lh(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function mr(e,t){return e<<32-t|e>>>t}const vC=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function EC(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}const Zr=vC?e=>e:e=>EC(e);function u5(e){for(let t=0;t<e.length;t++)e[t]=EC(e[t]);return e}const Ns=vC?e=>e:u5,CC=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",d5=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function xc(e){if(qn(e),CC)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=d5[e[n]];return t}const qr={_0:48,_9:57,A:65,F:70,a:97,f:102};function iy(e){if(e>=qr._0&&e<=qr._9)return e-qr._0;if(e>=qr.A&&e<=qr.F)return e-(qr.A-10);if(e>=qr.a&&e<=qr.f)return e-(qr.a-10)}function Kg(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(CC)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=iy(e.charCodeAt(i)),a=iy(e.charCodeAt(i+1));if(o===void 0||a===void 0){const c=e[i]+e[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function h5(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function hr(e){return typeof e=="string"&&(e=h5(e)),qn(e),e}function Ci(...e){let t=0;for(let r=0;r<e.length;r++){const s=e[r];qn(s),t+=s.length}const n=new Uint8Array(t);for(let r=0,s=0;r<e.length;r++){const i=e[r];n.set(i,s),s+=i.length}return n}let Ed=class{};function fl(e){const t=r=>e().update(hr(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function f5(e){const t=(r,s)=>e(s).update(hr(r)).digest(),n=e({});return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}function pa(e=32){if(lo&&typeof lo.getRandomValues=="function")return lo.getRandomValues(new Uint8Array(e));if(lo&&typeof lo.randomBytes=="function")return Uint8Array.from(lo.randomBytes(e));throw new Error("crypto.getRandomValues must be defined")}const p5=BigInt(0),Pa=BigInt(1),g5=BigInt(2),w5=BigInt(7),m5=BigInt(256),y5=BigInt(113),AC=[],IC=[],SC=[];for(let e=0,t=Pa,n=1,r=0;e<24;e++){[n,r]=[r,(2*n+3*r)%5],AC.push(2*(5*r+n)),IC.push((e+1)*(e+2)/2%64);let s=p5;for(let i=0;i<7;i++)t=(t<<Pa^(t>>w5)*y5)%m5,t&g5&&(s^=Pa<<(Pa<<BigInt(i))-Pa);SC.push(s)}const xC=bC(SC,!0),b5=xC[0],v5=xC[1],oy=(e,t,n)=>n>32?s5(e,t,n):n5(e,t,n),ay=(e,t,n)=>n>32?i5(e,t,n):r5(e,t,n);function E5(e,t=24){const n=new Uint32Array(10);for(let r=24-t;r<24;r++){for(let o=0;o<10;o++)n[o]=e[o]^e[o+10]^e[o+20]^e[o+30]^e[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=oy(l,u,1)^n[a],h=ay(l,u,1)^n[a+1];for(let p=0;p<50;p+=10)e[o+p]^=d,e[o+p+1]^=h}let s=e[2],i=e[3];for(let o=0;o<24;o++){const a=IC[o],c=oy(s,i,a),l=ay(s,i,a),u=AC[o];s=e[u],i=e[u+1],e[u]=c,e[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=e[o+a];for(let a=0;a<10;a++)e[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}e[0]^=b5[r],e[1]^=v5[r]}Wn(n)}let C5=class NC extends Ed{constructor(t,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,os(r),!(0<t&&t<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Sc(this.state)}clone(){return this._cloneInto()}keccak(){Ns(this.state32),E5(this.state32,this.rounds),Ns(this.state32),this.posOut=0,this.pos=0}update(t){Ws(this),t=hr(t),qn(t);const{blockLen:n,state:r}=this,s=t.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=t[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:n,pos:r,blockLen:s}=this;t[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),t[s-1]^=128,this.keccak()}writeInto(t){Ws(this,!1),qn(t),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=t.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);t.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return t}xofInto(t){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return os(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(Vg(t,this),this.finished)throw new Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Wn(this.state)}_cloneInto(t){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return t||(t=new NC(n,r,s,o,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=s,t.enableXOF=o,t.destroyed=this.destroyed,t}};const A5=(e,t,n)=>fl(()=>new C5(t,e,n)),I5=A5(1,136,256/8);function S5(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;e.setUint32(t+c,o,r),e.setUint32(t+l,a,r)}function x5(e,t,n){return e&t^~e&n}function N5(e,t,n){return e&t^e&n^t&n}let _C=class extends Ed{constructor(t,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(t),this.view=Lh(this.buffer)}update(t){Ws(this),t=hr(t),qn(t);const{view:n,buffer:r,blockLen:s}=this,i=t.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Lh(t);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Ws(this),Vg(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Wn(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;S5(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Lh(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return t.destroyed=o,t.finished=i,t.length=s,t.pos=a,s%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}};const ws=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Bt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Mt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),_5=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),ms=new Uint32Array(64);let T5=class extends _C{constructor(t=32){super(64,t,8,!1),this.A=ws[0]|0,this.B=ws[1]|0,this.C=ws[2]|0,this.D=ws[3]|0,this.E=ws[4]|0,this.F=ws[5]|0,this.G=ws[6]|0,this.H=ws[7]|0}get(){const{A:t,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[t,n,r,s,i,o,a,c]}set(t,n,r,s,i,o,a,c){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(t,n){for(let d=0;d<16;d++,n+=4)ms[d]=t.getUint32(n,!1);for(let d=16;d<64;d++){const h=ms[d-15],p=ms[d-2],f=mr(h,7)^mr(h,18)^h>>>3,g=mr(p,17)^mr(p,19)^p>>>10;ms[d]=g+ms[d-7]+f+ms[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=mr(a,6)^mr(a,11)^mr(a,25),p=u+h+x5(a,c,l)+_5[d]+ms[d]|0,f=(mr(r,2)^mr(r,13)^mr(r,22))+N5(r,s,i)|0;u=l,l=c,c=a,a=o+p|0,o=i,i=s,s=r,r=p+f|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Wn(ms)}destroy(){this.set(0,0,0,0,0,0,0,0),Wn(this.buffer)}};const TC=bC(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),O5=TC[0],D5=TC[1],ys=new Uint32Array(80),bs=new Uint32Array(80);let Gg=class extends _C{constructor(t=64){super(128,t,16,!1),this.Ah=Mt[0]|0,this.Al=Mt[1]|0,this.Bh=Mt[2]|0,this.Bl=Mt[3]|0,this.Ch=Mt[4]|0,this.Cl=Mt[5]|0,this.Dh=Mt[6]|0,this.Dl=Mt[7]|0,this.Eh=Mt[8]|0,this.El=Mt[9]|0,this.Fh=Mt[10]|0,this.Fl=Mt[11]|0,this.Gh=Mt[12]|0,this.Gl=Mt[13]|0,this.Hh=Mt[14]|0,this.Hl=Mt[15]|0}get(){const{Ah:t,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:p,Gl:f,Hh:g,Hl:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=p|0,this.Gl=f|0,this.Hh=g|0,this.Hl=w|0}process(t,n){for(let y=0;y<16;y++,n+=4)ys[y]=t.getUint32(n),bs[y]=t.getUint32(n+=4);for(let y=16;y<80;y++){const m=ys[y-15]|0,v=bs[y-15]|0,C=Ss(m,v,1)^Ss(m,v,8)^ry(m,v,7),O=xs(m,v,1)^xs(m,v,8)^sy(m,v,7),D=ys[y-2]|0,S=bs[y-2]|0,E=Ss(D,S,19)^Wa(D,S,61)^ry(D,S,6),N=xs(D,S,19)^Va(D,S,61)^sy(D,S,6),$=o5(O,N,bs[y-7],bs[y-16]),B=a5($,C,E,ys[y-7],ys[y-16]);ys[y]=B|0,bs[y]=$|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:p,Fl:f,Gh:g,Gl:w,Hh:b,Hl:I}=this;for(let y=0;y<80;y++){const m=Ss(d,h,14)^Ss(d,h,18)^Wa(d,h,41),v=xs(d,h,14)^xs(d,h,18)^Va(d,h,41),C=d&p^~d&g,O=h&f^~h&w,D=c5(I,v,O,D5[y],bs[y]),S=l5(D,b,m,C,O5[y],ys[y]),E=D|0,N=Ss(r,s,28)^Wa(r,s,34)^Wa(r,s,39),$=xs(r,s,28)^Va(r,s,34)^Va(r,s,39),B=r&i^r&a^i&a,R=s&o^s&c^o&c;b=g|0,I=w|0,g=p|0,w=f|0,p=d|0,f=h|0,{h:d,l:h}=nr(l|0,u|0,S|0,E|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const A=Hg(E,$,R);r=zg(A,S,N,B),s=A|0}({h:r,l:s}=nr(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=nr(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=nr(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=nr(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=nr(this.Eh|0,this.El|0,d|0,h|0),{h:p,l:f}=nr(this.Fh|0,this.Fl|0,p|0,f|0),{h:g,l:w}=nr(this.Gh|0,this.Gl|0,g|0,w|0),{h:b,l:I}=nr(this.Hh|0,this.Hl|0,b|0,I|0),this.set(r,s,i,o,a,c,l,u,d,h,p,f,g,w,b,I)}roundClean(){Wn(ys,bs)}destroy(){Wn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},$5=class extends Gg{constructor(){super(48),this.Ah=Bt[0]|0,this.Al=Bt[1]|0,this.Bh=Bt[2]|0,this.Bl=Bt[3]|0,this.Ch=Bt[4]|0,this.Cl=Bt[5]|0,this.Dh=Bt[6]|0,this.Dl=Bt[7]|0,this.Eh=Bt[8]|0,this.El=Bt[9]|0,this.Fh=Bt[10]|0,this.Fl=Bt[11]|0,this.Gh=Bt[12]|0,this.Gl=Bt[13]|0,this.Hh=Bt[14]|0,this.Hl=Bt[15]|0}};const Lt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class P5 extends Gg{constructor(){super(32),this.Ah=Lt[0]|0,this.Al=Lt[1]|0,this.Bh=Lt[2]|0,this.Bl=Lt[3]|0,this.Ch=Lt[4]|0,this.Cl=Lt[5]|0,this.Dh=Lt[6]|0,this.Dl=Lt[7]|0,this.Eh=Lt[8]|0,this.El=Lt[9]|0,this.Fh=Lt[10]|0,this.Fl=Lt[11]|0,this.Gh=Lt[12]|0,this.Gl=Lt[13]|0,this.Hh=Lt[14]|0,this.Hl=Lt[15]|0}}const Cd=fl(()=>new T5),k5=fl(()=>new Gg),U5=fl(()=>new $5),R5=fl(()=>new P5),B5=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),ht=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),te=new Uint32Array(32);function vs(e,t,n,r,s,i){const o=s[i],a=s[i+1];let c=te[2*e],l=te[2*e+1],u=te[2*t],d=te[2*t+1],h=te[2*n],p=te[2*n+1],f=te[2*r],g=te[2*r+1],w=Hg(c,u,o);l=zg(w,l,d,a),c=w|0,{Dh:g,Dl:f}={Dh:g^l,Dl:f^c},{Dh:g,Dl:f}={Dh:e5(g,f),Dl:t5(g)},{h:p,l:h}=nr(p,h,g,f),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:Ss(d,u,24),Bl:xs(d,u,24)},te[2*e]=c,te[2*e+1]=l,te[2*t]=u,te[2*t+1]=d,te[2*n]=h,te[2*n+1]=p,te[2*r]=f,te[2*r+1]=g}function Es(e,t,n,r,s,i){const o=s[i],a=s[i+1];let c=te[2*e],l=te[2*e+1],u=te[2*t],d=te[2*t+1],h=te[2*n],p=te[2*n+1],f=te[2*r],g=te[2*r+1],w=Hg(c,u,o);l=zg(w,l,d,a),c=w|0,{Dh:g,Dl:f}={Dh:g^l,Dl:f^c},{Dh:g,Dl:f}={Dh:Ss(g,f,16),Dl:xs(g,f,16)},{h:p,l:h}=nr(p,h,g,f),{Bh:d,Bl:u}={Bh:d^p,Bl:u^h},{Bh:d,Bl:u}={Bh:Wa(d,u,63),Bl:Va(d,u,63)},te[2*e]=c,te[2*e+1]=l,te[2*t]=u,te[2*t+1]=d,te[2*n]=h,te[2*n+1]=p,te[2*r]=f,te[2*r+1]=g}function M5(e,t={},n,r,s){if(os(n),e<0||e>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=t;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class L5 extends Ed{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,os(t),os(n),this.blockLen=t,this.outputLen=n,this.buffer=new Uint8Array(t),this.buffer32=Sc(this.buffer)}update(t){Ws(this),t=hr(t),qn(t);const{blockLen:n,buffer:r,buffer32:s}=this,i=t.length,o=t.byteOffset,a=t.buffer;for(let c=0;c<i;){this.pos===n&&(Ns(s),this.compress(s,0,!1),Ns(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));Ns(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);Ns(d);continue}r.set(t.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(t){Ws(this),Vg(t,this);const{pos:n,buffer32:r}=this;this.finished=!0,Wn(this.buffer.subarray(n)),Ns(r),this.compress(r,0,!0),Ns(r);const s=Sc(t);this.get().forEach((i,o)=>s[o]=Zr(i))}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return t||(t=new this.constructor({dkLen:o})),t.set(...this.get()),t.buffer.set(n),t.destroyed=i,t.finished=s,t.length=r,t.pos=a,t.outputLen=o,t}clone(){return this._cloneInto()}}class j5 extends L5{constructor(t={}){const n=t.dkLen===void 0?64:t.dkLen;super(128,n),this.v0l=ht[0]|0,this.v0h=ht[1]|0,this.v1l=ht[2]|0,this.v1h=ht[3]|0,this.v2l=ht[4]|0,this.v2h=ht[5]|0,this.v3l=ht[6]|0,this.v3h=ht[7]|0,this.v4l=ht[8]|0,this.v4h=ht[9]|0,this.v5l=ht[10]|0,this.v5h=ht[11]|0,this.v6l=ht[12]|0,this.v6h=ht[13]|0,this.v7l=ht[14]|0,this.v7h=ht[15]|0,M5(n,t,64,16,16);let{key:r,personalization:s,salt:i}=t,o=0;if(r!==void 0&&(r=hr(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=hr(i);const a=Sc(i);this.v4l^=Zr(a[0]),this.v4h^=Zr(a[1]),this.v5l^=Zr(a[2]),this.v5h^=Zr(a[3])}if(s!==void 0){s=hr(s);const a=Sc(s);this.v6l^=Zr(a[0]),this.v6h^=Zr(a[1]),this.v7l^=Zr(a[2]),this.v7h^=Zr(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:t,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:p,v6h:f,v7l:g,v7h:w}=this;return[t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w]}set(t,n,r,s,i,o,a,c,l,u,d,h,p,f,g,w){this.v0l=t|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=p|0,this.v6h=f|0,this.v7l=g|0,this.v7h=w|0}compress(t,n,r){this.get().forEach((c,l)=>te[l]=c),te.set(ht,16);let{h:s,l:i}=yC(BigInt(this.length));te[24]=ht[8]^i,te[25]=ht[9]^s,r&&(te[28]=~te[28],te[29]=~te[29]);let o=0;const a=B5;for(let c=0;c<12;c++)vs(0,4,8,12,t,n+2*a[o++]),Es(0,4,8,12,t,n+2*a[o++]),vs(1,5,9,13,t,n+2*a[o++]),Es(1,5,9,13,t,n+2*a[o++]),vs(2,6,10,14,t,n+2*a[o++]),Es(2,6,10,14,t,n+2*a[o++]),vs(3,7,11,15,t,n+2*a[o++]),Es(3,7,11,15,t,n+2*a[o++]),vs(0,5,10,15,t,n+2*a[o++]),Es(0,5,10,15,t,n+2*a[o++]),vs(1,6,11,12,t,n+2*a[o++]),Es(1,6,11,12,t,n+2*a[o++]),vs(2,7,8,13,t,n+2*a[o++]),Es(2,7,8,13,t,n+2*a[o++]),vs(3,4,9,14,t,n+2*a[o++]),Es(3,4,9,14,t,n+2*a[o++]);this.v0l^=te[0]^te[16],this.v0h^=te[1]^te[17],this.v1l^=te[2]^te[18],this.v1h^=te[3]^te[19],this.v2l^=te[4]^te[20],this.v2h^=te[5]^te[21],this.v3l^=te[6]^te[22],this.v3h^=te[7]^te[23],this.v4l^=te[8]^te[24],this.v4h^=te[9]^te[25],this.v5l^=te[10]^te[26],this.v5h^=te[11]^te[27],this.v6l^=te[12]^te[28],this.v6h^=te[13]^te[29],this.v7l^=te[14]^te[30],this.v7h^=te[15]^te[31],Wn(te)}destroy(){this.destroyed=!0,Wn(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const F5=f5(e=>new j5(e)),H5="https://rpc.walletconnect.org/v1";function OC(e){const t=`Ethereum Signed Message:
${e.length}`,n=new TextEncoder().encode(t+e);return"0x"+Buffer.from(I5(n)).toString("hex")}async function z5(e,t,n,r,s,i){switch(n.t){case"eip191":return await q5(e,t,n.s);case"eip1271":return await W5(e,t,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function q5(e,t,n){return(await jk({hash:OC(t),signature:n})).toLowerCase()===e.toLowerCase()}async function W5(e,t,n,r,s,i){const o=Fo(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(t.startsWith("0x")?t:OC(t)).substring(2),h=a+d+c+u+l,p=await fetch(`${i||H5}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:V5(),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:h},"latest"]})}),{result:f}=await p.json();return f?f.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function V5(){return Date.now()+Math.floor(Math.random()*1e3)}function K5(e){const t=atob(e),n=new Uint8Array(t.length);for(let o=0;o<t.length;o++)n[o]=t.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(e,"base64").slice(1,65);return ha.encode(i)}function G5(e){const t=new Uint8Array(Buffer.from(e,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+t.length);r.set(n),r.set(t,n.length);const s=F5(r,{dkLen:32});return ha.encode(s)}function cy(e){const t=new Uint8Array(Cd(Y5(e)));return ha.encode(t)}function Y5(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if(typeof e=="object"&&e!=null&&e.data)return new Uint8Array(Object.values(e.data));if(typeof e=="object"&&e)return new Uint8Array(Object.values(e));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function ly(e){const t=Buffer.from(e,"base64"),n=I8(t).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=g8(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=R5(i);return cS.encode(o).replace(/=+$/,"")}function jh(e){const t=[];let n=BigInt(e);for(;n>=BigInt(128);)t.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return t.push(Number(n)),Buffer.from(t)}function Z5(e){const t=Buffer.from(e.signed.bodyBytes,"base64"),n=Buffer.from(e.signed.authInfoBytes,"base64"),r=Buffer.from(e.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(jh(t.length)),s.push(t),s.push(Buffer.from([18])),s.push(jh(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(jh(r.length)),s.push(r);const i=Buffer.concat(s),o=Cd(i);return Buffer.from(o).toString("hex").toUpperCase()}var J5=Object.defineProperty,X5=Object.defineProperties,Q5=Object.getOwnPropertyDescriptors,uy=Object.getOwnPropertySymbols,eU=Object.prototype.hasOwnProperty,tU=Object.prototype.propertyIsEnumerable,dy=(e,t,n)=>t in e?J5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nU=(e,t)=>{for(var n in t||(t={}))eU.call(t,n)&&dy(e,n,t[n]);if(uy)for(var n of uy(t))tU.call(t,n)&&dy(e,n,t[n]);return e},rU=(e,t)=>X5(e,Q5(t));const sU="did:pkh:",Yg=e=>e?.split(":"),iU=e=>{const t=e&&Yg(e);if(t)return e.includes(sU)?t[3]:t[1]},fp=e=>{const t=e&&Yg(e);if(t)return t[2]+":"+t[3]},Zu=e=>{const t=e&&Yg(e);if(t)return t.pop()};async function hy(e){const{cacao:t,projectId:n}=e,{s:r,p:s}=t,i=DC(s,s.iss),o=Zu(s.iss);return await z5(o,i,r,fp(s.iss),n)}const DC=(e,t)=>{const n=`${e.domain} wants you to sign in with your Ethereum account:`,r=Zu(t);if(!e.aud&&!e.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0;const i=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${iU(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,u=e.exp?`Expiration Time: ${e.exp}`:void 0,d=e.nbf?`Not Before: ${e.nbf}`:void 0,h=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(g=>`
- ${g}`).join("")}`:void 0,f=Au(e.resources);if(f){const g=Nc(f);s=pU(s,g)}return[n,r,"",s,"",i,o,a,c,l,u,d,h,p].filter(g=>g!=null).join(`
`)};function oU(e){return Buffer.from(JSON.stringify(e)).toString("base64")}function aU(e){return JSON.parse(Buffer.from(e,"base64").toString("utf-8"))}function Li(e){if(!e)throw new Error("No recap provided, value is undefined");if(!e.att)throw new Error("No `att` property found");const t=Object.keys(e.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(n=>{const r=e.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function cU(e,t,n,r={}){return n?.sort((s,i)=>s.localeCompare(i)),{att:{[e]:lU(t,n,r)}}}function lU(e,t,n={}){t=t?.sort((s,i)=>s.localeCompare(i));const r=t.map(s=>({[`${e}/${s}`]:[n]}));return Object.assign({},...r)}function $C(e){return Li(e),`urn:recap:${oU(e).replace(/=/g,"")}`}function Nc(e){const t=aU(e.replace("urn:recap:",""));return Li(t),t}function uU(e,t,n){const r=cU(e,t,n);return $C(r)}function dU(e){return e&&e.includes("urn:recap:")}function hU(e,t){const n=Nc(e),r=Nc(t),s=fU(n,r);return $C(s)}function fU(e,t){Li(e),Li(t);const n=Object.keys(e.att).concat(Object.keys(t.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=e.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=t.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=rU(nU({},r.att[s]),{[a]:((c=e.att[s])==null?void 0:c[a])||((l=t.att[s])==null?void 0:l[a])})})}),r}function pU(e="",t){Li(t);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(n))return e;const r=[];let s=0;Object.keys(t.att).forEach(a=>{const c=Object.keys(t.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${e?e+" ":""}${o}`}function fy(e){var t;const n=Nc(e);Li(n);const r=(t=n.att)==null?void 0:t.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function py(e){const t=Nc(e);Li(t);const n=[];return Object.values(t.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function Au(e){if(!e)return;const t=e?.[e.length-1];return dU(t)?t:void 0}function PC(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function pp(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Fh(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function cn(e,...t){if(!PC(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function gy(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function gU(e,t){cn(e);const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function js(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Jo(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function wU(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const mU=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function yU(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function gp(e){if(typeof e=="string")e=yU(e);else if(PC(e))e=wp(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function bU(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function vU(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}const EU=(e,t)=>{function n(r,...s){if(cn(r),!mU)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");e.varSizeNonce?cn(l):cn(l,e.nonceLength)}const i=e.tagLength;i&&s[1]!==void 0&&cn(s[1]);const o=t(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");cn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,cn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(cn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,e),n};function wy(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!AU(t))throw new Error("invalid output, must be aligned");return t}function my(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);e.setUint32(t+4,o,r),e.setUint32(t+0,a,r)}function CU(e,t,n){pp(n);const r=new Uint8Array(16),s=wU(r);return my(s,0,BigInt(t),n),my(s,8,BigInt(e),n),r}function AU(e){return e.byteOffset%4===0}function wp(e){return Uint8Array.from(e)}const kC=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),IU=kC("expand 16-byte k"),SU=kC("expand 32-byte k"),xU=js(IU),NU=js(SU);function Te(e,t){return e<<t|e>>>32-t}function mp(e){return e.byteOffset%4===0}const Jl=64,_U=16,UC=2**32-1,yy=new Uint32Array;function TU(e,t,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(Jl),u=js(l),d=mp(s)&&mp(i),h=d?js(s):yy,p=d?js(i):yy;for(let f=0;f<c;o++){if(e(t,n,r,u,o,a),o>=UC)throw new Error("arx: counter overflow");const g=Math.min(Jl,c-f);if(d&&g===Jl){const w=f/4;if(f%4!==0)throw new Error("arx: invalid block position");for(let b=0,I;b<_U;b++)I=w+b,p[I]=h[I]^u[b];f+=Jl;continue}for(let w=0,b;w<g;w++)b=f+w,i[b]=s[b]^l[w];f+=g}}function OU(e,t){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=bU({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Fh(s),Fh(o),pp(i),pp(n),(a,c,l,u,d=0)=>{cn(a),cn(c),cn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),cn(u),Fh(d),d<0||d>=UC)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const p=[];let f=a.length,g,w;if(f===32)p.push(g=wp(a)),w=NU;else if(f===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),w=xU,p.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${f}`);mp(c)||p.push(c=wp(c));const b=js(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(w,b,js(c.subarray(0,16)),b),c=c.subarray(16)}const I=16-s;if(I!==c.length)throw new Error(`arx: nonce must be ${I} or 16 bytes`);if(I!==12){const m=new Uint8Array(12);m.set(c,i?0:12-c.length),c=m,p.push(c)}const y=js(c);return TU(e,w,b,y,l,u,d,o),Jo(...p),u}}const St=(e,t)=>e[t++]&255|(e[t++]&255)<<8;class DU{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=gp(t),cn(t,32);const n=St(t,0),r=St(t,2),s=St(t,4),i=St(t,6),o=St(t,8),a=St(t,10),c=St(t,12),l=St(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=St(t,16+2*u)}process(t,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],p=o[6],f=o[7],g=o[8],w=o[9],b=St(t,n+0),I=St(t,n+2),y=St(t,n+4),m=St(t,n+6),v=St(t,n+8),C=St(t,n+10),O=St(t,n+12),D=St(t,n+14);let S=i[0]+(b&8191),E=i[1]+((b>>>13|I<<3)&8191),N=i[2]+((I>>>10|y<<6)&8191),$=i[3]+((y>>>7|m<<9)&8191),B=i[4]+((m>>>4|v<<12)&8191),R=i[5]+(v>>>1&8191),A=i[6]+((v>>>14|C<<2)&8191),_=i[7]+((C>>>11|O<<5)&8191),k=i[8]+((O>>>8|D<<8)&8191),M=i[9]+(D>>>5|s),U=0,P=U+S*a+E*(5*w)+N*(5*g)+$*(5*f)+B*(5*p);U=P>>>13,P&=8191,P+=R*(5*h)+A*(5*d)+_*(5*u)+k*(5*l)+M*(5*c),U+=P>>>13,P&=8191;let H=U+S*c+E*a+N*(5*w)+$*(5*g)+B*(5*f);U=H>>>13,H&=8191,H+=R*(5*p)+A*(5*h)+_*(5*d)+k*(5*u)+M*(5*l),U+=H>>>13,H&=8191;let Y=U+S*l+E*c+N*a+$*(5*w)+B*(5*g);U=Y>>>13,Y&=8191,Y+=R*(5*f)+A*(5*p)+_*(5*h)+k*(5*d)+M*(5*u),U+=Y>>>13,Y&=8191;let J=U+S*u+E*l+N*c+$*a+B*(5*w);U=J>>>13,J&=8191,J+=R*(5*g)+A*(5*f)+_*(5*p)+k*(5*h)+M*(5*d),U+=J>>>13,J&=8191;let K=U+S*d+E*u+N*l+$*c+B*a;U=K>>>13,K&=8191,K+=R*(5*w)+A*(5*g)+_*(5*f)+k*(5*p)+M*(5*h),U+=K>>>13,K&=8191;let ne=U+S*h+E*d+N*u+$*l+B*c;U=ne>>>13,ne&=8191,ne+=R*a+A*(5*w)+_*(5*g)+k*(5*f)+M*(5*p),U+=ne>>>13,ne&=8191;let ue=U+S*p+E*h+N*d+$*u+B*l;U=ue>>>13,ue&=8191,ue+=R*c+A*a+_*(5*w)+k*(5*g)+M*(5*f),U+=ue>>>13,ue&=8191;let _e=U+S*f+E*p+N*h+$*d+B*u;U=_e>>>13,_e&=8191,_e+=R*l+A*c+_*a+k*(5*w)+M*(5*g),U+=_e>>>13,_e&=8191;let Ie=U+S*g+E*f+N*p+$*h+B*d;U=Ie>>>13,Ie&=8191,Ie+=R*u+A*l+_*c+k*a+M*(5*w),U+=Ie>>>13,Ie&=8191;let be=U+S*w+E*g+N*f+$*p+B*h;U=be>>>13,be&=8191,be+=R*d+A*u+_*l+k*c+M*a,U+=be>>>13,be&=8191,U=(U<<2)+U|0,U=U+P|0,P=U&8191,U=U>>>13,H+=U,i[0]=P,i[1]=H,i[2]=Y,i[3]=J,i[4]=K,i[5]=ne,i[6]=ue,i[7]=_e,i[8]=Ie,i[9]=be}finalize(){const{h:t,pad:n}=this,r=new Uint16Array(10);let s=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=s,s=t[a]>>>13,t[a]&=8191;t[0]+=s*5,s=t[0]>>>13,t[0]&=8191,t[1]+=s,s=t[1]>>>13,t[1]&=8191,t[2]+=s,r[0]=t[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=t[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)t[a]=t[a]&i|r[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let o=t[0]+n[0];t[0]=o&65535;for(let a=1;a<8;a++)o=(t[a]+n[a]|0)+(o>>>16)|0,t[a]=o&65535;Jo(r)}update(t){gy(this),t=gp(t),cn(t);const{buffer:n,blockLen:r}=this,s=t.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(t,i);continue}n.set(t.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){Jo(this.h,this.r,this.buffer,this.pad)}digestInto(t){gy(this),gU(t,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)t[i++]=r[o]>>>0,t[i++]=r[o]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}}function $U(e){const t=(r,s)=>e(s).update(gp(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}const PU=$U(e=>new DU(e));function kU(e,t,n,r,s,i=20){let o=e[0],a=e[1],c=e[2],l=e[3],u=t[0],d=t[1],h=t[2],p=t[3],f=t[4],g=t[5],w=t[6],b=t[7],I=s,y=n[0],m=n[1],v=n[2],C=o,O=a,D=c,S=l,E=u,N=d,$=h,B=p,R=f,A=g,_=w,k=b,M=I,U=y,P=m,H=v;for(let J=0;J<i;J+=2)C=C+E|0,M=Te(M^C,16),R=R+M|0,E=Te(E^R,12),C=C+E|0,M=Te(M^C,8),R=R+M|0,E=Te(E^R,7),O=O+N|0,U=Te(U^O,16),A=A+U|0,N=Te(N^A,12),O=O+N|0,U=Te(U^O,8),A=A+U|0,N=Te(N^A,7),D=D+$|0,P=Te(P^D,16),_=_+P|0,$=Te($^_,12),D=D+$|0,P=Te(P^D,8),_=_+P|0,$=Te($^_,7),S=S+B|0,H=Te(H^S,16),k=k+H|0,B=Te(B^k,12),S=S+B|0,H=Te(H^S,8),k=k+H|0,B=Te(B^k,7),C=C+N|0,H=Te(H^C,16),_=_+H|0,N=Te(N^_,12),C=C+N|0,H=Te(H^C,8),_=_+H|0,N=Te(N^_,7),O=O+$|0,M=Te(M^O,16),k=k+M|0,$=Te($^k,12),O=O+$|0,M=Te(M^O,8),k=k+M|0,$=Te($^k,7),D=D+B|0,U=Te(U^D,16),R=R+U|0,B=Te(B^R,12),D=D+B|0,U=Te(U^D,8),R=R+U|0,B=Te(B^R,7),S=S+E|0,P=Te(P^S,16),A=A+P|0,E=Te(E^A,12),S=S+E|0,P=Te(P^S,8),A=A+P|0,E=Te(E^A,7);let Y=0;r[Y++]=o+C|0,r[Y++]=a+O|0,r[Y++]=c+D|0,r[Y++]=l+S|0,r[Y++]=u+E|0,r[Y++]=d+N|0,r[Y++]=h+$|0,r[Y++]=p+B|0,r[Y++]=f+R|0,r[Y++]=g+A|0,r[Y++]=w+_|0,r[Y++]=b+k|0,r[Y++]=I+M|0,r[Y++]=y+U|0,r[Y++]=m+P|0,r[Y++]=v+H|0}const UU=OU(kU,{counterRight:!1,counterLength:4,allowShortKeys:!1}),RU=new Uint8Array(16),by=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(RU.subarray(n))},BU=new Uint8Array(32);function vy(e,t,n,r,s){const i=e(t,n,BU),o=PU.create(i);s&&by(o,s),by(o,r);const a=CU(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return Jo(i,a),c}const MU=e=>(t,n,r)=>({encrypt(s,i){const o=s.length;i=wy(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);e(t,n,a,a,1);const c=vy(e,t,n,a,r);return i.set(c,o),Jo(c),i},decrypt(s,i){i=wy(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=vy(e,t,n,o,r);if(!vU(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),e(t,n,i,i,1),Jo(c),i}}),RC=EU({blockSize:64,nonceLength:12,tagLength:16},MU(UU));let BC=class extends Ed{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,Wg(t);const r=hr(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?t.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=t.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Wn(i)}update(t){return Ws(this),this.iHash.update(t),this}digestInto(t){Ws(this),qn(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return t=t,t.finished=s,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Ad=(e,t,n)=>new BC(e,t).update(n).digest();Ad.create=(e,t)=>new BC(e,t);function LU(e,t,n){return Wg(e),n===void 0&&(n=new Uint8Array(e.outputLen)),Ad(e,hr(n),hr(t))}const Hh=Uint8Array.from([0]),Ey=Uint8Array.of();function jU(e,t,n,r=32){Wg(e),os(r);const s=e.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=Ey);const o=new Uint8Array(i*s),a=Ad.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Hh[0]=u+1,c.update(u===0?Ey:l).update(n).update(Hh).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Wn(l,Hh),o.slice(0,r)}const FU=(e,t,n,r,s)=>jU(e,LU(e,t,n),r,s),Id=Cd,Zg=BigInt(0),yp=BigInt(1);function Ju(e,t){if(typeof t!="boolean")throw new Error(e+" boolean expected, got "+t)}function Xl(e){const t=e.toString(16);return t.length&1?"0"+t:t}function MC(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?Zg:BigInt("0x"+e)}function Sd(e){return MC(xc(e))}function Xu(e){return qn(e),MC(xc(Uint8Array.from(e).reverse()))}function Jg(e,t){return Kg(e.toString(16).padStart(t*2,"0"))}function Xg(e,t){return Jg(e,t).reverse()}function an(e,t,n){let r;if(typeof t=="string")try{r=Kg(t)}catch(i){throw new Error(e+" must be hex string or Uint8Array, cause: "+i)}else if(qg(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}const zh=e=>typeof e=="bigint"&&Zg<=e;function HU(e,t,n){return zh(e)&&zh(t)&&zh(n)&&t<=e&&e<n}function bp(e,t,n,r){if(!HU(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}function zU(e){let t;for(t=0;e>Zg;e>>=yp,t+=1);return t}const xd=e=>(yp<<BigInt(e))-yp;function qU(e,t,n){if(typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof t!="number"||t<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(e),o=r(e),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>n(o,i,...h),u=(h=r(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const p=[];for(;h<t;){i=l();const f=i.slice();p.push(f),h+=i.length}return Ci(...p)};return(h,p)=>{c(),u(h);let f;for(;!(f=p(d()));)u();return c(),f}}function Nd(e,t,n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(s,i,o){const a=e[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(t).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function Cy(e){const t=new WeakMap;return(n,...r)=>{const s=t.get(n);if(s!==void 0)return s;const i=e(n,...r);return t.set(n,i),i}}const un=BigInt(0),Wt=BigInt(1),Ai=BigInt(2),WU=BigInt(3),LC=BigInt(4),jC=BigInt(5),FC=BigInt(8);function Fn(e,t){const n=e%t;return n>=un?n:t+n}function er(e,t,n){let r=e;for(;t-- >un;)r*=r,r%=n;return r}function Ay(e,t){if(e===un)throw new Error("invert: expected non-zero number");if(t<=un)throw new Error("invert: expected positive modulus, got "+t);let n=Fn(e,t),r=t,s=un,i=Wt;for(;n!==un;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==Wt)throw new Error("invert: does not exist");return Fn(s,t)}function HC(e,t){const n=(e.ORDER+Wt)/LC,r=e.pow(t,n);if(!e.eql(e.sqr(r),t))throw new Error("Cannot find square root");return r}function VU(e,t){const n=(e.ORDER-jC)/FC,r=e.mul(t,Ai),s=e.pow(r,n),i=e.mul(t,s),o=e.mul(e.mul(i,Ai),s),a=e.mul(i,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),t))throw new Error("Cannot find square root");return a}function KU(e){if(e<BigInt(3))throw new Error("sqrt is not defined for small field");let t=e-Wt,n=0;for(;t%Ai===un;)t/=Ai,n++;let r=Ai;const s=ga(e);for(;Iy(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return HC;let i=s.pow(r,t);const o=(t+Wt)/Ai;return function(a,c){if(a.is0(c))return c;if(Iy(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,t),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let p=1,f=a.sqr(d);for(;!a.eql(f,a.ONE);)if(p++,f=a.sqr(f),p===l)throw new Error("Cannot find square root");const g=Wt<<BigInt(l-p-1),w=a.pow(u,g);l=p,u=a.sqr(w),d=a.mul(d,u),h=a.mul(h,w)}return h}}function GU(e){return e%LC===WU?HC:e%FC===jC?VU:KU(e)}const YU=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function ZU(e){const t={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=YU.reduce((r,s)=>(r[s]="function",r),t);return Nd(e,n),e}function JU(e,t,n){if(n<un)throw new Error("invalid exponent, negatives unsupported");if(n===un)return e.ONE;if(n===Wt)return t;let r=e.ONE,s=t;for(;n>un;)n&Wt&&(r=e.mul(r,s)),s=e.sqr(s),n>>=Wt;return r}function zC(e,t,n=!1){const r=new Array(t.length).fill(n?e.ZERO:void 0),s=t.reduce((o,a,c)=>e.is0(a)?o:(r[c]=o,e.mul(o,a)),e.ONE),i=e.inv(s);return t.reduceRight((o,a,c)=>e.is0(a)?o:(r[c]=e.mul(o,r[c]),e.mul(o,a)),i),r}function Iy(e,t){const n=(e.ORDER-Wt)/Ai,r=e.pow(t,n),s=e.eql(r,e.ONE),i=e.eql(r,e.ZERO),o=e.eql(r,e.neg(e.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function XU(e,t){t!==void 0&&os(t);const n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function ga(e,t,n=!1,r={}){if(e<=un)throw new Error("invalid field: expected ORDER > 0, got "+e);let s,i;if(typeof t=="object"&&t!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const u=t;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(n=u.isLE)}else typeof t=="number"&&(s=t),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=XU(e,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:e,isLE:n,BITS:o,BYTES:a,MASK:xd(o),ZERO:un,ONE:Wt,create:u=>Fn(u,e),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return un<=u&&u<e},is0:u=>u===un,isValidNot0:u=>!l.is0(u)&&l.isValid(u),isOdd:u=>(u&Wt)===Wt,neg:u=>Fn(-u,e),eql:(u,d)=>u===d,sqr:u=>Fn(u*u,e),add:(u,d)=>Fn(u+d,e),sub:(u,d)=>Fn(u-d,e),mul:(u,d)=>Fn(u*d,e),pow:(u,d)=>JU(l,u,d),div:(u,d)=>Fn(u*Ay(d,e),e),sqrN:u=>u*u,addN:(u,d)=>u+d,subN:(u,d)=>u-d,mulN:(u,d)=>u*d,inv:u=>Ay(u,e),sqrt:i||(u=>(c||(c=GU(e)),c(l,u))),toBytes:u=>n?Xg(u,a):Jg(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return n?Xu(u):Sd(u)},invertBatch:u=>zC(l,u),cmov:(u,d,h)=>h?d:u});return Object.freeze(l)}function qC(e){if(typeof e!="bigint")throw new Error("field order must be bigint");const t=e.toString(2).length;return Math.ceil(t/8)}function WC(e){const t=qC(e);return t+Math.ceil(t/2)}function QU(e,t,n=!1){const r=e.length,s=qC(t),i=WC(t);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?Xu(e):Sd(e),a=Fn(o,t-Wt)+Wt;return n?Xg(a,s):Jg(a,s)}const Xo=BigInt(0),Ii=BigInt(1);function tc(e,t){const n=t.negate();return e?n:t}function e6(e,t,n){const r=i=>i.pz,s=zC(e.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(e.fromAffine)}function VC(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function qh(e,t){VC(e,t);const n=Math.ceil(t/e)+1,r=2**(e-1),s=2**e,i=xd(e),o=BigInt(e);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function Sy(e,t,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(e&s),c=e>>o;a>r&&(a-=i,c+=Ii);const l=t*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,p=t%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:l}}function t6(e,t){if(!Array.isArray(e))throw new Error("array expected");e.forEach((n,r)=>{if(!(n instanceof t))throw new Error("invalid point at index "+r)})}function n6(e,t){if(!Array.isArray(e))throw new Error("array of scalars expected");e.forEach((n,r)=>{if(!t.isValid(n))throw new Error("invalid scalar at index "+r)})}const Wh=new WeakMap,KC=new WeakMap;function Vh(e){return KC.get(e)||1}function xy(e){if(e!==Xo)throw new Error("invalid wNAF")}function r6(e,t){return{constTimeNegate:tc,hasPrecomputes(n){return Vh(n)!==1},unsafeLadder(n,r,s=e.ZERO){let i=n;for(;r>Xo;)r&Ii&&(s=s.add(i)),i=i.double(),r>>=Ii;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=qh(r,t),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=e.ZERO,o=e.BASE;const a=qh(n,t);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:p,offsetF:f}=Sy(s,c,a);s=l,d?o=o.add(tc(p,r[f])):i=i.add(tc(h,r[u]))}return xy(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=e.ZERO){const o=qh(n,t);for(let a=0;a<o.windows&&s!==Xo;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=Sy(s,a,o);if(s=c,!u){const h=r[l];i=i.add(d?h.negate():h)}}return xy(s),i},getPrecomputes(n,r,s){let i=Wh.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),Wh.set(r,i))),i},wNAFCached(n,r,s){const i=Vh(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Vh(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){VC(r,t),KC.set(n,r),Wh.delete(n)}}}function s6(e,t,n,r){let s=t,i=e.ZERO,o=e.ZERO;for(;n>Xo||r>Xo;)n&Ii&&(i=i.add(s)),r&Ii&&(o=o.add(s)),s=s.double(),n>>=Ii,r>>=Ii;return{p1:i,p2:o}}function i6(e,t,n,r){t6(n,e),n6(r,t);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=e.ZERO,a=zU(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=xd(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((t.BITS-1)/c)*c;let h=o;for(let p=d;p>=0;p-=c){u.fill(o);for(let g=0;g<i;g++){const w=r[g],b=Number(w>>BigInt(p)&l);u[b]=u[b].add(n[g])}let f=o;for(let g=u.length-1,w=o;g>0;g--)w=w.add(u[g]),f=f.add(w);if(h=h.add(f),p!==0)for(let g=0;g<c;g++)h=h.double()}return h}function Ny(e,t){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return ZU(t),t}else return ga(e)}function o6(e,t,n={}){if(!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(const o of["p","n","h"]){const a=t[o];if(!(typeof a=="bigint"&&a>Xo))throw new Error(`CURVE.${o} must be positive bigint`)}const r=Ny(t.p,n.Fp),s=Ny(t.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(t[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const ka=BigInt(0),uo=BigInt(1),Ql=BigInt(2);function a6(e){return Nd(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})}function c6(e){const t=a6(e),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=t,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||pa,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),p=a?Ql**BigInt(254):Ql**BigInt(447),f=a?BigInt(8)*Ql**BigInt(251)-uo:BigInt(4)*Ql**BigInt(445)-uo,g=p+f+uo,w=S=>Fn(S,n),b=I(d);function I(S){return Xg(w(S),u)}function y(S){const E=an("u coordinate",S,u);return a&&(E[31]&=127),w(Xu(E))}function m(S){return Xu(s(an("scalar",S,u)))}function v(S,E){const N=D(y(E),m(S));if(N===ka)throw new Error("invalid private or public key received");return I(N)}function C(S){return v(S,b)}function O(S,E,N){const $=w(S*(E-N));return E=w(E-$),N=w(N+$),{x_2:E,x_3:N}}function D(S,E){bp("u",S,ka,n),bp("scalar",E,p,g);const N=E,$=S;let B=uo,R=ka,A=S,_=uo,k=ka;for(let U=BigInt(l-1);U>=ka;U--){const P=N>>U&uo;k^=P,{x_2:B,x_3:A}=O(k,B,A),{x_2:R,x_3:_}=O(k,R,_),k=P;const H=B+R,Y=w(H*H),J=B-R,K=w(J*J),ne=Y-K,ue=A+_,_e=A-_,Ie=w(_e*H),be=w(ue*J),nt=Ie+be,lt=Ie-be;A=w(nt*nt),_=w($*w(lt*lt)),B=w(Y*K),R=w(ne*(Y+w(h*ne)))}({x_2:B,x_3:A}=O(k,B,A)),{x_2:R,x_3:_}=O(k,R,_);const M=i(R);return w(B*M)}return{scalarMult:v,scalarMultBase:C,getSharedSecret:(S,E)=>v(S,E),getPublicKey:S=>C(S),utils:{randomPrivateKey:()=>c(u)},GuBytes:b.slice()}}BigInt(0);const l6=BigInt(1),_y=BigInt(2),u6=BigInt(3),d6=BigInt(5);BigInt(8);const GC={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function h6(e){const t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=GC.p,o=e*e%i*e%i,a=er(o,_y,i)*o%i,c=er(a,l6,i)*e%i,l=er(c,d6,i)*c%i,u=er(l,t,i)*l%i,d=er(u,n,i)*u%i,h=er(d,r,i)*d%i,p=er(h,s,i)*h%i,f=er(p,s,i)*h%i,g=er(f,t,i)*l%i;return{pow_p_5_8:er(g,_y,i)*e%i,b2:o}}function f6(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const vp=(()=>{const e=GC.p;return c6({P:e,type:"x25519",powPminus2:t=>{const{pow_p_5_8:n,b2:r}=h6(t);return Fn(er(n,u6,e)*r,e)},adjustScalarBytes:f6})})();function Ty(e){e.lowS!==void 0&&Ju("lowS",e.lowS),e.prehash!==void 0&&Ju("prehash",e.prehash)}class p6 extends Error{constructor(t=""){super(t)}}const Xr={Err:p6,_tlv:{encode:(e,t)=>{const{Err:n}=Xr;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length&1)throw new n("tlv.encode: unpadded data");const r=t.length/2,s=Xl(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?Xl(s.length/2|128):"";return Xl(e)+i+s+t},decode(e,t){const{Err:n}=Xr;let r=0;if(e<0||e>256)throw new n("tlv.encode: wrong tag");if(t.length<2||t[r++]!==e)throw new n("tlv.decode: wrong tlv");const s=t[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=t.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=t.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:t.subarray(r+o)}}},_int:{encode(e){const{Err:t}=Xr;if(e<nc)throw new t("integer: negative integers are not allowed");let n=Xl(e);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return n},decode(e){const{Err:t}=Xr;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return Sd(e)}},toSig(e){const{Err:t,_int:n,_tlv:r}=Xr,s=an("signature",e),{v:i,l:o}=r.decode(48,s);if(o.length)throw new t("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(e){const{_tlv:t,_int:n}=Xr,r=t.encode(2,n.encode(e.r)),s=t.encode(2,n.encode(e.s)),i=r+s;return t.encode(48,i)}},nc=BigInt(0),rc=BigInt(1),g6=BigInt(2),eu=BigInt(3),w6=BigInt(4);function m6(e,t,n){function r(s){const i=e.sqr(s),o=e.mul(i,s);return e.add(e.add(o,e.mul(s,t)),n)}return r}function YC(e,t,n){const{BYTES:r}=e;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=an("private key",i);if(t){if(!t.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=e.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=e.create(o)),!e.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function y6(e,t={}){const{Fp:n,Fn:r}=o6("weierstrass",e,t),{h:s,n:i}=e;Nd(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=t;if(o&&(!n.is0(e.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(D,S,E){const{x:N,y:$}=S.toAffine(),B=n.toBytes(N);if(Ju("isCompressed",E),E){a();const R=!n.isOdd($);return Ci(ZC(R),B)}else return Ci(Uint8Array.of(4),B,n.toBytes($))}function l(D){qn(D);const S=n.BYTES,E=S+1,N=2*S+1,$=D.length,B=D[0],R=D.subarray(1);if($===E&&(B===2||B===3)){const A=n.fromBytes(R);if(!n.isValid(A))throw new Error("bad point: is not on curve, wrong x");const _=h(A);let k;try{k=n.sqrt(_)}catch(U){const P=U instanceof Error?": "+U.message:"";throw new Error("bad point: is not on curve, sqrt error"+P)}a();const M=n.isOdd(k);return(B&1)===1!==M&&(k=n.neg(k)),{x:A,y:k}}else if($===N&&B===4){const A=n.fromBytes(R.subarray(S*0,S*1)),_=n.fromBytes(R.subarray(S*1,S*2));if(!p(A,_))throw new Error("bad point: is not on curve");return{x:A,y:_}}else throw new Error(`bad point: got length ${$}, expected compressed=${E} or uncompressed=${N}`)}const u=t.toBytes||c,d=t.fromBytes||l,h=m6(n,e.a,e.b);function p(D,S){const E=n.sqr(S),N=h(D);return n.eql(E,N)}if(!p(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const f=n.mul(n.pow(e.a,eu),w6),g=n.mul(n.sqr(e.b),BigInt(27));if(n.is0(n.add(f,g)))throw new Error("bad curve params: a or b");function w(D,S,E=!1){if(!n.isValid(S)||E&&n.is0(S))throw new Error(`bad point coordinate ${D}`);return S}function b(D){if(!(D instanceof v))throw new Error("ProjectivePoint expected")}const I=Cy((D,S)=>{const{px:E,py:N,pz:$}=D;if(n.eql($,n.ONE))return{x:E,y:N};const B=D.is0();S==null&&(S=B?n.ONE:n.inv($));const R=n.mul(E,S),A=n.mul(N,S),_=n.mul($,S);if(B)return{x:n.ZERO,y:n.ZERO};if(!n.eql(_,n.ONE))throw new Error("invZ was invalid");return{x:R,y:A}}),y=Cy(D=>{if(D.is0()){if(t.allowInfinityPoint&&!n.is0(D.py))return;throw new Error("bad point: ZERO")}const{x:S,y:E}=D.toAffine();if(!n.isValid(S)||!n.isValid(E))throw new Error("bad point: x or y not field elements");if(!p(S,E))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function m(D,S,E,N,$){return E=new v(n.mul(E.px,D),E.py,E.pz),S=tc(N,S),E=tc($,E),S.add(E)}class v{constructor(S,E,N){this.px=w("x",S),this.py=w("y",E,!0),this.pz=w("z",N),Object.freeze(this)}static fromAffine(S){const{x:E,y:N}=S||{};if(!S||!n.isValid(E)||!n.isValid(N))throw new Error("invalid affine point");if(S instanceof v)throw new Error("projective point not allowed");return n.is0(E)&&n.is0(N)?v.ZERO:new v(E,N,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(S){return e6(v,"pz",S)}static fromBytes(S){return qn(S),v.fromHex(S)}static fromHex(S){const E=v.fromAffine(d(an("pointHex",S)));return E.assertValidity(),E}static fromPrivateKey(S){const E=YC(r,t.allowedPrivateKeyLengths,t.wrapPrivateKey);return v.BASE.multiply(E(S))}static msm(S,E){return i6(v,r,S,E)}precompute(S=8,E=!0){return O.setWindowSize(this,S),E||this.multiply(eu),this}_setWindowSize(S){this.precompute(S)}assertValidity(){y(this)}hasEvenY(){const{y:S}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(S)}equals(S){b(S);const{px:E,py:N,pz:$}=this,{px:B,py:R,pz:A}=S,_=n.eql(n.mul(E,A),n.mul(B,$)),k=n.eql(n.mul(N,A),n.mul(R,$));return _&&k}negate(){return new v(this.px,n.neg(this.py),this.pz)}double(){const{a:S,b:E}=e,N=n.mul(E,eu),{px:$,py:B,pz:R}=this;let A=n.ZERO,_=n.ZERO,k=n.ZERO,M=n.mul($,$),U=n.mul(B,B),P=n.mul(R,R),H=n.mul($,B);return H=n.add(H,H),k=n.mul($,R),k=n.add(k,k),A=n.mul(S,k),_=n.mul(N,P),_=n.add(A,_),A=n.sub(U,_),_=n.add(U,_),_=n.mul(A,_),A=n.mul(H,A),k=n.mul(N,k),P=n.mul(S,P),H=n.sub(M,P),H=n.mul(S,H),H=n.add(H,k),k=n.add(M,M),M=n.add(k,M),M=n.add(M,P),M=n.mul(M,H),_=n.add(_,M),P=n.mul(B,R),P=n.add(P,P),M=n.mul(P,H),A=n.sub(A,M),k=n.mul(P,U),k=n.add(k,k),k=n.add(k,k),new v(A,_,k)}add(S){b(S);const{px:E,py:N,pz:$}=this,{px:B,py:R,pz:A}=S;let _=n.ZERO,k=n.ZERO,M=n.ZERO;const U=e.a,P=n.mul(e.b,eu);let H=n.mul(E,B),Y=n.mul(N,R),J=n.mul($,A),K=n.add(E,N),ne=n.add(B,R);K=n.mul(K,ne),ne=n.add(H,Y),K=n.sub(K,ne),ne=n.add(E,$);let ue=n.add(B,A);return ne=n.mul(ne,ue),ue=n.add(H,J),ne=n.sub(ne,ue),ue=n.add(N,$),_=n.add(R,A),ue=n.mul(ue,_),_=n.add(Y,J),ue=n.sub(ue,_),M=n.mul(U,ne),_=n.mul(P,J),M=n.add(_,M),_=n.sub(Y,M),M=n.add(Y,M),k=n.mul(_,M),Y=n.add(H,H),Y=n.add(Y,H),J=n.mul(U,J),ne=n.mul(P,ne),Y=n.add(Y,J),J=n.sub(H,J),J=n.mul(U,J),ne=n.add(ne,J),H=n.mul(Y,ne),k=n.add(k,H),H=n.mul(ue,ne),_=n.mul(K,_),_=n.sub(_,H),H=n.mul(K,Y),M=n.mul(ue,M),M=n.add(M,H),new v(_,k,M)}subtract(S){return this.add(S.negate())}is0(){return this.equals(v.ZERO)}multiply(S){const{endo:E}=t;if(!r.isValidNot0(S))throw new Error("invalid scalar: out of range");let N,$;const B=R=>O.wNAFCached(this,R,v.normalizeZ);if(E){const{k1neg:R,k1:A,k2neg:_,k2:k}=E.splitScalar(S),{p:M,f:U}=B(A),{p:P,f:H}=B(k);$=U.add(H),N=m(E.beta,M,P,R,_)}else{const{p:R,f:A}=B(S);N=R,$=A}return v.normalizeZ([N,$])[0]}multiplyUnsafe(S){const{endo:E}=t,N=this;if(!r.isValid(S))throw new Error("invalid scalar: out of range");if(S===nc||N.is0())return v.ZERO;if(S===rc)return N;if(O.hasPrecomputes(this))return this.multiply(S);if(E){const{k1neg:$,k1:B,k2neg:R,k2:A}=E.splitScalar(S),{p1:_,p2:k}=s6(v,N,B,A);return m(E.beta,_,k,$,R)}else return O.wNAFCachedUnsafe(N,S)}multiplyAndAddUnsafe(S,E,N){const $=this.multiplyUnsafe(E).add(S.multiplyUnsafe(N));return $.is0()?void 0:$}toAffine(S){return I(this,S)}isTorsionFree(){const{isTorsionFree:S}=t;return s===rc?!0:S?S(v,this):O.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:S}=t;return s===rc?this:S?S(v,this):this.multiplyUnsafe(s)}toBytes(S=!0){return Ju("isCompressed",S),this.assertValidity(),u(v,this,S)}toRawBytes(S=!0){return this.toBytes(S)}toHex(S=!0){return xc(this.toBytes(S))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}v.BASE=new v(e.Gx,e.Gy,n.ONE),v.ZERO=new v(n.ZERO,n.ONE,n.ZERO),v.Fp=n,v.Fn=r;const C=r.BITS,O=r6(v,t.endo?Math.ceil(C/2):C);return v}function ZC(e){return Uint8Array.of(e?2:3)}function b6(e,t,n={}){Nd(t,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=t.randomBytes||pa,s=t.hmac||((N,...$)=>Ad(t.hash,N,Ci(...$))),{Fp:i,Fn:o}=e,{ORDER:a,BITS:c}=o;function l(N){const $=a>>rc;return N>$}function u(N){return l(N)?o.neg(N):N}function d(N,$){if(!o.isValidNot0($))throw new Error(`invalid signature ${N}: out of range 1..CURVE.n`)}class h{constructor($,B,R){d("r",$),d("s",B),this.r=$,this.s=B,R!=null&&(this.recovery=R),Object.freeze(this)}static fromCompact($){const B=o.BYTES,R=an("compactSignature",$,B*2);return new h(o.fromBytes(R.subarray(0,B)),o.fromBytes(R.subarray(B,B*2)))}static fromDER($){const{r:B,s:R}=Xr.toSig(an("DER",$));return new h(B,R)}assertValidity(){}addRecoveryBit($){return new h(this.r,this.s,$)}recoverPublicKey($){const B=i.ORDER,{r:R,s:A,recovery:_}=this;if(_==null||![0,1,2,3].includes(_))throw new Error("recovery id invalid");if(a*g6<B&&_>1)throw new Error("recovery id is ambiguous for h>1 curve");const k=_===2||_===3?R+a:R;if(!i.isValid(k))throw new Error("recovery id 2 or 3 invalid");const M=i.toBytes(k),U=e.fromHex(Ci(ZC((_&1)===0),M)),P=o.inv(k),H=y(an("msgHash",$)),Y=o.create(-H*P),J=o.create(A*P),K=e.BASE.multiplyUnsafe(Y).add(U.multiplyUnsafe(J));if(K.is0())throw new Error("point at infinify");return K.assertValidity(),K}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,o.neg(this.s),this.recovery):this}toBytes($){if($==="compact")return Ci(o.toBytes(this.r),o.toBytes(this.s));if($==="der")return Kg(Xr.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return xc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return xc(this.toBytes("compact"))}}const p=YC(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),f={isValidPrivateKey(N){try{return p(N),!0}catch{return!1}},normPrivateKeyToScalar:p,randomPrivateKey:()=>{const N=a;return QU(r(WC(N)),N)},precompute(N=8,$=e.BASE){return $.precompute(N,!1)}};function g(N,$=!0){return e.fromPrivateKey(N).toBytes($)}function w(N){if(typeof N=="bigint")return!1;if(N instanceof e)return!0;const $=an("key",N).length,B=i.BYTES,R=B+1,A=2*B+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===R))return $===R||$===A}function b(N,$,B=!0){if(w(N)===!0)throw new Error("first arg must be private key");if(w($)===!1)throw new Error("second arg must be public key");return e.fromHex($).multiply(p(N)).toBytes(B)}const I=t.bits2int||function(N){if(N.length>8192)throw new Error("input is too large");const $=Sd(N),B=N.length*8-c;return B>0?$>>BigInt(B):$},y=t.bits2int_modN||function(N){return o.create(I(N))},m=xd(c);function v(N){return bp("num < 2^"+c,N,nc,m),o.toBytes(N)}function C(N,$,B=O){if(["recovered","canonical"].some(K=>K in B))throw new Error("sign() legacy options not supported");const{hash:R}=t;let{lowS:A,prehash:_,extraEntropy:k}=B;A==null&&(A=!0),N=an("msgHash",N),Ty(B),_&&(N=an("prehashed msgHash",R(N)));const M=y(N),U=p($),P=[v(U),v(M)];if(k!=null&&k!==!1){const K=k===!0?r(i.BYTES):k;P.push(an("extraEntropy",K))}const H=Ci(...P),Y=M;function J(K){const ne=I(K);if(!o.isValidNot0(ne))return;const ue=o.inv(ne),_e=e.BASE.multiply(ne).toAffine(),Ie=o.create(_e.x);if(Ie===nc)return;const be=o.create(ue*o.create(Y+Ie*U));if(be===nc)return;let nt=(_e.x===Ie?0:2)|Number(_e.y&rc),lt=be;return A&&l(be)&&(lt=u(be),nt^=1),new h(Ie,lt,nt)}return{seed:H,k2sig:J}}const O={lowS:t.lowS,prehash:!1},D={lowS:t.lowS,prehash:!1};function S(N,$,B=O){const{seed:R,k2sig:A}=C(N,$,B);return qU(t.hash.outputLen,o.BYTES,s)(R,A)}e.BASE.precompute(8);function E(N,$,B,R=D){const A=N;$=an("msgHash",$),B=an("publicKey",B),Ty(R);const{lowS:_,prehash:k,format:M}=R;if("strict"in R)throw new Error("options.strict was renamed to lowS");if(M!==void 0&&!["compact","der","js"].includes(M))throw new Error('format must be "compact", "der" or "js"');const U=typeof A=="string"||qg(A),P=!U&&!M&&typeof A=="object"&&A!==null&&typeof A.r=="bigint"&&typeof A.s=="bigint";if(!U&&!P)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let H,Y;try{if(P)if(M===void 0||M==="js")H=new h(A.r,A.s);else throw new Error("invalid format");if(U){try{M!=="compact"&&(H=h.fromDER(A))}catch(nt){if(!(nt instanceof Xr.Err))throw nt}!H&&M!=="der"&&(H=h.fromCompact(A))}Y=e.fromHex(B)}catch{return!1}if(!H||_&&H.hasHighS())return!1;k&&($=t.hash($));const{r:J,s:K}=H,ne=y($),ue=o.inv(K),_e=o.create(ne*ue),Ie=o.create(J*ue),be=e.BASE.multiplyUnsafe(_e).add(Y.multiplyUnsafe(Ie));return be.is0()?!1:o.create(be.x)===J}return Object.freeze({getPublicKey:g,getSharedSecret:b,sign:S,verify:E,utils:f,Point:e,Signature:h})}function v6(e){const t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},n=e.Fp,r=ga(t.n,e.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:e.allowedPrivateKeyLengths,allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,wrapPrivateKey:e.wrapPrivateKey,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}function E6(e){const{CURVE:t,curveOpts:n}=v6(e),r={hash:e.hash,hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:n,ecdsaOpts:r}}function C6(e,t){return Object.assign({},t,{ProjectivePoint:t.Point,CURVE:e})}function A6(e){const{CURVE:t,curveOpts:n,ecdsaOpts:r}=E6(e),s=y6(t,n),i=b6(s,r,n);return C6(e,i)}function Ep(e,t){const n=r=>A6({...e,hash:r});return{...n(t),create:n}}const JC={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},XC={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},QC={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},I6=ga(JC.p),S6=ga(XC.p),x6=ga(QC.p),N6=Ep({...JC,Fp:I6,lowS:!1},Cd);Ep({...XC,Fp:S6,lowS:!1},U5),Ep({...QC,Fp:x6,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},k5);const _6=N6,eA="base10",Vt="base16",cr="base64pad",Ts="base64url",pl="utf8",tA=0,es=1,gl=2,T6=0,Oy=1,sc=12,Qg=32;function O6(){const e=vp.utils.randomPrivateKey(),t=vp.getPublicKey(e);return{privateKey:dn(e,Vt),publicKey:dn(t,Vt)}}function Cp(){const e=pa(Qg);return dn(e,Vt)}function D6(e,t){const n=vp.getSharedSecret(zn(e,Vt),zn(t,Vt)),r=FU(Id,n,void 0,void 0,Qg);return dn(r,Vt)}function Iu(e){const t=Id(zn(e,Vt));return dn(t,Vt)}function Ir(e){const t=Id(zn(e,pl));return dn(t,Vt)}function nA(e){return zn(`${e}`,eA)}function ji(e){return Number(dn(e,eA))}function rA(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function sA(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=(4-t.length%4)%4;return t+"=".repeat(n)}function $6(e){const t=nA(typeof e.type<"u"?e.type:tA);if(ji(t)===es&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof e.senderPublicKey<"u"?zn(e.senderPublicKey,Vt):void 0,r=typeof e.iv<"u"?zn(e.iv,Vt):pa(sc),s=zn(e.symKey,Vt),i=RC(s,r).encrypt(zn(e.message,pl)),o=iA({type:t,sealed:i,iv:r,senderPublicKey:n});return e.encoding===Ts?rA(o):o}function P6(e){const t=zn(e.symKey,Vt),{sealed:n,iv:r}=_c({encoded:e.encoded,encoding:e.encoding}),s=RC(t,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return dn(s,pl)}function k6(e,t){const n=nA(gl),r=pa(sc),s=zn(e,pl),i=iA({type:n,sealed:s,iv:r});return t===Ts?rA(i):i}function U6(e,t){const{sealed:n}=_c({encoded:e,encoding:t});return dn(n,pl)}function iA(e){if(ji(e.type)===gl)return dn(ec([e.type,e.sealed]),cr);if(ji(e.type)===es){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return dn(ec([e.type,e.senderPublicKey,e.iv,e.sealed]),cr)}return dn(ec([e.type,e.iv,e.sealed]),cr)}function _c(e){const t=(e.encoding||cr)===Ts?sA(e.encoded):e.encoded,n=zn(t,cr),r=n.slice(T6,Oy),s=Oy;if(ji(r)===es){const c=s+Qg,l=c+sc,u=n.slice(s,c),d=n.slice(c,l),h=n.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(ji(r)===gl){const c=n.slice(s),l=pa(sc);return{type:r,sealed:c,iv:l}}const i=s+sc,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function R6(e,t){const n=_c({encoded:e,encoding:t?.encoding});return oA({type:ji(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?dn(n.senderPublicKey,Vt):void 0,receiverPublicKey:t?.receiverPublicKey})}function oA(e){const t=e?.type||tA;if(t===es){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Dy(e){return e.type===es&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}function $y(e){return e.type===gl}function B6(e){const t=Buffer.from(e.x,"base64"),n=Buffer.from(e.y,"base64");return ec([new Uint8Array([4]),t,n])}function M6(e,t){const[n,r,s]=e.split("."),i=Buffer.from(sA(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=Id(c),u=B6(t);if(!_6.verify(ec([o,a]),l,u))throw new Error("Invalid signature");return rp(e).payload}const L6="irn";function Qu(e){return e?.relay||{protocol:L6}}function Ka(e){const t=E4[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}function j6(e,t="-"){const n={},r="relay"+t;return Object.keys(e).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=e[s];n[i]=o}}),n}function Py(e){if(!e.includes("wc:")){const l=mC(e);l!=null&&l.includes("wc:")&&(e=l)}e=e.includes("wc://")?e.replace("wc://",""):e,e=e.includes("wc:")?e.replace("wc:",""):e;const t=e.indexOf(":"),n=e.indexOf("?")!==-1?e.indexOf("?"):void 0,r=e.substring(0,t),s=e.substring(t+1,n).split("@"),i=typeof n<"u"?e.substring(n):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:F6(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:j6(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function F6(e){return e.startsWith("//")?e.substring(2):e}function H6(e,t="-"){const n="relay",r={};return Object.keys(e).forEach(s=>{const i=s,o=n+t+i;e[i]&&(r[o]=e[i])}),r}function ky(e){const t=new URLSearchParams,n=H6(e.relay);Object.keys(n).sort().forEach(s=>{t.set(s,n[s])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));const r=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${r}`}function tu(e,t,n){return`${e}?wc_ev=${n}&topic=${t}`}var z6=Object.defineProperty,q6=Object.defineProperties,W6=Object.getOwnPropertyDescriptors,Uy=Object.getOwnPropertySymbols,V6=Object.prototype.hasOwnProperty,K6=Object.prototype.propertyIsEnumerable,Ry=(e,t,n)=>t in e?z6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,G6=(e,t)=>{for(var n in t||(t={}))V6.call(t,n)&&Ry(e,n,t[n]);if(Uy)for(var n of Uy(t))K6.call(t,n)&&Ry(e,n,t[n]);return e},Y6=(e,t)=>q6(e,W6(t));function wa(e){const t=[];return e.forEach(n=>{const[r,s]=n.split(":");t.push(`${r}:${s}`)}),t}function Z6(e){const t=[];return Object.values(e).forEach(n=>{t.push(...wa(n.accounts))}),t}function J6(e,t){const n=[];return Object.values(e).forEach(r=>{wa(r.accounts).includes(t)&&n.push(...r.methods)}),n}function X6(e,t){const n=[];return Object.values(e).forEach(r=>{wa(r.accounts).includes(t)&&n.push(...r.events)}),n}function _d(e){return e.includes(":")}function Ro(e){return _d(e)?e.split(":")[0]:e}function By(e){var t,n,r;const s={};if(!Dr(e))return s;for(const[i,o]of Object.entries(e)){const a=_d(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Ro(i);s[u]=Y6(G6({},s[u]),{chains:Or(a,(t=s[u])==null?void 0:t.chains),methods:Or(c,(n=s[u])==null?void 0:n.methods),events:Or(l,(r=s[u])==null?void 0:r.events)})}return s}function Q6(e){const t={};return e?.forEach(n=>{var r;const[s,i]=n.split(":");t[s]||(t[s]={accounts:[],chains:[],events:[],methods:[]}),t[s].accounts.push(n),(r=t[s].chains)==null||r.push(`${s}:${i}`)}),t}function My(e,t){t=t.map(r=>r.replace("did:pkh:",""));const n=Q6(t);for(const[r,s]of Object.entries(n))s.methods?s.methods=Or(s.methods,e):s.methods=e,s.events=["chainChanged","accountsChanged"];return n}function eR(e,t){var n,r,s,i,o,a;const c=By(e),l=By(t),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:Or((n=c[h])==null?void 0:n.chains,(r=l[h])==null?void 0:r.chains),methods:Or((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:Or((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const tR={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},nR={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function G(e,t){const{message:n,code:r}=nR[e];return{message:t?`${n} ${t}`:n,code:r}}function et(e,t){const{message:n,code:r}=tR[e];return{message:t?`${n} ${t}`:n,code:r}}function ts(e,t){return!!Array.isArray(e)}function Dr(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Ot(e){return typeof e>"u"}function dt(e,t){return t&&Ot(e)?!0:typeof e=="string"&&!!e.trim().length}function ew(e,t){return t&&Ot(e)?!0:typeof e=="number"&&!isNaN(e)}function rR(e,t){const{requiredNamespaces:n}=t,r=Object.keys(e.namespaces),s=Object.keys(n);let i=!0;return Ei(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=e.namespaces[o],u=wa(a),d=n[o];(!Ei(hC(o,d),u)||!Ei(d.methods,c)||!Ei(d.events,l))&&(i=!1)}),i):!1}function ed(e){return dt(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function sR(e){if(dt(e,!1)&&e.includes(":")){const t=e.split(":");if(t.length===3){const n=t[0]+":"+t[1];return!!t[2]&&ed(n)}}return!1}function iR(e){function t(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(dt(e,!1)){if(t(e))return!0;const n=mC(e);return t(n)}}catch{}return!1}function oR(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function aR(e){return e?.topic}function cR(e,t){let n=null;return dt(e?.publicKey,!1)||(n=G("MISSING_OR_INVALID",`${t} controller public key should be a string`)),n}function Ly(e){let t=!0;return ts(e)?e.length&&(t=e.every(n=>dt(n,!1))):t=!1,t}function lR(e,t,n){let r=null;return ts(t)&&t.length?t.forEach(s=>{r||ed(s)||(r=et("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):ed(e)||(r=et("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function uR(e,t,n){let r=null;return Object.entries(e).forEach(([s,i])=>{if(r)return;const o=lR(s,hC(s,i),`${t} ${n}`);o&&(r=o)}),r}function dR(e,t){let n=null;return ts(e)?e.forEach(r=>{n||sR(r)||(n=et("UNSUPPORTED_ACCOUNTS",`${t}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=et("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function hR(e,t){let n=null;return Object.values(e).forEach(r=>{if(n)return;const s=dR(r?.accounts,`${t} namespace`);s&&(n=s)}),n}function fR(e,t){let n=null;return Ly(e?.methods)?Ly(e?.events)||(n=et("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):n=et("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),n}function aA(e,t){let n=null;return Object.values(e).forEach(r=>{if(n)return;const s=fR(r,`${t}, namespace`);s&&(n=s)}),n}function pR(e,t,n){let r=null;if(e&&Dr(e)){const s=aA(e,t);s&&(r=s);const i=uR(e,t,n);i&&(r=i)}else r=G("MISSING_OR_INVALID",`${t}, ${n} should be an object with data`);return r}function Kh(e,t){let n=null;if(e&&Dr(e)){const r=aA(e,t);r&&(n=r);const s=hR(e,t);s&&(n=s)}else n=G("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return n}function cA(e){return dt(e.protocol,!0)}function gR(e,t){let n=!1;return e?e&&ts(e)&&e.length&&e.forEach(r=>{n=cA(r)}):n=!0,n}function wR(e){return typeof e=="number"}function on(e){return typeof e<"u"&&typeof e!==null}function mR(e){return!(!e||typeof e!="object"||!e.code||!ew(e.code,!1)||!e.message||!dt(e.message,!1))}function yR(e){return!(Ot(e)||!dt(e.method,!1))}function bR(e){return!(Ot(e)||Ot(e.result)&&Ot(e.error)||!ew(e.id,!1)||!dt(e.jsonrpc,!1))}function vR(e){return!(Ot(e)||!dt(e.name,!1))}function jy(e,t){return!(!ed(t)||!Z6(e).includes(t))}function ER(e,t,n){return dt(n,!1)?J6(e,t).includes(n):!1}function CR(e,t,n){return dt(n,!1)?X6(e,t).includes(n):!1}function Fy(e,t,n){let r=null;const s=AR(e),i=IR(t),o=Object.keys(s),a=Object.keys(i),c=Hy(Object.keys(e)),l=Hy(Object.keys(t)),u=c.filter(d=>!l.includes(d));return u.length&&(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(t).toString()}`)),Ei(o,a)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(d=>{if(!d.includes(":")||r)return;const h=wa(t[d].accounts);h.includes(d)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(Ei(s[d].methods,i[d].methods)?Ei(s[d].events,i[d].events)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function AR(e){const t={};return Object.keys(e).forEach(n=>{var r;n.includes(":")?t[n]=e[n]:(r=e[n].chains)==null||r.forEach(s=>{t[s]={methods:e[n].methods,events:e[n].events}})}),t}function Hy(e){return[...new Set(e.map(t=>t.includes(":")?t.split(":")[0]:t))]}function IR(e){const t={};return Object.keys(e).forEach(n=>{n.includes(":")?t[n]=e[n]:wa(e[n].accounts)?.forEach(s=>{t[s]={accounts:e[n].accounts.filter(i=>i.includes(`${s}:`)),methods:e[n].methods,events:e[n].events}})}),t}function SR(e,t){return ew(e,!1)&&e<=t.max&&e>=t.min}function zy(){const e=hl();return new Promise(t=>{switch(e){case Nn.browser:t(xR());break;case Nn.reactNative:t(NR());break;case Nn.node:t(_R());break;default:t(!0)}})}function xR(){return fa()&&navigator?.onLine}async function NR(){return Gs()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function _R(){return!0}function TR(e){switch(hl()){case Nn.browser:OR(e);break;case Nn.reactNative:DR(e);break}}function OR(e){!Gs()&&fa()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)))}function DR(e){Gs()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(t=>e(t?.isConnected))}function $R(){var e;return fa()&&is.getDocument()?((e=is.getDocument())==null?void 0:e.visibilityState)==="visible":!0}const Gh={};class Ua{static get(t){return Gh[t]}static set(t,n){Gh[t]=n}static delete(t){delete Gh[t]}}function PR(e){const t=ha.decode(e);if(t.length<33)throw new Error("Too short to contain a public key");return t.slice(1,33)}function kR({publicKey:e,signature:t,payload:n}){var r;const s=Ap(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=BR(n.address),a=n.era==="00"?new Uint8Array([0]):Ap(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${RR(n.tip)}`),d=LR(u),h=new Uint8Array([0,...e,o,...t,...a,...l,...d,...s]),p=MR(h.length+1);return new Uint8Array([...p,i,...h])}function UR(e){const t=Ap(e),n=S4.blake2b(t,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function Ap(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(t=>parseInt(t,16)))}function RR(e){return e.startsWith("0x")?e.slice(2):e}function BR(e){const t=ha.decode(e)[0];return t===42?0:t===60?2:1}function MR(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){const t=e<<2|1;return new Uint8Array([t&255,t>>8&255])}else if(e<1<<30){const t=e<<2|2;return new Uint8Array([t&255,t>>8&255,t>>16&255,t>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function LR(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){const t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}else if(e<BigInt(1)<<BigInt(30)){const t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function jR(e){const t=Uint8Array.from(Buffer.from(e.signature,"hex")),n=PR(e.transaction.address),r=kR({publicKey:n,signature:t,payload:e.transaction}),s=Buffer.from(r).toString("hex");return UR(s)}const FR="PARSE_ERROR",HR="INVALID_REQUEST",zR="METHOD_NOT_FOUND",qR="INVALID_PARAMS",lA="INTERNAL_ERROR",tw="SERVER_ERROR",WR=[-32700,-32600,-32601,-32602,-32603],ic={[FR]:{code:-32700,message:"Parse error"},[HR]:{code:-32600,message:"Invalid Request"},[zR]:{code:-32601,message:"Method not found"},[qR]:{code:-32602,message:"Invalid params"},[lA]:{code:-32603,message:"Internal error"},[tw]:{code:-32e3,message:"Server error"}},uA=tw;function VR(e){return WR.includes(e)}function qy(e){return Object.keys(ic).includes(e)?ic[e]:ic[uA]}function KR(e){const t=Object.values(ic).find(n=>n.code===e);return t||ic[uA]}function dA(e,t,n){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${t}`):e}var Yh={},Wr={},Wy;function GR(){if(Wy)return Wr;Wy=1,Object.defineProperty(Wr,"__esModule",{value:!0}),Wr.isBrowserCryptoAvailable=Wr.getSubtleCrypto=Wr.getBrowerCrypto=void 0;function e(){return Ht?.crypto||Ht?.msCrypto||{}}Wr.getBrowerCrypto=e;function t(){const r=e();return r.subtle||r.webkitSubtle}Wr.getSubtleCrypto=t;function n(){return!!e()&&!!t()}return Wr.isBrowserCryptoAvailable=n,Wr}var Vr={},Vy;function YR(){if(Vy)return Vr;Vy=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.isBrowser=Vr.isNode=Vr.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Vr.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Vr.isNode=t;function n(){return!e()&&!t()}return Vr.isBrowser=n,Vr}var Ky;function ZR(){return Ky||(Ky=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=il;t.__exportStar(GR(),e),t.__exportStar(YR(),e)})(Yh)),Yh}var JR=ZR();function Cr(e=3){const t=Date.now()*Math.pow(10,e),n=Math.floor(Math.random()*Math.pow(10,e));return t+n}function Si(e=6){return BigInt(Cr(e))}function ks(e,t,n){return{id:n||Cr(),jsonrpc:"2.0",method:e,params:t}}function Td(e,t){return{id:e,jsonrpc:"2.0",result:t}}function Od(e,t,n){return{id:e,jsonrpc:"2.0",error:XR(t)}}function XR(e,t){return typeof e>"u"?qy(lA):(typeof e=="string"&&(e=Object.assign(Object.assign({},qy(tw)),{message:e})),VR(e.code)&&(e=KR(e.code)),e)}let QR=class{},eB=class extends QR{constructor(){super()}},tB=class extends eB{constructor(t){super()}};const nB="^https?:",rB="^wss?:";function sB(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function hA(e,t){const n=sB(e);return typeof n>"u"?!1:new RegExp(t).test(n)}function Gy(e){return hA(e,nB)}function Yy(e){return hA(e,rB)}function iB(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function fA(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function nw(e){return fA(e)&&"method"in e}function Dd(e){return fA(e)&&(Ar(e)||jn(e))}function Ar(e){return"result"in e}function jn(e){return"error"in e}let Kn=class extends tB{constructor(t){super(t),this.events=new Vn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async request(t,n){return this.requestStrict(ks(t.method,t.params||[],t.id||Si().toString()),n)}async requestStrict(t,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${t.id}`,i=>{jn(i)?s(i.error):r(i.result)});try{await this.connection.send(t,n)}catch(i){s(i)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Dd(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const oB=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),aB=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Zy=e=>e.split("?")[0],Jy=10,cB=oB();let lB=class{constructor(t){if(this.url=t,this.events=new Vn.EventEmitter,this.registering=!1,!Yy(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ss(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!Yy(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=t,this.registering=!0,new Promise((n,r)=>{const s=JR.isReactNative()?void 0:{rejectUnauthorized:!iB(t)},i=new cB(t,[],s);aB()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(t){t.onmessage=n=>this.onPayload(n),t.onclose=n=>this.onClose(n),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const n=typeof t.data=="string"?Mi(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n),s=r.message||r.toString(),i=Od(t,s);this.events.emit("payload",i)}parseError(t,n=this.url){return dA(t,Zy(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Jy&&this.events.setMaxListeners(Jy)}emitError(t){const n=this.parseError(new Error(t?.message||`WebSocket connection failed for host: ${Zy(this.url)}`));return this.events.emit("register_error",n),n}};var uB={};const pA="wc",gA=2,Ip="core",Pr=`${pA}@2:${Ip}:`,dB={logger:"error"},hB={database:":memory:"},fB="crypto",Xy="client_ed25519_seed",pB=Z.ONE_DAY,gB="keychain",wB="0.3",mB="messages",yB="0.3",Qy=Z.SIX_HOURS,bB="publisher",wA="irn",vB="error",mA="wss://relay.walletconnect.org",EB="relayer",vt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},CB="_subscription",kn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},AB=.1,Sp="2.21.5",Xe={link_mode:"link_mode",relay:"relay"},Su={inbound:"inbound",outbound:"outbound"},IB="0.3",SB="WALLETCONNECT_CLIENT_ID",eb="WALLETCONNECT_LINK_MODE_APPS",yn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},xB="subscription",NB="0.3",_B="pairing",TB="0.3",Ra={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},wi={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Jn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},OB="history",DB="0.3",$B="expirer",Ln={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},PB="0.3",kB="verify-api",UB="https://verify.walletconnect.com",yA="https://verify.walletconnect.org",oc=yA,RB=`${oc}/v3`,BB=[UB,yA],MB="echo",LB="https://echo.walletconnect.com",Er={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Jr={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Xn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},oi={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},ai={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Ba={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},jB=.1,FB="event-client",HB=86400,zB="https://pulse.walletconnect.org/batch";function qB(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<e.length;s++){var i=e.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(f){if(f instanceof Uint8Array||(ArrayBuffer.isView(f)?f=new Uint8Array(f.buffer,f.byteOffset,f.byteLength):Array.isArray(f)&&(f=Uint8Array.from(f))),!(f instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(f.length===0)return"";for(var g=0,w=0,b=0,I=f.length;b!==I&&f[b]===0;)b++,g++;for(var y=(I-b)*u+1>>>0,m=new Uint8Array(y);b!==I;){for(var v=f[b],C=0,O=y-1;(v!==0||C<w)&&O!==-1;O--,C++)v+=256*m[O]>>>0,m[O]=v%a>>>0,v=v/a>>>0;if(v!==0)throw new Error("Non-zero carry");w=C,b++}for(var D=y-w;D!==y&&m[D]===0;)D++;for(var S=c.repeat(g);D<y;++D)S+=e.charAt(m[D]);return S}function h(f){if(typeof f!="string")throw new TypeError("Expected String");if(f.length===0)return new Uint8Array;var g=0;if(f[g]!==" "){for(var w=0,b=0;f[g]===c;)w++,g++;for(var I=(f.length-g)*l+1>>>0,y=new Uint8Array(I);f[g];){var m=n[f.charCodeAt(g)];if(m===255)return;for(var v=0,C=I-1;(m!==0||v<b)&&C!==-1;C--,v++)m+=a*y[C]>>>0,y[C]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");b=v,g++}if(f[g]!==" "){for(var O=I-b;O!==I&&y[O]===0;)O++;for(var D=new Uint8Array(w+(I-O)),S=w;O!==I;)D[S++]=y[O++];return D}}}function p(f){var g=h(f);if(g)return g;throw new Error(`Non-${t} character`)}return{encode:d,decodeUnsafe:h,decode:p}}var WB=qB,VB=WB;const bA=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},KB=e=>new TextEncoder().encode(e),GB=e=>new TextDecoder().decode(e);class YB{constructor(t,n,r){this.name=t,this.prefix=n,this.baseEncode=r}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class ZB{constructor(t,n,r){if(this.name=t,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return vA(this,t)}}class JB{constructor(t){this.decoders=t}or(t){return vA(this,t)}decode(t){const n=t[0],r=this.decoders[n];if(r)return r.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vA=(e,t)=>new JB({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class XB{constructor(t,n,r,s){this.name=t,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new YB(t,n,r),this.decoder=new ZB(t,n,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const $d=({name:e,prefix:t,encode:n,decode:r})=>new XB(e,t,n,r),wl=({prefix:e,name:t,alphabet:n})=>{const{encode:r,decode:s}=VB(n,t);return $d({prefix:e,name:t,encode:r,decode:i=>bA(s(i))})},QB=(e,t,n,r)=>{const s={};for(let u=0;u<t.length;++u)s[t[u]]=u;let i=e.length;for(;e[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[e[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},eM=(e,t,n)=>{const r=t[t.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],o+=8;o>n;)o-=n,i+=t[s&a>>o];if(o&&(i+=t[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Ut=({name:e,prefix:t,bitsPerChar:n,alphabet:r})=>$d({prefix:t,name:e,encode(s){return eM(s,r,n)},decode(s){return QB(s,r,n,e)}}),tM=$d({prefix:"\0",name:"identity",encode:e=>GB(e),decode:e=>KB(e)});var nM=Object.freeze({__proto__:null,identity:tM});const rM=Ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var sM=Object.freeze({__proto__:null,base2:rM});const iM=Ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var oM=Object.freeze({__proto__:null,base8:iM});const aM=wl({prefix:"9",name:"base10",alphabet:"0123456789"});var cM=Object.freeze({__proto__:null,base10:aM});const lM=Ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),uM=Ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var dM=Object.freeze({__proto__:null,base16:lM,base16upper:uM});const hM=Ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),fM=Ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),pM=Ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),gM=Ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),wM=Ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mM=Ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yM=Ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),bM=Ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),vM=Ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var EM=Object.freeze({__proto__:null,base32:hM,base32upper:fM,base32pad:pM,base32padupper:gM,base32hex:wM,base32hexupper:mM,base32hexpad:yM,base32hexpadupper:bM,base32z:vM});const CM=wl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),AM=wl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var IM=Object.freeze({__proto__:null,base36:CM,base36upper:AM});const SM=wl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),xM=wl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var NM=Object.freeze({__proto__:null,base58btc:SM,base58flickr:xM});const _M=Ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),TM=Ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),OM=Ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),DM=Ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $M=Object.freeze({__proto__:null,base64:_M,base64pad:TM,base64url:OM,base64urlpad:DM});const EA=Array.from(""),PM=EA.reduce((e,t,n)=>(e[n]=t,e),[]),kM=EA.reduce((e,t,n)=>(e[t.codePointAt(0)]=n,e),[]);function UM(e){return e.reduce((t,n)=>(t+=PM[n],t),"")}function RM(e){const t=[];for(const n of e){const r=kM[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);t.push(r)}return new Uint8Array(t)}const BM=$d({prefix:"",name:"base256emoji",encode:UM,decode:RM});var MM=Object.freeze({__proto__:null,base256emoji:BM}),LM=CA,tb=128,jM=-128,FM=Math.pow(2,31);function CA(e,t,n){t=t||[],n=n||0;for(var r=n;e>=FM;)t[n++]=e&255|tb,e/=128;for(;e&jM;)t[n++]=e&255|tb,e>>>=7;return t[n]=e|0,CA.bytes=n-r+1,t}var HM=xp,zM=128,nb=127;function xp(e,r){var n=0,r=r||0,s=0,i=r,o,a=e.length;do{if(i>=a)throw xp.bytes=0,new RangeError("Could not decode varint");o=e[i++],n+=s<28?(o&nb)<<s:(o&nb)*Math.pow(2,s),s+=7}while(o>=zM);return xp.bytes=i-r,n}var qM=Math.pow(2,7),WM=Math.pow(2,14),VM=Math.pow(2,21),KM=Math.pow(2,28),GM=Math.pow(2,35),YM=Math.pow(2,42),ZM=Math.pow(2,49),JM=Math.pow(2,56),XM=Math.pow(2,63),QM=function(e){return e<qM?1:e<WM?2:e<VM?3:e<KM?4:e<GM?5:e<YM?6:e<ZM?7:e<JM?8:e<XM?9:10},eL={encode:LM,decode:HM,encodingLength:QM},AA=eL;const rb=(e,t,n=0)=>(AA.encode(e,t,n),t),sb=e=>AA.encodingLength(e),Np=(e,t)=>{const n=t.byteLength,r=sb(e),s=r+sb(n),i=new Uint8Array(s+n);return rb(e,i,0),rb(n,i,r),i.set(t,s),new tL(e,n,t,i)};class tL{constructor(t,n,r,s){this.code=t,this.size=n,this.digest=r,this.bytes=s}}const IA=({name:e,code:t,encode:n})=>new nL(e,t,n);class nL{constructor(t,n,r){this.name=t,this.code=n,this.encode=r}digest(t){if(t instanceof Uint8Array){const n=this.encode(t);return n instanceof Uint8Array?Np(this.code,n):n.then(r=>Np(this.code,r))}else throw Error("Unknown type, must be binary type")}}const SA=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),rL=IA({name:"sha2-256",code:18,encode:SA("SHA-256")}),sL=IA({name:"sha2-512",code:19,encode:SA("SHA-512")});var iL=Object.freeze({__proto__:null,sha256:rL,sha512:sL});const xA=0,oL="identity",NA=bA,aL=e=>Np(xA,NA(e)),cL={code:xA,name:oL,encode:NA,digest:aL};var lL=Object.freeze({__proto__:null,identity:cL});new TextEncoder,new TextDecoder;const ib={...nM,...sM,...oM,...cM,...dM,...EM,...IM,...NM,...$M,...MM};({...iL,...lL});function _A(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function uL(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?_A(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function TA(e,t,n,r){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:n},decoder:{decode:r}}}const ob=TA("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Zh=TA("ascii","a",e=>{let t="a";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},e=>{e=e.substring(1);const t=uL(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}),dL={utf8:ob,"utf-8":ob,hex:ib.base16,latin1:Zh,ascii:Zh,binary:Zh,...ib};function hL(e,t="utf8"){const n=dL[t];if(!n)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?_A(globalThis.Buffer.from(e,"utf-8")):n.decoder.decode(`${n.prefix}${e}`)}var fL=Object.defineProperty,pL=(e,t,n)=>t in e?fL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yr=(e,t,n)=>pL(e,typeof t!="symbol"?t+"":t,n);let gL=class{constructor(t,n){this.core=t,this.logger=n,yr(this,"keychain",new Map),yr(this,"name",gB),yr(this,"version",wB),yr(this,"initialized",!1),yr(this,"storagePrefix",Pr),yr(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),yr(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),yr(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),yr(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),yr(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=t,this.logger=Gt(n,this.name)}get context(){return fn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,dp(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?hp(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}};var wL=Object.defineProperty,mL=(e,t,n)=>t in e?wL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,xt=(e,t,n)=>mL(e,typeof t!="symbol"?t+"":t,n);class yL{constructor(t,n,r){this.core=t,this.logger=n,xt(this,"name",fB),xt(this,"keychain"),xt(this,"randomSessionIdentifier",Cp()),xt(this,"initialized",!1),xt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),xt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),xt(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=Om(s);return ME(i.publicKey)}),xt(this,"generateKeyPair",()=>{this.isInitialized();const s=O6();return this.setPrivateKey(s.publicKey,s.privateKey)}),xt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=Om(i),a=this.randomSessionIdentifier;return await UP(a,s,pB,o)}),xt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=D6(a,i);return this.setSymKey(c,o)}),xt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Iu(s);return await this.keychain.set(o,s),o}),xt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),xt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),xt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=oA(o),c=ss(i);if($y(a))return k6(c,o?.encoding);if(Dy(a)){const h=a.senderPublicKey,p=a.receiverPublicKey;s=await this.generateSharedKey(h,p)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return $6({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),xt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=R6(i,o);if($y(a)){const c=U6(i,o?.encoding);return Mi(c)}if(Dy(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=P6({symKey:c,encoded:i,encoding:o?.encoding});return Mi(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),xt(this,"getPayloadType",(s,i=cr)=>{const o=_c({encoded:s,encoding:i});return ji(o.type)}),xt(this,"getPayloadSenderPublicKey",(s,i=cr)=>{const o=_c({encoded:s,encoding:i});return o.senderPublicKey?dn(o.senderPublicKey,Vt):void 0}),this.core=t,this.logger=Gt(n,this.name),this.keychain=r||new gL(this.core,this.logger)}get context(){return fn(this.logger)}async setPrivateKey(t,n){return await this.keychain.set(t,n),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Xy)}catch{t=Cp(),await this.keychain.set(Xy,t)}return hL(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}var bL=Object.defineProperty,vL=Object.defineProperties,EL=Object.getOwnPropertyDescriptors,ab=Object.getOwnPropertySymbols,CL=Object.prototype.hasOwnProperty,AL=Object.prototype.propertyIsEnumerable,_p=(e,t,n)=>t in e?bL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,IL=(e,t)=>{for(var n in t||(t={}))CL.call(t,n)&&_p(e,n,t[n]);if(ab)for(var n of ab(t))AL.call(t,n)&&_p(e,n,t[n]);return e},SL=(e,t)=>vL(e,EL(t)),wn=(e,t,n)=>_p(e,typeof t!="symbol"?t+"":t,n);class xL extends PO{constructor(t,n){super(t,n),this.logger=t,this.core=n,wn(this,"messages",new Map),wn(this,"messagesWithoutClientAck",new Map),wn(this,"name",mB),wn(this,"version",yB),wn(this,"initialized",!1),wn(this,"storagePrefix",Pr),wn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),wn(this,"set",async(r,s,i)=>{this.isInitialized();const o=Ir(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===Su.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,SL(IL({},c),{[o]:s}))}return await this.persist(),o}),wn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),wn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),wn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=Ir(s);return typeof i[o]<"u"}),wn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=Ir(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),wn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Gt(t,this.name),this.core=n}get context(){return fn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,dp(t))}async setRelayerMessagesWithoutClientAck(t){await this.core.storage.setItem(this.storageKeyWithoutClientAck,dp(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?hp(t):void 0}async getRelayerMessagesWithoutClientAck(){const t=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof t<"u"?hp(t):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}var NL=Object.defineProperty,_L=Object.defineProperties,TL=Object.getOwnPropertyDescriptors,cb=Object.getOwnPropertySymbols,OL=Object.prototype.hasOwnProperty,DL=Object.prototype.propertyIsEnumerable,Tp=(e,t,n)=>t in e?NL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nu=(e,t)=>{for(var n in t||(t={}))OL.call(t,n)&&Tp(e,n,t[n]);if(cb)for(var n of cb(t))DL.call(t,n)&&Tp(e,n,t[n]);return e},Jh=(e,t)=>_L(e,TL(t)),Qn=(e,t,n)=>Tp(e,typeof t!="symbol"?t+"":t,n);class $L extends kO{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,Qn(this,"events",new Vn.EventEmitter),Qn(this,"name",bB),Qn(this,"queue",new Map),Qn(this,"publishTimeout",Z.toMiliseconds(Z.ONE_MINUTE)),Qn(this,"initialPublishTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),Qn(this,"needsTransportRestart",!1),Qn(this,"publish",async(r,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const a=i?.ttl||Qy,c=Qu(i),l=i?.prompt||!1,u=i?.tag||0,d=i?.id||Si().toString(),h={topic:r,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:d,attestation:i?.attestation,tvf:i?.tvf}},p=`Failed to publish payload, please try again. id:${d} tag:${u}`;try{const f=new Promise(async g=>{const w=({id:I})=>{h.opts.id===I&&(this.removeRequestFromQueue(I),this.relayer.events.removeListener(vt.publish,w),g(h))};this.relayer.events.on(vt.publish,w);const b=Ps(new Promise((I,y)=>{this.rpcPublish({topic:r,message:s,ttl:a,prompt:l,tag:u,id:d,attestation:i?.attestation,tvf:i?.tvf}).then(I).catch(m=>{this.logger.warn(m,m?.message),y(m)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${u}`);try{await b,this.events.removeListener(vt.publish,w)}catch(I){this.queue.set(d,Jh(nu({},h),{attempt:1})),this.logger.warn(I,I?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:r,message:s,opts:i}}),await Ps(f,this.publishTimeout,p)}catch(f){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(f),(o=i?.internal)!=null&&o.throwOnFailedPublish)throw f}finally{this.queue.delete(d)}}),Qn(this,"on",(r,s)=>{this.events.on(r,s)}),Qn(this,"once",(r,s)=>{this.events.once(r,s)}),Qn(this,"off",(r,s)=>{this.events.off(r,s)}),Qn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=t,this.logger=Gt(n,this.name),this.registerEventListeners()}get context(){return fn(this.logger)}async rpcPublish(t){var n,r,s,i;const{topic:o,message:a,ttl:c=Qy,prompt:l,tag:u,id:d,attestation:h,tvf:p}=t,f={method:Ka(Qu().protocol).publish,params:nu({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:h},p),id:d};Ot((n=f.params)==null?void 0:n.prompt)&&((r=f.params)==null||delete r.prompt),Ot((s=f.params)==null?void 0:s.tag)&&((i=f.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:f});const g=await this.relayer.request(f);return this.relayer.events.emit(vt.publish,t),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async(t,n)=>{const r=t.attempt+1;this.queue.set(n,Jh(nu({},t),{attempt:r}));const{topic:s,message:i,opts:o,attestation:a}=t;this.logger.warn({},`Publisher: queue->publishing: ${t.opts.id}, tag: ${t.opts.tag}, attempt: ${r}`),await this.rpcPublish(Jh(nu({},t),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${t.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Ki.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(vt.connection_stalled);return}this.checkQueue()}),this.relayer.on(vt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}var PL=Object.defineProperty,kL=(e,t,n)=>t in e?PL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ho=(e,t,n)=>kL(e,typeof t!="symbol"?t+"":t,n);class UL{constructor(){ho(this,"map",new Map),ho(this,"set",(t,n)=>{const r=this.get(t);this.exists(t,n)||this.map.set(t,[...r,n])}),ho(this,"get",t=>this.map.get(t)||[]),ho(this,"exists",(t,n)=>this.get(t).includes(n)),ho(this,"delete",(t,n)=>{if(typeof n>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const r=this.get(t);if(!this.exists(t,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(t);return}this.map.set(t,s)}),ho(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var RL=Object.defineProperty,BL=Object.defineProperties,ML=Object.getOwnPropertyDescriptors,lb=Object.getOwnPropertySymbols,LL=Object.prototype.hasOwnProperty,jL=Object.prototype.propertyIsEnumerable,Op=(e,t,n)=>t in e?RL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ma=(e,t)=>{for(var n in t||(t={}))LL.call(t,n)&&Op(e,n,t[n]);if(lb)for(var n of lb(t))jL.call(t,n)&&Op(e,n,t[n]);return e},Xh=(e,t)=>BL(e,ML(t)),qe=(e,t,n)=>Op(e,typeof t!="symbol"?t+"":t,n);class FL extends BO{constructor(t,n){super(t,n),this.relayer=t,this.logger=n,qe(this,"subscriptions",new Map),qe(this,"topicMap",new UL),qe(this,"events",new Vn.EventEmitter),qe(this,"name",xB),qe(this,"version",NB),qe(this,"pending",new Map),qe(this,"cached",[]),qe(this,"initialized",!1),qe(this,"storagePrefix",Pr),qe(this,"subscribeTimeout",Z.toMiliseconds(Z.ONE_MINUTE)),qe(this,"initialSubscribeTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),qe(this,"clientId"),qe(this,"batchSubscribeTopicsLimit",500),qe(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),qe(this,"subscribe",async(r,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const i=Qu(s),o={topic:r,relay:i,transportType:s?.transportType};this.pending.set(r,o);const a=await this.rpcSubscribe(r,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),qe(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),qe(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),qe(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),qe(this,"on",(r,s)=>{this.events.on(r,s)}),qe(this,"once",(r,s)=>{this.events.once(r,s)}),qe(this,"off",(r,s)=>{this.events.off(r,s)}),qe(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),qe(this,"start",async()=>{await this.onConnect()}),qe(this,"stop",async()=>{await this.onDisconnect()}),qe(this,"restart",async()=>{await this.restore(),await this.onRestart()}),qe(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),qe(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Ki.pulse,async()=>{await this.checkPending()}),this.events.on(yn.created,async r=>{const s=yn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(yn.deleted,async r=>{const s=yn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=t,this.logger=Gt(n,this.name),this.clientId=""}get context(){return fn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(t,n){let r=!1;try{r=this.getSubscription(t).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,n){const r=this.topicMap.get(t);await Promise.all(r.map(async s=>await this.unsubscribeById(t,s,n)))}async unsubscribeById(t,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}});try{const s=Qu(r);await this.restartToComplete({topic:t,id:n,relay:s}),await this.rpcUnsubscribe(t,n,s);const i=et("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,n,r){var s;(!r||r?.transportType===Xe.relay)&&await this.restartToComplete({topic:t,id:t,relay:n});const i={method:Ka(n.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=r?.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(t);if(r?.transportType===Xe.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},Z.toMiliseconds(Z.ONE_SECOND)),a;const c=new Promise(async u=>{const d=h=>{h.topic===t&&(this.events.removeListener(yn.created,d),u(h.id))};this.events.on(yn.created,d);try{const h=await Ps(new Promise((p,f)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g?.message),f(g)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${t} failed, please try again`);this.events.removeListener(yn.created,d),u(h)}catch{}}),l=await Ps(c,this.subscribeTimeout,`Subscribing to ${t} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${t} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(vt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(t){if(!t.length)return;const n=t[0].relay,r={method:Ka(n.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Ps(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(vt.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const n=t[0].relay,r={method:Ka(n.protocol).batchFetchMessages,params:{topics:t.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await Ps(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(vt.connection_stalled)}return s}rpcUnsubscribe(t,n,r){const s={method:Ka(r.protocol).unsubscribe,params:{topic:t,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,n){this.setSubscription(t,Xh(Ma({},n),{id:t})),this.pending.delete(n.topic)}onBatchSubscribe(t){t.length&&t.forEach(n=>{this.setSubscription(n.id,Ma({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(t,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,t)&&this.deleteSubscription(n,r),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:n}),this.addSubscription(t,n)}addSubscription(t,n){this.subscriptions.set(t,Ma({},n)),this.topicMap.set(n.topic,t),this.events.emit(yn.created,n)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const n=this.subscriptions.get(t);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}deleteSubscription(t,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:n});const r=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(r.topic,t),this.events.emit(yn.deleted,Xh(Ma({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(yn.sync)}async onRestart(){if(this.cached.length){const t=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=t.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(yn.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){t.length&&(await this.rpcBatchSubscribe(t),this.onBatchSubscribe(await Promise.all(t.map(async n=>Xh(Ma({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const n=await this.rpcBatchFetchMessages(t);n&&n.messages&&(await X4(Z.toMiliseconds(Z.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(t){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(t),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(t){return Ir(t+await this.getClientId())}}var HL=Object.defineProperty,ub=Object.getOwnPropertySymbols,zL=Object.prototype.hasOwnProperty,qL=Object.prototype.propertyIsEnumerable,Dp=(e,t,n)=>t in e?HL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,db=(e,t)=>{for(var n in t||(t={}))zL.call(t,n)&&Dp(e,n,t[n]);if(ub)for(var n of ub(t))qL.call(t,n)&&Dp(e,n,t[n]);return e},Oe=(e,t,n)=>Dp(e,typeof t!="symbol"?t+"":t,n);class WL extends UO{constructor(t){super(t),Oe(this,"protocol","wc"),Oe(this,"version",2),Oe(this,"core"),Oe(this,"logger"),Oe(this,"events",new Vn.EventEmitter),Oe(this,"provider"),Oe(this,"messages"),Oe(this,"subscriber"),Oe(this,"publisher"),Oe(this,"name",EB),Oe(this,"transportExplicitlyClosed",!1),Oe(this,"initialized",!1),Oe(this,"connectionAttemptInProgress",!1),Oe(this,"relayUrl"),Oe(this,"projectId"),Oe(this,"packageName"),Oe(this,"bundleId"),Oe(this,"hasExperiencedNetworkDisruption",!1),Oe(this,"pingTimeout"),Oe(this,"heartBeatTimeout",Z.toMiliseconds(Z.THIRTY_SECONDS+Z.FIVE_SECONDS)),Oe(this,"reconnectTimeout"),Oe(this,"connectPromise"),Oe(this,"reconnectInProgress",!1),Oe(this,"requestsInFlight",[]),Oe(this,"connectTimeout",Z.toMiliseconds(Z.ONE_SECOND*15)),Oe(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||Si().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Oe(this,"resetPingTimeout",()=>{Yu()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o?.message)}},this.heartBeatTimeout))}),Oe(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),Oe(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(vt.connect)}),Oe(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Oe(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(vt.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Oe(this,"registerProviderListeners",()=>{this.provider.on(kn.payload,this.onPayloadHandler),this.provider.on(kn.connect,this.onConnectHandler),this.provider.on(kn.disconnect,this.onDisconnectHandler),this.provider.on(kn.error,this.onProviderErrorHandler)}),this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Gt(t.logger,this.name):al(ll({level:t.logger||vB})),this.messages=new xL(this.logger,t.core),this.subscriber=new FL(this,this.logger),this.publisher=new $L(this,this.logger),this.relayUrl=t?.relayUrl||mA,this.projectId=t.projectId,R4()?this.packageName=Qm():B4()&&(this.bundleId=Qm()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(t=>this.logger.warn(t,t?.message))}get context(){return fn(this.logger)}get connected(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var t,n,r;return((r=(n=(t=this.provider)==null?void 0:t.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(t,n,r){this.isInitialized(),await this.publisher.publish(t,n,r),await this.recordMessageEvent({topic:t,message:n,publishedAt:Date.now(),transportType:Xe.relay},Su.outbound)}async subscribe(t,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(t))==null?void 0:i[0])||"",c;const l=u=>{u.topic===t&&(this.subscriber.off(yn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(yn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(t,db({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(t,n){this.isInitialized(),await this.subscriber.unsubscribe(t,n)}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Ps(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(t).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(t){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await zy())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if(t?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=t.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(t,n){const{topic:r}=t;if(!n.sessionExists){const s=gt(Z.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(vt.message,t),await this.recordMessageEvent(t,Su.inbound)}async connect(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(kn.disconnect,i),await Ps(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(kn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(kn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(kn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,Z.toMiliseconds(n*1))),n++}}startPingTimeout(){var t,n,r,s,i;if(Yu())try{(n=(t=this.provider)==null?void 0:t.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Kn(new lB(H4({sdkVersion:Sp,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(t,n){const{topic:r,message:s}=t;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(t){const{topic:n,message:r}=t;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),nw(t)){if(!t.method.endsWith(CB))return;const n=t.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:Xe.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(db({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(t),await this.onMessageEvent(a)}else Dd(t)&&this.events.emit(vt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(await this.recordMessageEvent(t,Su.inbound),this.events.emit(vt.message,t))}async acknowledgePayload(t){const n=Td(t.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(kn.payload,this.onPayloadHandler),this.provider.off(kn.connect,this.onConnectHandler),this.provider.off(kn.disconnect,this.onDisconnectHandler),this.provider.off(kn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await zy();TR(async n=>{t!==n&&(t=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Ki.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&$R())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(vt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t,t?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Z.toMiliseconds(AB)))))}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function VL(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}function hb(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function fb(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const KL="[object RegExp]",GL="[object String]",YL="[object Number]",ZL="[object Boolean]",pb="[object Arguments]",JL="[object Symbol]",XL="[object Date]",QL="[object Map]",ej="[object Set]",tj="[object Array]",nj="[object Function]",rj="[object ArrayBuffer]",Qh="[object Object]",sj="[object Error]",ij="[object DataView]",oj="[object Uint8Array]",aj="[object Uint8ClampedArray]",cj="[object Uint16Array]",lj="[object Uint32Array]",uj="[object BigUint64Array]",dj="[object Int8Array]",hj="[object Int16Array]",fj="[object Int32Array]",pj="[object BigInt64Array]",gj="[object Float32Array]",wj="[object Float64Array]";function mj(){}function gb(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype||Object.getPrototypeOf(t)===null?Object.prototype.toString.call(e)==="[object Object]":!1}function yj(e,t,n){return Ga(e,t,void 0,void 0,void 0,void 0,n)}function Ga(e,t,n,r,s,i,o){const a=o(e,t,n,r,s,i);if(a!==void 0)return a;if(typeof e==typeof t)switch(typeof e){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return e===t;case"number":return e===t||Object.is(e,t);case"function":return e===t;case"object":return ac(e,t,i,o)}return ac(e,t,i,o)}function ac(e,t,n,r){if(Object.is(e,t))return!0;let s=fb(e),i=fb(t);if(s===pb&&(s=Qh),i===pb&&(i=Qh),s!==i)return!1;switch(s){case GL:return e.toString()===t.toString();case YL:{const c=e.valueOf(),l=t.valueOf();return VL(c,l)}case ZL:case XL:case JL:return Object.is(e.valueOf(),t.valueOf());case KL:return e.source===t.source&&e.flags===t.flags;case nj:return e===t}n=n??new Map;const o=n.get(e),a=n.get(t);if(o!=null&&a!=null)return o===t;n.set(e,t),n.set(t,e);try{switch(s){case QL:{if(e.size!==t.size)return!1;for(const[c,l]of e.entries())if(!t.has(c)||!Ga(l,t.get(c),c,e,t,n,r))return!1;return!0}case ej:{if(e.size!==t.size)return!1;const c=Array.from(e.values()),l=Array.from(t.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(p=>Ga(d,p,void 0,e,t,n,r));if(h===-1)return!1;l.splice(h,1)}return!0}case tj:case oj:case aj:case cj:case lj:case uj:case dj:case hj:case fj:case pj:case gj:case wj:{if(typeof Buffer<"u"&&Buffer.isBuffer(e)!==Buffer.isBuffer(t)||e.length!==t.length)return!1;for(let c=0;c<e.length;c++)if(!Ga(e[c],t[c],c,e,t,n,r))return!1;return!0}case rj:return e.byteLength!==t.byteLength?!1:ac(new Uint8Array(e),new Uint8Array(t),n,r);case ij:return e.byteLength!==t.byteLength||e.byteOffset!==t.byteOffset?!1:ac(new Uint8Array(e),new Uint8Array(t),n,r);case sj:return e.name===t.name&&e.message===t.message;case Qh:{if(!(ac(e.constructor,t.constructor,n,r)||gb(e)&&gb(t)))return!1;const c=[...Object.keys(e),...hb(e)],l=[...Object.keys(t),...hb(t)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=e[d];if(!Object.hasOwn(t,d))return!1;const p=t[d];if(!Ga(h,p,d,e,t,n,r))return!1}return!0}default:return!1}}finally{n.delete(e),n.delete(t)}}function bj(e,t){return yj(e,t,mj)}var vj=Object.defineProperty,wb=Object.getOwnPropertySymbols,Ej=Object.prototype.hasOwnProperty,Cj=Object.prototype.propertyIsEnumerable,$p=(e,t,n)=>t in e?vj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mb=(e,t)=>{for(var n in t||(t={}))Ej.call(t,n)&&$p(e,n,t[n]);if(wb)for(var n of wb(t))Cj.call(t,n)&&$p(e,n,t[n]);return e},Xt=(e,t,n)=>$p(e,typeof t!="symbol"?t+"":t,n);class Yi extends RO{constructor(t,n,r,s=Pr,i=void 0){super(t,n,r,s),this.core=t,this.logger=n,this.name=r,Xt(this,"map",new Map),Xt(this,"version",IB),Xt(this,"cached",[]),Xt(this,"initialized",!1),Xt(this,"getKey"),Xt(this,"storagePrefix",Pr),Xt(this,"recentlyDeleted",[]),Xt(this,"recentlyDeletedLimit",200),Xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Ot(o)?this.map.set(this.getKey(o),o):oR(o)?this.map.set(o.id,o):aR(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Xt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Xt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Xt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>bj(a[c],o[c]))):this.values)),Xt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=mb(mb({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Xt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Gt(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return fn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const n=this.map.get(t);if(!n){if(this.recentlyDeleted.includes(t)){const{message:s}=G("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Aj=Object.defineProperty,Ij=(e,t,n)=>t in e?Aj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ve=(e,t,n)=>Ij(e,typeof t!="symbol"?t+"":t,n);class Sj{constructor(t,n){this.core=t,this.logger=n,ve(this,"name",_B),ve(this,"version",TB),ve(this,"events",new Tg),ve(this,"pairings"),ve(this,"initialized",!1),ve(this,"storagePrefix",Pr),ve(this,"ignoredPayloadTypes",[es]),ve(this,"registeredMethods",[]),ve(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),ve(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),ve(this,"create",async r=>{this.isInitialized();const s=Cp(),i=await this.core.crypto.setSymKey(s),o=gt(Z.FIVE_MINUTES),a={protocol:wA},c={topic:i,expiry:o,relay:a,active:!1,methods:r?.methods},l=ky({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(wi.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r?.transportType}),{topic:i,uri:l}}),ve(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[Er.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Py(r.uri);s.props.properties.topic=i,s.addTrace(Er.pairing_uri_validation_success),s.addTrace(Er.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(Er.existing_pairing),u.active)throw s.setError(Jr.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(Er.pairing_not_expired)}const d=c||gt(Z.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(Er.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(wi.create,h),s.addTrace(Er.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(Er.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Jr.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(p){throw s.setError(Jr.subscribe_pairing_topic_failure),p}return s.addTrace(Er.subscribe_pairing_topic_success),h}),ve(this,"activate",async({topic:r})=>{this.isInitialized();const s=gt(Z.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),ve(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=di();this.events.once(Re("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),ve(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),ve(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),ve(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),ve(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",et("USER_DISCONNECTED")),await this.deletePairing(s))}),ve(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return ky({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),ve(this,"sendRequest",async(r,s,i)=>{const o=ks(s,i),a=await this.core.crypto.encode(r,o),c=Ra[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),ve(this,"sendResult",async(r,s,i)=>{const o=Td(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Ra[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ve(this,"sendError",async(r,s,i)=>{const o=Od(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Ra[c]?Ra[c].res:Ra.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),ve(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,et("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),ve(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>Is(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),ve(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),ve(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),ve(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(wi.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ve(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{Ar(s)?this.events.emit(Re("pairing_ping",i),{}):jn(s)&&this.events.emit(Re("pairing_ping",i),{error:s.error})},500)}),ve(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(wi.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),ve(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=et("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),ve(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(et("WC_METHOD_UNSUPPORTED",r))}),ve(this,"isValidPair",(r,s)=>{var i;if(!on(r)){const{message:a}=G("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(Jr.malformed_pairing_uri),new Error(a)}if(!iR(r.uri)){const{message:a}=G("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(Jr.malformed_pairing_uri),new Error(a)}const o=Py(r?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Jr.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=G("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Jr.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Z.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(Jr.pairing_expired);const{message:a}=G("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),ve(this,"isValidPing",async r=>{if(!on(r)){const{message:i}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ve(this,"isValidDisconnect",async r=>{if(!on(r)){const{message:i}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),ve(this,"isValidPairingTopic",async r=>{if(!dt(r,!1)){const{message:s}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(Is(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=G("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=t,this.logger=Gt(n,this.name),this.pairings=new Yi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return fn(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(vt.message,async t=>{const{topic:n,message:r,transportType:s}=t;if(this.pairings.keys.includes(n)&&s!==Xe.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);nw(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):Dd(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Ln.expired,async t=>{const{topic:n}=wC(t.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(wi.expire,{topic:n}))})}}var xj=Object.defineProperty,Nj=(e,t,n)=>t in e?xj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Nt=(e,t,n)=>Nj(e,typeof t!="symbol"?t+"":t,n);class _j extends $O{constructor(t,n){super(t,n),this.core=t,this.logger=n,Nt(this,"records",new Map),Nt(this,"events",new Vn.EventEmitter),Nt(this,"name",OB),Nt(this,"version",DB),Nt(this,"cached",[]),Nt(this,"initialized",!1),Nt(this,"storagePrefix",Pr),Nt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Nt(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:gt(Z.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Jn.created,o)}),Nt(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=jn(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Jn.updated,s))}),Nt(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Nt(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Jn.deleted,i)}}),this.persist()}),Nt(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Nt(this,"on",(r,s)=>{this.events.on(r,s)}),Nt(this,"once",(r,s)=>{this.events.once(r,s)}),Nt(this,"off",(r,s)=>{this.events.off(r,s)}),Nt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Gt(n,this.name)}get context(){return fn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:ks(n.request.method,n.request.params,n.id),chainId:n.chainId};return t.push(r)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const n=this.records.get(t);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Jn.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Jn.created,t=>{const n=Jn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(Jn.updated,t=>{const n=Jn.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.events.on(Jn.deleted,t=>{const n=Jn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:t})}),this.core.heartbeat.on(Ki.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(n=>{Z.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Jn.deleted,n,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Tj=Object.defineProperty,Oj=(e,t,n)=>t in e?Tj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jt=(e,t,n)=>Oj(e,typeof t!="symbol"?t+"":t,n);class Dj extends MO{constructor(t,n){super(t,n),this.core=t,this.logger=n,jt(this,"expirations",new Map),jt(this,"events",new Vn.EventEmitter),jt(this,"name",$B),jt(this,"version",PB),jt(this,"cached",[]),jt(this,"initialized",!1),jt(this,"storagePrefix",Pr),jt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),jt(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),jt(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Ln.created,{target:i,expiration:o})}),jt(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),jt(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Ln.deleted,{target:s,expiration:i})}}),jt(this,"on",(r,s)=>{this.events.on(r,s)}),jt(this,"once",(r,s)=>{this.events.once(r,s)}),jt(this,"off",(r,s)=>{this.events.off(r,s)}),jt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Gt(n,this.name)}get context(){return fn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return z4(t);if(typeof t=="number")return q4(t);const{message:n}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(n)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Ln.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const n=this.expirations.get(t);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(t,n){const{expiry:r}=n;Z.toMiliseconds(r)-Date.now()<=0&&this.expire(t,n)}expire(t,n){this.expirations.delete(t),this.events.emit(Ln.expired,{target:t,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,n)=>this.checkExpiry(n,t))}registerEventListeners(){this.core.heartbeat.on(Ki.pulse,()=>this.checkExpirations()),this.events.on(Ln.created,t=>{const n=Ln.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(Ln.expired,t=>{const n=Ln.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()}),this.events.on(Ln.deleted,t=>{const n=Ln.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}var $j=Object.defineProperty,Pj=(e,t,n)=>t in e?$j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ut=(e,t,n)=>Pj(e,typeof t!="symbol"?t+"":t,n);class kj extends LO{constructor(t,n,r){super(t,n,r),this.core=t,this.logger=n,this.store=r,ut(this,"name",kB),ut(this,"abortController"),ut(this,"isDevEnv"),ut(this,"verifyUrlV3",RB),ut(this,"storagePrefix",Pr),ut(this,"version",gA),ut(this,"publicKey"),ut(this,"fetchPromise"),ut(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Z.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ut(this,"register",async s=>{if(!fa()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=is.getDocument(),u=this.startAbortTimer(Z.ONE_SECOND*5),d=await new Promise((h,p)=>{const f=()=>{window.removeEventListener("message",w),l.body.removeChild(g),p("attestation aborted")};this.abortController.signal.addEventListener("abort",f);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",f,{signal:this.abortController.signal});const w=b=>{if(b.data&&typeof b.data=="string")try{const I=JSON.parse(b.data);if(I.type==="verify_attestation"){if(rp(I.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",f),window.removeEventListener("message",w),h(I.attestation===null?"":I.attestation)}}catch(I){this.logger.warn(I)}};l.body.appendChild(g),window.addEventListener("message",w,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),ut(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(rp(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),ut(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Z.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ut(this,"getVerifyUrl",s=>{let i=s||oc;return BB.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${oc}`),i=oc),i}),ut(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Z.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),ut(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),ut(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ut(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ut(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ut(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),ut(this,"validateAttestation",(s,i)=>{const o=M6(s,i.publicKey),a={hasExpired:Z.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Gt(n,this.name),this.abortController=new AbortController,this.isDevEnv=Fg(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return fn(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Z.toMiliseconds(t))}}var Uj=Object.defineProperty,Rj=(e,t,n)=>t in e?Uj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yb=(e,t,n)=>Rj(e,typeof t!="symbol"?t+"":t,n);class Bj extends jO{constructor(t,n){super(t,n),this.projectId=t,this.logger=n,yb(this,"context",MB),yb(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${LB}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Gt(n,this.context)}}var Mj=Object.defineProperty,bb=Object.getOwnPropertySymbols,Lj=Object.prototype.hasOwnProperty,jj=Object.prototype.propertyIsEnumerable,Pp=(e,t,n)=>t in e?Mj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,La=(e,t)=>{for(var n in t||(t={}))Lj.call(t,n)&&Pp(e,n,t[n]);if(bb)for(var n of bb(t))jj.call(t,n)&&Pp(e,n,t[n]);return e},mt=(e,t,n)=>Pp(e,typeof t!="symbol"?t+"":t,n);class Fj extends FO{constructor(t,n,r=!0){super(t,n,r),this.core=t,this.logger=n,mt(this,"context",FB),mt(this,"storagePrefix",Pr),mt(this,"storageVersion",jB),mt(this,"events",new Map),mt(this,"shouldPersist",!1),mt(this,"init",async()=>{if(!Fg())try{const s={eventId:ty(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:pC(this.core.relayer.protocol,this.core.relayer.version,Sp)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),mt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=ty(),u=this.core.projectId||"",d=Date.now(),h=La({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),mt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return La(La({},a),this.setMethods(a.eventId))}),mt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),mt(this,"setEventListeners",()=>{this.core.heartbeat.on(Ki.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Z.fromMiliseconds(Date.now())-Z.fromMiliseconds(s.timestamp)>HB&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),mt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),mt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),mt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),mt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),mt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,La(La({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),mt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),mt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${zB}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Sp}${i}`,{method:"POST",body:JSON.stringify(s)})}),mt(this,"getAppDomain",()=>fC().url),this.logger=Gt(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Hj=Object.defineProperty,vb=Object.getOwnPropertySymbols,zj=Object.prototype.hasOwnProperty,qj=Object.prototype.propertyIsEnumerable,kp=(e,t,n)=>t in e?Hj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Eb=(e,t)=>{for(var n in t||(t={}))zj.call(t,n)&&kp(e,n,t[n]);if(vb)for(var n of vb(t))qj.call(t,n)&&kp(e,n,t[n]);return e},Ke=(e,t,n)=>kp(e,typeof t!="symbol"?t+"":t,n);let Wj=class OA extends _O{constructor(t){var n;super(t),Ke(this,"protocol",pA),Ke(this,"version",gA),Ke(this,"name",Ip),Ke(this,"relayUrl"),Ke(this,"projectId"),Ke(this,"customStoragePrefix"),Ke(this,"events",new Vn.EventEmitter),Ke(this,"logger"),Ke(this,"heartbeat"),Ke(this,"relayer"),Ke(this,"crypto"),Ke(this,"storage"),Ke(this,"history"),Ke(this,"expirer"),Ke(this,"pairing"),Ke(this,"verify"),Ke(this,"echoClient"),Ke(this,"linkModeSupportedApps"),Ke(this,"eventClient"),Ke(this,"initialized",!1),Ke(this,"logChunkController"),Ke(this,"on",(a,c)=>this.events.on(a,c)),Ke(this,"once",(a,c)=>this.events.once(a,c)),Ke(this,"off",(a,c)=>this.events.off(a,c)),Ke(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ke(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Xe.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(t?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||mA,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const s=ll({level:typeof t?.logger=="string"&&t.logger?t.logger:dB.logger,name:Ip}),{logger:i,chunkLoggerController:o}=lE({opts:s,maxSizeInBytes:t?.maxLogBlobSizeInBytes,loggerOverride:t?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Gt(i,this.name),this.heartbeat=new NT,this.crypto=new yL(this,this.logger,t?.keychain),this.history=new _j(this,this.logger),this.expirer=new Dj(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new lO(Eb(Eb({},hB),t?.storageOptions)),this.relayer=new WL({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Sj(this,this.logger),this.verify=new kj(this,this.logger,this.storage),this.echoClient=new Bj(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Fj(this,this.logger,t?.telemetryEnabled),this.setGlobalCore(this)}static async init(t){const n=new OA(t);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(SB,r),n}get context(){return fn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(eb,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(eb)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}getGlobalCore(t=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${t}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(t){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=t.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=t}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&uB.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const Vj=Wj,DA="wc",$A=2,PA="client",rw=`${DA}@${$A}:${PA}:`,ef={name:PA,logger:"error"},Cb="WALLETCONNECT_DEEPLINK_CHOICE",Kj="proposal",Ab="Proposal expired",Gj="session",fo=Z.SEVEN_DAYS,Yj="engine",yt={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Z.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Z.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1119}}},tf={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},br={idle:"IDLE",active:"ACTIVE"},Zj={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},Jj="request",Xj=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],Qj="wc",e9="auth",t9="authKeys",n9="pairingTopics",r9="requests",Pd=`${Qj}@${1.5}:${e9}:`,xu=`${Pd}:PUB_KEY`;var s9=Object.defineProperty,i9=Object.defineProperties,o9=Object.getOwnPropertyDescriptors,Ib=Object.getOwnPropertySymbols,a9=Object.prototype.hasOwnProperty,c9=Object.prototype.propertyIsEnumerable,Up=(e,t,n)=>t in e?s9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Je=(e,t)=>{for(var n in t||(t={}))a9.call(t,n)&&Up(e,n,t[n]);if(Ib)for(var n of Ib(t))c9.call(t,n)&&Up(e,n,t[n]);return e},Qt=(e,t)=>i9(e,o9(t)),W=(e,t,n)=>Up(e,typeof t!="symbol"?t+"":t,n);class l9 extends WO{constructor(t){super(t),W(this,"name",Yj),W(this,"events",new Tg),W(this,"initialized",!1),W(this,"requestQueue",{state:br.idle,queue:[]}),W(this,"sessionRequestQueue",{state:br.idle,queue:[]}),W(this,"emittedSessionRequests",new Q4({limit:500})),W(this,"requestQueueDelay",Z.ONE_SECOND),W(this,"expectedPairingMethodMap",new Map),W(this,"recentlyDeletedMap",new Map),W(this,"recentlyDeletedLimit",200),W(this,"relayMessageCache",[]),W(this,"pendingSessions",new Map),W(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(yt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Z.toMiliseconds(this.requestQueueDelay)))}),W(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=Qt(Je({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=eR(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r;let u=s,d,h=!1;try{if(u){const C=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=C.active}}catch(C){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),C}if(!u||!h){const{topic:C,uri:O}=await this.client.core.pairing.create();u=C,d=O}if(!u){const{message:C}=G("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(C)}const p=await this.client.core.crypto.generateKeyPair(),f=yt.wc_sessionPropose.req.ttl||Z.FIVE_MINUTES,g=gt(f),w=Qt(Je(Je({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:wA}],proposer:{publicKey:p,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Cr()}),b=Re("session_connect",w.id),{reject:I,resolve:y,done:m}=di(f,Ab),v=({id:C})=>{C===w.id&&(this.client.events.off("proposal_expire",v),this.pendingSessions.delete(w.id),this.events.emit(b,{error:{message:Ab,code:0}}))};return this.client.events.on("proposal_expire",v),this.events.once(b,({error:C,session:O})=>{this.client.events.off("proposal_expire",v),C?I(C):O&&y(O)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:w,throwOnFailedPublish:!0,clientRpcId:w.id}),await this.setProposal(w.id,w),{uri:d,approval:m}}),W(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),W(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n?.id)==null?void 0:r.toString(),trace:[Xn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(S){throw o.setError(oi.no_internet_connection),S}try{await this.isValidProposalId(n?.id)}catch(S){throw this.client.logger.error(`approve() -> proposal.get(${n?.id}) failed`),o.setError(oi.proposal_not_found),S}try{await this.isValidApprove(n)}catch(S){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(oi.session_approve_namespace_validation_failure),S}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n,p=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:f,proposer:g,requiredNamespaces:w,optionalNamespaces:b}=p;let I=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:f});I||(I=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Xn.session_approve_started,properties:{topic:f,trace:[Xn.session_approve_started,Xn.session_namespaces_validation_success]}}));const y=await this.client.core.crypto.generateKeyPair(),m=g.publicKey,v=await this.client.core.crypto.generateSharedKey(y,m),C=Je(Je(Je({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:y,metadata:this.client.metadata},expiry:gt(fo)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),O=Xe.relay;I.addTrace(Xn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(v,{transportType:O})}catch(S){throw I.setError(oi.subscribe_session_topic_failure),S}I.addTrace(Xn.subscribe_session_topic_success);const D=Qt(Je({},C),{topic:v,requiredNamespaces:w,optionalNamespaces:b,pairingTopic:f,acknowledged:!1,self:C.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:y,transportType:Xe.relay});await this.client.session.set(v,D),I.addTrace(Xn.store_session);try{I.addTrace(Xn.publishing_session_settle),await this.sendRequest({topic:v,method:"wc_sessionSettle",params:C,throwOnFailedPublish:!0}).catch(S=>{throw I?.setError(oi.session_settle_publish_failure),S}),I.addTrace(Xn.session_settle_publish_success),I.addTrace(Xn.publishing_session_approve),await this.sendResult({id:a,topic:f,result:{relay:{protocol:c??"irn"},responderPublicKey:y},throwOnFailedPublish:!0}).catch(S=>{throw I?.setError(oi.session_approve_publish_failure),S}),I.addTrace(Xn.session_approve_publish_success)}catch(S){throw this.client.logger.error(S),this.client.session.delete(v,et("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(v),S}return this.client.core.eventClient.deleteEvent({eventId:I.eventId}),await this.client.core.pairing.updateMetadata({topic:f,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:f}),await this.setExpiry(v,gt(fo)),{topic:v,acknowledged:()=>Promise.resolve(this.client.session.get(v))}}),W(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:yt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),W(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=di(),c=Cr(),l=Si().toString(),u=this.client.session.get(r).namespaces;return this.events.once(Re("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),W(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=Cr(),{done:i,resolve:o,reject:a}=di();return this.events.once(Re("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,gt(fo)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),W(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(w){throw this.client.logger.error("request() -> isValidRequest() failed"),w}const{chainId:r,request:s,topic:i,expiry:o=yt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);a?.transportType===Xe.relay&&await this.confirmOnlineStateOrThrow();const c=Cr(),l=Si().toString(),{done:u,resolve:d,reject:h}=di(o,"Request expired. Please try again.");this.events.once(Re("session_request",c),({error:w,result:b})=>{w?h(w):d(b)});const p="wc_sessionRequest",f=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(f)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:{request:Qt(Je({},s),{expiryTimestamp:gt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:f}).catch(w=>h(w)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const g={request:Qt(Je({},s),{expiryTimestamp:gt(o)}),chainId:r};return await Promise.all([new Promise(async w=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:p,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(b=>h(b)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),w()}),new Promise(async w=>{var b;if(!((b=a.sessionConfig)!=null&&b.disableDeepLink)){const I=await G4(this.client.core.storage,Cb);await W4({id:c,topic:i,wcDeepLink:I})}w()}),u()]).then(w=>w[2])}),W(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===Xe.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Ar(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):jn(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(n)}),W(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=Cr(),i=Si().toString(),{done:o,resolve:a,reject:c}=di();this.events.once(Re("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),W(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=Si().toString(),a=Cr();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),W(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:et("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=G("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),W(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>rR(r,n)))),W(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),W(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Xe.link_mode:Xe.relay;o===Xe.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:p,nbf:f,methods:g=[],expiry:w}=n,b=[...n.resources||[]],{topic:I,uri:y}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:I,uri:y}});const m=await this.client.core.crypto.generateKeyPair(),v=Iu(m);if(await Promise.all([this.client.auth.authKeys.set(xu,{responseTopic:v,publicKey:m}),this.client.auth.pairingTopics.set(v,{topic:v,pairingTopic:I})]),await this.client.core.relayer.subscribe(v,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${I}`),g.length>0){const{namespace:U}=Fo(a[0]);let P=uU(U,"request",g);Au(b)&&(P=hU(P,b.pop())),b.push(P)}const C=w&&w>yt.wc_sessionAuthenticate.req.ttl?w:yt.wc_sessionAuthenticate.req.ttl,O={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:p,nbf:f,resources:b},requester:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:gt(C)},D={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},S={requiredNamespaces:{},optionalNamespaces:D,relays:[{protocol:"irn"}],pairingTopic:I,proposer:{publicKey:m,metadata:this.client.metadata},expiryTimestamp:gt(yt.wc_sessionPropose.req.ttl),id:Cr()},{done:E,resolve:N,reject:$}=di(C,"Request expired"),B=Cr(),R=Re("session_connect",S.id),A=Re("session_request",B),_=async({error:U,session:P})=>{this.events.off(A,k),U?$(U):P&&N({session:P})},k=async U=>{var P,H,Y;if(await this.deletePendingAuthRequest(B,{message:"fulfilled",code:0}),U.error){const be=et("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return U.error.code===be.code?void 0:(this.events.off(R,_),$(U.error.message))}await this.deleteProposal(S.id),this.events.off(R,_);const{cacaos:J,responder:K}=U.result,ne=[],ue=[];for(const be of J){await hy({cacao:be,projectId:this.client.core.projectId})||(this.client.logger.error(be,"Signature verification failed"),$(et("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:nt}=be,lt=Au(nt.resources),Br=[fp(nt.iss)],eo=Zu(nt.iss);if(lt){const Mr=fy(lt),to=py(lt);ne.push(...Mr),Br.push(...to)}for(const Mr of Br)ue.push(`${Mr}:${eo}`)}const _e=await this.client.core.crypto.generateSharedKey(m,K.publicKey);let Ie;ne.length>0&&(Ie={topic:_e,acknowledged:!0,self:{publicKey:m,metadata:this.client.metadata},peer:K,controller:K.publicKey,expiry:gt(fo),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:I,namespaces:My([...new Set(ne)],[...new Set(ue)]),transportType:o},await this.client.core.relayer.subscribe(_e,{transportType:o}),await this.client.session.set(_e,Ie),I&&await this.client.core.pairing.updateMetadata({topic:I,metadata:K.metadata}),Ie=this.client.session.get(_e)),(P=this.client.metadata.redirect)!=null&&P.linkMode&&(H=K.metadata.redirect)!=null&&H.linkMode&&(Y=K.metadata.redirect)!=null&&Y.universal&&r&&(this.client.core.addLinkModeSupportedApp(K.metadata.redirect.universal),this.client.session.update(_e,{transportType:Xe.link_mode})),N({auths:J,session:Ie})};this.events.once(R,_),this.events.once(A,k);let M;try{if(i){const U=ks("wc_sessionAuthenticate",O,B);this.client.core.history.set(I,U);const P=await this.client.core.crypto.encode("",U,{type:gl,encoding:Ts});M=tu(r,I,P)}else await Promise.all([this.sendRequest({topic:I,method:"wc_sessionAuthenticate",params:O,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:B}),this.sendRequest({topic:I,method:"wc_sessionPropose",params:S,expiry:yt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(U){throw this.events.off(R,_),this.events.off(A,k),U}return await this.setProposal(S.id,S),await this.setAuthRequest(B,{request:Qt(Je({},O),{verifyContext:{}}),pairingTopic:I,transportType:o}),{uri:M??y,response:E}}),W(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[ai.authenticated_session_approve_started]}});try{this.isInitialized()}catch(w){throw i.setError(Ba.no_internet_connection),w}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(Ba.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Xe.relay;a===Xe.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=Iu(c),d={type:es,receiverPublicKey:c,senderPublicKey:l},h=[],p=[];for(const w of s){if(!await hy({cacao:w,projectId:this.client.core.projectId})){i.setError(Ba.invalid_cacao);const v=et("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:v,encodeOpts:d}),new Error(v.message)}i.addTrace(ai.cacaos_verified);const{p:b}=w,I=Au(b.resources),y=[fp(b.iss)],m=Zu(b.iss);if(I){const v=fy(I),C=py(I);h.push(...v),y.push(...C)}for(const v of y)p.push(`${v}:${m}`)}const f=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(ai.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:f,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:gt(fo),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:My([...new Set(h)],[...new Set(p)]),transportType:a},i.addTrace(ai.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(f,{transportType:a})}catch(w){throw i.setError(Ba.subscribe_authenticated_session_topic_failure),w}i.addTrace(ai.subscribe_authenticated_session_topic_success),await this.client.session.set(f,g),i.addTrace(ai.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(ai.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(w){throw i.setError(Ba.authenticated_session_approve_publish_failure),w}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),W(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Xe.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Iu(o),l={type:es,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:yt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),W(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return DC(r,s)}),W(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),W(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),W(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,et("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Cb).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,et("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=br.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),W(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(oi.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,et("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),W(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=br.idle,this.client.events.emit("session_request_expire",{id:n}))}),W(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),W(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),W(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,gt(yt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),W(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=Xe.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),W(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||gt(yt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),W(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d}=n,h=ks(s,i,c);let p;const f=!!u;try{const b=f?Ts:cr;p=await this.client.core.crypto.encode(r,h,{encoding:b})}catch(b){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),b}let g;if(Xj.includes(s)){const b=Ir(JSON.stringify(h)),I=Ir(p);g=await this.client.core.verify.register({id:I,decryptedId:b})}const w=yt[s].req;if(w.attestation=g,o&&(w.ttl=o),a&&(w.id=a),this.client.core.history.set(r,h),f){const b=tu(u,r,p);await global.Linking.openURL(b,this.client.name)}else{const b=yt[s].req;o&&(b.ttl=o),a&&(b.id=a),b.tvf=Qt(Je({},d),{correlationId:h.id}),l?(b.internal=Qt(Je({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,b)):this.client.core.relayer.publish(r,p,b).catch(I=>this.client.logger.error(I))}return h.id}),W(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=Td(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?Ts:cr;u=await this.client.core.crypto.encode(s,l,Qt(Je({},a||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),f}let h,p;try{h=await this.client.core.history.get(s,r);const f=h.request;try{p=this.getTVFParams(r,f.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(f){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),f}if(d){const f=tu(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,g=yt[f].res;g.tvf=Qt(Je({},p),{correlationId:r}),o?(g.internal=Qt(Je({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(w=>this.client.logger.error(w))}await this.client.core.history.resolve(l)}),W(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=Od(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?Ts:cr;u=await this.client.core.crypto.encode(s,l,Qt(Je({},o||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),p}let h;try{h=await this.client.core.history.get(s,r)}catch(p){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),p}if(d){const p=tu(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,f=a||yt[p].res;this.client.core.relayer.publish(s,u,f)}await this.client.core.history.resolve(l)}),W(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;Is(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Is(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),W(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),W(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),W(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===br.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=br.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=br.idle}),W(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),W(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),W(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=G("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),W(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),W(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(Jr.proposal_listener_not_found)),this.isValidConnect(Je({},s.params));const u=a.expiryTimestamp||gt(yt.wc_sessionPropose.req.ttl),d=Je({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:Ir(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(Er.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:yt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),W(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(Ar(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(jn(r)){await this.deleteProposal(i);const o=Re("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),W(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r.params,p=[...this.pendingSessions.values()].find(w=>w.sessionTopic===n);if(!p)return this.client.logger.error(`Pending session not found for topic ${n}`);const f=this.client.proposal.get(p.proposalId),g=Qt(Je(Je(Je({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:p.pairingTopic,requiredNamespaces:f.requiredNamespaces,optionalNamespaces:f.optionalNamespaces,controller:a.publicKey,self:{publicKey:p.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Xe.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:p.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(Re("session_connect",p.proposalId),{session:g}),this.pendingSessions.delete(p.proposalId),this.deleteProposal(p.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),W(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;Ar(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(Re("session_approve",s),{})):jn(r)&&(await this.client.session.delete(n,et("USER_DISCONNECTED")),this.events.emit(Re("session_approve",s),{error:r.error}))}),W(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=Ua.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:et("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Je({topic:n},s));try{Ua.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw Ua.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),W(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),W(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=Re("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ar(r)?this.events.emit(Re("session_update",s),{}):jn(r)&&this.events.emit(Re("session_update",s),{error:r.error})}),W(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,gt(fo)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),W(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=Re("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ar(r)?this.events.emit(Re("session_extend",s),{}):jn(r)&&this.events.emit(Re("session_extend",s),{error:r.error})}),W(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),W(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=Re("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Ar(r)?this.events.emit(Re("session_ping",s),{}):jn(r)&&this.events.emit(Re("session_ping",s),{error:r.error})},500)}),W(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(vt.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:et("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),W(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:h}=a;try{await this.isValidRequest(Je({topic:o},h));const p=this.client.session.get(o),f=await this.getVerifyContext({attestationId:c,hash:Ir(JSON.stringify(ks("wc_sessionRequest",h,d))),encryptedId:l,metadata:p.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:f};await this.setPendingSessionRequest(g),u===Xe.link_mode&&(r=p.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=p.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(p){await this.sendError({id:d,topic:o,error:p}),this.client.logger.error(p)}}),W(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=Re("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ar(r)?this.events.emit(Re("session_request",s),{result:r.result}):jn(r)&&this.events.emit(Re("session_request",s),{error:r.error})}),W(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=Ua.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Je({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),Ua.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),W(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),Ar(r)?this.events.emit(Re("session_request",s),{result:r.result}):jn(r)&&this.events.emit(Re("session_request",s),{error:r.error})}),W(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Ir(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),p={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:p,pairingTopic:s,transportType:c}),c===Xe.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),p={type:es,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:p,rpcOpts:yt.wc_sessionAuthenticate.autoReject,appLink:h})}}),W(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),W(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=br.idle,this.processSessionRequestQueue()},Z.toMiliseconds(this.requestQueueDelay))}),W(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=Re("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(Re("session_request",i.request.id),{error:r})})}),W(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===br.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),W(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=br.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),W(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:ks("wc_sessionPropose",Qt(Je({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),W(this,"isValidConnect",async n=>{if(!on(n)){const{message:l}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(Ot(r)||await this.isValidPairingTopic(r),!gR(c)){const{message:l}=G("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!Ot(s)&&Dr(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!Ot(i)&&Dr(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),Ot(o)||this.validateSessionProps(o,"sessionProperties"),!Ot(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),W(this,"validateNamespaces",(n,r)=>{const s=pR(n,"connect()",r);if(s)throw new Error(s.message)}),W(this,"isValidApprove",async n=>{if(!on(n))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=Kh(s,"approve()");if(l)throw new Error(l.message);const u=Fy(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!dt(i,!0)){const{message:d}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(Ot(o)||this.validateSessionProps(o,"sessionProperties"),!Ot(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),W(this,"isValidReject",async n=>{if(!on(n)){const{message:i}=G("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!mR(s)){const{message:i}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),W(this,"isValidSessionSettleRequest",n=>{if(!on(n)){const{message:l}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!cA(r)){const{message:l}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=cR(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Kh(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Is(o)){const{message:l}=G("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),W(this,"isValidUpdate",async n=>{if(!on(n)){const{message:c}=G("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Kh(s,"update()");if(o)throw new Error(o.message);const a=Fy(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),W(this,"isValidExtend",async n=>{if(!on(n)){const{message:s}=G("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),W(this,"isValidRequest",async n=>{if(!on(n)){const{message:c}=G("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!jy(a,i)){const{message:c}=G("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!yR(s)){const{message:c}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!ER(a,i,s.method)){const{message:c}=G("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!SR(o,tf)){const{message:c}=G("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${tf.min} and ${tf.max}`);throw new Error(c)}}),W(this,"isValidRespond",async n=>{var r;if(!on(n)){const{message:o}=G("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n?.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!bR(i)){const{message:o}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),W(this,"isValidPing",async n=>{if(!on(n)){const{message:s}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),W(this,"isValidEmit",async n=>{if(!on(n)){const{message:a}=G("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!jy(o,i)){const{message:a}=G("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!vR(s)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!CR(o,i,s.name)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),W(this,"isValidDisconnect",async n=>{if(!on(n)){const{message:s}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),W(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!dt(s,!1))throw new Error("uri is required parameter");if(!dt(i,!1))throw new Error("domain is required parameter");if(!dt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>Fo(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=Fo(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),W(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||oc,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Xe.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),W(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=G("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),W(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),W(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),W(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=G("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),W(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,h;return!n||r!==Xe.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n?.redirect)==null?void 0:u.universal)!==void 0&&((d=n?.redirect)==null?void 0:d.universal)!==""&&((h=n?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),W(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n?.redirect)==null?void 0:s.universal:void 0}),W(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=ey(n,"topic")||"",s=decodeURIComponent(ey(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Xe.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),W(this,"registerLinkModeListeners",async()=>{var n;if(Fg()||Gs()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),W(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),W(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=n?.data||((r=n?.[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),W(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=Zj[i];if(i==="sui_signTransaction")return[G5(r.transactionBytes)];if(i==="near_signTransaction")return[cy(r)];if(i==="near_signTransactions")return r.map(c=>cy(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[jR({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return ts(r)?r.map(c=>ly(c)):[ly(r)];if(i==="cosmos_signDirect")return[Z5(r)];if(typeof r=="string")return[r];const a=r[o.key];if(ts(a))return i==="solana_signAllTransactions"?a.map(c=>K5(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const t=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(t);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(t){this.client.logger.warn("processPendingMessageEvents failed",t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(vt.message,t=>{this.onProviderMessageEvent(t)})}async onRelayMessage(t){const{topic:n,message:r,attestation:s,transportType:i}=t,{publicKey:o}=this.client.auth.authKeys.keys.includes(xu)?this.client.auth.authKeys.get(xu):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===Xe.link_mode?Ts:cr});nw(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:Ir(r)})):Dd(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Ln.expired,async t=>{const{topic:n,id:r}=wC(t.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,G("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,G("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(wi.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(wi.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!dt(t,!1)){const{message:n}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:n}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(n)}if(Is(this.client.core.pairing.pairings.get(t).expiry)){const{message:n}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(n)}}async isValidSessionTopic(t){if(!dt(t,!1)){const{message:n}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(n)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){const{message:n}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(n)}if(Is(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:n}=G("EXPIRED",`session topic: ${t}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(t)){const{message:n}=G("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(n)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(dt(t,!1)){const{message:n}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(n)}else{const{message:n}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(n)}}async isValidProposalId(t){if(!wR(t)){const{message:n}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(n)}if(!this.client.proposal.keys.includes(t)){const{message:n}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(n)}if(Is(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:n}=G("EXPIRED",`proposal id: ${t}`);throw new Error(n)}}}class u9 extends Yi{constructor(t,n){super(t,n,Kj,rw),this.core=t,this.logger=n}}let d9=class extends Yi{constructor(t,n){super(t,n,Gj,rw),this.core=t,this.logger=n}};class h9 extends Yi{constructor(t,n){super(t,n,Jj,rw,r=>r.id),this.core=t,this.logger=n}}class f9 extends Yi{constructor(t,n){super(t,n,t9,Pd,()=>xu),this.core=t,this.logger=n}}let p9=class extends Yi{constructor(t,n){super(t,n,n9,Pd),this.core=t,this.logger=n}};class g9 extends Yi{constructor(t,n){super(t,n,r9,Pd,r=>r.id),this.core=t,this.logger=n}}var w9=Object.defineProperty,m9=(e,t,n)=>t in e?w9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nf=(e,t,n)=>m9(e,typeof t!="symbol"?t+"":t,n);class y9{constructor(t,n){this.core=t,this.logger=n,nf(this,"authKeys"),nf(this,"pairingTopics"),nf(this,"requests"),this.authKeys=new f9(this.core,this.logger),this.pairingTopics=new p9(this.core,this.logger),this.requests=new g9(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var b9=Object.defineProperty,v9=(e,t,n)=>t in e?b9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ee=(e,t,n)=>v9(e,typeof t!="symbol"?t+"":t,n);let E9=class kA extends qO{constructor(t){super(t),Ee(this,"protocol",DA),Ee(this,"version",$A),Ee(this,"name",ef.name),Ee(this,"metadata"),Ee(this,"core"),Ee(this,"logger"),Ee(this,"events",new Vn.EventEmitter),Ee(this,"engine"),Ee(this,"session"),Ee(this,"proposal"),Ee(this,"pendingRequest"),Ee(this,"auth"),Ee(this,"signConfig"),Ee(this,"on",(r,s)=>this.events.on(r,s)),Ee(this,"once",(r,s)=>this.events.once(r,s)),Ee(this,"off",(r,s)=>this.events.off(r,s)),Ee(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Ee(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Ee(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Ee(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Ee(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Ee(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=t?.name||ef.name,this.metadata=L4(t?.metadata),this.signConfig=t?.signConfig;const n=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:al(ll({level:t?.logger||ef.logger}));this.core=t?.core||new Vj(t),this.logger=Gt(n,this.name),this.session=new d9(this.core,this.logger),this.proposal=new u9(this.core,this.logger),this.pendingRequest=new h9(this.core,this.logger),this.engine=new l9(this),this.auth=new y9(this.core,this.logger)}static async init(t){const n=new kA(t);return await n.initialize(),n}get context(){return fn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var ru={exports:{}},Sb;function C9(){return Sb||(Sb=1,(function(e,t){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Ht<"u"&&Ht,r=(function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i})();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Ht<"u"&&Ht||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(A){return A&&DataView.prototype.isPrototypeOf(A)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(A){return A&&u.indexOf(Object.prototype.toString.call(A))>-1};function h(A){if(typeof A!="string"&&(A=String(A)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(A)||A==="")throw new TypeError('Invalid character in header field name: "'+A+'"');return A.toLowerCase()}function p(A){return typeof A!="string"&&(A=String(A)),A}function f(A){var _={next:function(){var k=A.shift();return{done:k===void 0,value:k}}};return c.iterable&&(_[Symbol.iterator]=function(){return _}),_}function g(A){this.map={},A instanceof g?A.forEach(function(_,k){this.append(k,_)},this):Array.isArray(A)?A.forEach(function(_){if(_.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+_.length);this.append(_[0],_[1])},this):A&&Object.getOwnPropertyNames(A).forEach(function(_){this.append(_,A[_])},this)}g.prototype.append=function(A,_){A=h(A),_=p(_);var k=this.map[A];this.map[A]=k?k+", "+_:_},g.prototype.delete=function(A){delete this.map[h(A)]},g.prototype.get=function(A){return A=h(A),this.has(A)?this.map[A]:null},g.prototype.has=function(A){return this.map.hasOwnProperty(h(A))},g.prototype.set=function(A,_){this.map[h(A)]=p(_)},g.prototype.forEach=function(A,_){for(var k in this.map)this.map.hasOwnProperty(k)&&A.call(_,this.map[k],k,this)},g.prototype.keys=function(){var A=[];return this.forEach(function(_,k){A.push(k)}),f(A)},g.prototype.values=function(){var A=[];return this.forEach(function(_){A.push(_)}),f(A)},g.prototype.entries=function(){var A=[];return this.forEach(function(_,k){A.push([k,_])}),f(A)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function w(A){if(!A._noBody){if(A.bodyUsed)return Promise.reject(new TypeError("Already read"));A.bodyUsed=!0}}function b(A){return new Promise(function(_,k){A.onload=function(){_(A.result)},A.onerror=function(){k(A.error)}})}function I(A){var _=new FileReader,k=b(_);return _.readAsArrayBuffer(A),k}function y(A){var _=new FileReader,k=b(_),M=/charset=([A-Za-z0-9_-]+)/.exec(A.type),U=M?M[1]:"utf-8";return _.readAsText(A,U),k}function m(A){for(var _=new Uint8Array(A),k=new Array(_.length),M=0;M<_.length;M++)k[M]=String.fromCharCode(_[M]);return k.join("")}function v(A){if(A.slice)return A.slice(0);var _=new Uint8Array(A.byteLength);return _.set(new Uint8Array(A)),_.buffer}function C(){return this.bodyUsed=!1,this._initBody=function(A){this.bodyUsed=this.bodyUsed,this._bodyInit=A,A?typeof A=="string"?this._bodyText=A:c.blob&&Blob.prototype.isPrototypeOf(A)?this._bodyBlob=A:c.formData&&FormData.prototype.isPrototypeOf(A)?this._bodyFormData=A:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)?this._bodyText=A.toString():c.arrayBuffer&&c.blob&&l(A)?(this._bodyArrayBuffer=v(A.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(A)||d(A))?this._bodyArrayBuffer=v(A):this._bodyText=A=Object.prototype.toString.call(A):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof A=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(A)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var A=w(this);if(A)return A;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var A=w(this);return A||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(I);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var A=w(this);if(A)return A;if(this._bodyBlob)return y(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(m(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(E)}),this.json=function(){return this.text().then(JSON.parse)},this}var O=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function D(A){var _=A.toUpperCase();return O.indexOf(_)>-1?_:A}function S(A,_){if(!(this instanceof S))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');_=_||{};var k=_.body;if(A instanceof S){if(A.bodyUsed)throw new TypeError("Already read");this.url=A.url,this.credentials=A.credentials,_.headers||(this.headers=new g(A.headers)),this.method=A.method,this.mode=A.mode,this.signal=A.signal,!k&&A._bodyInit!=null&&(k=A._bodyInit,A.bodyUsed=!0)}else this.url=String(A);if(this.credentials=_.credentials||this.credentials||"same-origin",(_.headers||!this.headers)&&(this.headers=new g(_.headers)),this.method=D(_.method||this.method||"GET"),this.mode=_.mode||this.mode||null,this.signal=_.signal||this.signal||(function(){if("AbortController"in a){var P=new AbortController;return P.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&k)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(k),(this.method==="GET"||this.method==="HEAD")&&(_.cache==="no-store"||_.cache==="no-cache")){var M=/([?&])_=[^&]*/;if(M.test(this.url))this.url=this.url.replace(M,"$1_="+new Date().getTime());else{var U=/\?/;this.url+=(U.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}S.prototype.clone=function(){return new S(this,{body:this._bodyInit})};function E(A){var _=new FormData;return A.trim().split("&").forEach(function(k){if(k){var M=k.split("="),U=M.shift().replace(/\+/g," "),P=M.join("=").replace(/\+/g," ");_.append(decodeURIComponent(U),decodeURIComponent(P))}}),_}function N(A){var _=new g,k=A.replace(/\r?\n[\t ]+/g," ");return k.split("\r").map(function(M){return M.indexOf(`
`)===0?M.substr(1,M.length):M}).forEach(function(M){var U=M.split(":"),P=U.shift().trim();if(P){var H=U.join(":").trim();try{_.append(P,H)}catch(Y){console.warn("Response "+Y.message)}}}),_}C.call(S.prototype);function $(A,_){if(!(this instanceof $))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(_||(_={}),this.type="default",this.status=_.status===void 0?200:_.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=_.statusText===void 0?"":""+_.statusText,this.headers=new g(_.headers),this.url=_.url||"",this._initBody(A)}C.call($.prototype),$.prototype.clone=function(){return new $(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},$.error=function(){var A=new $(null,{status:200,statusText:""});return A.ok=!1,A.status=0,A.type="error",A};var B=[301,302,303,307,308];$.redirect=function(A,_){if(B.indexOf(_)===-1)throw new RangeError("Invalid status code");return new $(null,{status:_,headers:{location:A}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(_,k){this.message=_,this.name=k;var M=Error(_);this.stack=M.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function R(A,_){return new Promise(function(k,M){var U=new S(A,_);if(U.signal&&U.signal.aborted)return M(new o.DOMException("Aborted","AbortError"));var P=new XMLHttpRequest;function H(){P.abort()}P.onload=function(){var K={statusText:P.statusText,headers:N(P.getAllResponseHeaders()||"")};U.url.indexOf("file://")===0&&(P.status<200||P.status>599)?K.status=200:K.status=P.status,K.url="responseURL"in P?P.responseURL:K.headers.get("X-Request-URL");var ne="response"in P?P.response:P.responseText;setTimeout(function(){k(new $(ne,K))},0)},P.onerror=function(){setTimeout(function(){M(new TypeError("Network request failed"))},0)},P.ontimeout=function(){setTimeout(function(){M(new TypeError("Network request timed out"))},0)},P.onabort=function(){setTimeout(function(){M(new o.DOMException("Aborted","AbortError"))},0)};function Y(K){try{return K===""&&a.location.href?a.location.href:K}catch{return K}}if(P.open(U.method,Y(U.url),!0),U.credentials==="include"?P.withCredentials=!0:U.credentials==="omit"&&(P.withCredentials=!1),"responseType"in P&&(c.blob?P.responseType="blob":c.arrayBuffer&&(P.responseType="arraybuffer")),_&&typeof _.headers=="object"&&!(_.headers instanceof g||a.Headers&&_.headers instanceof a.Headers)){var J=[];Object.getOwnPropertyNames(_.headers).forEach(function(K){J.push(h(K)),P.setRequestHeader(K,p(_.headers[K]))}),U.headers.forEach(function(K,ne){J.indexOf(ne)===-1&&P.setRequestHeader(ne,K)})}else U.headers.forEach(function(K,ne){P.setRequestHeader(ne,K)});U.signal&&(U.signal.addEventListener("abort",H),P.onreadystatechange=function(){P.readyState===4&&U.signal.removeEventListener("abort",H)}),P.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return R.polyfill=!0,a.fetch||(a.fetch=R,a.Headers=g,a.Request=S,a.Response=$),o.Headers=g,o.Request=S,o.Response=$,o.fetch=R,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;t=s.fetch,t.default=s.fetch,t.fetch=s.fetch,t.Headers=s.Headers,t.Request=s.Request,t.Response=s.Response,e.exports=t})(ru,ru.exports)),ru.exports}var A9=C9();const xb=hd(A9);var I9=Object.defineProperty,S9=Object.defineProperties,x9=Object.getOwnPropertyDescriptors,Nb=Object.getOwnPropertySymbols,N9=Object.prototype.hasOwnProperty,_9=Object.prototype.propertyIsEnumerable,_b=(e,t,n)=>t in e?I9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Tb=(e,t)=>{for(var n in t||(t={}))N9.call(t,n)&&_b(e,n,t[n]);if(Nb)for(var n of Nb(t))_9.call(t,n)&&_b(e,n,t[n]);return e},Ob=(e,t)=>S9(e,x9(t));const T9={Accept:"application/json","Content-Type":"application/json"},O9="POST",Db={headers:T9,method:O9},$b=10;let pr=class{constructor(t,n=!1){if(this.url=t,this.disableProviderPing=n,this.events=new Vn.EventEmitter,this.isAvailable=!1,this.registering=!1,!Gy(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}off(t,n){this.events.off(t,n)}removeListener(t,n){this.events.removeListener(t,n)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const n=ss(t),r=await(await xb(this.url,Ob(Tb({},Db),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(t.id,n)}}async register(t=this.url){if(!Gy(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const n=ss({id:1,jsonrpc:"2.0",method:"test",params:[]});await xb(t,Ob(Tb({},Db),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const n=typeof t.data=="string"?Mi(t.data):t.data;this.events.emit("payload",n)}onError(t,n){const r=this.parseError(n),s=r.message||r.toString(),i=Od(t,s);this.events.emit("payload",i)}parseError(t,n=this.url){return dA(t,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>$b&&this.events.setMaxListeners($b)}};const Pb="error",D9="wss://relay.walletconnect.org",$9="wc",P9="universal_provider",su=`${$9}@2:${P9}:`,UA="https://rpc.walletconnect.org/v1/",To="generic",k9=`${UA}bundler`,Gn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function sw(e){return e==null||typeof e!="object"&&typeof e!="function"}function RA(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function BA(e){return e==null?e===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const U9="[object RegExp]",MA="[object String]",LA="[object Number]",jA="[object Boolean]",FA="[object Arguments]",R9="[object Symbol]",B9="[object Date]",M9="[object Map]",L9="[object Set]",j9="[object Array]",F9="[object ArrayBuffer]",H9="[object Object]",z9="[object DataView]",q9="[object Uint8Array]",W9="[object Uint8ClampedArray]",V9="[object Uint16Array]",K9="[object Uint32Array]",G9="[object Int8Array]",Y9="[object Int16Array]",Z9="[object Int32Array]",J9="[object Float32Array]",X9="[object Float64Array]";function iw(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Q9(e,t){return Bo(e,void 0,e,new Map,t)}function Bo(e,t,n,r=new Map,s=void 0){const i=s?.(e,t,n,r);if(i!=null)return i;if(sw(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){const o=new Array(e.length);r.set(e,o);for(let a=0;a<e.length;a++)o[a]=Bo(e[a],a,n,r,s);return Object.hasOwn(e,"index")&&(o.index=e.index),Object.hasOwn(e,"input")&&(o.input=e.input),o}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const o=new RegExp(e.source,e.flags);return o.lastIndex=e.lastIndex,o}if(e instanceof Map){const o=new Map;r.set(e,o);for(const[a,c]of e)o.set(a,Bo(c,a,n,r,s));return o}if(e instanceof Set){const o=new Set;r.set(e,o);for(const a of e)o.add(Bo(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(e))return e.subarray();if(iw(e)){const o=new(Object.getPrototypeOf(e)).constructor(e.length);r.set(e,o);for(let a=0;a<e.length;a++)o[a]=Bo(e[a],a,n,r,s);return o}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const o=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,o),mi(o,e,n,r,s),o}if(typeof File<"u"&&e instanceof File){const o=new File([e],e.name,{type:e.type});return r.set(e,o),mi(o,e,n,r,s),o}if(e instanceof Blob){const o=new Blob([e],{type:e.type});return r.set(e,o),mi(o,e,n,r,s),o}if(e instanceof Error){const o=new e.constructor;return r.set(e,o),o.message=e.message,o.name=e.name,o.stack=e.stack,o.cause=e.cause,mi(o,e,n,r,s),o}if(typeof e=="object"&&e7(e)){const o=Object.create(Object.getPrototypeOf(e));return r.set(e,o),mi(o,e,n,r,s),o}return e}function mi(e,t,n=e,r,s){const i=[...Object.keys(t),...RA(t)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(e,a);(c==null||c.writable)&&(e[a]=Bo(t[a],a,n,r,s))}}function e7(e){switch(BA(e)){case FA:case j9:case F9:case z9:case jA:case B9:case J9:case X9:case G9:case Y9:case Z9:case M9:case LA:case H9:case U9:case L9:case MA:case R9:case q9:case W9:case V9:case K9:return!0;default:return!1}}function t7(e,t){return Q9(e,(n,r,s,i)=>{if(typeof e=="object")switch(Object.prototype.toString.call(e)){case LA:case MA:case jA:{const o=new e.constructor(e?.valueOf());return mi(o,e),o}case FA:{const o={};return mi(o,e),o.length=e.length,o[Symbol.iterator]=e[Symbol.iterator],o}default:return}})}function kb(e){return t7(e)}function Ub(e){return e!==null&&typeof e=="object"&&BA(e)==="[object Arguments]"}function Rb(e){return typeof e=="object"&&e!==null}function n7(){}function r7(e){return iw(e)}function s7(e){if(typeof e!="object"||e==null)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!=="[object Object]"){const n=e[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable?!1:e.toString()===`[object ${n}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function i7(e){if(sw(e))return e;if(Array.isArray(e)||iw(e)||e instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer)return e.slice(0);const t=Object.getPrototypeOf(e),n=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new n(e);if(e instanceof RegExp){const r=new n(e);return r.lastIndex=e.lastIndex,r}if(e instanceof DataView)return new n(e.buffer.slice(0));if(e instanceof Error){const r=new n(e.message);return r.stack=e.stack,r.name=e.name,r.cause=e.cause,r}if(typeof File<"u"&&e instanceof File)return new n([e],e.name,{type:e.type,lastModified:e.lastModified});if(typeof e=="object"){const r=Object.create(t);return Object.assign(r,e)}return e}function o7(e,...t){const n=t.slice(0,-1),r=t[t.length-1];let s=e;for(let i=0;i<n.length;i++){const o=n[i];s=Rp(s,o,r,new Map)}return s}function Rp(e,t,n,r){if(sw(e)&&(e=Object(e)),t==null||typeof t!="object")return e;if(r.has(t))return i7(r.get(t));if(r.set(t,e),Array.isArray(t)){t=t.slice();for(let i=0;i<t.length;i++)t[i]=t[i]??void 0}const s=[...Object.keys(t),...RA(t)];for(let i=0;i<s.length;i++){const o=s[i];let a=t[o],c=e[o];if(Ub(a)&&(a={...a}),Ub(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=kb(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const p=d[h];u[p]=c[p]}c=u}else c=[];const l=n(c,a,o,e,t,r);l!=null?e[o]=l:Array.isArray(a)||Rb(c)&&Rb(a)?e[o]=Rp(c,a,n,r):c==null&&s7(a)?e[o]=Rp({},a,n,r):c==null&&r7(a)?e[o]=kb(a):(c===void 0||a!==void 0)&&(e[o]=a)}return e}function a7(e,...t){return o7(e,...t,n7)}var c7=Object.defineProperty,l7=Object.defineProperties,u7=Object.getOwnPropertyDescriptors,Bb=Object.getOwnPropertySymbols,d7=Object.prototype.hasOwnProperty,h7=Object.prototype.propertyIsEnumerable,Mb=(e,t,n)=>t in e?c7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,iu=(e,t)=>{for(var n in t||(t={}))d7.call(t,n)&&Mb(e,n,t[n]);if(Bb)for(var n of Bb(t))h7.call(t,n)&&Mb(e,n,t[n]);return e},f7=(e,t)=>l7(e,u7(t));function Tn(e,t,n){var r;const s=Fo(e);return((r=t.rpcMap)==null?void 0:r[s.reference])||`${UA}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function Zi(e){return e.includes(":")?e.split(":")[1]:e}function HA(e){return e.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function p7(e,t){const n=Object.keys(t.namespaces).filter(s=>s.includes(e));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=t.namespaces[s].accounts;r.push(...i)}),r}function Lb(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>{var r,s;return((r=n?.chains)==null?void 0:r.length)&&((s=n?.chains)==null?void 0:s.length)>0}))}function ou(e={},t={}){const n=Lb(jb(e)),r=Lb(jb(t));return a7(n,r)}function jb(e){var t,n,r,s,i;const o={};if(!Dr(e))return o;for(const[a,c]of Object.entries(e)){const l=_d(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},p=Ro(a);o[p]=f7(iu(iu({},o[p]),c),{chains:Or(l,(t=o[p])==null?void 0:t.chains),methods:Or(u,(n=o[p])==null?void 0:n.methods),events:Or(d,(r=o[p])==null?void 0:r.events)}),(Dr(h)||Dr(((s=o[p])==null?void 0:s.rpcMap)||{}))&&(o[p].rpcMap=iu(iu({},h),(i=o[p])==null?void 0:i.rpcMap))}return o}function Fb(e){return e.includes(":")?e.split(":")[2]:e}function Hb(e){const t={};for(const[n,r]of Object.entries(e)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=_d(n)?[n]:r.chains?r.chains:HA(r.accounts);t[n]={chains:a,methods:s,events:i,accounts:o}}return t}function rf(e){return typeof e=="number"?e:e.includes("0x")?parseInt(e,16):(e=e.includes(":")?e.split(":")[1]:e,isNaN(Number(e))?e:Number(e))}const zA={},Pe=e=>zA[e],sf=(e,t)=>{zA[e]=t};var g7=Object.defineProperty,zb=Object.getOwnPropertySymbols,w7=Object.prototype.hasOwnProperty,m7=Object.prototype.propertyIsEnumerable,qb=(e,t,n)=>t in e?g7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Wb=(e,t)=>{for(var n in t||(t={}))w7.call(t,n)&&qb(e,n,t[n]);if(zb)for(var n of zb(t))m7.call(t,n)&&qb(e,n,t[n]);return e};const Vb="eip155",y7=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],b7=e=>e&&e.startsWith("0x")?BigInt(e).toString(10):e,of=e=>e&&e.startsWith("0x")?e:`0x${BigInt(e).toString(16)}`,Kb=e=>Object.keys(e).filter(t=>y7.includes(t)).reduce((t,n)=>(t[n]=e[n],t),{}),v7=(e,t,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=e,i={};if(!Dr(s)&&!Dr(r))return;const o=Kb(r);for(const a of n){const c=b7(a);if(!c)continue;i[of(c)]=o;const l=s?.[`${Vb}:${c}`];if(l){const u=l?.[`${Vb}:${c}:${t}`];i[of(c)]=Wb(Wb({},i[of(c)]),Kb(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var E7=Object.defineProperty,C7=(e,t,n)=>t in e?E7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,po=(e,t,n)=>C7(e,typeof t!="symbol"?t+"":t,n);let A7=class{constructor(t){po(this,"name","polkadot"),po(this,"client"),po(this,"httpProviders"),po(this,"events"),po(this,"namespace"),po(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}};var I7=Object.defineProperty,S7=Object.defineProperties,x7=Object.getOwnPropertyDescriptors,Gb=Object.getOwnPropertySymbols,N7=Object.prototype.hasOwnProperty,_7=Object.prototype.propertyIsEnumerable,Bp=(e,t,n)=>t in e?I7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Yb=(e,t)=>{for(var n in t||(t={}))N7.call(t,n)&&Bp(e,n,t[n]);if(Gb)for(var n of Gb(t))_7.call(t,n)&&Bp(e,n,t[n]);return e},Zb=(e,t)=>S7(e,x7(t)),go=(e,t,n)=>Bp(e,typeof t!="symbol"?t+"":t,n);class T7{constructor(t){go(this,"name","eip155"),go(this,"client"),go(this,"chainId"),go(this,"namespace"),go(this,"httpProviders"),go(this,"events"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(t);case"wallet_getCallsStatus":return await this.getCallStatus(t)}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(parseInt(t),n),this.chainId=parseInt(t),this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,n){const r=n||Tn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(Zi(n));t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}async handleSwitchChain(t){var n,r;let s=t.request.params?(n=t.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}async getCapabilities(t){var n,r,s,i,o;const a=(r=(n=t.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=t.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(t.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let p;try{p=v7(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(p)return p;const f=await this.client.request(t);try{await this.client.session.update(t.topic,{sessionProperties:Zb(Yb({},l.sessionProperties||{}),{capabilities:Zb(Yb({},u||{}),{[d]:f})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return f}async getCallStatus(t){var n,r;const s=this.client.session.get(t.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const a=this.getBundlerUrl(t.chainId,i);try{return await this.getUserOperationReceipt(a,t)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,t)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(t.request.method))return await this.client.request(t);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(t,n){var r;const s=new URL(t),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ks("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(t,n){return`${k9}?projectId=${this.client.core.projectId}&chainId=${t}&bundler=${n}`}}var O7=Object.defineProperty,D7=(e,t,n)=>t in e?O7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,wo=(e,t,n)=>D7(e,typeof t!="symbol"?t+"":t,n);let $7=class{constructor(t){wo(this,"name","solana"),wo(this,"client"),wo(this,"httpProviders"),wo(this,"events"),wo(this,"namespace"),wo(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}};var P7=Object.defineProperty,k7=(e,t,n)=>t in e?P7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,mo=(e,t,n)=>k7(e,typeof t!="symbol"?t+"":t,n);class U7{constructor(t){mo(this,"name","cosmos"),mo(this,"client"),mo(this,"httpProviders"),mo(this,"events"),mo(this,"namespace"),mo(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}}var R7=Object.defineProperty,B7=(e,t,n)=>t in e?R7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yo=(e,t,n)=>B7(e,typeof t!="symbol"?t+"":t,n);let M7=class{constructor(t){yo(this,"name","algorand"),yo(this,"client"),yo(this,"httpProviders"),yo(this,"events"),yo(this,"namespace"),yo(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){if(!this.httpProviders[t]){const r=n||Tn(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;t[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Kn(new pr(r,Pe("disableProviderPing")))}};var L7=Object.defineProperty,j7=(e,t,n)=>t in e?L7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bo=(e,t,n)=>j7(e,typeof t!="symbol"?t+"":t,n);let F7=class{constructor(t){bo(this,"name","cip34"),bo(this,"client"),bo(this,"httpProviders"),bo(this,"events"),bo(this,"namespace"),bo(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=Zi(n);t[s]=this.createHttpProvider(s,r)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}getCardanoRPCUrl(t){const n=this.namespace.rpcMap;if(n)return n[t]}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||this.getCardanoRPCUrl(t);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}};var H7=Object.defineProperty,z7=(e,t,n)=>t in e?H7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,vo=(e,t,n)=>z7(e,typeof t!="symbol"?t+"":t,n);let q7=class{constructor(t){vo(this,"name","elrond"),vo(this,"client"),vo(this,"httpProviders"),vo(this,"events"),vo(this,"namespace"),vo(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}};var W7=Object.defineProperty,V7=(e,t,n)=>t in e?W7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Eo=(e,t,n)=>V7(e,typeof t!="symbol"?t+"":t,n);class K7{constructor(t){Eo(this,"name","multiversx"),Eo(this,"client"),Eo(this,"httpProviders"),Eo(this,"events"),Eo(this,"namespace"),Eo(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);t[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}}var G7=Object.defineProperty,Y7=(e,t,n)=>t in e?G7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Co=(e,t,n)=>Y7(e,typeof t!="symbol"?t+"":t,n);class Z7{constructor(t){Co(this,"name","near"),Co(this,"client"),Co(this,"httpProviders"),Co(this,"events"),Co(this,"namespace"),Co(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){if(this.chainId=t,!this.httpProviders[t]){const r=n||Tn(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{var r;t[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace);return typeof r>"u"?void 0:new Kn(new pr(r,Pe("disableProviderPing")))}}var J7=Object.defineProperty,X7=(e,t,n)=>t in e?J7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ao=(e,t,n)=>X7(e,typeof t!="symbol"?t+"":t,n);class Q7{constructor(t){Ao(this,"name","tezos"),Ao(this,"client"),Ao(this,"httpProviders"),Ao(this,"events"),Ao(this,"namespace"),Ao(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,n){if(this.chainId=t,!this.httpProviders[t]){const r=n||Tn(`${this.name}:${t}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,r)}this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(n=>{t[n]=this.createHttpProvider(n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace);return typeof r>"u"?void 0:new Kn(new pr(r))}}var eF=Object.defineProperty,tF=(e,t,n)=>t in e?eF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Io=(e,t,n)=>tF(e,typeof t!="symbol"?t+"":t,n);class nF{constructor(t){Io(this,"name",To),Io(this,"client"),Io(this,"httpProviders"),Io(this,"events"),Io(this,"namespace"),Io(this,"chainId"),this.namespace=t.namespace,this.events=Pe("events"),this.client=Pe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(t.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(t.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(t.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(t.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider(t.chainId).request(t.request)}setDefaultChain(t,n){this.httpProviders[t]||this.setHttpProvider(t,n),this.chainId=t,this.events.emit(Gn.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var t,n;const r={};return(n=(t=this.namespace)==null?void 0:t.accounts)==null||n.forEach(s=>{const i=Fo(s);r[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),r}getHttpProvider(t){const n=this.httpProviders[t];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return n}setHttpProvider(t,n){const r=this.createHttpProvider(t,n);r&&(this.httpProviders[t]=r)}createHttpProvider(t,n){const r=n||Tn(t,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${t}`);return new Kn(new pr(r,Pe("disableProviderPing")))}}var rF=Object.defineProperty,sF=Object.defineProperties,iF=Object.getOwnPropertyDescriptors,Jb=Object.getOwnPropertySymbols,oF=Object.prototype.hasOwnProperty,aF=Object.prototype.propertyIsEnumerable,Mp=(e,t,n)=>t in e?rF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,au=(e,t)=>{for(var n in t||(t={}))oF.call(t,n)&&Mp(e,n,t[n]);if(Jb)for(var n of Jb(t))aF.call(t,n)&&Mp(e,n,t[n]);return e},af=(e,t)=>sF(e,iF(t)),Un=(e,t,n)=>Mp(e,typeof t!="symbol"?t+"":t,n);let qA=class WA{constructor(t){Un(this,"client"),Un(this,"namespaces"),Un(this,"optionalNamespaces"),Un(this,"sessionProperties"),Un(this,"scopedProperties"),Un(this,"events",new Tg),Un(this,"rpcProviders",{}),Un(this,"session"),Un(this,"providerOpts"),Un(this,"logger"),Un(this,"uri"),Un(this,"disableProviderPing",!1),this.providerOpts=t,this.logger=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:al(ll({level:t?.logger||Pb})),this.disableProviderPing=t?.disableProviderPing||!1}static async init(t){const n=new WA(t);return await n.initialize(),n}async request(t,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:au({},t),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(t,n,r,s){const i=new Date().getTime();this.request(t,r,s).then(o=>n(null,Td(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:et("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}async authenticate(t,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(t),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(t,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=Hb(this.session.namespaces);this.namespaces=ou(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(t,n){this.events.on(t,n)}once(t,n){this.events.once(t,n)}removeListener(t,n){this.events.removeListener(t,n)}off(t,n){this.events.off(t,n)}get isWalletConnect(){return!0}async pair(t){const{uri:n,approval:r}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=Hb(s.namespaces);return this.namespaces=ou(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(t,n){try{if(!this.session)return;const[r,s]=this.validateChain(t),i=this.getProvider(r);i.name===To?i.setDefaultChain(`${r}:${s}`,n):i.setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(ts(n)){for(const r of n)t.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var t,n;if(this.client=this.providerOpts.client||await E9.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Pb,relayUrl:this.providerOpts.relayUrl||D9,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(t=this.providerOpts)==null?void 0:t.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(n=>Ro(n)))];sf("client",this.client),sf("events",this.events),sf("disableProviderPing",this.disableProviderPing),t.forEach(n=>{if(!this.session)return;const r=p7(n,this.session);if(r?.length===0)return;const s=HA(r),i=ou(this.namespaces,this.optionalNamespaces),o=af(au({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new T7({namespace:o});break;case"algorand":this.rpcProviders[n]=new M7({namespace:o});break;case"solana":this.rpcProviders[n]=new $7({namespace:o});break;case"cosmos":this.rpcProviders[n]=new U7({namespace:o});break;case"polkadot":this.rpcProviders[n]=new A7({namespace:o});break;case"cip34":this.rpcProviders[n]=new F7({namespace:o});break;case"elrond":this.rpcProviders[n]=new q7({namespace:o});break;case"multiversx":this.rpcProviders[n]=new K7({namespace:o});break;case"near":this.rpcProviders[n]=new Z7({namespace:o});break;case"tezos":this.rpcProviders[n]=new Q7({namespace:o});break;default:this.rpcProviders[To]?this.rpcProviders[To].updateNamespace(o):this.rpcProviders[To]=new nF({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{var n;const{topic:r}=t;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{var n;const{params:r,topic:s}=t;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&ts(o)&&this.events.emit("accountsChanged",o.map(Fb))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Ro(o),l=rf(o)!==rf(a)?`${c}:${rf(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:n})=>{var r,s;if(t!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(t);this.session=af(au({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:n})}),this.client.on("session_delete",async t=>{var n;t.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",af(au({},et("USER_DISCONNECTED")),{data:t.topic})))}),this.on(Gn.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){return this.rpcProviders[t]||this.rpcProviders[To]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var n;this.getProvider(t).updateNamespace((n=this.session)==null?void 0:n.namespaces[t])})}setNamespaces(t){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=t;this.optionalNamespaces=ou(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(t){const[n,r]=t?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>Ro(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=Ro(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}async onChainChanged(t,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(t);if(!s)return;this.updateNamespaceChain(r,s),this.events.emit("chainChanged",s);const i=this.getProvider(r).getDefaultChain();n||this.getProvider(r).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:t}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:t,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[t])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(Fb);if(!ts(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(t,n){if(!this.namespaces)return;const r=this.namespaces[t]?t:`${t}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(t,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${su}/${t}${s}`,n)}async getFromStore(t){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${su}/${t}${r}`)}async deleteFromStore(t){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${su}/${t}${r}`)}async cleanupStorage(){var t;try{if(((t=this.client)==null?void 0:t.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(su)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}};const cF=qA;var Xb={};const q={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Xb<"u"?Xb.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}},VA={caipNetworkIdToNumber(e){return e?Number(e.split(":")[1]):void 0},parseEvmChainId(e){return typeof e=="string"?this.caipNetworkIdToNumber(e):e},getNetworksByNamespace(e,t){return e?.filter(n=>n.chainNamespace===t)||[]},getFirstNetworkByNamespace(e,t){return this.getNetworksByNamespace(e,t)[0]},getNetworkNameByCaipNetworkId(e,t){if(!t)return;const n=e.find(s=>s.caipNetworkId===t);if(n)return n.name;const[r]=t.split(":");return q.CHAIN_NAME_MAP?.[r]||void 0}},KA=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var lF=20,uF=1,Fi=1e6,Qb=1e6,dF=-7,hF=21,fF=!1,ml="[big.js] ",Ji=ml+"Invalid ",kd=Ji+"decimal places",pF=Ji+"rounding mode",GA=ml+"Division by zero",je={},$r=void 0,gF=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function YA(){function e(t){var n=this;if(!(n instanceof e))return t===$r?YA():new e(t);if(t instanceof e)n.s=t.s,n.e=t.e,n.c=t.c.slice();else{if(typeof t!="string"){if(e.strict===!0&&typeof t!="bigint")throw TypeError(Ji+"value");t=t===0&&1/t<0?"-0":String(t)}wF(n,t)}n.constructor=e}return e.prototype=je,e.DP=lF,e.RM=uF,e.NE=dF,e.PE=hF,e.strict=fF,e.roundDown=0,e.roundHalfUp=1,e.roundHalfEven=2,e.roundUp=3,e}function wF(e,t){var n,r,s;if(!gF.test(t))throw Error(Ji+"number");for(e.s=t.charAt(0)=="-"?(t=t.slice(1),-1):1,(n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),s=t.length,r=0;r<s&&t.charAt(r)=="0";)++r;if(r==s)e.c=[e.e=0];else{for(;s>0&&t.charAt(--s)=="0";);for(e.e=n-r-1,e.c=[],n=0;r<=s;)e.c[n++]=+t.charAt(r++)}return e}function Xi(e,t,n,r){var s=e.c;if(n===$r&&(n=e.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(pF);if(t<1)r=n===3&&(r||!!s[0])||t===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==$r))),s.length=1,r?(e.e=e.e-t+1,s[0]=1):s[0]=e.e=0;else if(t<s.length){if(r=n===1&&s[t]>=5||n===2&&(s[t]>5||s[t]===5&&(r||s[t+1]!==$r||s[t-1]&1))||n===3&&(r||!!s[0]),s.length=t,r){for(;++s[--t]>9;)if(s[t]=0,t===0){++e.e,s.unshift(1);break}}for(t=s.length;!s[--t];)s.pop()}return e}function Qi(e,t,n){var r=e.e,s=e.c.join(""),i=s.length;if(t)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return e.s<0&&n?"-"+s:s}je.abs=function(){var e=new this.constructor(this);return e.s=1,e};je.cmp=function(e){var t,n=this,r=n.c,s=(e=new n.constructor(e)).c,i=n.s,o=e.s,a=n.e,c=e.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(t=i<0,a!=c)return a>c^t?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^t?1:-1;return a==c?0:a>c^t?1:-1};je.div=function(e){var t=this,n=t.constructor,r=t.c,s=(e=new n(e)).c,i=t.s==e.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>Fi)throw Error(kd);if(!s[0])throw Error(GA);if(!r[0])return e.s=i,e.c=[e.e=0],e;var a,c,l,u,d,h=s.slice(),p=a=s.length,f=r.length,g=r.slice(0,a),w=g.length,b=e,I=b.c=[],y=0,m=o+(b.e=t.e-e.e)+1;for(b.s=i,i=m<0?0:m,h.unshift(0);w++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(w=g.length))u=a>w?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=w==a?s:h;w;){if(g[--w]<c[w]){for(d=w;d&&!g[--d];)g[d]=9;--g[d],g[w]+=10}g[w]-=c[w]}for(;!g[0];)g.shift()}else break}I[y++]=u?l:++l,g[0]&&u?g[w]=r[p]||0:g=[r[p]]}while((p++<f||g[0]!==$r)&&i--);return!I[0]&&y!=1&&(I.shift(),b.e--,m--),y>m&&Xi(b,m,n.RM,g[0]!==$r),b};je.eq=function(e){return this.cmp(e)===0};je.gt=function(e){return this.cmp(e)>0};je.gte=function(e){return this.cmp(e)>-1};je.lt=function(e){return this.cmp(e)<0};je.lte=function(e){return this.cmp(e)<1};je.minus=je.sub=function(e){var t,n,r,s,i=this,o=i.constructor,a=i.s,c=(e=new o(e)).s;if(a!=c)return e.s=-c,i.plus(e);var l=i.c.slice(),u=i.e,d=e.c,h=e.e;if(!l[0]||!d[0])return d[0]?e.s=-c:l[0]?e=new o(i):e.s=1,e;if(a=u-h){for((s=a<0)?(a=-a,r=l):(h=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,e.s=-e.s),(c=(n=d.length)-(t=l.length))>0)for(;c--;)l[t++]=0;for(c=t;n>a;){if(l[--n]<d[n]){for(t=n;t&&!l[--t];)l[t]=9;--l[t],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(e.s=1,l=[h=0]),e.c=l,e.e=h,e};je.mod=function(e){var t,n=this,r=n.constructor,s=n.s,i=(e=new r(e)).s;if(!e.c[0])throw Error(GA);return n.s=e.s=1,t=e.cmp(n)==1,n.s=s,e.s=i,t?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(e),r.DP=s,r.RM=i,this.minus(n.times(e)))};je.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e};je.plus=je.add=function(e){var t,n,r,s=this,i=s.constructor;if(e=new i(e),s.s!=e.s)return e.s=-e.s,s.minus(e);var o=s.e,a=s.c,c=e.e,l=e.c;if(!a[0]||!l[0])return l[0]||(a[0]?e=new i(s):e.s=s.s),e;if(a=a.slice(),t=o-c){for(t>0?(c=o,r=l):(t=-t,r=a),r.reverse();t--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),t=l.length,n=0;t;a[t]%=10)n=(a[--t]=a[t]+l[t]+n)/10|0;for(n&&(a.unshift(n),++c),t=a.length;a[--t]===0;)a.pop();return e.c=a,e.e=c,e};je.pow=function(e){var t=this,n=new t.constructor("1"),r=n,s=e<0;if(e!==~~e||e<-Qb||e>Qb)throw Error(Ji+"exponent");for(s&&(e=-e);e&1&&(r=r.times(t)),e>>=1,!!e;)t=t.times(t);return s?n.div(r):r};je.prec=function(e,t){if(e!==~~e||e<1||e>Fi)throw Error(Ji+"precision");return Xi(new this.constructor(this),e,t)};je.round=function(e,t){if(e===$r)e=0;else if(e!==~~e||e<-Fi||e>Fi)throw Error(kd);return Xi(new this.constructor(this),e+this.e+1,t)};je.sqrt=function(){var e,t,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(ml+"No square root");i=Math.sqrt(+Qi(r,!0,!0)),i===0||i===1/0?(t=r.c.join(""),t.length+o&1||(t+="0"),i=Math.sqrt(t),o=((o+1)/2|0)-(o<0||o&1),e=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):e=new s(i+""),o=e.e+(s.DP+=4);do n=e,e=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==e.c.slice(0,o).join(""));return Xi(e,(s.DP-=4)+e.e+1,s.RM)};je.times=je.mul=function(e){var t,n=this,r=n.constructor,s=n.c,i=(e=new r(e)).c,o=s.length,a=i.length,c=n.e,l=e.e;if(e.s=n.s==e.s?1:-1,!s[0]||!i[0])return e.c=[e.e=0],e;for(e.e=c+l,o<a&&(t=s,s=i,i=t,l=o,o=a,a=l),t=new Array(l=o+a);l--;)t[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=t[l]+i[c]*s[l-c-1]+a,t[l--]=a%10,a=a/10|0;t[l]=a}for(a?++e.e:t.shift(),c=t.length;!t[--c];)t.pop();return e.c=t,e};je.toExponential=function(e,t){var n=this,r=n.c[0];if(e!==$r){if(e!==~~e||e<0||e>Fi)throw Error(kd);for(n=Xi(new n.constructor(n),++e,t);n.c.length<e;)n.c.push(0)}return Qi(n,!0,!!r)};je.toFixed=function(e,t){var n=this,r=n.c[0];if(e!==$r){if(e!==~~e||e<0||e>Fi)throw Error(kd);for(n=Xi(new n.constructor(n),e+n.e+1,t),e=e+n.e+1;n.c.length<e;)n.c.push(0)}return Qi(n,!1,!!r)};je[Symbol.for("nodejs.util.inspect.custom")]=je.toJSON=je.toString=function(){var e=this,t=e.constructor;return Qi(e,e.e<=t.NE||e.e>=t.PE,!!e.c[0])};je.toNumber=function(){var e=+Qi(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(e.toString()))throw Error(ml+"Imprecise conversion");return e};je.toPrecision=function(e,t){var n=this,r=n.constructor,s=n.c[0];if(e!==$r){if(e!==~~e||e<1||e>Fi)throw Error(Ji+"precision");for(n=Xi(new r(n),e,t);n.c.length<e;)n.c.push(0)}return Qi(n,e<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};je.valueOf=function(){var e=this,t=e.constructor;if(t.strict===!0)throw Error(ml+"valueOf disallowed");return Qi(e,e.e<=t.NE||e.e>=t.PE,!0)};var ja=YA();const mF={bigNumber(e){return e?new ja(e):new ja(0)},multiply(e,t){if(e===void 0||t===void 0)return new ja(0);const n=new ja(e),r=new ja(t);return n.times(r)},formatNumberToLocalString(e,t=2){return e===void 0?"0.00":typeof e=="number"?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})},parseLocalStringToNumber(e){return e===void 0?0:parseFloat(e.replace(/,/gu,""))}},yF=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],bF=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],vF=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],EF={getERC20Abi:e=>q.USDT_CONTRACT_ADDRESSES.includes(e)?vF:yF,getSwapAbi:()=>bF},An={validateCaipAddress(e){if(e.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return e},parseCaipAddress(e){const t=e.split(":");if(t.length!==3)throw new Error(`Invalid CAIP-10 address: ${e}`);const[n,r,s]=t;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(e){const t=e.split(":");if(t.length!==2)throw new Error(`Invalid CAIP-2 network id: ${e}`);const[n,r]=t;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:n,chainId:r}}},de={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails"};function cf(e){if(!e)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${e}:connected_connector_id`}const le={setItem(e,t){Mo()&&t!==void 0&&localStorage.setItem(e,t)},getItem(e){if(Mo())return localStorage.getItem(e)||void 0},removeItem(e){Mo()&&localStorage.removeItem(e)},clear(){Mo()&&localStorage.clear()}};function Mo(){return typeof window<"u"&&typeof localStorage<"u"}function Us(e,t){return t==="light"?{"--w3m-accent":e?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":e?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}const CF=Symbol(),ev=Object.getPrototypeOf,Lp=new WeakMap,AF=e=>e&&(Lp.has(e)?Lp.get(e):ev(e)===Object.prototype||ev(e)===Array.prototype),IF=e=>AF(e)&&e[CF]||null,tv=(e,t=!0)=>{Lp.set(e,t)},td={},ow=e=>typeof e=="object"&&e!==null,SF=e=>ow(e)&&!yl.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer)&&!(e instanceof Promise),ZA=(e,t)=>{const n=jp.get(e);if(n?.[0]===t)return n[1];const r=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return tv(r,!0),jp.set(e,[t,r]),Reflect.ownKeys(e).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(e,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(e,s),a={value:i,enumerable:o,configurable:!0};if(yl.has(i))tv(i,!1);else if(Vs.has(i)){const[c,l]=Vs.get(i);a.value=ZA(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},xF=(e,t,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!e()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(nv(l,o)||Tc.has(o)&&nv(l,Tc.get(o))))return!0;n(i),ow(o)&&(o=IF(o)||o);const u=!Vs.has(o)&&_F(o)?Ze(o):o;return t(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),Vs=new WeakMap,yl=new WeakSet,jp=new WeakMap,Ya=[1,1],Tc=new WeakMap;let nv=Object.is,NF=(e,t)=>new Proxy(e,t),_F=SF,TF=ZA,OF=xF;function Ze(e={}){if(!ow(e))throw new Error("object required");const t=Tc.get(e);if(t)return t;let n=Ya[0];const r=new Set,s=(w,b=++Ya[0])=>{n!==b&&(n=b,r.forEach(I=>I(w,b)))};let i=Ya[1];const o=(w=++Ya[1])=>(i!==w&&!r.size&&(i=w,c.forEach(([b])=>{const I=b[1](w);I>n&&(n=I)})),n),a=w=>(b,I)=>{const y=[...b];y[1]=[w,...y[1]],s(y,I)},c=new Map,l=(w,b)=>{const I=!yl.has(b)&&Vs.get(b);if(I){if((td?"production":void 0)!=="production"&&c.has(w))throw new Error("prop listener already exists");if(r.size){const y=I[2](a(w));c.set(w,[I,y])}else c.set(w,[I])}},u=w=>{var b;const I=c.get(w);I&&(c.delete(w),(b=I[1])==null||b.call(I))},d=w=>(r.add(w),r.size===1&&c.forEach(([I,y],m)=>{if((td?"production":void 0)!=="production"&&y)throw new Error("remove already exists");const v=I[2](a(m));c.set(m,[I,v])}),()=>{r.delete(w),r.size===0&&c.forEach(([I,y],m)=>{y&&(y(),c.set(m,[I]))})});let h=!0;const p=OF(()=>h,l,u,s),f=NF(e,p);Tc.set(e,f);const g=[e,o,d];return Vs.set(f,g),Reflect.ownKeys(e).forEach(w=>{const b=Object.getOwnPropertyDescriptor(e,w);"value"in b&&b.writable&&(f[w]=e[w])}),h=!1,f}function $t(e,t,n){const r=Vs.get(e);(td?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&t(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Oc(e){const t=Vs.get(e);(td?"production":void 0)!=="production"&&!t&&console.warn("Please use proxy object");const[n,r]=t;return TF(n,r())}function Hi(e){return yl.add(e),e}function DF(){return{proxyStateMap:Vs,refSet:yl,snapCache:jp,versionHolder:Ya,proxyCache:Tc}}function zt(e,t,n,r){let s=e[t];return $t(e,()=>{const i=e[t];Object.is(s,i)||n(s=i)})}const{proxyStateMap:$F,snapCache:PF}=DF(),cu=e=>$F.has(e);function kF(e){const t=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=PF.get(a),u=l?.[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:t,index:n,epoch:0,get size(){return cu(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!cu(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!cu(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!cu(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Ze(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}const JA=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],UF="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Me={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,ONE_SEC_MS:1e3,BALANCE_SUPPORTED_CHAINS:[q.CHAIN.EVM,q.CHAIN.SOLANA],NAMES_SUPPORTED_CHAIN_NAMESPACES:[q.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[q.CHAIN.EVM,q.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},V={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3},isCacheExpired(e,t){return Date.now()-e>t},getActiveNetworkProps(){const e=V.getActiveNamespace(),t=V.getActiveCaipNetworkId(),n=t?t.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:e,caipNetworkId:t,chainId:r}},setWalletConnectDeepLink({name:e,href:t}){try{le.setItem(de.DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const e=le.getItem(de.DEEPLINK_CHOICE);if(e)return JSON.parse(e)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{le.removeItem(de.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(e){try{le.setItem(de.ACTIVE_NAMESPACE,e)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(e){try{le.setItem(de.ACTIVE_CAIP_NETWORK_ID,e),V.setActiveNamespace(e.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return le.getItem(de.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{le.removeItem(de.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(e){try{const t=cf(e);le.removeItem(t)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(e){try{const t=V.getRecentWallets();t.find(r=>r.id===e.id)||(t.unshift(e),t.length>2&&t.pop(),le.setItem(de.RECENT_WALLETS,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const e=le.getItem(de.RECENT_WALLETS);return e?JSON.parse(e):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(e,t){try{const n=cf(e);le.setItem(n,t)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return le.getItem(de.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(e){if(e)try{const t=cf(e);return le.getItem(t)}catch{console.info("Unable to get connected connector id in namespace",e)}},setConnectedSocialProvider(e){try{le.setItem(de.CONNECTED_SOCIAL,e)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return le.getItem(de.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{le.removeItem(de.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return le.getItem(de.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return le.getItem(de.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(e){try{le.setItem(de.CONNECTION_STATUS,e)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return le.getItem(de.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const e=le.getItem(de.CONNECTED_NAMESPACES);return e?.length?e.split(","):[]}catch{return[]}},setConnectedNamespaces(e){try{const t=Array.from(new Set(e));le.setItem(de.CONNECTED_NAMESPACES,t.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(e){try{const t=V.getConnectedNamespaces();t.includes(e)||(t.push(e),V.setConnectedNamespaces(t))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(e){try{const t=V.getConnectedNamespaces(),n=t.indexOf(e);n>-1&&(t.splice(n,1),V.setConnectedNamespaces(t))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return le.getItem(de.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(e){try{le.setItem(de.TELEGRAM_SOCIAL_PROVIDER,e)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{le.removeItem(de.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let e={};try{const t=le.getItem(de.PORTFOLIO_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromBalanceCache(e){try{const t=V.getBalanceCache();le.setItem(de.PORTFOLIO_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getBalanceCacheForCaipAddress(e){try{const n=V.getBalanceCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;V.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateBalanceCache(e){try{const t=V.getBalanceCache();t[e.caipAddress]=e,le.setItem(de.PORTFOLIO_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getNativeBalanceCache(){let e={};try{const t=le.getItem(de.NATIVE_BALANCE_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromNativeBalanceCache(e){try{const t=V.getBalanceCache();le.setItem(de.NATIVE_BALANCE_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getNativeBalanceCacheForCaipAddress(e){try{const n=V.getNativeBalanceCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",e),V.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateNativeBalanceCache(e){try{const t=V.getNativeBalanceCache();t[e.caipAddress]=e,le.setItem(de.NATIVE_BALANCE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getEnsCache(){let e={};try{const t=le.getItem(de.ENS_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get ens name cache")}return e},getEnsFromCacheForAddress(e){try{const n=V.getEnsCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;V.removeEnsFromCache(e)}catch{console.info("Unable to get ens name from cache",e)}},updateEnsCache(e){try{const t=V.getEnsCache();t[e.address]=e,le.setItem(de.ENS_CACHE,JSON.stringify(t))}catch{console.info("Unable to update ens name cache",e)}},removeEnsFromCache(e){try{const t=V.getEnsCache();le.setItem(de.ENS_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove ens name from cache",e)}},getIdentityCache(){let e={};try{const t=le.getItem(de.IDENTITY_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get identity cache")}return e},getIdentityFromCacheForAddress(e){try{const n=V.getIdentityCache()[e];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;V.removeIdentityFromCache(e)}catch{console.info("Unable to get identity from cache",e)}},updateIdentityCache(e){try{const t=V.getIdentityCache();t[e.address]={identity:e.identity,timestamp:e.timestamp},le.setItem(de.IDENTITY_CACHE,JSON.stringify(t))}catch{console.info("Unable to update identity cache",e)}},removeIdentityFromCache(e){try{const t=V.getIdentityCache();le.setItem(de.IDENTITY_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove identity from cache",e)}},clearAddressCache(){try{le.removeItem(de.PORTFOLIO_CACHE),le.removeItem(de.NATIVE_BALANCE_CACHE),le.removeItem(de.ENS_CACHE),le.removeItem(de.IDENTITY_CACHE),le.removeItem(de.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(e){try{le.setItem(de.PREFERRED_ACCOUNT_TYPES,JSON.stringify(e))}catch{console.info("Unable to set preferred account types",e)}},getPreferredAccountTypes(){try{const e=le.getItem(de.PREFERRED_ACCOUNT_TYPES);return e?JSON.parse(e):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(e,t){try{const n=V.getConnections(),r=n[t]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of e){const a=s.get(o.connectorId),c=o.connectorId===q.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[t]:Array.from(s.values())};le.setItem(de.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const e=le.getItem(de.CONNECTIONS);return e?JSON.parse(e):{}}catch(e){return console.error("Unable to get connections from storage",e),{}}},deleteAddressFromConnection({connectorId:e,address:t,namespace:n}){try{const r=V.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(e);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==t.toLowerCase()).length===0?i.delete(e):i.set(e,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==t.toLowerCase())})),le.setItem(de.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${t}" from connector "${e}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const e=le.getItem(de.DISCONNECTED_CONNECTOR_IDS);return e?JSON.parse(e):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(e,t){try{const n=V.getDisconnectedConnectorIds(),r=n[t]??[];r.push(e),le.setItem(de.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[t]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${e}" for namespace "${t}"`)}},removeDisconnectedConnectorId(e,t){try{const n=V.getDisconnectedConnectorIds();let r=n[t]??[];r=r.filter(s=>s.toLowerCase()!==e.toLowerCase()),le.setItem(de.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[t]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${e}" for namespace "${t}"`)}},isConnectorDisconnected(e,t){try{return(V.getDisconnectedConnectorIds()[t]??[]).some(s=>s.toLowerCase()===e.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${e}" for namespace "${t}"`)}return!1},getTransactionsCache(){try{const e=le.getItem(de.HISTORY_TRANSACTIONS_CACHE);return e?JSON.parse(e):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:e,chainId:t=""}){try{const r=V.getTransactionsCache()[e]?.[t];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.transactionsHistory))return r.transactions;V.removeTransactionsCache({address:e,chainId:t})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:e,chainId:t="",timestamp:n,transactions:r}){try{const s=V.getTransactionsCache();s[e]={...s[e],[t]:{timestamp:n,transactions:r}},le.setItem(de.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:e,chainId:t,timestamp:n,transactions:r})}},removeTransactionsCache({address:e,chainId:t}){try{const n=V.getTransactionsCache(),r=n?.[e]||{},{[t]:s,...i}=r;le.setItem(de.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[e]:i}))}catch{console.info("Unable to remove transactions cache",{address:e,chainId:t})}},getTokenPriceCache(){try{const e=le.getItem(de.TOKEN_PRICE_CACHE);return e?JSON.parse(e):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(e){try{const n=V.getTokenPriceCache()[e.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;V.removeTokenPriceCache(e)}catch{console.info("Unable to get token price cache for addresses",e)}},updateTokenPriceCache(e){try{const t=V.getTokenPriceCache();t[e.addresses.join(",")]={timestamp:e.timestamp,tokenPrice:e.tokenPrice},le.setItem(de.TOKEN_PRICE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update token price cache",e)}},removeTokenPriceCache(e){try{const t=V.getTokenPriceCache();le.setItem(de.TOKEN_PRICE_CACHE,JSON.stringify({...t,[e.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",e)}}},ce={isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(e,t=""){return e?.caipNetworkId.toLocaleLowerCase().includes(t.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return ce.isMobile()&&e.includes("android")},isIos(){if(!this.isMobile())return!1;const e=window?.navigator.userAgent.toLowerCase();return e.includes("iphone")||e.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(e){return e?e-Date.now()<=Me.TEN_SEC_MS:!0},isAllowedRetry(e,t=Me.ONE_SEC_MS){return Date.now()-e>=t},copyToClopboard(e){navigator.clipboard.writeText(e)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(ce.isClient()&&window.self!==window.top)try{const e=window?.location?.ancestorOrigins?.[0],t="https://app.safe.global";if(e){const n=new URL(e),r=new URL(t);return n.hostname===r.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Me.FOUR_MINUTES_MS},getNetworkId(e){return e?.split(":")[1]},getPlainAddress(e){return e?.split(":")[2]},async wait(e){return new Promise(t=>{setTimeout(t,e)})},debounce(e,t=500){let n;return(...r)=>{function s(){e(...r)}n&&clearTimeout(n),n=setTimeout(s,t)}},isHttpUrl(e){return e.startsWith("http://")||e.startsWith("https://")},formatNativeUrl(e,t,n=null){if(ce.isHttpUrl(e))return this.formatUniversalUrl(e,t);let r=e,s=n;r.includes("://")||(r=e.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(t=encodeURIComponent(t));const i=encodeURIComponent(t);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(e,t){if(!ce.isHttpUrl(e))return this.formatNativeUrl(e,t);let n=e;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(t);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(e){return e==="popupWindow"?e:this.isTelegram()?V.getTelegramSocialProvider()?"_top":"_blank":e},openHref(e,t,n){window?.open(e,this.getOpenTargetForPlatform(t),n||"noreferrer noopener")},returnOpenHref(e,t,n){return window?.open(e,this.getOpenTargetForPlatform(t),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const e=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,t=window?.navigator?.standalone;return!!(e||t)},async preloadImage(e){const t=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=e});return Promise.race([t,ce.wait(2e3)])},formatBalance(e,t){let n="0.000";if(typeof e=="string"){const r=Number(e);if(r){const s=Math.floor(r*1e3)/1e3;s&&(n=s.toString())}}return`${n}${t?` ${t}`:""}`},formatBalance2(e,t){let n;if(e==="0")n="0";else if(typeof e=="string"){const r=Number(e);r&&(n=r.toString().match(/^-?\d+(?:\.\d{0,3})?/u)?.[0])}return{value:n??"0",rest:n==="0"?"000":"",symbol:t}},getApiUrl(){return q.W3M_API_URL},getBlockchainApiUrl(){return q.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return q.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})},parseError(e){return typeof e=="string"?e:typeof e?.issues?.[0]?.message=="string"?e.issues[0].message:e instanceof Error?e.message:"Unknown error"},sortRequestedNetworks(e,t=[]){const n={};return t&&e&&(e.forEach((r,s)=>{n[r]=s}),t.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),t},calculateBalance(e){let t=0;for(const n of e)t+=n.value??0;return t},formatTokenBalance(e){const t=e.toFixed(2),[n,r]=t.split(".");return{dollars:n,pennies:r}},isAddress(e,t="eip155"){switch(t){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)||/^(?:0x)?[0-9A-F]{40}$/iu.test(e))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(e);default:return!1}},uniqueBy(e,t){const n=new Set;return e.filter(r=>{const s=r[t];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(e,t,n){const s=e.length===0?Me.ADAPTER_TYPES.UNIVERSAL:e.map(i=>i.adapterType).join(",");return`${t}-${s}-${n}`},createAccount(e,t,n,r,s){return{namespace:e,address:t,type:n,publicKey:r,path:s}},isCaipAddress(e){if(typeof e!="string")return!1;const t=e.split(":"),n=t[0];return t.filter(Boolean).length===3&&n in q.CHAIN_NAME_MAP},getAccount(e){return e?typeof e=="string"?{address:e,chainId:void 0}:{address:e.address,chainId:e.chainId}:{address:void 0,chainId:void 0}},isMac(){const e=window?.navigator.userAgent.toLowerCase();return e.includes("macintosh")&&!e.includes("safari")},formatTelegramSocialLoginUrl(e){const t=`--${encodeURIComponent(window?.location.href)}`,n="state=";if(new URL(e).host==="auth.magic.link"){const s="provider_authorization_url=",i=e.substring(e.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,t);return e.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(e,n,t)},injectIntoUrl(e,t,n){const r=e.indexOf(t);if(r===-1)throw new Error(`${t} parameter not found in the URL: ${e}`);const s=e.indexOf("&",r),i=t.length,o=s!==-1?s:e.length,a=e.substring(0,r+i),c=e.substring(r+i,o),l=e.substring(s),u=c+n;return a+u+l}};async function Fa(...e){const t=await fetch(...e);if(!t.ok)throw new Error(`HTTP status code: ${t.status}`,{cause:t});return t}class bl{constructor({baseUrl:t,clientId:n}){this.baseUrl=t,this.clientId=n}async get({headers:t,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"GET",headers:t,signal:n,cache:r})).json()}async getBlob({headers:t,signal:n,...r}){const s=this.createUrl(r);return(await Fa(s,{method:"GET",headers:t,signal:n})).blob()}async post({body:t,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"POST",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}async put({body:t,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"PUT",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}async delete({body:t,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Fa(i,{method:"DELETE",headers:n,body:t?JSON.stringify(t):void 0,signal:r})).json()}createUrl({path:t,params:n}){const r=new URL(t,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}const RF={getFeatureValue(e,t){const n=t?.[e];return n===void 0?Me.DEFAULT_FEATURES[e]:n},filterSocialsByPlatform(e){if(!e||!e.length)return e;if(ce.isTelegram()){if(ce.isIos())return e.filter(t=>t!=="google");if(ce.isMac())return e.filter(t=>t!=="x");if(ce.isAndroid())return e.filter(t=>!["facebook","x"].includes(t))}return e}},ie=Ze({features:Me.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Me.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),z={state:ie,subscribeKey(e,t){return zt(ie,e,t)},setOptions(e){Object.assign(ie,e)},setRemoteFeatures(e){if(!e)return;const t={...ie.remoteFeatures,...e};ie.remoteFeatures=t,ie.remoteFeatures?.socials&&(ie.remoteFeatures.socials=RF.filterSocialsByPlatform(ie.remoteFeatures.socials)),ie.features?.pay&&(ie.remoteFeatures.email=!1,ie.remoteFeatures.socials=!1)},setFeatures(e){if(!e)return;ie.features||(ie.features=Me.DEFAULT_FEATURES);const t={...ie.features,...e};ie.features=t,ie.features?.pay&&ie.remoteFeatures&&(ie.remoteFeatures.email=!1,ie.remoteFeatures.socials=!1)},setProjectId(e){ie.projectId=e},setCustomRpcUrls(e){ie.customRpcUrls=e},setAllWallets(e){ie.allWallets=e},setIncludeWalletIds(e){ie.includeWalletIds=e},setExcludeWalletIds(e){ie.excludeWalletIds=e},setFeaturedWalletIds(e){ie.featuredWalletIds=e},setTokens(e){ie.tokens=e},setTermsConditionsUrl(e){ie.termsConditionsUrl=e},setPrivacyPolicyUrl(e){ie.privacyPolicyUrl=e},setCustomWallets(e){ie.customWallets=e},setIsSiweEnabled(e){ie.isSiweEnabled=e},setIsUniversalProvider(e){ie.isUniversalProvider=e},setSdkVersion(e){ie.sdkVersion=e},setMetadata(e){ie.metadata=e},setDisableAppend(e){ie.disableAppend=e},setEIP6963Enabled(e){ie.enableEIP6963=e},setDebug(e){ie.debug=e},setEnableWalletConnect(e){ie.enableWalletConnect=e},setEnableWalletGuide(e){ie.enableWalletGuide=e},setEnableAuthLogger(e){ie.enableAuthLogger=e},setEnableWallets(e){ie.enableWallets=e},setPreferUniversalLinks(e){ie.experimental_preferUniversalLinks=e},setSIWX(e){if(e)for(const[t,n]of Object.entries(Me.SIWX_DEFAULTS))e[t]??=n;ie.siwx=e},setConnectMethodsOrder(e){ie.features={...ie.features,connectMethodsOrder:e}},setWalletFeaturesOrder(e){ie.features={...ie.features,walletFeaturesOrder:e}},setSocialsOrder(e){ie.remoteFeatures={...ie.remoteFeatures,socials:e}},setCollapseWallets(e){ie.features={...ie.features,collapseWallets:e}},setEnableEmbedded(e){ie.enableEmbedded=e},setAllowUnsupportedChain(e){ie.allowUnsupportedChain=e},setManualWCControl(e){ie.manualWCControl=e},setEnableNetworkSwitch(e){ie.enableNetworkSwitch=e},setEnableReconnect(e){ie.enableReconnect=e},setDefaultAccountTypes(e={}){Object.entries(e).forEach(([t,n])=>{n&&(ie.defaultAccountTypes[t]=n)})},setUniversalProviderConfigOverride(e){ie.universalProviderConfigOverride=e},getUniversalProviderConfigOverride(){return ie.universalProviderConfigOverride},getSnapshot(){return Oc(ie)}},BF=Object.freeze({enabled:!0,events:[]}),MF=new bl({baseUrl:ce.getAnalyticsUrl(),clientId:null}),LF=5,jF=60*1e3,Cs=Ze({...BF}),FF={state:Cs,subscribeKey(e,t){return zt(Cs,e,t)},async sendError(e,t){if(!Cs.enabled)return;const n=Date.now();if(Cs.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<jF}).length>=LF)return;const s={type:"error",event:t,properties:{errorType:e.name,errorMessage:e.message,stackTrace:e.stack,timestamp:new Date().toISOString()}};Cs.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=z.state;await MF.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:ce.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:t,errorType:e.name,errorMessage:e.message,stackTrace:e.stack}}})}catch{}},enable(){Cs.enabled=!0},disable(){Cs.enabled=!1},clearEvents(){Cs.events=[]}};class Qo extends Error{constructor(t,n,r){super(t),this.name="AppKitError",this.category=n,this.originalError=r,Object.setPrototypeOf(this,Qo.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,Qo):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function rv(e,t){const n=e instanceof Qo?e:new Qo(e instanceof Error?e.message:String(e),t,e);throw FF.sendError(n,n.category),n}function Dn(e,t="INTERNAL_SDK_ERROR"){const n={};return Object.keys(e).forEach(r=>{const s=e[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return rv(a,t)}}:i=(...o)=>{try{return s(...o)}catch(a){return rv(a,t)}},n[r]=i}else n[r]=s}),n}const Oi={ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},Sr={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"}},HF={handleMobileDeeplinkRedirect(e,t){const n=window.location.href,r=encodeURIComponent(n);if(e===Sr.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${Sr.PHANTOM.url}/ul/browse/${r}?ref=${o}`}e===Sr.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${Sr.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),t===q.CHAIN.SOLANA&&e===Sr.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${Sr.COINBASE.url}/dapp?cb_url=${r}`)}},mn=Ze({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),zF={state:mn,subscribeNetworkImages(e){return $t(mn.networkImages,()=>e(mn.networkImages))},subscribeKey(e,t){return zt(mn,e,t)},subscribe(e){return $t(mn,()=>e(mn))},setWalletImage(e,t){mn.walletImages[e]=t},setNetworkImage(e,t){mn.networkImages[e]=t},setChainImage(e,t){mn.chainImages[e]=t},setConnectorImage(e,t){mn.connectorImages={...mn.connectorImages,[e]:t}},setTokenImage(e,t){mn.tokenImages[e]=t},setCurrencyImage(e,t){mn.currencyImages[e]=t}},rr=Dn(zF),qF={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},lf=Ze({networkImagePromises:{}}),XA={async fetchWalletImage(e){if(e)return await he._fetchWalletImage(e),this.getWalletImageById(e)},async fetchNetworkImage(e){if(!e)return;const t=this.getNetworkImageById(e);return t||(lf.networkImagePromises[e]||(lf.networkImagePromises[e]=he._fetchNetworkImage(e)),await lf.networkImagePromises[e],this.getNetworkImageById(e))},getWalletImageById(e){if(e)return rr.state.walletImages[e]},getWalletImage(e){if(e?.image_url)return e?.image_url;if(e?.image_id)return rr.state.walletImages[e.image_id]},getNetworkImage(e){if(e?.assets?.imageUrl)return e?.assets?.imageUrl;if(e?.assets?.imageId)return rr.state.networkImages[e.assets.imageId]},getNetworkImageById(e){if(e)return rr.state.networkImages[e]},getConnectorImage(e){if(e?.imageUrl)return e.imageUrl;if(e?.info?.icon)return e.info.icon;if(e?.imageId)return rr.state.connectorImages[e.imageId]},getChainImage(e){return rr.state.networkImages[qF[e]]}},As=Ze({message:"",variant:"info",open:!1}),WF={state:As,subscribeKey(e,t){return zt(As,e,t)},open(e,t){const{debug:n}=z.state,{code:r,displayMessage:s,debugMessage:i}=e;s&&n&&(As.message=s,As.variant=t,As.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},close(){As.open=!1,As.message="",As.variant="info"}},Ft=Dn(WF),VF=ce.getAnalyticsUrl(),KF=new bl({baseUrl:VF,clientId:null}),GF=["MODAL_CREATED"],Kr=Ze({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),He={state:Kr,subscribe(e){return $t(Kr,()=>e(Kr))},getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:n}=z.state;return{projectId:e,st:t,sv:n||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(e){try{const t=ae.state.address;if(GF.includes(e.data.event)||typeof window>"u")return;await KF.post({path:"/e",params:He.getSdkProperties(),body:{eventId:ce.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:e.timestamp,props:{...e.data,address:t}}}),Kr.reportedErrors.FORBIDDEN=!1}catch(t){t instanceof Error&&t.cause instanceof Response&&t.cause.status===q.HTTP_STATUS_CODES.FORBIDDEN&&!Kr.reportedErrors.FORBIDDEN&&(Ft.open({displayMessage:"Invalid App Configuration",debugMessage:`Origin ${Mo()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Kr.reportedErrors.FORBIDDEN=!0)}},sendEvent(e){Kr.timestamp=Date.now(),Kr.data=e,(z.state.features?.analytics||e.event==="INITIALIZE")&&He._sendAnalyticsEvent(Kr)}},YF=ce.getApiUrl(),en=new bl({baseUrl:YF,clientId:null}),ZF=40,sv=4,JF=20,ge=Ze({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),he={state:ge,subscribeKey(e,t){return zt(ge,e,t)},_getSdkProperties(){const{projectId:e,sdkType:t,sdkVersion:n}=z.state;return{projectId:e,st:t||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(e){return z.state.isUniversalProvider?e.filter(t=>!!(t.mobile_link||t.desktop_link||t.webapp_link)):e},async _fetchWalletImage(e){const t=`${en.baseUrl}/getWalletImage/${e}`,n=await en.getBlob({path:t,params:he._getSdkProperties()});rr.setWalletImage(e,URL.createObjectURL(n))},async _fetchNetworkImage(e){const t=`${en.baseUrl}/public/getAssetImage/${e}`,n=await en.getBlob({path:t,params:he._getSdkProperties()});rr.setNetworkImage(e,URL.createObjectURL(n))},async _fetchConnectorImage(e){const t=`${en.baseUrl}/public/getAssetImage/${e}`,n=await en.getBlob({path:t,params:he._getSdkProperties()});rr.setConnectorImage(e,URL.createObjectURL(n))},async _fetchCurrencyImage(e){const t=`${en.baseUrl}/public/getCurrencyImage/${e}`,n=await en.getBlob({path:t,params:he._getSdkProperties()});rr.setCurrencyImage(e,URL.createObjectURL(n))},async _fetchTokenImage(e){const t=`${en.baseUrl}/public/getTokenImage/${e}`,n=await en.getBlob({path:t,params:he._getSdkProperties()});rr.setTokenImage(e,URL.createObjectURL(n))},_filterWalletsByPlatform(e){return ce.isMobile()?e?.filter(n=>n.mobile_link||n.id===Sr.COINBASE.id?!0:T.state.activeChain==="solana"&&(n.id===Sr.SOLFLARE.id||n.id===Sr.PHANTOM.id)):e},async fetchProjectConfig(){return(await en.get({path:"/appkit/v1/config",params:he._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:e}=await en.get({path:"/projects/v1/origins",params:he._getSdkProperties()});return e}catch(e){if(e instanceof Error&&e.cause instanceof Response){const t=e.cause.status;if(t===q.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:e});if(t>=q.HTTP_STATUS_CODES.SERVER_ERROR&&t<600)throw new Error("SERVER_ERROR",{cause:e});return[]}return[]}},async fetchNetworkImages(){const t=T.getAllRequestedCaipNetworks()?.map(({assets:n})=>n?.imageId).filter(Boolean).filter(n=>!XA.getNetworkImageById(n));t&&await Promise.allSettled(t.map(n=>he._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:e}=X.state,t=e.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(t.map(n=>he._fetchConnectorImage(n)))},async fetchCurrencyImages(e=[]){await Promise.allSettled(e.map(t=>he._fetchCurrencyImage(t)))},async fetchTokenImages(e=[]){await Promise.allSettled(e.map(t=>he._fetchTokenImage(t)))},async fetchWallets(e){const t=e.exclude??[];he._getSdkProperties().sv.startsWith("html-core-")&&t.push(...Object.values(Sr).map(i=>i.id));const r=await en.get({path:"/getWallets",params:{...he._getSdkProperties(),...e,page:String(e.page),entries:String(e.entries),include:e.include?.join(","),exclude:t.join(",")}});return{data:he._filterWalletsByPlatform(r?.data)||[],count:r?.count}},async fetchFeaturedWallets(){const{featuredWalletIds:e}=z.state;if(e?.length){const t={...he._getSdkProperties(),page:1,entries:e?.length??sv,include:e},{data:n}=await he.fetchWallets(t),r=[...n].sort((i,o)=>e.indexOf(i.id)-e.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>he._fetchWalletImage(i))),ge.featured=r,ge.allFeatured=r}},async fetchRecommendedWallets(){try{ge.isFetchingRecommendedWallets=!0;const{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:n}=z.state,r=[...t??[],...n??[]].filter(Boolean),s=T.getRequestedCaipNetworkIds().join(","),i={page:1,entries:sv,include:e,exclude:r,chains:s},{data:o,count:a}=await he.fetchWallets(i),c=V.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>he._fetchWalletImage(d))),ge.recommended=o,ge.allRecommended=o,ge.count=a??0}catch{}finally{ge.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:e}){const{includeWalletIds:t,excludeWalletIds:n,featuredWalletIds:r}=z.state,s=T.getRequestedCaipNetworkIds().join(","),i=[...ge.recommended.map(({id:u})=>u),...n??[],...r??[]].filter(Boolean),o={page:e,entries:ZF,include:t,exclude:i,chains:s},{data:a,count:c}=await he.fetchWallets(o),l=a.slice(0,JF).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>he._fetchWalletImage(u))),ge.wallets=ce.uniqueBy([...ge.wallets,...he._filterOutExtensions(a)],"id").filter(u=>u.chains?.some(d=>s.includes(d))),ge.count=c>ge.count?c:ge.count,ge.page=e},async initializeExcludedWallets({ids:e}){const t={page:1,entries:e.length,include:e},{data:n}=await he.fetchWallets(t);n&&n.forEach(r=>{ge.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:e,badge:t}){const{includeWalletIds:n,excludeWalletIds:r}=z.state,s=T.getRequestedCaipNetworkIds().join(",");ge.search=[];const i={page:1,entries:100,search:e?.trim(),badge_type:t,include:n,exclude:r,chains:s},{data:o}=await he.fetchWallets(i);He.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:t??"",search:e??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>he._fetchWalletImage(c)),ce.wait(300)]),ge.search=he._filterOutExtensions(o)},initPromise(e,t){const n=ge.promises[e];return n||(ge.promises[e]=t())},prefetch({fetchConnectorImages:e=!0,fetchFeaturedWallets:t=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0}={}){const s=[e&&he.initPromise("connectorImages",he.fetchConnectorImages),t&&he.initPromise("featuredWallets",he.fetchFeaturedWallets),n&&he.initPromise("recommendedWallets",he.fetchRecommendedWallets),r&&he.initPromise("networkImages",he.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){z.state.features?.analytics&&he.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:e}=await en.get({path:"/getAnalyticsConfig",params:he._getSdkProperties()});z.setFeatures({analytics:e})}catch{z.setFeatures({analytics:!1})}},filterByNamespaces(e){if(!e?.length){ge.featured=ge.allFeatured,ge.recommended=ge.allRecommended;return}const t=T.getRequestedCaipNetworkIds().join(",");ge.featured=ge.allFeatured.filter(n=>n.chains?.some(r=>t.includes(r))),ge.recommended=ge.allRecommended.filter(n=>n.chains?.some(r=>t.includes(r))),ge.filteredWallets=ge.wallets.filter(n=>n.chains?.some(r=>t.includes(r)))},clearFilterByNamespaces(){ge.filteredWallets=[]},setFilterByNamespace(e){if(!e){ge.featured=ge.allFeatured,ge.recommended=ge.allRecommended;return}const t=T.getRequestedCaipNetworkIds().join(",");ge.featured=ge.allFeatured.filter(n=>n.chains?.some(r=>t.includes(r))),ge.recommended=ge.allRecommended.filter(n=>n.chains?.some(r=>t.includes(r))),ge.filteredWallets=ge.wallets.filter(n=>n.chains?.some(r=>t.includes(r)))}},Fe=Ze({view:"Connect",history:["Connect"],transactionStack:[]}),XF={state:Fe,subscribeKey(e,t){return zt(Fe,e,t)},pushTransactionStack(e){Fe.transactionStack.push(e)},popTransactionStack(e){const t=Fe.transactionStack.pop();if(!t)return;const{onSuccess:n,onError:r,onCancel:s}=t;switch(e){case"success":n?.();break;case"error":r?.(),pe.goBack();break;case"cancel":s?.(),pe.goBack();break}},push(e,t){e!==Fe.view&&(Fe.view=e,Fe.history.push(e),Fe.data=t)},reset(e,t){Fe.view=e,Fe.history=[e],Fe.data=t},replace(e,t){Fe.history.at(-1)===e||(Fe.view=e,Fe.history[Fe.history.length-1]=e,Fe.data=t)},goBack(){const e=T.state.activeCaipAddress,t=pe.state.view==="ConnectingFarcaster",n=!e&&t;if(Fe.history.length>1){Fe.history.pop();const[r]=Fe.history.slice(-1);r&&(e&&r==="Connect"?Fe.view="Account":Fe.view=r)}else Ae.close();Fe.data?.wallet&&(Fe.data.wallet=void 0),setTimeout(()=>{if(n){ae.setFarcasterUrl(void 0,T.state.activeChain);const r=X.getAuthConnector();r?.provider?.reload();const s=Oc(z.state);r?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(e){if(Fe.history.length>1){Fe.history=Fe.history.slice(0,e+1);const[t]=Fe.history.slice(-1);t&&(Fe.view=t)}},goBackOrCloseModal(){pe.state.history.length>1?pe.goBack():Ae.close()}},pe=Dn(XF),Gr=Ze({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Fp={state:Gr,subscribe(e){return $t(Gr,()=>e(Gr))},setThemeMode(e){Gr.themeMode=e;try{const t=X.getAuthConnector();if(t){const n=Fp.getSnapshot().themeVariables;t.provider.syncTheme({themeMode:e,themeVariables:n,w3mThemeVariables:Us(n,e)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(e){Gr.themeVariables={...Gr.themeVariables,...e};try{const t=X.getAuthConnector();if(t){const n=Fp.getSnapshot().themeVariables;t.provider.syncTheme({themeVariables:n,w3mThemeVariables:Us(Gr.themeVariables,Gr.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Oc(Gr)}},vn=Dn(Fp),QA=Object.fromEntries(KA.map(e=>[e,void 0])),QF=Object.fromEntries(KA.map(e=>[e,!0])),De=Ze({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:QA,filterByNamespaceMap:QF}),eH={state:De,subscribe(e){return $t(De,()=>{e(De)})},subscribeKey(e,t){return zt(De,e,t)},initialize(e){e.forEach(t=>{const n=V.getConnectedConnectorId(t);n&&X.setConnectorId(n,t)})},setActiveConnector(e){e&&(De.activeConnector=Hi(e))},setConnectors(e){e.filter(s=>!De.allConnectors.some(i=>i.id===s.id&&X.getConnectorName(i.name)===X.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&De.allConnectors.push(Hi(s))});const n=X.getEnabledNamespaces(),r=X.getEnabledConnectors(n);De.connectors=X.mergeMultiChainConnectors(r)},filterByNamespaces(e){Object.keys(De.filterByNamespaceMap).forEach(t=>{De.filterByNamespaceMap[t]=!1}),e.forEach(t=>{De.filterByNamespaceMap[t]=!0}),X.updateConnectorsForEnabledNamespaces()},filterByNamespace(e,t){De.filterByNamespaceMap[e]=t,X.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const e=X.getEnabledNamespaces(),t=X.getEnabledConnectors(e),n=X.areAllNamespacesEnabled();De.connectors=X.mergeMultiChainConnectors(t),n?he.clearFilterByNamespaces():he.filterByNamespaces(e)},getEnabledNamespaces(){return Object.entries(De.filterByNamespaceMap).filter(([e,t])=>t).map(([e])=>e)},getEnabledConnectors(e){return De.allConnectors.filter(t=>e.includes(t.chain))},areAllNamespacesEnabled(){return Object.values(De.filterByNamespaceMap).every(e=>e)},mergeMultiChainConnectors(e){const t=X.generateConnectorMapByName(e),n=[];return t.forEach(r=>{const s=r[0],i=s?.id===q.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&n.push(s)}),n},generateConnectorMapByName(e){const t=new Map;return e.forEach(n=>{const{name:r}=n,s=X.getConnectorName(r);if(!s)return;const i=t.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),t.set(s,i)}),t},getConnectorName(e){return e&&({"Trust Wallet":"Trust"}[e]||e)},getUniqueConnectorsByName(e){const t=[];return e.forEach(n=>{t.find(r=>r.chain===n.chain)||t.push(n)}),t},addConnector(e){if(e.id===q.CONNECTOR_ID.AUTH){const t=e,n=Oc(z.state),r=vn.getSnapshot().themeMode,s=vn.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),t?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Us(s,r)}),X.setConnectors([e])}else X.setConnectors([e])},getAuthConnector(e){const t=e||T.state.activeChain,n=De.connectors.find(r=>r.id===q.CONNECTOR_ID.AUTH);if(n)return n?.connectors?.length?n.connectors.find(s=>s.chain===t):n},getAnnouncedConnectorRdns(){return De.connectors.filter(e=>e.type==="ANNOUNCED").map(e=>e.info?.rdns)},getConnectorById(e){return De.allConnectors.find(t=>t.id===e)},getConnector({id:e,rdns:t,namespace:n}){const r=n||T.state.activeChain;return De.allConnectors.filter(i=>i.chain===r).find(i=>i.explorerId===e||i.info?.rdns===t)},syncIfAuthConnector(e){if(e.id!=="ID_AUTH")return;const t=e,n=Oc(z.state),r=vn.getSnapshot().themeMode,s=vn.getSnapshot().themeVariables;t?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),t.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Us(s,r)})},getConnectorsByNamespace(e){const t=De.allConnectors.filter(n=>n.chain===e);return X.mergeMultiChainConnectors(t)},canSwitchToSmartAccount(e){return T.checkIfSmartAccountEnabled()&&kr(e)===Oi.ACCOUNT_TYPES.EOA},selectWalletConnector(e){const t=X.getConnector({id:e.id,rdns:e.rdns});HF.handleMobileDeeplinkRedirect(t?.explorerId||e.id,T.state.activeChain),t?pe.push("ConnectingExternal",{connector:t,wallet:e}):pe.push("ConnectingWalletConnect",{wallet:e})},getConnectors(e){return e?X.getConnectorsByNamespace(e):X.mergeMultiChainConnectors(De.allConnectors)},setFilterByNamespace(e){De.filterByNamespace=e,De.connectors=X.getConnectors(e),he.setFilterByNamespace(e)},setConnectorId(e,t){e&&(De.activeConnectorIds={...De.activeConnectorIds,[t]:e},V.setConnectedConnectorId(t,e))},removeConnectorId(e){De.activeConnectorIds={...De.activeConnectorIds,[e]:void 0},V.deleteConnectedConnectorId(e)},getConnectorId(e){if(e)return De.activeConnectorIds[e]},isConnected(e){return e?!!De.activeConnectorIds[e]:Object.values(De.activeConnectorIds).some(t=>!!t)},resetConnectorIds(){De.activeConnectorIds={...QA}}},X=Dn(eH),tH=1e3,Ha={checkNamespaceConnectorId(e,t){return X.getConnectorId(e)===t},isSocialProvider(e){return Me.DEFAULT_REMOTE_FEATURES.socials.includes(e)},connectWalletConnect({walletConnect:e,connector:t,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(e&&X.setActiveConnector(t),s?.(ce.isMobile()&&e),r){const l=Ae.subscribeKey("open",u=>{u||(pe.state.view!==r&&pe.replace(r),l(),a(new Error("Modal closed")))})}const c=T.subscribeKey("activeCaipAddress",l=>{l&&(i?.(),n&&Ae.close(),c(),o(An.parseCaipAddress(l)))})})},connectExternal(e){return new Promise((t,n)=>{const r=T.subscribeKey("activeCaipAddress",s=>{s&&(Ae.close(),r(),t(An.parseCaipAddress(s)))});Q.connectExternal(e,e.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:e,namespace:t,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){let i=ae.state.socialWindow,o=ae.state.socialProvider,a=!1,c=null;const l=t||T.state.activeChain,u=T.subscribeKey("activeCaipAddress",d=>{d&&(n&&Ae.close(),u())});return new Promise((d,h)=>{async function p(g){if(g.data?.resultUri)if(g.origin===q.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",p,!1);try{const w=X.getAuthConnector(l);if(w&&!a){i&&(i.close(),ae.setSocialWindow(void 0,l),i=ae.state.socialWindow),a=!0;const b=g.data.resultUri;if(o&&He.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:o}}),o){V.setConnectedSocialProvider(o),await Q.connectExternal({id:w.id,type:w.type,socialUri:b},w.chain);const I=T.state.activeCaipAddress;if(!I){h(new Error("Failed to connect"));return}d(An.parseCaipAddress(I)),He.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:o,caipNetworkId:T.getActiveCaipNetwork()?.caipNetworkId}})}}}catch{o&&He.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}}),h(new Error("Failed to connect"))}}else o&&He.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:o}})}async function f(){if(e&&(ae.setSocialProvider(e,l),o=ae.state.socialProvider,He.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:o}})),o==="farcaster"){r?.();const g=Ae.subscribeKey("open",b=>{!b&&e==="farcaster"&&(h(new Error("Popup closed")),s?.(),g())}),w=X.getAuthConnector();if(w&&!ae.state.farcasterUrl)try{const{url:b}=await w.provider.getFarcasterUri();ae.setFarcasterUrl(b,l)}catch{h(new Error("Failed to connect to farcaster"))}}else{const g=X.getAuthConnector();c=ce.returnOpenHref(`${q.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(g&&o){const{uri:w}=await g.provider.getSocialRedirectUri({provider:o});if(c&&w){ae.setSocialWindow(c,l),i=ae.state.socialWindow,c.location.href=w;const b=setInterval(()=>{i?.closed&&!a&&(h(new Error("Popup closed")),clearInterval(b))},1e3);window.addEventListener("message",p,!1)}else c?.close(),h(new Error("Failed to initiate social connection"))}}catch{h(new Error("Failed to initiate social connection")),c?.close()}}}f()})},connectEmail({closeModalOnConnect:e=!0,redirectViewOnModalClose:t="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n?.(),t){const a=Ae.subscribeKey("open",c=>{c||(pe.state.view!==t&&pe.replace(t),a(),i(new Error("Modal closed")))})}const o=T.subscribeKey("activeCaipAddress",a=>{a&&(r?.(),e&&Ae.close(),o(),s(An.parseCaipAddress(a)))})})},async updateEmail(){const e=V.getConnectedConnectorId(T.state.activeChain),t=X.getAuthConnector();if(!t)throw new Error("No auth connector found");if(e!==q.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=t.provider.getEmail()??"";return await Ae.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=t.provider.getEmail()??"";a!==n&&(Ae.close(),clearInterval(i),o(),r({email:a}))},tH),o=Ae.subscribeKey("open",a=>{a||(pe.state.view!=="Connect"&&pe.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(e){return T.checkIfSmartAccountEnabled()&&kr(e)===Oi.ACCOUNT_TYPES.EOA}};function e2(){const e=T.state.activeCaipNetwork?.chainNamespace||"eip155",t=T.state.activeCaipNetwork?.id||1,n=Me.NATIVE_TOKEN_ADDRESS[e];return`${e}:${t}:${n}`}function kr(e){return T.getAccountData(e)?.preferredAccountType}function iv(e){return T.state.activeCaipNetwork}const nd={getConnectionStatus(e,t){const n=X.state.activeConnectorIds[t],r=Q.getConnections(t);return!!n&&e.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===e.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:e,connectorId:t,addresses:n}){return e.map(r=>{if((t?r.connectorId.toLowerCase()===t.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(e,t){const n=new Set(e);return t.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(e,t){return e.filter(n=>n.connectorId.toLowerCase()===t.toLowerCase())},getConnectionsData(e){const t=!!z.state.remoteFeatures?.multiWallet,n=X.state.activeConnectorIds[e],r=Q.getConnections(e),i=(Q.state.recentConnections.get(e)??[]).filter(a=>X.getConnectorById(a.connectorId)),o=nd.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return t?{connections:r,recentConnections:o}:{connections:r.filter(a=>a.connectorId.toLowerCase()===n?.toLowerCase()),recentConnections:[]}}},hi=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),ft=Ze({...hi}),nH={state:ft,subscribeKey(e,t){return zt(ft,e,t)},showLoading(e,t={}){this._showMessage({message:e,variant:"loading",...t})},showSuccess(e){this._showMessage({message:e,variant:"success"})},showSvg(e,t){this._showMessage({message:e,svg:t})},showError(e){const t=ce.parseError(e);this._showMessage({message:t,variant:"error"})},hide(){ft.message=hi.message,ft.variant=hi.variant,ft.svg=hi.svg,ft.open=hi.open,ft.autoClose=hi.autoClose},_showMessage({message:e,svg:t,variant:n="success",autoClose:r=hi.autoClose}){ft.open?(ft.open=!1,setTimeout(()=>{ft.message=e,ft.variant=n,ft.svg=t,ft.open=!0,ft.autoClose=r},150)):(ft.message=e,ft.variant=n,ft.svg=t,ft.open=!0,ft.autoClose=r)}},_r=nH,Qe=Ze({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),rH={state:Qe,subscribe(e){return $t(Qe,()=>e(Qe))},setLastNetworkInView(e){Qe.lastNetworkInView=e},async fetchTransactions(e){if(!e)throw new Error("Transactions can't be fetched without an accountAddress");Qe.loading=!0;try{const t=await fe.fetchTransactions({account:e,cursor:Qe.next,chainId:T.state.activeCaipNetwork?.caipNetworkId}),n=Nu.filterSpamTransactions(t.data),r=Nu.filterByConnectedChain(n),s=[...Qe.transactions,...r];Qe.loading=!1,Qe.transactions=s,Qe.transactionsByYear=Nu.groupTransactionsByYearAndMonth(Qe.transactionsByYear,r),Qe.empty=s.length===0,Qe.next=t.next?t.next:void 0}catch{const n=T.state.activeChain;He.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:e,projectId:z.state.projectId,cursor:Qe.next,isSmartAccount:kr(n)===Oi.ACCOUNT_TYPES.SMART_ACCOUNT}}),_r.showError("Failed to fetch transactions"),Qe.loading=!1,Qe.empty=!0,Qe.next=void 0}},groupTransactionsByYearAndMonth(e={},t=[]){const n=e;return t.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(e){return e.filter(t=>!t.transfers.every(r=>r.nft_info?.flags.is_spam===!0))},filterByConnectedChain(e){const t=T.state.activeCaipNetwork?.caipNetworkId;return e.filter(r=>r.metadata.chain===t)},clearCursor(){Qe.next=void 0},resetTransactions(){Qe.transactions=[],Qe.transactionsByYear={},Qe.lastNetworkInView=void 0,Qe.loading=!1,Qe.empty=!1,Qe.next=void 0}},Nu=Dn(rH,"API_ERROR"),$e=Ze({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let ci;const sH={state:$e,subscribe(e){return $t($e,()=>e($e))},subscribeKey(e,t){return zt($e,e,t)},_getClient(){return $e._client},setClient(e){$e._client=Hi(e)},initialize(e){const t=e.filter(n=>!!n.namespace).map(n=>n.namespace);Q.syncStorageConnections(t)},syncStorageConnections(e){const t=V.getConnections(),n=e??Array.from(T.state.chains.keys());for(const r of n){const s=t[r]??[],i=new Map($e.recentConnections);i.set(r,s),$e.recentConnections=i}},getConnections(e){return e?$e.connections.get(e)??[]:[]},hasAnyConnection(e){const t=Q.state.connections;return Array.from(t.values()).flatMap(n=>n).some(({connectorId:n})=>n===e)},async connectWalletConnect(){if(ce.isTelegram()||ce.isSafari()&&ce.isIos()){if(ci){await ci,ci=void 0;return}if(!ce.isPairingExpired($e?.wcPairingExpiry)){const e=$e.wcUri;$e.wcUri=e;return}ci=Q._getClient()?.connectWalletConnect?.().catch(()=>{}),Q.state.status="connecting",await ci,ci=void 0,$e.wcPairingExpiry=void 0,Q.state.status="connected"}else await Q._getClient()?.connectWalletConnect?.()},async connectExternal(e,t,n=!0){const r=await Q._getClient()?.connectExternal?.(e);return n&&T.setActiveNamespace(t),r},async reconnectExternal(e){await Q._getClient()?.reconnectExternal?.(e);const t=e.chain||T.state.activeChain;t&&X.setConnectorId(e.id,t)},async setPreferredAccountType(e,t){if(!t)return;Ae.setLoading(!0,T.state.activeChain);const n=X.getAuthConnector();n&&(ae.setPreferredAccountType(e,t),await n.provider.setPreferredAccount(e),V.setPreferredAccountTypes(Object.entries(T.state.chains).reduce((r,[s,i])=>{const o=s,a=kr(o);return a!==void 0&&(r[o]=a),r},{})),await Q.reconnectExternal(n),Ae.setLoading(!1,T.state.activeChain),He.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:e,network:T.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(e){return Q._getClient()?.signMessage(e)},parseUnits(e,t){return Q._getClient()?.parseUnits(e,t)},formatUnits(e,t){return Q._getClient()?.formatUnits(e,t)},async sendTransaction(e){return Q._getClient()?.sendTransaction(e)},async getCapabilities(e){return Q._getClient()?.getCapabilities(e)},async grantPermissions(e){return Q._getClient()?.grantPermissions(e)},async walletGetAssets(e){return Q._getClient()?.walletGetAssets(e)??{}},async estimateGas(e){return Q._getClient()?.estimateGas(e)},async writeContract(e){return Q._getClient()?.writeContract(e)},async getEnsAddress(e){return Q._getClient()?.getEnsAddress(e)},async getEnsAvatar(e){return Q._getClient()?.getEnsAvatar(e)},checkInstalled(e){return Q._getClient()?.checkInstalled?.(e)||!1},resetWcConnection(){$e.wcUri=void 0,$e.wcPairingExpiry=void 0,$e.wcLinking=void 0,$e.recentWallet=void 0,$e.status="disconnected",Nu.resetTransactions(),V.deleteWalletConnectDeepLink()},resetUri(){$e.wcUri=void 0,$e.wcPairingExpiry=void 0,ci=void 0},finalizeWcConnection(){const{wcLinking:e,recentWallet:t}=Q.state;e&&V.setWalletConnectDeepLink(e),t&&V.setAppKitRecent(t),He.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:e?"mobile":"qrcode",name:pe.state.data?.wallet?.name||"Unknown",caipNetworkId:T.getActiveCaipNetwork()?.caipNetworkId}})},setWcBasic(e){$e.wcBasic=e},setUri(e){$e.wcUri=e,$e.wcPairingExpiry=ce.getPairingExpiry()},setWcLinking(e){$e.wcLinking=e},setWcError(e){$e.wcError=e,$e.buffering=!1},setRecentWallet(e){$e.recentWallet=e},setBuffering(e){$e.buffering=e},setStatus(e){$e.status=e},setIsSwitchingConnection(e){$e.isSwitchingConnection=e},async disconnect({id:e,namespace:t,initialDisconnect:n}={}){try{await Q._getClient()?.disconnect({id:e,chainNamespace:t,initialDisconnect:n})}catch(r){throw new Qo("Failed to disconnect","INTERNAL_SDK_ERROR",r)}},setConnections(e,t){const n=new Map($e.connections);n.set(t,e),$e.connections=n},async handleAuthAccountSwitch({address:e,namespace:t}){const n=ae.state.user?.accounts?.find(s=>s.type==="smartAccount"),r=n&&n.address.toLowerCase()===e.toLowerCase()&&Ha.canSwitchToSmartAccount(t)?"smartAccount":"eoa";await Q.setPreferredAccountType(r,t)},async handleActiveConnection({connection:e,namespace:t,address:n}){const r=X.getConnectorById(e.connectorId),s=e.connectorId===q.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${e.connectorId}`);if(s)s&&n&&await Q.handleAuthAccountSwitch({address:n,namespace:t});else return(await Q.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:t},t))?.address;return n},async handleDisconnectedConnection({connection:e,namespace:t,address:n,closeModalOnConnect:r}){const s=X.getConnectorById(e.connectorId),i=e.auth?.name?.toLowerCase(),o=e.connectorId===q.CONNECTOR_ID.AUTH,a=e.connectorId===q.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${e.connectorId}`);let c;if(o)if(i&&Ha.isSocialProvider(i)){const{address:l}=await Ha.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Ae.open({view:"ConnectingFarcaster"})},onConnect(){pe.replace("ProfileWallets")}});c=l}else{const{address:l}=await Ha.connectEmail({closeModalOnConnect:r,onOpen(){Ae.open({view:"EmailLogin"})},onConnect(){pe.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await Ha.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(u){Ae.open({view:u?"AllWallets":"ConnectingWalletConnect"})},onConnect(){pe.replace("ProfileWallets")}});c=l}else{const l=await Q.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:t},t);l&&(c=l.address)}return o&&n&&await Q.handleAuthAccountSwitch({address:n,namespace:t}),c},async switchConnection({connection:e,address:t,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=ae.getCaipAddress(n);if(o){const{address:c}=An.parseCaipAddress(o);i=c}const a=nd.getConnectionStatus(e,n);switch(a){case"connected":case"active":{const c=await Q.handleActiveConnection({connection:e,namespace:n,address:t});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:n,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await Q.handleDisconnectedConnection({connection:e,namespace:n,address:t,closeModalOnConnect:r});c&&s?.({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},Q=Dn(sH),So=Ze({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Qr={state:So,subscribe(e){return $t(So,()=>e(So))},subscribeOpen(e){return zt(So,"open",e)},set(e){Object.assign(So,{...So,...e})}},iH={async getTokenList(){const e=T.state.activeCaipNetwork;return(await fe.fetchSwapTokens({chainId:e?.caipNetworkId}))?.tokens?.map(r=>({...r,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const e=T.state.activeCaipNetwork;if(!e)return null;try{switch(e.chainNamespace){case"solana":const t=(await Q?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:t,fast:t,instant:t};case"eip155":default:return await fe.fetchGasPrice({chainId:e.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:e,userAddress:t,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await fe.fetchSwapAllowance({tokenAddress:e,userAddress:t});if(s?.allowance&&n&&r){const i=Q.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(e){const t=await uw.getMyTokensWithBalance(e);return ae.setTokenBalance(t,T.state.activeChain),this.mapBalancesToSwapTokens(t)},mapBalancesToSwapTokens(e){return e?.map(t=>({...t,address:t?.address?t.address:e2(),decimals:parseInt(t.quantity.decimals,10),logoUri:t.iconUrl,eip2612:!1}))||[]}},Le=Ze({tokenBalances:[],loading:!1}),oH={state:Le,subscribe(e){return $t(Le,()=>e(Le))},subscribeKey(e,t){return zt(Le,e,t)},setToken(e){e&&(Le.token=Hi(e))},setTokenAmount(e){Le.sendTokenAmount=e},setReceiverAddress(e){Le.receiverAddress=e},setReceiverProfileImageUrl(e){Le.receiverProfileImageUrl=e},setReceiverProfileName(e){Le.receiverProfileName=e},setNetworkBalanceInUsd(e){Le.networkBalanceInUSD=e},setLoading(e){Le.loading=e},async sendToken(){try{switch(ke.setLoading(!0),T.state.activeCaipNetwork?.chainNamespace){case"eip155":await ke.sendEvmToken();return;case"solana":await ke.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{ke.setLoading(!1)}},async sendEvmToken(){const e=T.state.activeChain;if(!e)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const t=kr(e);if(!ke.state.sendTokenAmount||!ke.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!ke.state.token)throw new Error("A token is required");ke.state.token?.address?(He.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===Oi.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token.address,amount:ke.state.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),await ke.sendERC20Token({receiverAddress:ke.state.receiverAddress,tokenAddress:ke.state.token.address,sendTokenAmount:ke.state.sendTokenAmount,decimals:ke.state.token.quantity.decimals})):(He.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:t===Oi.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token.symbol||"",amount:ke.state.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),await ke.sendNativeToken({receiverAddress:ke.state.receiverAddress,sendTokenAmount:ke.state.sendTokenAmount,decimals:ke.state.token.quantity.decimals}))},async fetchTokenBalance(e){Le.loading=!0;const t=T.state.activeCaipNetwork?.caipNetworkId,n=T.state.activeCaipNetwork?.chainNamespace,r=T.state.activeCaipAddress,s=r?ce.getPlainAddress(r):void 0;if(Le.lastRetry&&!ce.isAllowedRetry(Le.lastRetry,30*Me.ONE_SEC_MS))return Le.loading=!1,[];try{if(s&&t&&n){const i=await uw.getMyTokensWithBalance();return Le.tokenBalances=i,Le.lastRetry=void 0,i}}catch(i){Le.lastRetry=Date.now(),e?.(i),_r.showError("Token Balance Unavailable")}finally{Le.loading=!1}return[]},fetchNetworkBalance(){if(Le.tokenBalances.length===0)return;const e=iH.mapBalancesToSwapTokens(Le.tokenBalances);if(!e)return;const t=e.find(n=>n.address===e2());t&&(Le.networkBalanceInUSD=t?mF.multiply(t.quantity.numeric,t.price).toString():"0")},async sendNativeToken(e){pe.pushTransactionStack({});const t=e.receiverAddress,n=ae.state.address,r=Q.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));await Q.sendTransaction({chainNamespace:q.CHAIN.EVM,to:t,address:n,data:"0x",value:r??BigInt(0)}),He.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:kr("eip155")===Oi.ACCOUNT_TYPES.SMART_ACCOUNT,token:ke.state.token?.symbol||"",amount:e.sendTokenAmount,network:T.state.activeCaipNetwork?.caipNetworkId||""}}),Q._getClient()?.updateBalance("eip155"),ke.resetSend()},async sendERC20Token(e){pe.pushTransactionStack({onSuccess(){pe.replace("Account")}});const t=Q.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));if(ae.state.address&&e.sendTokenAmount&&e.receiverAddress&&e.tokenAddress){const n=ce.getPlainAddress(e.tokenAddress);if(!n)throw new Error("SendController:sendERC20Token - tokenAddress is required");await Q.writeContract({fromAddress:ae.state.address,tokenAddress:n,args:[e.receiverAddress,t??BigInt(0)],method:"transfer",abi:EF.getERC20Abi(n),chainNamespace:q.CHAIN.EVM}),ke.resetSend()}},async sendSolanaToken(){if(!ke.state.sendTokenAmount||!ke.state.receiverAddress)throw new Error("An amount and receiver address are required");pe.pushTransactionStack({onSuccess(){pe.replace("Account")}}),await Q.sendTransaction({chainNamespace:"solana",to:ke.state.receiverAddress,value:ke.state.sendTokenAmount}),Q._getClient()?.updateBalance("solana"),ke.resetSend()},resetSend(){Le.token=void 0,Le.sendTokenAmount=void 0,Le.receiverAddress=void 0,Le.receiverProfileImageUrl=void 0,Le.receiverProfileName=void 0,Le.loading=!1,Le.tokenBalances=[]}},ke=Dn(oH),uf={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},lu={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},ee=Ze({chains:kF(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),aH={state:ee,subscribe(e){return $t(ee,()=>{e(ee)})},subscribeKey(e,t){return zt(ee,e,t)},subscribeChainProp(e,t,n){let r;return $t(ee.chains,()=>{const s=n||ee.activeChain;if(s){const i=ee.chains.get(s)?.[e];r!==i&&(r=i,t(i))}})},initialize(e,t,n){const{chainId:r,namespace:s}=V.getActiveNetworkProps(),i=t?.find(u=>u.id.toString()===r?.toString()),a=e.find(u=>u?.namespace===s)||e?.[0],c=e.map(u=>u.namespace).filter(u=>u!==void 0),l=z.state.enableEmbedded?new Set([...c]):new Set([...t?.map(u=>u.chainNamespace)??[]]);(e?.length===0||!a)&&(ee.noAdapters=!0),ee.noAdapters||(ee.activeChain=a?.namespace,ee.activeCaipNetwork=i,T.setChainNetworkData(a?.namespace,{caipNetwork:i}),ee.activeChain&&Qr.set({activeChain:a?.namespace})),l.forEach(u=>{const d=t?.filter(f=>f.chainNamespace===u),h=V.getPreferredAccountTypes()||{},p={...z.state.defaultAccountTypes,...h};T.state.chains.set(u,{namespace:u,networkState:Ze({...lu,caipNetwork:d?.[0]}),accountState:Ze({...uf,preferredAccountType:p[u]}),caipNetworks:d??[],...n}),T.setRequestedCaipNetworks(d??[],u)})},removeAdapter(e){if(ee.activeChain===e){const t=Array.from(ee.chains.entries()).find(([n])=>n!==e);if(t){const n=t[1]?.caipNetworks?.[0];n&&T.setActiveCaipNetwork(n)}}ee.chains.delete(e)},addAdapter(e,{networkControllerClient:t,connectionControllerClient:n},r){if(!e.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");ee.chains.set(e.namespace,{namespace:e.namespace,networkState:{...lu,caipNetwork:r[0]},accountState:uf,caipNetworks:r,connectionControllerClient:n,networkControllerClient:t}),T.setRequestedCaipNetworks(r?.filter(s=>s.chainNamespace===e.namespace)??[],e.namespace)},addNetwork(e){const t=ee.chains.get(e.chainNamespace);if(t){const n=[...t.caipNetworks||[]];t.caipNetworks?.find(r=>r.id===e.id)||n.push(e),ee.chains.set(e.chainNamespace,{...t,caipNetworks:n}),T.setRequestedCaipNetworks(n,e.chainNamespace),X.filterByNamespace(e.chainNamespace,!0)}},removeNetwork(e,t){const n=ee.chains.get(e);if(n){const r=ee.activeCaipNetwork?.id===t,s=[...n.caipNetworks?.filter(i=>i.id!==t)||[]];r&&n?.caipNetworks?.[0]&&T.setActiveCaipNetwork(n.caipNetworks[0]),ee.chains.set(e,{...n,caipNetworks:s}),T.setRequestedCaipNetworks(s||[],e),s.length===0&&X.filterByNamespace(e,!1)}},setAdapterNetworkState(e,t){const n=ee.chains.get(e);n&&(n.networkState={...n.networkState||lu,...t},ee.chains.set(e,n))},setChainAccountData(e,t,n=!0){if(!e)throw new Error("Chain is required to update chain account data");const r=ee.chains.get(e);if(r){const s={...r.accountState||uf,...t};ee.chains.set(e,{...r,accountState:s}),(ee.chains.size===1||ee.activeChain===e)&&(t.caipAddress&&(ee.activeCaipAddress=t.caipAddress),ae.replaceState(s))}},setChainNetworkData(e,t){if(!e)return;const n=ee.chains.get(e);if(n){const r={...n.networkState||lu,...t};ee.chains.set(e,{...n,networkState:r})}},setAccountProp(e,t,n,r=!0){T.setChainAccountData(n,{[e]:t},r)},setActiveNamespace(e){ee.activeChain=e;const t=e?ee.chains.get(e):void 0,n=t?.networkState?.caipNetwork;n?.id&&e&&(ee.activeCaipAddress=t?.accountState?.caipAddress,ee.activeCaipNetwork=n,T.setChainNetworkData(e,{caipNetwork:n}),V.setActiveCaipNetworkId(n?.caipNetworkId),Qr.set({activeChain:e,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(e){if(!e)return;ee.activeChain!==e.chainNamespace&&T.setIsSwitchingNamespace(!0);const t=ee.chains.get(e.chainNamespace);ee.activeChain=e.chainNamespace,ee.activeCaipNetwork=e,T.setChainNetworkData(e.chainNamespace,{caipNetwork:e}),t?.accountState?.address?ee.activeCaipAddress=`${e.chainNamespace}:${e.id}:${t?.accountState?.address}`:ee.activeCaipAddress=void 0,T.setAccountProp("caipAddress",ee.activeCaipAddress,e.chainNamespace),t&&ae.replaceState(t.accountState),ke.resetSend(),Qr.set({activeChain:ee.activeChain,selectedNetworkId:ee.activeCaipNetwork?.caipNetworkId}),V.setActiveCaipNetworkId(e.caipNetworkId),!T.checkIfSupportedNetwork(e.chainNamespace)&&z.state.enableNetworkSwitch&&!z.state.allowUnsupportedChain&&!Q.state.wcBasic&&T.showUnsupportedChainUI()},addCaipNetwork(e){if(!e)return;const t=ee.chains.get(e.chainNamespace);t&&t?.caipNetworks?.push(e)},async switchActiveNamespace(e){if(!e)return;const t=e!==T.state.activeChain,n=T.getNetworkData(e)?.caipNetwork,r=T.getCaipNetworkByNamespace(e,n?.id);t&&r&&await T.switchActiveNetwork(r)},async switchActiveNetwork(e){const t=T.state.activeChain;if(!t)throw new Error("ChainController:switchActiveNetwork - namespace is required");const r=!T.state.chains.get(t)?.caipNetworks?.some(i=>i.id===ee.activeCaipNetwork?.id),s=T.getNetworkControllerClient(e.chainNamespace);if(s){try{await s.switchCaipNetwork(e),r&&Ae.close()}catch{pe.goBack()}He.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:e.caipNetworkId}})}},getNetworkControllerClient(e){const t=e||ee.activeChain;if(!t)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=ee.chains.get(t);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(e){const t=e||ee.activeChain;if(!t)throw new Error("Chain is required to get connection controller client");const n=ee.chains.get(t);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(e,t){const n=ee.chains.get(t)?.networkState;if(n)return n[e]},getRequestedCaipNetworks(e){const t=ee.chains.get(e),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=t?.networkState||{};return ce.sortRequestedNetworks(n,r).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const e=[];return ee.chains.forEach(t=>{if(!t.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=T.getRequestedCaipNetworks(t.namespace);e.push(...n)}),e},setRequestedCaipNetworks(e,t){T.setAdapterNetworkState(t,{requestedCaipNetworks:e});const r=T.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));X.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const e=[];return ee.chains.forEach(t=>{if(!t.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=T.getApprovedCaipNetworkIds(t.namespace);e.push(...n)}),e},getActiveCaipNetwork(e){return e?ee.chains.get(e)?.networkState?.caipNetwork:ee.activeCaipNetwork},getActiveCaipAddress(){return ee.activeCaipAddress},getApprovedCaipNetworkIds(e){return ee.chains.get(e)?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(e){const n=await T.getNetworkControllerClient()?.getApprovedCaipNetworksData();T.setAdapterNetworkState(e,{approvedCaipNetworkIds:n?.approvedCaipNetworkIds,supportsAllNetworks:n?.supportsAllNetworks})},checkIfSupportedNetwork(e,t){const n=t||ee.activeCaipNetwork?.caipNetworkId,r=T.getRequestedCaipNetworks(e);return r.length?r?.some(s=>s.caipNetworkId===n):!0},checkIfSupportedChainId(e){return ee.activeChain?T.getRequestedCaipNetworks(ee.activeChain)?.some(n=>n.id===e):!0},setSmartAccountEnabledNetworks(e,t){T.setAdapterNetworkState(t,{smartAccountEnabledNetworks:e})},checkIfSmartAccountEnabled(){const e=VA.caipNetworkIdToNumber(ee.activeCaipNetwork?.caipNetworkId),t=ee.activeChain;return!t||!e?!1:!!T.getNetworkProp("smartAccountEnabledNetworks",t)?.includes(Number(e))},showUnsupportedChainUI(){Ae.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const e=ee.activeCaipNetwork;return!!(e?.chainNamespace&&Me.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(e.chainNamespace))},resetNetwork(e){T.setAdapterNetworkState(e,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(e){const t=e;if(!t)throw new Error("Chain is required to set account prop");const n=T.state.chains.get(t)?.accountState?.preferredAccountType,r=z.state.defaultAccountTypes[t];ee.activeCaipAddress=void 0,T.setChainAccountData(t,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),X.removeConnectorId(t)},setIsSwitchingNamespace(e){ee.isSwitchingNamespace=e},getFirstCaipNetworkSupportsAuthConnector(){const e=[];let t;if(ee.chains.forEach(n=>{q.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(r=>r===n.namespace)&&n.namespace&&e.push(n.namespace)}),e.length>0){const n=e[0];return t=n?ee.chains.get(n)?.caipNetworks?.[0]:void 0,t}},getAccountData(e){const t=e||ee.activeChain;if(t)return T.state.chains.get(t)?.accountState},getNetworkData(e){const t=e||ee.activeChain;if(t)return T.state.chains.get(t)?.networkState},getCaipNetworkByNamespace(e,t){if(!e)return;const n=T.state.chains.get(e),r=n?.caipNetworks?.find(s=>s.id===t);return r||n?.networkState?.caipNetwork||n?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const e=X.state.filterByNamespace;return(e?[ee.chains.get(e)]:Array.from(ee.chains.values())).flatMap(n=>n?.caipNetworks||[]).map(n=>n.caipNetworkId)},getCaipNetworks(e){return e?T.getRequestedCaipNetworks(e):T.getAllRequestedCaipNetworks()},setLastConnectedSIWECaipNetwork(e){ee.lastConnectedSIWECaipNetwork=e},getLastConnectedSIWECaipNetwork(){return ee.lastConnectedSIWECaipNetwork}},T=Dn(aH),cH={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},t2=ce.getBlockchainApiUrl(),tn=Ze({clientId:null,api:new bl({baseUrl:t2,clientId:null}),supportedChains:{http:[],ws:[]}}),fe={state:tn,async get(e){const{st:t,sv:n}=fe.getSdkProperties(),r=z.state.projectId,s={...e.params||{},st:t,sv:n,projectId:r};return tn.api.get({...e,params:s})},getSdkProperties(){const{sdkType:e,sdkVersion:t}=z.state;return{st:e||"unknown",sv:t||"unknown"}},async isNetworkSupported(e){if(!e)return!1;try{tn.supportedChains.http.length||await fe.getSupportedNetworks()}catch{return!1}return tn.supportedChains.http.includes(e)},async getSupportedNetworks(){try{const e=await fe.get({path:"v1/supported-chains"});return tn.supportedChains=e,e}catch{return tn.supportedChains}},async fetchIdentity({address:e,caipNetworkId:t}){if(!await fe.isNetworkSupported(t))return{avatar:"",name:""};const r=V.getIdentityFromCacheForAddress(e);if(r)return r;const s=await fe.get({path:`/v1/identity/${e}`,params:{sender:T.state.activeCaipAddress?ce.getPlainAddress(T.state.activeCaipAddress):void 0}});return V.updateIdentityCache({address:e,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:e,cursor:t,signal:n,cache:r,chainId:s}){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=V.getTransactionsCacheForAddress({address:e,chainId:s});if(o)return o;const a=await fe.get({path:`/v1/account/${e}/history`,params:{cursor:t,chainId:s},signal:n,cache:r});return V.updateTransactionsCache({address:e,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:e,userAddress:t,from:n,to:r,gasPrice:s}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:e,userAddress:t,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:e}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:"/v1/convert/tokens",params:{chainId:e}}):{tokens:[]}},async fetchTokenPrice({addresses:e}){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const n=V.getTokenPriceCacheForAddresses(e);if(n)return n;const r=await tn.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:e,projectId:z.state.projectId},headers:{"Content-Type":"application/json"}});return V.updateTokenPriceCache({addresses:e,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:e,userAddress:t}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:"/v1/convert/allowance",params:{tokenAddress:e,userAddress:t},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:e}){const{st:t,sv:n}=fe.getSdkProperties();if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return fe.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:e,st:t,sv:n}})},async generateSwapCalldata({amount:e,from:t,to:n,userAddress:r,disableEstimate:s}){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return tn.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:e,eip155:{slippage:Me.CONVERT_SLIPPAGE_TOLERANCE},projectId:z.state.projectId,from:t,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:e,to:t,userAddress:n}){const{st:r,sv:s}=fe.getSdkProperties();if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return fe.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:e,to:t,st:r,sv:s}})},async getBalance(e,t,n){const{st:r,sv:s}=fe.getSdkProperties();if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return _r.showError("Token Balance Unavailable"),{balances:[]};const o=`${t}:${e}`,a=V.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await fe.get({path:`/v1/account/${e}/balance`,params:{currency:"usd",chainId:t,forceUpdate:n,st:r,sv:s}});return V.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(e){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/profile/account/${e}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:e}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/profile/reverse/${e}`,params:{sender:ae.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(e){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/profile/suggestions/${e}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:e,address:t,message:n,signature:r}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?tn.api.post({path:"/v1/profile/account",body:{coin_type:e,address:t,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:e,partnerUserId:t,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?(await tn.api.post({path:"/v1/generators/onrampurl",params:{projectId:z.state.projectId},body:{destinationWallets:e,defaultNetwork:n,partnerUserId:t,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await fe.get({path:"/v1/onramp/options"})}catch{return cH}},async getOnrampQuote({purchaseCurrency:e,paymentCurrency:t,amount:n,network:r}){try{return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?await tn.api.post({path:"/v1/onramp/quote",params:{projectId:z.state.projectId},body:{purchaseCurrency:e,paymentCurrency:t,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:t.id},paymentSubtotal:{amount:n,currency:t.id},paymentTotal:{amount:n,currency:t.id},purchaseAmount:{amount:n,currency:t.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(e){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?fe.get({path:`/v1/sessions/${e}`}):[]},async revokeSmartSession(e,t,n){return await fe.isNetworkSupported(T.state.activeCaipNetwork?.caipNetworkId)?tn.api.post({path:`/v1/sessions/${e}/revoke`,params:{projectId:z.state.projectId},body:{pci:t,signature:n}}):{success:!1}},setClientId(e){tn.clientId=e,tn.api=new bl({baseUrl:t2,clientId:e})}};function lH(e,{strict:t=!0}={}){return!e||typeof e!="string"?!1:t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x")}function ov(e){return lH(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}const n2="2.41.2";let df={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:n})=>t?`${e??"https://viem.sh"}${t}${n?`#${n}`:""}`:void 0,version:`viem@${n2}`};class On extends Error{constructor(t,n={}){const r=n.cause instanceof On?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof On&&n.cause.docsPath||n.docsPath,i=df.getDocsUrl?.({...n,docsPath:s}),o=[t||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...df.version?[`Version: ${df.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=t,this.version=n2}walk(t){return r2(this,t)}}function r2(e,t){return t?.(e)?e:e&&typeof e=="object"&&"cause"in e&&e.cause!==void 0?r2(e.cause,t):t?null:e}class s2 extends On{constructor({size:t,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${t}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function aw(e,{dir:t,size:n=32}={}){return typeof e=="string"?uH(e,{dir:t,size:n}):dH(e,{dir:t,size:n})}function uH(e,{dir:t,size:n=32}={}){if(n===null)return e;const r=e.replace("0x","");if(r.length>n*2)throw new s2({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[t==="right"?"padEnd":"padStart"](n*2,"0")}`}function dH(e,{dir:t,size:n=32}={}){if(n===null)return e;if(e.length>n)throw new s2({size:e.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=t==="right";r[i?s:n-s-1]=e[i?s:e.length-s-1]}return r}class hH extends On{constructor({max:t,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${t?`(${n} to ${t})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class fH extends On{constructor({givenSize:t,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${t} bytes.`,{name:"SizeOverflowError"})}}function i2(e,{size:t}){if(ov(e)>t)throw new fH({givenSize:ov(e),maxSize:t})}const pH=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function av(e,t={}){return typeof e=="number"||typeof e=="bigint"?wH(e,t):typeof e=="string"?a2(e,t):typeof e=="boolean"?gH(e,t):o2(e,t)}function gH(e,t={}){const n=`0x${Number(e)}`;return typeof t.size=="number"?(i2(n,{size:t.size}),aw(n,{size:t.size})):n}function o2(e,t={}){let n="";for(let s=0;s<e.length;s++)n+=pH[e[s]];const r=`0x${n}`;return typeof t.size=="number"?(i2(r,{size:t.size}),aw(r,{dir:"right",size:t.size})):r}function wH(e,t={}){const{signed:n,size:r}=t,s=BigInt(e);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof e=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof e=="bigint"?"n":"";throw new hH({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${e}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?aw(a,{size:r}):a}const mH=new TextEncoder;function a2(e,t={}){const n=mH.encode(e);return o2(n,t)}class yH extends Map{constructor(t){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=t}get(t){const n=super.get(t);return super.has(t)&&n!==void 0&&(this.delete(t),super.set(t,n)),n}set(t,n){if(super.set(t,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const Di=(e,t,n)=>JSON.stringify(e,(r,s)=>typeof s=="bigint"?s.toString():s,n);function bH(e,t){let n=e.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(t,"0");let[s,i]=[n.slice(0,n.length-t),n.slice(n.length-t)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}const cw=e=>e;class cc extends On{constructor({body:t,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${cw(o)}`,t&&`Request body: ${Di(t)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=t,this.headers=s,this.status=i,this.url=o}}class c2 extends On{constructor({body:t,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${cw(r)}`,`Request body: ${Di(t)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data,this.url=r}}class cv extends On{constructor({body:t,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${cw(n)}`,`Request body: ${Di(t)}`],name:"TimeoutError"}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.url=n}}const vH=-1;class pn extends On{constructor(t,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:t,docsPath:r,metaMessages:s||t?.metaMessages,name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||t.name,this.code=t instanceof c2?t.code:n??vH}}class $n extends pn{constructor(t,n){super(t,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class Dc extends pn{constructor(t){super(t,{code:Dc.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Dc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class $c extends pn{constructor(t){super(t,{code:$c.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty($c,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Pc extends pn{constructor(t,{method:n}={}){super(t,{code:Pc.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(Pc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class kc extends pn{constructor(t){super(t,{code:kc.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(kc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class ea extends pn{constructor(t){super(t,{code:ea.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(ea,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Uc extends pn{constructor(t){super(t,{code:Uc.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Uc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Rc extends pn{constructor(t){super(t,{code:Rc.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Rc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Bc extends pn{constructor(t){super(t,{code:Bc.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Bc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class ta extends pn{constructor(t){super(t,{code:ta.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(ta,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class xi extends pn{constructor(t,{method:n}={}){super(t,{code:xi.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(xi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class na extends pn{constructor(t){super(t,{code:na.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(na,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Mc extends pn{constructor(t){super(t,{code:Mc.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Mc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class $i extends $n{constructor(t){super(t,{code:$i.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty($i,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class Lc extends $n{constructor(t){super(t,{code:Lc.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(Lc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class jc extends $n{constructor(t,{method:n}={}){super(t,{code:jc.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(jc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Fc extends $n{constructor(t){super(t,{code:Fc.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Fc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Hc extends $n{constructor(t){super(t,{code:Hc.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Hc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class zc extends $n{constructor(t){super(t,{code:zc.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(zc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class qc extends $n{constructor(t){super(t,{code:qc.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(qc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Wc extends $n{constructor(t){super(t,{code:Wc.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Wc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Vc extends $n{constructor(t){super(t,{code:Vc.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(Vc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Kc extends $n{constructor(t){super(t,{code:Kc.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(Kc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class Gc extends $n{constructor(t){super(t,{code:Gc.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(Gc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Yc extends $n{constructor(t){super(t,{code:Yc.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(Yc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class Zc extends $n{constructor(t){super(t,{code:Zc.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(Zc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class EH extends pn{constructor(t){super(t,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class lw extends On{constructor({cause:t,message:n}={}){const r=n?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"})}}Object.defineProperty(lw,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(lw,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});function CH(){let e=()=>{},t=()=>{};return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}const hf=new Map;function AH({fn:e,id:t,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:h})=>h);d.length!==0&&e(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let p=0;p<u.length;p++){const{resolve:f}=u[p];f?.([h[p],h])}}).catch(h=>{for(let p=0;p<u.length;p++){const{reject:f}=u[p];f?.(h)}})},o=()=>hf.delete(t),a=()=>c().map(({args:u})=>u),c=()=>hf.get(t)||[],l=u=>hf.set(t,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:h,reject:p}=CH();return n?.([...a(),u])&&i(),c().length>0?(l({args:u,resolve:h,reject:p}),d):(l({args:u,resolve:h,reject:p}),setTimeout(i,r),d)}}}async function l2(e){return new Promise(t=>setTimeout(t,e))}function IH(e,{delay:t=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof t=="function"?t({count:a,error:l}):t;u&&await l2(u),o({count:a+1})};try{const l=await e();s(l)}catch(l){if(a<n&&await r({count:a,error:l}))return c({error:l});i(l)}};o()})}const Hp=256;let uu=Hp,du;function SH(e=11){if(!du||uu+e>Hp*2){du="",uu=0;for(let t=0;t<Hp;t++)du+=(256+Math.random()*256|0).toString(16).substring(1)}return du.substring(uu,uu+++e)}const hu=new yH(8192);function xH(e,{enabled:t=!0,id:n}){if(!t||!n)return e();if(hu.get(n))return hu.get(n);const r=e().finally(()=>hu.delete(n));return hu.set(n,r),r}function NH(e,t={}){return async(n,r={})=>{const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...t,...r},{method:l}=n;if(i?.exclude?.includes(l))throw new xi(new Error("method not supported"),{method:l});if(i?.include&&!i.include.includes(l))throw new xi(new Error("method not supported"),{method:l});const u=s?a2(`${c}.${Di(n)}`):void 0;return xH(()=>IH(async()=>{try{return await e(n)}catch(d){const h=d;switch(h.code){case Dc.code:throw new Dc(h);case $c.code:throw new $c(h);case Pc.code:throw new Pc(h,{method:n.method});case kc.code:throw new kc(h);case ea.code:throw new ea(h);case Uc.code:throw new Uc(h);case Rc.code:throw new Rc(h);case Bc.code:throw new Bc(h);case ta.code:throw new ta(h);case xi.code:throw new xi(h,{method:n.method});case na.code:throw new na(h);case Mc.code:throw new Mc(h);case $i.code:throw new $i(h);case Lc.code:throw new Lc(h);case jc.code:throw new jc(h);case Fc.code:throw new Fc(h);case Hc.code:throw new Hc(h);case zc.code:throw new zc(h);case qc.code:throw new qc(h);case Wc.code:throw new Wc(h);case Vc.code:throw new Vc(h);case Kc.code:throw new Kc(h);case Gc.code:throw new Gc(h);case Yc.code:throw new Yc(h);case Zc.code:throw new Zc(h);case 5e3:throw new $i(h);default:throw d instanceof On?d:new EH(h)}}},{delay:({count:d,error:h})=>{if(h&&h instanceof cc){const p=h?.headers?.get("Retry-After");if(p?.match(/\d/))return Number.parseInt(p,10)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>_H(d)}),{enabled:s,id:u})}}function _H(e){return"code"in e&&typeof e.code=="number"?e.code===-1||e.code===na.code||e.code===ea.code:e instanceof cc&&e.status?e.status===403||e.status===408||e.status===413||e.status===429||e.status===500||e.status===502||e.status===503||e.status===504:!0}function TH(e,{errorInstance:t=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r&&a.abort()},n)),s(await e({signal:a?.signal||null}))}catch(a){a?.name==="AbortError"&&i(t),i(a)}finally{clearTimeout(o)}})()})}function OH(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const lv=OH();function DH(e,t={}){return{async request(n){const{body:r,fetchFn:s=t.fetchFn??fetch,onRequest:i=t.onRequest,onResponse:o=t.onResponse,timeout:a=t.timeout??1e4}=n,c={...t.fetchOptions??{},...n.fetchOptions??{}},{headers:l,method:u,signal:d}=c;try{const h=await TH(async({signal:f})=>{const g={...c,body:Array.isArray(r)?Di(r.map(y=>({jsonrpc:"2.0",id:y.id??lv.take(),...y}))):Di({jsonrpc:"2.0",id:r.id??lv.take(),...r}),headers:{"Content-Type":"application/json",...l},method:u||"POST",signal:d||(a>0?f:null)},w=new Request(e,g),b=await i?.(w,g)??{...g,url:e};return await s(b.url??e,b)},{errorInstance:new cv({body:r,url:e}),timeout:a,signal:!0});o&&await o(h);let p;if(h.headers.get("Content-Type")?.startsWith("application/json"))p=await h.json();else{p=await h.text();try{p=JSON.parse(p||"{}")}catch(f){if(h.ok)throw f;p={error:p}}}if(!h.ok)throw new cc({body:r,details:Di(p.error)||h.statusText,headers:h.headers,status:h.status,url:e});return p}catch(h){throw h instanceof cc||h instanceof cv?h:new cc({body:r,cause:h,url:e})}}}}function u2({key:e,methods:t,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=SH();return{config:{key:e,methods:t,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:NH(r,{methods:t,retryCount:s,retryDelay:i,uid:l}),value:c}}function uv(e,t={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=$H,retryCount:o,retryDelay:a}=t;return(({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let h=e,p=()=>{};const f=u2({key:n,name:r,async request({method:g,params:w}){let b;const I=async(y=0)=>{const m=h[y]({...d,chain:c,retryCount:0,timeout:u});try{const v=await m.request({method:g,params:w});return p({method:g,params:w,response:v,transport:m,status:"success"}),v}catch(v){if(p({error:v,method:g,params:w,transport:m,status:"error"}),i(v)||y===h.length-1||(b??=h.slice(y+1).some(C=>{const{include:O,exclude:D}=C({chain:c}).config.methods||{};return O?O.includes(g):D?!D.includes(g):!0}),!b))throw v;return I(y+1)}};return I()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>p=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};PH({chain:c,interval:g.interval??l,onTransports:w=>h=w,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return f})}function $H(e){return!!("code"in e&&typeof e.code=="number"&&(e.code===ta.code||e.code===$i.code||lw.nodeMessage.test(e.message)||e.code===5e3))}function PH({chain:e,interval:t=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const w=g({chain:e,retryCount:0,timeout:i}),b=Date.now();let I,y;try{await(r?r({transport:w}):w.request({method:"net_listening"})),y=1}catch{y=0}finally{I=Date.now()}return{latency:I-b,success:y}}));u.push(h),u.length>s&&u.shift();const p=Math.max(...u.map(g=>Math.max(...g.map(({latency:w})=>w)))),f=o.map((g,w)=>{const b=u.map(C=>C[w].latency),y=1-b.reduce((C,O)=>C+O,0)/b.length/p,m=u.map(C=>C[w].success),v=m.reduce((C,O)=>C+O,0)/m.length;return v===0?[0,w]:[l*y+c*v,w]}).sort((g,w)=>w[0]-g[0]);n(f.map(([,g])=>o[g])),await l2(t),d()};d()}class kH extends On{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function fu(e,t={}){const{batch:n,fetchFn:r,fetchOptions:s,key:i="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:c,onFetchResponse:l,retryDelay:u,raw:d}=t;return({chain:h,retryCount:p,timeout:f})=>{const{batchSize:g=1e3,wait:w=0}=typeof n=="object"?n:{},b=t.retryCount??p,I=f??t.timeout??1e4,y=e||h?.rpcUrls.default.http[0];if(!y)throw new kH;const m=DH(y,{fetchFn:r,fetchOptions:s,onRequest:c,onResponse:l,timeout:I});return u2({key:i,methods:o,name:a,async request({method:v,params:C}){const O={method:v,params:C},{schedule:D}=AH({id:y,wait:w,shouldSplitBatch($){return $.length>g},fn:$=>m.request({body:$}),sort:($,B)=>$.id-B.id}),S=async $=>n?D($):[await m.request({body:$})],[{error:E,result:N}]=await S(O);if(d)return{error:E,result:N};if(E)throw new c2({body:O,error:E,url:y});return N},retryCount:b,retryDelay:u,timeout:I,type:"http"},{fetchOptions:s,url:y})}}const ff={createBalance(e,t){const n={name:e.metadata.name||"",symbol:e.metadata.symbol||"",decimals:e.metadata.decimals||0,value:e.metadata.value||0,price:e.metadata.price||0,iconUrl:e.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:t,address:e.address==="native"?void 0:this.convertAddressToCAIP10Address(e.address,t),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:e.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:e,decimals:t}){return bH(BigInt(e),t)},convertAddressToCAIP10Address(e,t){return`${t}:${e}`},createCAIP2ChainId(e,t){return`${t}:${parseInt(e,16)}`},getChainIdHexFromCAIP2ChainId(e){const t=e.split(":");if(t.length<2||!t[1])return"0x0";const n=t[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(e){return typeof e!="object"||e===null?!1:Object.values(e).every(t=>Array.isArray(t)&&t.every(n=>this.isValidAsset(n)))},isValidAsset(e){return typeof e=="object"&&e!==null&&typeof e.address=="string"&&typeof e.balance=="string"&&(e.type==="ERC20"||e.type==="NATIVE")&&typeof e.metadata=="object"&&e.metadata!==null&&typeof e.metadata.name=="string"&&typeof e.metadata.symbol=="string"&&typeof e.metadata.decimals=="number"&&typeof e.metadata.price=="number"&&typeof e.metadata.iconUrl=="string"}},uw={async getMyTokensWithBalance(e){const t=ae.state.address,n=T.state.activeCaipNetwork,r=X.getConnectorId("eip155")===q.CONNECTOR_ID.AUTH;if(!t||!n)return[];const s=`${n.caipNetworkId}:${t}`,i=V.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===q.CHAIN.EVM&&r){const a=await this.getEIP155Balances(t,n);if(a)return this.filterLowQualityTokens(a)}const o=await fe.getBalance(t,n.caipNetworkId,e);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(e,t){try{const n=ff.getChainIdHexFromCAIP2ChainId(t.caipNetworkId);if(!(await Q.getCapabilities(e))?.[n]?.assetDiscovery?.supported)return null;const s=await Q.walletGetAssets({account:e,chainFilter:[n]});if(!ff.isWalletGetAssetsResponse(s))return null;const o=(s[n]||[]).map(a=>ff.createBalance(a,t.caipNetworkId));return V.updateBalanceCache({caipAddress:`${t.caipNetworkId}:${e}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(e){return e.filter(t=>t.quantity.decimals!=="0")}},vr=Ze({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),UH={state:vr,replaceState(e){e&&Object.assign(vr,Hi(e))},subscribe(e){return T.subscribeChainProp("accountState",t=>{if(t)return e(t)})},subscribeKey(e,t,n){let r;return T.subscribeChainProp("accountState",s=>{if(s){const i=s[e];r!==i&&(r=i,t(i))}},n)},setStatus(e,t){T.setAccountProp("status",e,t)},getCaipAddress(e){if(e)return T.state.chains.get(e)?.accountState?.caipAddress},setCaipAddress(e,t){const n=e?ce.getPlainAddress(e):void 0;t===T.state.activeChain&&(T.state.activeCaipAddress=e),T.setAccountProp("caipAddress",e,t),T.setAccountProp("address",n,t)},setBalance(e,t,n){T.setAccountProp("balance",e,n),T.setAccountProp("balanceSymbol",t,n)},setProfileName(e,t){T.setAccountProp("profileName",e,t)},setProfileImage(e,t){T.setAccountProp("profileImage",e,t)},setUser(e,t){T.setAccountProp("user",e,t)},setAddressExplorerUrl(e,t){T.setAccountProp("addressExplorerUrl",e,t)},setSmartAccountDeployed(e,t){T.setAccountProp("smartAccountDeployed",e,t)},setCurrentTab(e){T.setAccountProp("currentTab",e,T.state.activeChain)},setTokenBalance(e,t){e&&T.setAccountProp("tokenBalance",e,t)},setShouldUpdateToAddress(e,t){T.setAccountProp("shouldUpdateToAddress",e,t)},addAddressLabel(e,t,n){if(!n)return;const r=T.state.chains.get(n)?.accountState?.addressLabels||new Map;r.set(e,t),T.setAccountProp("addressLabels",r,n)},removeAddressLabel(e,t){if(!t)return;const n=T.state.chains.get(t)?.accountState?.addressLabels||new Map;n.delete(e),T.setAccountProp("addressLabels",n,t)},setConnectedWalletInfo(e,t){T.setAccountProp("connectedWalletInfo",e,t,!1)},setPreferredAccountType(e,t){T.setAccountProp("preferredAccountType",e,t)},setSocialProvider(e,t){e&&T.setAccountProp("socialProvider",e,t)},setSocialWindow(e,t){T.setAccountProp("socialWindow",e?Hi(e):void 0,t)},setFarcasterUrl(e,t){T.setAccountProp("farcasterUrl",e,t)},async fetchTokenBalance(e){vr.balanceLoading=!0;const t=T.state.activeCaipNetwork?.caipNetworkId,n=T.state.activeCaipNetwork?.chainNamespace,r=T.state.activeCaipAddress,s=r?ce.getPlainAddress(r):void 0;if(vr.lastRetry&&!ce.isAllowedRetry(vr.lastRetry,30*Me.ONE_SEC_MS))return vr.balanceLoading=!1,[];try{if(s&&t&&n){const i=await uw.getMyTokensWithBalance();return ae.setTokenBalance(i,n),vr.lastRetry=void 0,vr.balanceLoading=!1,i}}catch(i){vr.lastRetry=Date.now(),e?.(i),_r.showError("Token Balance Unavailable")}finally{vr.balanceLoading=!1}return[]},resetAccount(e){T.resetAccount(e)}},ae=Dn(UH),RH={onSwitchNetwork({network:e,ignoreSwitchConfirmation:t=!1}){const n=T.state.activeCaipNetwork,r=pe.state.data;if(e.id===n?.id)return;const i=ae.getCaipAddress(T.state.activeChain),o=e.chainNamespace!==T.state.activeChain,a=ae.getCaipAddress(e.chainNamespace),l=X.getConnectorId(T.state.activeChain)===q.CONNECTOR_ID.AUTH,u=q.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(d=>d===e.chainNamespace);t||l&&u?pe.push("SwitchNetwork",{...r,network:e}):i&&o&&!a?pe.push("SwitchActiveChain",{switchToChain:e.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:e}):pe.push("SwitchNetwork",{...r,network:e})}},nn=Ze({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),BH={state:nn,subscribe(e){return $t(nn,()=>e(nn))},subscribeKey(e,t){return zt(nn,e,t)},async open(e){const t=e?.namespace,n=T.state.activeChain,r=t&&t!==n,s=T.getAccountData(e?.namespace)?.caipAddress;if(Q.state.wcBasic?he.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await he.prefetch(),X.setFilterByNamespace(e?.namespace),Ae.setLoading(!0,t),t&&r){const i=T.getNetworkData(t)?.caipNetwork||T.getRequestedCaipNetworks(t)[0];i&&RH.onSwitchNetwork({network:i,ignoreSwitchConfirmation:!0})}else{const i=T.state.noAdapters;z.state.manualWCControl||i&&!s?ce.isMobile()?pe.reset("AllWallets"):pe.reset("ConnectingWalletConnectBasic"):e?.view?pe.reset(e.view,e.data):s?pe.reset("Account"):pe.reset("Connect")}nn.open=!0,Qr.set({open:!0}),He.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const e=z.state.enableEmbedded,t=!!T.state.activeCaipAddress;nn.open&&He.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),nn.open=!1,pe.reset("Connect"),Ae.clearLoading(),e?t?pe.replace("Account"):pe.push("Connect"):Qr.set({open:!1}),Q.resetUri()},setLoading(e,t){t&&nn.loadingNamespaceMap.set(t,e),nn.loading=e,Qr.set({loading:e})},clearLoading(){nn.loadingNamespaceMap.clear(),nn.loading=!1,Qr.set({loading:!1})},shake(){nn.shake||(nn.shake=!0,setTimeout(()=>{nn.shake=!1},500))}},Ae=Dn(BH),lc={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},zp={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},MH={providers:JA,selectedProvider:null,error:null,purchaseCurrency:lc,paymentCurrency:zp,purchaseCurrencies:[lc],paymentCurrencies:[],quotesLoading:!1},Se=Ze(MH),LH={state:Se,subscribe(e){return $t(Se,()=>e(Se))},subscribeKey(e,t){return zt(Se,e,t)},setSelectedProvider(e){if(e&&e.name==="meld"){const t=T.state.activeChain,n=t===q.CHAIN.SOLANA?"SOL":"USDC",r=t?T.state.chains.get(t)?.accountState?.address??"":"",s=new URL(e.url);s.searchParams.append("publicKey",UF),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",z.state.projectId),Se.selectedProvider={...e,url:s.toString()}}else Se.selectedProvider=e},setOnrampProviders(e){if(Array.isArray(e)&&e.every(t=>typeof t=="string")){const t=e,n=JA.filter(r=>t.includes(r.name));Se.providers=n}else Se.providers=[]},setPurchaseCurrency(e){Se.purchaseCurrency=e},setPaymentCurrency(e){Se.paymentCurrency=e},setPurchaseAmount(e){qp.state.purchaseAmount=e},setPaymentAmount(e){qp.state.paymentAmount=e},async getAvailableCurrencies(){const e=await fe.getOnrampOptions();Se.purchaseCurrencies=e.purchaseCurrencies,Se.paymentCurrencies=e.paymentCurrencies,Se.paymentCurrency=e.paymentCurrencies[0]||zp,Se.purchaseCurrency=e.purchaseCurrencies[0]||lc,await he.fetchCurrencyImages(e.paymentCurrencies.map(t=>t.id)),await he.fetchTokenImages(e.purchaseCurrencies.map(t=>t.symbol))},async getQuote(){Se.quotesLoading=!0;try{const e=await fe.getOnrampQuote({purchaseCurrency:Se.purchaseCurrency,paymentCurrency:Se.paymentCurrency,amount:Se.paymentAmount?.toString()||"0",network:Se.purchaseCurrency?.symbol});return Se.quotesLoading=!1,Se.purchaseAmount=Number(e?.purchaseAmount.amount),e}catch(e){return Se.error=e.message,Se.quotesLoading=!1,null}finally{Se.quotesLoading=!1}},resetState(){Se.selectedProvider=null,Se.error=null,Se.purchaseCurrency=lc,Se.paymentCurrency=zp,Se.purchaseCurrencies=[lc],Se.paymentCurrencies=[],Se.paymentAmount=void 0,Se.purchaseAmount=void 0,Se.quotesLoading=!1}},qp=Dn(LH),dv=2147483648,jH={convertEVMChainIdToCoinType(e){if(e>=dv)throw new Error("Invalid chainId");return(dv|e)>>>0}},Rn=Ze({suggestions:[],loading:!1}),FH={state:Rn,subscribe(e){return $t(Rn,()=>e(Rn))},subscribeKey(e,t){return zt(Rn,e,t)},async resolveName(e){try{return await fe.lookupEnsName(e)}catch(t){const n=t;throw new Error(n?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await fe.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{Rn.loading=!0,Rn.suggestions=[];const t=await fe.getEnsNameSuggestions(e);return Rn.suggestions=t.suggestions.map(n=>({...n,name:n.name}))||[],Rn.suggestions}catch(t){const n=uc.parseEnsApiError(t,"Error fetching name suggestions");throw new Error(n)}finally{Rn.loading=!1}},async getNamesForAddress(e){try{if(!T.state.activeCaipNetwork)return[];const n=V.getEnsFromCacheForAddress(e);if(n)return n;const r=await fe.reverseLookupEnsName({address:e});return V.updateEnsCache({address:e,ens:r,timestamp:Date.now()}),r}catch(t){const n=uc.parseEnsApiError(t,"Error fetching names for address");throw new Error(n)}},async registerName(e){const t=T.state.activeCaipNetwork,n=ae.state.address,r=X.getAuthConnector();if(!t)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");Rn.loading=!0;try{const s=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});pe.pushTransactionStack({onCancel(){pe.replace("RegisterAccountName")}});const i=await Q.signMessage(s);Rn.loading=!1;const o=t.id;if(!o)throw new Error("Network not found");const a=jH.convertEVMChainIdToCoinType(Number(o));await fe.registerEnsName({coinType:a,address:n,signature:i,message:s}),ae.setProfileName(e,t.chainNamespace),pe.replace("RegisterAccountNameSuccess")}catch(s){const i=uc.parseEnsApiError(s,`Error registering name ${e}`);throw pe.replace("RegisterAccountName"),new Error(i)}finally{Rn.loading=!1}},validateName(e){return/^[a-zA-Z0-9-]{4,}$/u.test(e)},parseEnsApiError(e,t){return e?.reasons?.[0]?.description||t}},uc=Dn(FH);let li=null;const xr={getSIWX(){return z.state.siwx},async initializeIfEnabled(e=T.getActiveCaipAddress()){const t=z.state.siwx;if(!(t&&e))return;const[n,r,s]=e.split(":");if(T.checkIfSupportedNetwork(n,`${n}:${r}`))try{if(z.state.remoteFeatures?.emailCapture){const o=T.getAccountData(n)?.user;await Ae.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(li&&await li,(await t.getSessions(`${n}:${r}`,s)).length)return;await Ae.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),He.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await Q._getClient()?.disconnect().catch(console.error),pe.reset("Connect"),_r.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const e=z.state.siwx,t=ce.getPlainAddress(T.getActiveCaipAddress()),n=iv(),r=Q._getClient();if(!e)throw new Error("SIWX is not enabled");if(!t)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await e.createMessage({chainId:n.caipNetworkId,accountAddress:t}),i=s.toString();X.getConnectorId(n.chainNamespace)===q.CONNECTOR_ID.AUTH&&pe.pushTransactionStack({});const a=await r.signMessage(i);await e.addSession({data:s,message:i,signature:a}),T.setLastConnectedSIWECaipNetwork(n),Ae.close(),He.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!Ae.state.open||pe.state.view==="ApproveTransaction")&&await Ae.open({view:"SIWXSignMessage"}),_r.showError("Error signing message"),He.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){try{const e=this.getSIWX();if(e?.getRequired?.()){const n=T.getLastConnectedSIWECaipNetwork();if(n){const r=await e?.getSessions(n?.caipNetworkId,ce.getPlainAddress(T.getActiveCaipAddress())||"");r&&r.length>0?await T.switchActiveNetwork(n):await Q.disconnect()}else await Q.disconnect()}else Ae.close();Ae.close(),He.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const e=this.getSIWX(),t=T.getAllRequestedCaipNetworks(),n=[];return await Promise.all(t.map(async r=>{const s=await e?.getSessions(r.caipNetworkId,ce.getPlainAddress(T.getActiveCaipAddress())||"");s&&n.push(...s)})),n},async getSessions(e){const t=z.state.siwx;let n=e?.address;if(!n){const s=T.getActiveCaipAddress();n=ce.getPlainAddress(s)}let r=e?.caipNetworkId;return r||(r=T.getActiveCaipNetwork()?.caipNetworkId),t&&n&&r?t.getSessions(r,n):[]},async isSIWXCloseDisabled(){const e=this.getSIWX();if(e){const t=pe.state.view==="ApproveTransaction",n=pe.state.view==="SIWXSignMessage";if(t||n)return e.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:e,chainId:t,socialUri:n,preferredAccountType:r,chainNamespace:s}){const i=xr.getSIWX();if(!i||!s.includes(q.CHAIN.EVM)||z.state.remoteFeatures?.emailCapture){const u=await e.connect({chainId:t,socialUri:n,preferredAccountType:r});return{address:u.address,chainId:u.chainId,accounts:u.accounts}}const o=`${s}:${t}`,a=await i.createMessage({chainId:o,accountAddress:"<<AccountAddress>>"}),c={accountAddress:a.accountAddress,chainId:a.chainId,domain:a.domain,uri:a.uri,version:a.version,nonce:a.nonce,notBefore:a.notBefore,statement:a.statement,resources:a.resources,requestId:a.requestId,issuedAt:a.issuedAt,expirationTime:a.expirationTime,serializedMessage:a.toString()},l=await e.connect({chainId:t,socialUri:n,siwxMessage:c,preferredAccountType:r});return c.accountAddress=l.address,c.serializedMessage=l.message||"",l.signature&&l.message&&await xr.addEmbeddedWalletSession(c,l.message,l.signature),{address:l.address,chainId:l.chainId,accounts:l.accounts}},async addEmbeddedWalletSession(e,t,n){if(li)return li;const r=xr.getSIWX();return r?(li=r.addSession({data:e,message:t,signature:n}).finally(()=>{li=null}),li):Promise.resolve()},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:n}){const r=xr.getSIWX(),s=new Set(t.map(a=>a.split(":")[0]));if(!r||s.size!==1||!s.has("eip155"))return!1;const i=await r.createMessage({chainId:iv()?.caipNetworkId||"",accountAddress:""}),o=await e.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:n,chains:[i.chainId,...t.filter(a=>a!==i.chainId)]});if(_r.showLoading("Authenticating...",{autoClose:!1}),ae.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:o.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(s)[0]),o?.auths?.length){const a=o.auths.map(c=>{const l=e.client.formatAuthMessage({request:c.p,iss:c.p.iss});return{data:{...c.p,accountAddress:c.p.iss.split(":").slice(-1).join(""),chainId:c.p.iss.split(":").slice(2,4).join(":"),uri:c.p.aud,version:c.p.version||i.version,expirationTime:c.p.exp,issuedAt:c.p.iat,notBefore:c.p.nbf},message:l,signature:c.s.s,cacao:c}});try{await r.setSessions(a),He.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:xr.getSIWXEventProperties()})}catch(c){throw console.error("SIWX:universalProviderAuth - failed to set sessions",c),He.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:xr.getSIWXEventProperties()}),await e.disconnect().catch(console.error),c}finally{_r.hide()}}return!0},getSIWXEventProperties(){const e=T.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:T.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:kr(e)===Oi.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const e=this.getSIWX();e&&await e.setSessions([])}},fi={EIP155:q.CHAIN.EVM,CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED"},Jc={NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[q.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[q.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[q.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[q.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[q.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[q.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[q.CONNECTOR_ID.INJECTED]:"Browser Wallet",[q.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[q.CONNECTOR_ID.COINBASE]:"Coinbase",[q.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[q.CONNECTOR_ID.LEDGER]:"Ledger",[q.CONNECTOR_ID.SAFE]:"Safe"}},In={getCaipTokens(e){if(!e)return;const t={};return Object.entries(e).forEach(([n,r])=>{t[`${fi.EIP155}:${n}`]=r}),t},isLowerCaseMatch(e,t){return e?.toLowerCase()===t?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const e=T.state.activeChain;return q.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(t=>X.getConnectorId(t)===q.CONNECTOR_ID.AUTH&&t===e)},withRetry({conditionFn:e,intervalMs:t,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await e()?s(!0):r>=n?s(!1):(setTimeout(i,t),null)}i()})}},HH=new AbortController,Bn={EmbeddedWalletAbortController:HH,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${Mo()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:e=>`Unable to fetch App Configuration. ${e}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:e=>`[Reown Config Notice] ${e}`}}},zH={createLogger(e,t="error"){const n=ll({level:t}),{logger:r}=lE({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){e(i,...s);return}e(void 0,...s)},r}},qH="rpc.walletconnect.org";function hv(e,t){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",e),n.searchParams.set("projectId",t),n.toString()}const pf=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Oo={extendRpcUrlWithProjectId(e,t){let n=!1;try{n=new URL(e).host===qH}catch{n=!1}if(n){const r=new URL(e);return r.searchParams.has("projectId")||r.searchParams.set("projectId",t),r.toString()}return e},isCaipNetwork(e){return"chainNamespace"in e&&"caipNetworkId"in e},getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:q.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${q.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,n){const r=e.rpcUrls?.default?.http?.[0];return pf.includes(t)?hv(t,n):r||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:n,customRpcUrls:r}){const s=this.getChainNamespace(e),i=this.getCaipNetworkId(e),o=e.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(e,i,n),c=e?.rpcUrls?.chainDefault?.http?.[0]||o,l=r?.[i]?.map(h=>h.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...e,chainNamespace:s,caipNetworkId:i,assets:{imageId:Jc.NetworkImageIds[e.id],imageUrl:t?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(e,{customNetworkImageUrls:t,projectId:n,customRpcUrls:r}){return e.map(s=>Oo.extendCaipNetwork(s,{customNetworkImageUrls:t,customRpcUrls:r,projectId:n}))},getViemTransport(e,t,n){const r=[];return n?.forEach(s=>{r.push(fu(s.url,s.config))}),pf.includes(e.caipNetworkId)&&r.push(fu(hv(e.caipNetworkId,t),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),e?.rpcUrls?.default?.http?.forEach(s=>{r.push(fu(s))}),uv(r)},extendWagmiTransports(e,t,n){if(pf.includes(e.caipNetworkId)){const r=this.getDefaultRpcUrl(e,e.caipNetworkId,t);return uv([n,fu(r)])}return n},getUnsupportedNetwork(e){return{id:e.split(":")[1],caipNetworkId:e,name:q.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(e){const t=V.getActiveCaipNetworkId(),n=T.getAllRequestedCaipNetworks(),r=Array.from(T.state.chains?.keys()||[]),s=t?.split(":")[0],i=s?r.includes(s):!1,o=n?.find(c=>c.caipNetworkId===t);return i&&!o&&t?this.getUnsupportedNetwork(t):o||e||n?.[0]}},rd={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},rn=Ze({providers:{...rd},providerIds:{...rd}}),it={state:rn,subscribeKey(e,t){return zt(rn,e,t)},subscribe(e){return $t(rn,()=>{e(rn)})},subscribeProviders(e){return $t(rn.providers,()=>e(rn.providers))},setProvider(e,t){e&&t&&(rn.providers[e]=Hi(t))},getProvider(e){if(e)return rn.providers[e]},setProviderId(e,t){t&&(rn.providerIds[e]=t)},getProviderId(e){if(e)return rn.providerIds[e]},reset(){rn.providers={...rd},rn.providerIds={...rd}},resetChain(e){rn.providers[e]=void 0,rn.providerIds[e]=void 0}},WH={VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},Wp={filterOutDuplicatesByRDNS(e){const t=z.state.enableEIP6963?X.state.connectors:[],n=V.getRecentWallets(),r=t.map(a=>a.info?.rdns).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&ce.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return e.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&t.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(e){const t=X.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),n=V.getRecentWallets(),r=t.map(a=>a.explorerId),s=n.map(a=>a.id),i=r.concat(s);return e.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(e){const t=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(t)},markWalletsAsInstalled(e){const{connectors:t}=X.state,{featuredWalletIds:n}=z.state,r=t.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return e.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n?.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(e,t){const n=e?.connectMethodsOrder||z.state.features?.connectMethodsOrder,r=t||X.state.connectors;if(n)return n;const{injected:s,announced:i}=_u.getConnectorsByType(r,he.state.recommended,he.state.featured),o=s.filter(_u.showConnector),a=i.filter(_u.showConnector);return o.length||a.length?["wallet","email","social"]:WH.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(e){const t=!!e.rdns&&he.state.excludedWallets.some(r=>r.rdns===e.rdns),n=!!e.name&&he.state.excludedWallets.some(r=>In.isLowerCaseMatch(r.name,e.name));return t||n},markWalletsWithDisplayIndex(e){return e.map((t,n)=>({...t,display_index:n}))}},_u={getConnectorsByType(e,t,n){const{customWallets:r}=z.state,s=V.getRecentWallets(),i=Wp.filterOutDuplicateWallets(t),o=Wp.filterOutDuplicateWallets(n),a=e.filter(d=>d.type==="MULTI_CHAIN"),c=e.filter(d=>d.type==="ANNOUNCED"),l=e.filter(d=>d.type==="INJECTED"),u=e.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(e){const t=e.info?.rdns,n=!!t&&he.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===t),r=!!e.name&&he.state.excludedWallets.some(s=>In.isLowerCaseMatch(s.name,e.name));return!(e.type==="INJECTED"&&(e.name==="Browser Wallet"&&(!ce.isMobile()||ce.isMobile()&&!t&&!Q.checkInstalled())||n||r)||(e.type==="ANNOUNCED"||e.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(T.state.chains.values()).some(n=>X.getConnectorId(n.namespace)===q.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:e,featured:t,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=z.state.features?.connectorTypeOrder??[]}){const d=[{type:"walletConnect",isEnabled:z.state.enableWalletConnect},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:t.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:e.length>0}].filter(g=>g.isEnabled),h=new Set(d.map(g=>g.type)),p=c.filter(g=>h.has(g)).map(g=>({type:g,isEnabled:!0})),f=d.filter(({type:g})=>!p.some(({type:b})=>b===g));return Array.from(new Set([...p,...f].map(({type:g})=>g)))},getAuthName({email:e,socialUsername:t,socialProvider:n}){return t?n&&n==="discord"&&t.endsWith("0")?t.slice(0,-1):t:e.length>30?`${e.slice(0,-3)}...`:e},async fetchProviderData(e){try{if(e.name==="Browser Wallet"&&!ce.isMobile())return{accounts:[],chainId:void 0};if(e.id===q.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[t,n]=await Promise.all([e.provider?.request({method:"eth_accounts"}),e.provider?.request({method:"eth_chainId"}).then(r=>Number(r))]);return{accounts:t,chainId:n}}catch(t){return console.warn(`Failed to fetch provider data for ${e.name}`,t),{accounts:[],chainId:void 0}}}};const Tu=globalThis,dw=Tu.ShadowRoot&&(Tu.ShadyCSS===void 0||Tu.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,hw=Symbol(),fv=new WeakMap;let d2=class{constructor(t,n,r){if(this._$cssResult$=!0,r!==hw)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=n}get styleSheet(){let t=this.o;const n=this.t;if(dw&&t===void 0){const r=n!==void 0&&n.length===1;r&&(t=fv.get(n)),t===void 0&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),r&&fv.set(n,t))}return t}toString(){return this.cssText}};const Mn=e=>new d2(typeof e=="string"?e:e+"",void 0,hw),Ho=(e,...t)=>{const n=e.length===1?e[0]:t.reduce(((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+e[i+1]),e[0]);return new d2(n,e,hw)},VH=(e,t)=>{if(dw)e.adoptedStyleSheets=t.map((n=>n instanceof CSSStyleSheet?n:n.styleSheet));else for(const n of t){const r=document.createElement("style"),s=Tu.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,e.appendChild(r)}},pv=dw?e=>e:e=>e instanceof CSSStyleSheet?(t=>{let n="";for(const r of t.cssRules)n+=r.cssText;return Mn(n)})(e):e;const{is:KH,defineProperty:GH,getOwnPropertyDescriptor:YH,getOwnPropertyNames:ZH,getOwnPropertySymbols:JH,getPrototypeOf:XH}=Object,Ud=globalThis,gv=Ud.trustedTypes,QH=gv?gv.emptyScript:"",ez=Ud.reactiveElementPolyfillSupport,dc=(e,t)=>e,Vp={toAttribute(e,t){switch(t){case Boolean:e=e?QH:null;break;case Object:case Array:e=e==null?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=e!==null;break;case Number:n=e===null?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},h2=(e,t)=>!KH(e,t),wv={attribute:!0,type:String,converter:Vp,reflect:!1,useDefault:!1,hasChanged:h2};Symbol.metadata??=Symbol("metadata"),Ud.litPropertyMetadata??=new WeakMap;let Do=class extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,n=wv){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(t,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(t,r,n);s!==void 0&&GH(this.prototype,t,s)}}static getPropertyDescriptor(t,n,r){const{get:s,set:i}=YH(this.prototype,t)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(t,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??wv}static _$Ei(){if(this.hasOwnProperty(dc("elementProperties")))return;const t=XH(this);t.finalize(),t.l!==void 0&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(dc("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(dc("properties"))){const n=this.properties,r=[...ZH(n),...JH(n)];for(const s of r)this.createProperty(s,n[s])}const t=this[Symbol.metadata];if(t!==null){const n=litPropertyMetadata.get(t);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(t){const n=[];if(Array.isArray(t)){const r=new Set(t.flat(1/0).reverse());for(const s of r)n.unshift(pv(s))}else t!==void 0&&n.push(pv(t));return n}static _$Eu(t,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof t=="string"?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),this.renderRoot!==void 0&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(t.set(r,this[r]),delete this[r]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return VH(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,n,r){this._$AK(t,r)}_$ET(t,n){const r=this.constructor.elementProperties.get(t),s=this.constructor._$Eu(t,r);if(s!==void 0&&r.reflect===!0){const i=(r.converter?.toAttribute!==void 0?r.converter:Vp).toAttribute(n,r.type);this._$Em=t,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(t,n){const r=this.constructor,s=r._$Eh.get(t);if(s!==void 0&&this._$Em!==s){const i=r.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:Vp;this._$Em=s;const a=o.fromAttribute(n,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(t,n,r){if(t!==void 0){const s=this.constructor,i=this[t];if(r??=s.getPropertyOptions(t),!((r.hasChanged??h2)(i,n)||r.useDefault&&r.reflect&&i===this._$Ej?.get(t)&&!this.hasAttribute(s._$Eu(t,r))))return;this.C(t,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(t,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,o??n??this[t]),i!==!0||o!==void 0)||(this._$AL.has(t)||(this.hasUpdated||r||(n=void 0),this._$AL.set(t,n)),s===!0&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const t=this.scheduleUpdate();return t!=null&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,i]of r){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),this._$EO?.forEach((r=>r.hostUpdate?.())),this.update(n)):this._$EM()}catch(r){throw t=!1,this._$EM(),r}t&&this._$AE(n)}willUpdate(t){}_$AE(t){this._$EO?.forEach((n=>n.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((n=>this._$ET(n,this[n]))),this._$EM()}updated(t){}firstUpdated(t){}};Do.elementStyles=[],Do.shadowRootOptions={mode:"open"},Do[dc("elementProperties")]=new Map,Do[dc("finalized")]=new Map,ez?.({ReactiveElement:Do}),(Ud.reactiveElementVersions??=[]).push("2.1.1");const fw=globalThis,sd=fw.trustedTypes,mv=sd?sd.createPolicy("lit-html",{createHTML:e=>e}):void 0,f2="$lit$",Os=`lit$${Math.random().toFixed(9).slice(2)}$`,p2="?"+Os,tz=`<${p2}>`,zi=document,Xc=()=>zi.createComment(""),Qc=e=>e===null||typeof e!="object"&&typeof e!="function",pw=Array.isArray,nz=e=>pw(e)||typeof e?.[Symbol.iterator]=="function",gf=`[ 	
\f\r]`,za=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,yv=/-->/g,bv=/>/g,ui=RegExp(`>|${gf}(?:([^\\s"'>=/]+)(${gf}*=${gf}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),vv=/'/g,Ev=/"/g,g2=/^(?:script|style|textarea|title)$/i,w2=e=>(t,...n)=>({_$litType$:e,strings:t,values:n}),LW=w2(1),jW=w2(2),ra=Symbol.for("lit-noChange"),Et=Symbol.for("lit-nothing"),Cv=new WeakMap,Ni=zi.createTreeWalker(zi,129);function m2(e,t){if(!pw(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return mv!==void 0?mv.createHTML(t):t}const rz=(e,t)=>{const n=e.length-1,r=[];let s,i=t===2?"<svg>":t===3?"<math>":"",o=za;for(let a=0;a<n;a++){const c=e[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===za?u[1]==="!--"?o=yv:u[1]!==void 0?o=bv:u[2]!==void 0?(g2.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=ui):u[3]!==void 0&&(o=ui):o===ui?u[0]===">"?(o=s??za,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?ui:u[3]==='"'?Ev:vv):o===Ev||o===vv?o=ui:o===yv||o===bv?o=za:(o=ui,s=void 0);const p=o===ui&&e[a+1].startsWith("/>")?" ":"";i+=o===za?c+tz:d>=0?(r.push(l),c.slice(0,d)+f2+c.slice(d)+Os+p):c+Os+(d===-2?a:p)}return[m2(e,i+(e[n]||"<?>")+(t===2?"</svg>":t===3?"</math>":"")),r]};let Kp=class y2{constructor({strings:t,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=t.length-1,c=this.parts,[l,u]=rz(t,n);if(this.el=y2.createElement(l,r),Ni.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Ni.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(f2)){const h=u[o++],p=s.getAttribute(d).split(Os),f=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:f[2],strings:p,ctor:f[1]==="."?iz:f[1]==="?"?oz:f[1]==="@"?az:Rd}),s.removeAttribute(d)}else d.startsWith(Os)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(g2.test(s.tagName)){const d=s.textContent.split(Os),h=d.length-1;if(h>0){s.textContent=sd?sd.emptyScript:"";for(let p=0;p<h;p++)s.append(d[p],Xc()),Ni.nextNode(),c.push({type:2,index:++i});s.append(d[h],Xc())}}}else if(s.nodeType===8)if(s.data===p2)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Os,d+1))!==-1;)c.push({type:7,index:i}),d+=Os.length-1}i++}}static createElement(t,n){const r=zi.createElement("template");return r.innerHTML=t,r}};function sa(e,t,n=e,r){if(t===ra)return t;let s=r!==void 0?n._$Co?.[r]:n._$Cl;const i=Qc(t)?void 0:t._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(e),s._$AT(e,n,r)),r!==void 0?(n._$Co??=[])[r]=s:n._$Cl=s),s!==void 0&&(t=sa(e,s._$AS(e,t.values),s,r)),t}let sz=class{constructor(t,n){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:n},parts:r}=this._$AD,s=(t?.creationScope??zi).importNode(n,!0);Ni.currentNode=s;let i=Ni.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new vl(i,i.nextSibling,this,t):c.type===1?l=new c.ctor(i,c.name,c.strings,this,t):c.type===6&&(l=new cz(i,this,t)),this._$AV.push(l),c=r[++a]}o!==c?.index&&(i=Ni.nextNode(),o++)}return Ni.currentNode=zi,s}p(t){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(t,r,n),n+=r.strings.length-2):r._$AI(t[n])),n++}};class vl{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,n,r,s){this.type=2,this._$AH=Et,this._$AN=void 0,this._$AA=t,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&t?.nodeType===11&&(t=n.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,n=this){t=sa(this,t,n),Qc(t)?t===Et||t==null||t===""?(this._$AH!==Et&&this._$AR(),this._$AH=Et):t!==this._$AH&&t!==ra&&this._(t):t._$litType$!==void 0?this.$(t):t.nodeType!==void 0?this.T(t):nz(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==Et&&Qc(this._$AH)?this._$AA.nextSibling.data=t:this.T(zi.createTextNode(t)),this._$AH=t}$(t){const{values:n,_$litType$:r}=t,s=typeof r=="number"?this._$AC(t):(r.el===void 0&&(r.el=Kp.createElement(m2(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(n);else{const i=new sz(s,this),o=i.u(this.options);i.p(n),this.T(o),this._$AH=i}}_$AC(t){let n=Cv.get(t.strings);return n===void 0&&Cv.set(t.strings,n=new Kp(t)),n}k(t){pw(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of t)s===n.length?n.push(r=new vl(this.O(Xc()),this.O(Xc()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(t=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);t!==this._$AB;){const r=t.nextSibling;t.remove(),t=r}}setConnected(t){this._$AM===void 0&&(this._$Cv=t,this._$AP?.(t))}}let Rd=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,n,r,s,i){this.type=1,this._$AH=Et,this._$AN=void 0,this.element=t,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Et}_$AI(t,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)t=sa(this,t,n,0),o=!Qc(t)||t!==this._$AH&&t!==ra,o&&(this._$AH=t);else{const a=t;let c,l;for(t=i[0],c=0;c<i.length-1;c++)l=sa(this,a[r+c],n,c),l===ra&&(l=this._$AH[c]),o||=!Qc(l)||l!==this._$AH[c],l===Et?t=Et:t!==Et&&(t+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(t)}j(t){t===Et?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"")}};class iz extends Rd{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===Et?void 0:t}}class oz extends Rd{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==Et)}}class az extends Rd{constructor(t,n,r,s,i){super(t,n,r,s,i),this.type=5}_$AI(t,n=this){if((t=sa(this,t,n,0)??Et)===ra)return;const r=this._$AH,s=t===Et&&r!==Et||t.capture!==r.capture||t.once!==r.once||t.passive!==r.passive,i=t!==Et&&(r===Et||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}let cz=class{constructor(t,n,r){this.element=t,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(t){sa(this,t)}};const lz=fw.litHtmlPolyfillSupport;lz?.(Kp,vl),(fw.litHtmlVersions??=[]).push("3.3.1");const uz=(e,t,n)=>{const r=n?.renderBefore??t;let s=r._$litPart$;if(s===void 0){const i=n?.renderBefore??null;r._$litPart$=s=new vl(t.insertBefore(Xc(),i),i,void 0,n??{})}return s._$AI(e),s};const gw=globalThis;class Ou extends Do{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=uz(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return ra}}Ou._$litElement$=!0,Ou.finalized=!0,gw.litElementHydrateSupport?.({LitElement:Ou});const dz=gw.litElementPolyfillSupport;dz?.({LitElement:Ou});(gw.litElementVersions??=[]).push("4.2.1");let hc,Fs,Hs;function qW(e,t){hc=document.createElement("style"),Fs=document.createElement("style"),Hs=document.createElement("style"),hc.textContent=zo(e).core.cssText,Fs.textContent=zo(e).dark.cssText,Hs.textContent=zo(e).light.cssText,document.head.appendChild(hc),document.head.appendChild(Fs),document.head.appendChild(Hs),b2(t)}function b2(e){Fs&&Hs&&(e==="light"?(Fs.removeAttribute("media"),Hs.media="enabled"):(Hs.removeAttribute("media"),Fs.media="enabled"))}function hz(e){hc&&Fs&&Hs&&(hc.textContent=zo(e).core.cssText,Fs.textContent=zo(e).dark.cssText,Hs.textContent=zo(e).light.cssText)}function zo(e){return{core:Ho`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${Mn(e?.["--w3m-color-mix-strength"]?`${e["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${Mn(e?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${Mn(e?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${Mn(e?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${Mn(e?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:Ho`
      :root {
        --w3m-color-mix: ${Mn(e?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${Mn(Us(e,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${Mn(Us(e,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:Ho`
      :root {
        --w3m-color-mix: ${Mn(e?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${Mn(Us(e,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${Mn(Us(e,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const WW=Ho`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,VW=Ho`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,KW=Ho`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,Du={hexStringToNumber(e){const t=e.startsWith("0x")?e.slice(2):e;return parseInt(t,16)},numberToHexString(e){return`0x${e.toString(16)}`},async getUserInfo(e){const[t,n]=await Promise.all([Du.getAddresses(e),Du.getChainId(e)]);return{chainId:n,addresses:t}},async getChainId(e){const t=await e.request({method:"eth_chainId"});return Number(t)},async getAddress(e){const[t]=await e.request({method:"eth_accounts"});return t},async getAddresses(e){return await e.request({method:"eth_accounts"})},async addEthereumChain(e,t){const n=t.rpcUrls.chainDefault?.http||[];await e.request({method:"wallet_addEthereumChain",params:[{chainId:Du.numberToHexString(t.id),rpcUrls:[...n],chainName:t.name,nativeCurrency:{name:t.nativeCurrency.name,decimals:t.nativeCurrency.decimals,symbol:t.nativeCurrency.symbol},blockExplorerUrls:[t.blockExplorers?.default.url],iconUrls:[Jc.NetworkImageIds[t.id]]}]})}},xo={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}};function El(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}const Av=El({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),Iv=El({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});El({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});const fz=El({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),pz=El({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0}),gz={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},ns={getMethodsByChainNamespace(e){return gz[e]||[]},createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};const n={...e},r=new Set;if(t.methods&&Object.keys(t.methods).forEach(s=>r.add(s)),t.chains&&Object.keys(t.chains).forEach(s=>r.add(s)),t.events&&Object.keys(t.events).forEach(s=>r.add(s)),t.rpcMap&&Object.keys(t.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),t.methods&&Object.entries(t.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),t.chains&&Object.entries(t.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),t.events&&Object.entries(t.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),t.rpcMap){const s=new Set;Object.entries(t.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(e,t){const n=e.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case Av.caipNetworkId:u.chains.push(Av.deprecatedCaipNetworkId);break;case Iv.caipNetworkId:u.chains.push(Iv.deprecatedCaipNetworkId);break}return u?.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,t)},resolveReownName:async e=>{const t=await uc.resolveName(e);return(Object.values(t?.addresses)||[])[0]?.address||!1},getChainsFromNamespaces(e={}){return Object.values(e).flatMap(t=>{const n=t.chains||[],r=t.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(e){return typeof e=="object"&&e!==null&&"id"in e&&"topic"in e&&"params"in e&&typeof e.params=="object"&&e.params!==null&&"chainId"in e.params&&"event"in e.params&&typeof e.params.event=="object"&&e.params.event!==null},isOriginAllowed(e,t,n){for(const r of[...t,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(e))return!0}else try{if(new URL(r).origin===e)return!0}catch{if(r===e)return!0}return!1},listenWcProvider({universalProvider:e,namespace:t,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&e.on("connect",()=>{const a=ns.getWalletConnectAccounts(e,t);n(a)}),r&&e.on("disconnect",()=>{r()}),s&&e.on("session_event",a=>{if(ns.isSessionEventData(a)){const{name:c,data:l}=a.params.event;if(c==="accountsChanged"&&Array.isArray(l)){const u=l.filter(d=>ce.isCaipAddress(d)).map(d=>An.parseCaipAddress(d)).filter(d=>d.chainNamespace===t);s(u)}}}),i&&e.on("chainChanged",a=>{i(a)}),o&&e.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(e,t){const n=new Set,r=e?.session?.namespaces?.[t]?.accounts?.map(s=>An.parseCaipAddress(s)).filter(({address:s})=>n.has(s.toLowerCase())?!1:(n.add(s.toLowerCase()),!0));return r&&r.length>0?r:[]}};class wz{constructor(t){this.namespace=t.namespace}async syncConnections(t){switch(this.namespace){case q.CHAIN.EVM:await this.syncEVMConnections(t);break;case q.CHAIN.SOLANA:await this.syncSolanaConnections(t);break;case q.CHAIN.BITCOIN:await this.syncBitcoinConnections(t);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:t,caipNetworks:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(t.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===q.CONNECTOR_ID.WALLET_CONNECT){const c=ns.getWalletConnectAccounts(r,this.namespace),l=n.find(u=>u.chainNamespace===this.namespace&&u.id.toString()===c[0]?.chainId?.toString());c.length>0&&i({connectorId:a.id,accounts:c.map(u=>({address:u.address})),caipNetwork:l})}else{const{accounts:c,chainId:l}=await _u.fetchProviderData(a);if(c.length>0&&l){const u=n.find(d=>d.chainNamespace===this.namespace&&d.id.toString()===l.toString());i({connectorId:a.id,accounts:c.map(d=>({address:d})),caipNetwork:u}),a.provider&&a.id!==q.CONNECTOR_ID.AUTH&&a.id!==q.CONNECTOR_ID.WALLET_CONNECT&&o(a.id,a.provider)}}}))}async syncSolanaConnections({connectors:t,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(t.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===q.CONNECTOR_ID.WALLET_CONNECT){const c=ns.getWalletConnectAccounts(r,this.namespace);c.length>0&&i({connectorId:a.id,accounts:c.map(l=>({address:l.address})),caipNetwork:n})}else{const c=await a.connect({chainId:n?.id});c&&(i({connectorId:a.id,accounts:[{address:c}],caipNetwork:n}),o(a.id,a.provider))}}))}async syncBitcoinConnections({connectors:t,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(t.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===q.CONNECTOR_ID.WALLET_CONNECT){const h=ns.getWalletConnectAccounts(r,this.namespace);h.length>0&&i({connectorId:a.id,accounts:h.map(p=>({address:p.address})),caipNetwork:n});return}const c=await a.connect();let u=(await a.getAccountAddresses())?.map(h=>ce.createAccount(q.CHAIN.BITCOIN,h.address,h.purpose||"payment",h.publicKey,h.path));if(u&&u.length>1&&(u=[{namespace:q.CHAIN.BITCOIN,publicKey:u[xo.ACCOUNT_INDEXES.PAYMENT]?.publicKey??"",path:u[xo.ACCOUNT_INDEXES.PAYMENT]?.path??"",address:u[xo.ACCOUNT_INDEXES.PAYMENT]?.address??"",type:"payment"},{namespace:q.CHAIN.BITCOIN,publicKey:u[xo.ACCOUNT_INDEXES.ORDINAL]?.publicKey??"",path:u[xo.ACCOUNT_INDEXES.ORDINAL]?.path??"",address:u[xo.ACCOUNT_INDEXES.ORDINAL]?.address??"",type:"ordinal"}]),!(a.chains.find(h=>h.id===n?.id)||a.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(o(a.id,a.provider),i({connectorId:a.id,accounts:u.map(h=>({address:h.address,type:h.type})),caipNetwork:n}))}))}getConnection({address:t,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>In.isLowerCaseMatch(l.connectorId,n));if(!o)return null;const a=s.find(l=>In.isLowerCaseMatch(l.id,o.connectorId)),c=t?o.accounts.find(l=>In.isLowerCaseMatch(l.address,t)):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>In.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(c=>In.isLowerCaseMatch(c.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const Za={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class v2{constructor({provider:t,namespace:n}){this.id=q.CONNECTOR_ID.WALLET_CONNECT,this.name=Jc.ConnectorNamesMap[q.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Jc.ConnectorImageIds[q.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=T.getCaipNetworks.bind(T),this.caipNetworks=this.getCaipNetworks(),this.provider=t,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=z.state.universalProviderConfigOverride,s=ns.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const t=this.chains.map(n=>n.caipNetworkId);return xr.universalProviderAuthenticate({universalProvider:this.provider,chains:t,methods:mz})}}const mz=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],yz=[q.CONNECTOR_ID.AUTH,q.CONNECTOR_ID.WALLET_CONNECT];class bz{constructor(t){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>T.getCaipNetworks(n),this.getConnectorId=n=>X.getConnectorId(n),t&&this.construct(t),t?.namespace&&(this.connectionManager=new wz({namespace:t.namespace}))}construct(t){this.projectId=t.projectId,this.namespace=t.namespace,this.adapterType=t.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:t,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===n?.toString());t&&r&&this.addConnection({connectorId:q.CONNECTOR_ID.AUTH,accounts:t,caipNetwork:r})}setAuthProvider(t){t.onConnect(this.onAuthConnected.bind(this)),t.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:q.CONNECTOR_ID.AUTH,type:"AUTH",name:q.CONNECTOR_NAMES.AUTH,provider:t,imageId:Jc.ConnectorImageIds[q.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...t){const n=new Set;this.availableConnectors=[...t,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...t){const n=new Set;this.availableConnections=[...t,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(t){this.availableConnections=this.availableConnections.filter(n=>!In.isLowerCaseMatch(n.connectorId,t)),this.emit("connections",this.availableConnections)}clearConnections(t=!1){this.availableConnections=[],t&&this.emit("connections",this.availableConnections)}setStatus(t,n){ae.setStatus(t,n)}on(t,n){this.eventListeners.has(t)||this.eventListeners.set(t,new Set),this.eventListeners.get(t)?.add(n)}off(t,n){const r=this.eventListeners.get(t);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(t=>{t.clear()})}emit(t,n){const r=this.eventListeners.get(t);r&&r.forEach(s=>s(n))}async connectWalletConnect(t){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(t){const{caipNetwork:n,providerType:r}=t;if(!t.provider)return;const s="provider"in t.provider?t.provider.provider:t.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=kr(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const t=this.connectors.find(n=>n instanceof v2);if(!t)throw new Error("WalletConnectConnector not found");return t}onConnect(t,n){if(t.length>0){const{address:r,chainId:s}=ce.getAccount(t[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:t.map(a=>{const{address:c}=ce.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(t,n,r=!0){if(t.length>0){const{address:s}=ce.getAccount(t[0]),i=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});s&&In.isLowerCaseMatch(this.getConnectorId(q.CHAIN.EVM),n)&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:n,accounts:t.map(o=>{const{address:a}=ce.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(t){this.removeProviderListeners(t),this.deleteConnection(t),In.isLowerCaseMatch(this.getConnectorId(q.CHAIN.EVM),t)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(t,n){const r=typeof t=="string"&&t.startsWith("0x")?Du.hexStringToNumber(t).toString():t.toString(),s=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),In.isLowerCaseMatch(this.getConnectorId(q.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(t,n){if(yz.includes(t))return;const r=o=>this.onAccountsChanged(o,t),s=o=>this.onChainChanged(o,t),i=()=>this.onDisconnect(t);this.providerHandlers[t]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[t]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(t){if(this.providerHandlers[t]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[t];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[t]=null}}emitFirstAvailableConnection(){const t=this.connectionManager?.getConnection({connections:this.connections,connectors:this.connectors});if(t){const[n]=t.accounts;this.emit("accountChanged",{address:n?.address,chainId:t.caipNetwork?.id,connector:t.connector})}}}class vz extends bz{async setUniversalProvider(t){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new v2({provider:t,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(t){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(t.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(t){console.warn("UniversalAdapter:disconnect - error",t)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:t}){const r=this.provider?.session?.namespaces?.[t]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:r.map(s=>ce.createAccount(t,s,t==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(t){if(!(t.caipNetwork&&Me.BALANCE_SUPPORTED_CHAINS.includes(t.caipNetwork?.chainNamespace))||t.caipNetwork?.testnet)return{balance:"0.00",symbol:t.caipNetwork?.nativeCurrency.symbol||""};if(ae.state.balanceLoading&&t.chainId===T.state.activeCaipNetwork?.id)return{balance:ae.state.balance||"0.00",symbol:ae.state.balanceSymbol||""};const s=(await ae.fetchTokenBalance()).find(i=>i.chainId===`${t.caipNetwork?.chainNamespace}:${t.chainId}`&&i.symbol===t.caipNetwork?.nativeCurrency.symbol);return{balance:s?.quantity.numeric||"0.00",symbol:s?.symbol||t.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(t){const{provider:n,message:r,address:s}=t;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return T.state.activeCaipNetwork?.chainNamespace===q.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:ha.encode(new TextEncoder().encode(r)),pubkey:s}},T.state.activeCaipNetwork?.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},T.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(t){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(t){const{caipNetwork:n}=t,r=this.getWalletConnectConnector();if(n.chainNamespace===q.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:av(n.id)}]})}catch(s){if(s.code===Za.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===Za.ERROR_INVALID_CHAIN_ID||s.code===Za.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===Za.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:av(n.id),rpcUrls:[n?.rpcUrls.chainDefault?.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}const Ez=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture"],pu={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return!!e.isEnabled&&t.includes("email")},processFallback:e=>e===void 0?Me.DEFAULT_REMOTE_FEATURES.email:!!e},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return e.isEnabled&&t.length>0?t.filter(n=>n!=="email"):!1},processFallback:e=>e===void 0?Me.DEFAULT_REMOTE_FEATURES.socials:typeof e=="boolean"?e?Me.DEFAULT_REMOTE_FEATURES.socials:!1:e},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return e.isEnabled&&t.length>0?t:!1},processFallback:e=>e===void 0?Me.DEFAULT_REMOTE_FEATURES.swaps:typeof e=="boolean"?e?Me.DEFAULT_REMOTE_FEATURES.swaps:!1:e},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>{if(!e?.config)return!1;const t=e.config;return e.isEnabled&&t.length>0?t:!1},processFallback:e=>e===void 0?Me.DEFAULT_REMOTE_FEATURES.onramp:typeof e=="boolean"?e?Me.DEFAULT_REMOTE_FEATURES.onramp:!1:e},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>e===void 0?Me.DEFAULT_REMOTE_FEATURES.activity:!!e},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:e=>e===void 0?Me.DEFAULT_REMOTE_FEATURES.reownBranding:!!e},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>e.isEnabled&&(e.config??[]),processFallback:e=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:e=>!!e.isEnabled,processFallback:()=>Me.DEFAULT_REMOTE_FEATURES.multiWallet}},Cz={localSettingsOverridden:new Set,getApiConfig(e,t){return t?.find(n=>n.id===e)},addWarning(e,t){if(e!==void 0){const n=pu[t],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${t}")`:`"features.${t}"`;this.localSettingsOverridden.add(r)}},processFeature(e,t,n,r,s){const i=pu[e],o=t[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return a?.config===null?this.processFallbackFeature(e,o):a?.config?(o!==void 0&&this.addWarning(o,e),this.processApiFeature(e,a)):!1}return this.processFallbackFeature(e,o)},processApiFeature(e,t){return pu[e].processApi(t)},processFallbackFeature(e,t){return pu[e].processFallback(t)},async fetchRemoteFeatures(e){const t=e.basic??!1,n=e.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await he.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!t?Me.DEFAULT_REMOTE_FEATURES:Me.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of Ez){const a=this.processFeature(o,n,r,s,t);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Me.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;Ft.open({debugMessage:Bn.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class Az{constructor(t){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{if(n){const s=T.getCaipNetworks(n)?.find(a=>a.id===r);if(s)return s;const i=T.getNetworkData(n)?.caipNetwork;return i||T.getRequestedCaipNetworks(n).filter(a=>a.chainNamespace===n)?.[0]}return T.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>T.getCaipNetworks(n),this.getActiveChainNamespace=()=>T.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{T.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>T.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>T.state.activeChain===n||!n?T.state.activeCaipAddress:T.state.chains.get(n)?.accountState?.caipAddress,this.setClientId=n=>{fe.setClientId(n)},this.getProvider=n=>it.getProvider(n),this.getProviderType=n=>it.getProviderId(n),this.getPreferredAccountType=n=>kr(n),this.setCaipAddress=(n,r)=>{ae.setCaipAddress(n,r)},this.setBalance=(n,r,s)=>{ae.setBalance(n,r,s)},this.setProfileName=(n,r)=>{ae.setProfileName(n,r)},this.setProfileImage=(n,r)=>{ae.setProfileImage(n,r)},this.setUser=(n,r)=>{ae.setUser(n,r)},this.resetAccount=n=>{ae.resetAccount(n)},this.setCaipNetwork=n=>{T.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{T.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{ae.setStatus(n,r),X.isConnected()?V.setConnectionStatus("connected"):V.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>T.state.chains.get(n)?.accountState?.address,this.setConnectors=n=>{const r=[...X.state.allConnectors,...n];X.setConnectors(r)},this.setConnections=(n,r)=>{V.setConnections(n,r),Q.setConnections(n,r)},this.fetchIdentity=n=>fe.fetchIdentity(n),this.getReownName=n=>uc.getNamesForAddress(n),this.getConnectors=()=>X.getConnectors(),this.getConnectorImage=n=>XA.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?nd.getConnectionsData(n).connections:(Ft.open(q.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?nd.getConnectionsData(n).recentConnections:(Ft.open(q.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){Ft.open(q.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await Q.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){Ft.open(q.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}V.deleteAddressFromConnection(n),Q.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=it.getProviderId(r),i=n?{...n,type:s}:void 0;ae.setConnectedWalletInfo(i,r)},this.getIsConnectedState=()=>!!T.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{ae.addAddressLabel(n,r,s)},this.removeAddressLabel=(n,r)=>{ae.removeAddressLabel(n,r)},this.getAddress=n=>T.state.activeChain===n||!n?ae.state.address:T.state.chains.get(n)?.accountState?.address,this.setApprovedCaipNetworksData=n=>T.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{T.resetNetwork(n)},this.addConnector=n=>{X.addConnector(n)},this.resetWcConnection=()=>{Q.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{ae.setAddressExplorerUrl(n,r)},this.setSmartAccountDeployed=(n,r)=>{ae.setSmartAccountDeployed(n,r)},this.setPreferredAccountType=(n,r)=>{T.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{z.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=t,this.version=t.sdkVersion,this.caipNetworks=this.extendCaipNetworks(t),this.chainNamespaces=this.getChainNamespacesSet(t.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(t),this.chainAdapters=this.createAdapters(t.adapters),this.readyPromise=this.initialize(t)}getChainNamespacesSet(t,n){const r=t?.map(i=>i.namespace).filter(i=>!!i);if(r?.length)return[...new Set(r)];const s=n?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(t){this.initializeProjectSettings(t),this.initControllers(t),await this.initChainAdapters(),this.sendInitializeEvent(t),z.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await Cz.fetchRemoteFeatures(t),z.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&qp.setOnrampProviders(this.remoteFeatures.onramp),(z.state.remoteFeatures?.email||Array.isArray(z.state.remoteFeatures?.socials)&&z.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){try{const t=await he.fetchAllowedOrigins();if(!t||!ce.isClient()){Ft.open(Bn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}const n=window.location.origin;ns.isOriginAllowed(n,t,Za.DEFAULT_ALLOWED_ANCESTORS)||Ft.open(Bn.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(t){if(!(t instanceof Error)){Ft.open(Bn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}switch(t.message){case"RATE_LIMITED":Ft.open(Bn.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=t.cause instanceof Error?t.cause:t;Ft.open({displayMessage:Bn.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:Bn.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}default:Ft.open(Bn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(t){const{...n}=t;delete n.adapters,delete n.universalProvider,He.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:t.networks.map(r=>r.id),siweConfig:{options:t.siweConfig?.options||{}}}})}initControllers(t){this.initializeOptionsController(t),this.initializeChainController(t),this.initializeThemeController(t),this.initializeConnectionController(t),this.initializeConnectorController()}initializeThemeController(t){t.themeMode&&vn.setThemeMode(t.themeMode),t.themeVariables&&vn.setThemeVariables(t.themeVariables)}initializeChainController(t){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");T.initialize(t.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&T.setActiveCaipNetwork(n)}initializeConnectionController(t){Q.initialize(t.adapters??[]),Q.setWcBasic(t.basic??!1)}initializeConnectorController(){X.initialize(this.chainNamespaces)}initializeProjectSettings(t){z.setProjectId(t.projectId),z.setSdkVersion(t.sdkVersion)}initializeOptionsController(t){z.setDebug(t.debug!==!1),z.setEnableWalletConnect(t.enableWalletConnect!==!1),z.setEnableWalletGuide(t.enableWalletGuide!==!1),z.setEnableWallets(t.enableWallets!==!1),z.setEIP6963Enabled(t.enableEIP6963!==!1),z.setEnableNetworkSwitch(t.enableNetworkSwitch!==!1),z.setEnableReconnect(t.enableReconnect!==!1),z.setEnableAuthLogger(t.enableAuthLogger!==!1),z.setCustomRpcUrls(t.customRpcUrls),z.setEnableEmbedded(t.enableEmbedded),z.setAllWallets(t.allWallets),z.setIncludeWalletIds(t.includeWalletIds),z.setExcludeWalletIds(t.excludeWalletIds),z.setFeaturedWalletIds(t.featuredWalletIds),z.setTokens(t.tokens),z.setTermsConditionsUrl(t.termsConditionsUrl),z.setPrivacyPolicyUrl(t.privacyPolicyUrl),z.setCustomWallets(t.customWallets),z.setFeatures(t.features),z.setAllowUnsupportedChain(t.allowUnsupportedChain),z.setUniversalProviderConfigOverride(t.universalProviderConfigOverride),z.setPreferUniversalLinks(t.experimental_preferUniversalLinks),z.setDefaultAccountTypes(t.defaultAccountTypes);const n=this.getDefaultMetaData();if(!t.metadata&&n&&(t.metadata=n),z.setMetadata(t.metadata),z.setDisableAppend(t.disableAppend),z.setEnableEmbedded(t.enableEmbedded),z.setSIWX(t.siwx),!t.projectId){Ft.open(Bn.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(t.adapters?.find(s=>s.namespace===q.CHAIN.EVM)&&t.siweConfig){if(t.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");z.setSIWX(t.siweConfig.mapToSIWX())}}getDefaultMetaData(){return ce.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(t){const n=this.getActiveChainNamespace();if(n){const r=Oo.getUnsupportedNetwork(`${n}:${t}`);T.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Oo.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(t,n){return Oo.extendCaipNetwork(t,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(t){return Oo.extendCaipNetworks(t.networks,{customNetworkImageUrls:t.chainImages,customRpcUrls:t.customRpcUrls,projectId:t.projectId})}extendDefaultCaipNetwork(t){const n=t.networks.find(s=>s.id===t.defaultNetwork?.id);return n?Oo.extendCaipNetwork(n,{customNetworkImageUrls:t.chainImages,customRpcUrls:t.customRpcUrls,projectId:t.projectId}):void 0}async disconnectNamespace(t,n){try{this.setLoading(!0,t);let r={connections:[]};const s=this.getAdapter(t);return(T.state.chains.get(t)?.accountState?.caipAddress||!z.state.enableReconnect)&&s?.disconnect&&(r=await s.disconnect({id:n})),this.setLoading(!1,t),r}catch(r){throw this.setLoading(!1,t),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const t=T.state.activeChain,n=this.getAdapter(t),r=this.getCaipNetwork(t)?.id,s=Q.getConnections(t),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),V.setConnectedNamespaces([...T.state.chains.keys()]),await this.syncWalletConnectAccount(),await xr.initializeIfEnabled()},connectExternal:async({id:t,address:n,info:r,type:s,provider:i,chain:o,caipNetwork:a,socialUri:c})=>{const l=T.state.activeChain,u=o||l,d=this.getAdapter(u);if(o&&o!==l&&!a){const f=this.getCaipNetworks().find(g=>g.chainNamespace===o);f&&this.setCaipNetwork(f)}if(!u)throw new Error("connectExternal: namespace not found");if(!d)throw new Error("connectExternal: adapter not found");const h=this.getCaipNetwork(u),p=await d.connect({id:t,address:n,info:r,type:s,provider:i,socialUri:c,chainId:a?.id||h?.id,rpcUrl:a?.rpcUrls?.default?.http?.[0]||h?.rpcUrls?.default?.http?.[0]});if(p)return V.addConnectedNamespace(u),this.syncProvider({...p,chainNamespace:u}),this.setStatus("connected",u),this.syncConnectedWalletInfo(u),V.removeDisconnectedConnectorId(t,u),{address:p.address}},reconnectExternal:async({id:t,info:n,type:r,provider:s})=>{const i=T.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:t,info:n,type:r,provider:s,chainId:this.getCaipNetwork()?.id}),V.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async t=>{const{id:n,chainNamespace:r,initialDisconnect:s}=t||{},i=r||T.state.activeChain,o=X.getConnectorId(i),a=n===q.CONNECTOR_ID.AUTH||o===q.CONNECTOR_ID.AUTH,c=n===q.CONNECTOR_ID.WALLET_CONNECT||o===q.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(T.state.chains.keys());let u=r?[r]:l;(c||a)&&(u=l);const d=u.map(async f=>{const g=X.getConnectorId(f),w=await this.disconnectNamespace(f,n||g);w&&(a&&V.deleteConnectedSocialProvider(),w.connections.forEach(b=>{V.addDisconnectedConnectorId(b.connectorId,f)})),s&&this.onDisconnectNamespace({chainNamespace:f,closeModal:!1})}),h=await Promise.allSettled(d);ke.resetSend(),Q.resetWcConnection(),xr.getSIWX()?.signOutOnDisconnect&&await xr.clearSessions(),X.setFilterByNamespace(void 0),Q.syncStorageConnections();const p=h.filter(f=>f.status==="rejected");if(p.length>0)throw new Error(p.map(f=>f.reason.message).join(", "));He.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:t=>t?t.some(n=>!!window.ethereum?.[String(n)]):!!window.ethereum,signMessage:async t=>{const n=T.state.activeChain,r=this.getAdapter(T.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");return(await r?.signMessage({message:t,address:ae.state.address,provider:it.getProvider(n)}))?.signature||""},sendTransaction:async t=>{const n=t.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Me.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=it.getProvider(n);return(await r?.sendTransaction({...t,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async t=>{const n=t.chainNamespace;if(n===q.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=it.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas({...t,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const t=T.state.activeChain;if(!t)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:ae.state.address,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:t}),ae.state.profileImage||!1},getEnsAddress:async t=>await ns.resolveReownName(t),writeContract:async t=>{const n=T.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=it.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract({...t,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(t,n)=>{const r=this.getAdapter(T.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:t,decimals:n})??0n},formatUnits:(t,n)=>{const r=this.getAdapter(T.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:t,decimals:n})??"0"},getCapabilities:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await n?.getCapabilities(t)},grantPermissions:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await n?.grantPermissions(t)},revokePermissions:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n?.revokePermissions?await n.revokePermissions(t):"0x"},walletGetAssets:async t=>{const n=this.getAdapter(T.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await n?.walletGetAssets(t)??{}},updateBalance:t=>{const n=this.getCaipNetwork(t);!n||!ae.state.address||this.updateNativeBalance(ae.state.address,n?.id,t)}},this.networkControllerClient={switchCaipNetwork:async t=>await this.switchCaipNetwork(t),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},Q.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(it.getProviderId(T.state.activeChain)===fi.CONNECTOR_TYPE_WALLET_CONNECT){const n=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(t){if(!t)return;const n=t.chainNamespace;if(this.getAddressByChainNamespace(t.chainNamespace)){const s=it.getProvider(n),i=it.getProviderId(n);if(t.chainNamespace===T.state.activeChain)await this.getAdapter(n)?.switchNetwork({caipNetwork:t,provider:s,providerType:i});else if(this.setCaipNetwork(t),i===fi.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:t.id,chainNamespace:n})}}else this.setCaipNetwork(t)}getChainsFromNamespaces(t={}){return Object.values(t).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=An.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(t){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{const s=t?.find(i=>i.namespace===r);return s?(s.construct({namespace:r,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),n[r]=s):n[r]=new vz({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(t){this.onConnectors(t),this.listenAdapter(t),await this.chainAdapters?.[t].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(t)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async t=>{await this.initChainAdapter(t)}))}onConnectors(t){this.getAdapter(t)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(t){const n=this.getAdapter(t);if(!n)return;const r=V.getConnectionStatus();z.state.enableReconnect===!1?this.setStatus("disconnected",t):r==="connected"?this.setStatus("connecting",t):r==="disconnected"?(V.clearAddressCache(),this.setStatus(r,t)):this.setStatus(r,t),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=T.state.activeChain===t,c=T.state.chains.get(t)?.accountState?.address;if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:t})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(Q.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:t,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,t)}),n.on("pendingTransactions",()=>{const s=ae.state.address,i=T.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{const a=T.state.activeChain===t;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o.provider,chainNamespace:t}),this.syncConnectedWalletInfo(t)),a&&i?this.syncAccount({address:s,chainId:i,chainNamespace:t}):a&&T.state.activeCaipNetwork?.id?this.syncAccount({address:s,chainId:T.state.activeCaipNetwork?.id,chainNamespace:t}):this.syncAccountInfo(s,i,t),V.addConnectedNamespace(t)})}async createUniversalProviderForAdapter(t){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[t]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(t=>this.syncNamespaceConnection(t)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(t=>Q.disconnect({namespace:t,initialDisconnect:!0})))}catch(t){console.error("Error disconnecting existing connections:",t)}}async syncNamespaceConnection(t){try{t===q.CHAIN.EVM&&ce.isSafeApp()&&X.setConnectorId(q.CONNECTOR_ID.SAFE,t);const n=X.getConnectorId(t);switch(this.setStatus("connecting",t),n){case q.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case q.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(t)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",t)}}onDisconnectNamespace(t){const{chainNamespace:n,closeModal:r}=t||{};T.resetAccount(n),T.resetNetwork(n),V.removeConnectedNamespace(n);const s=Array.from(T.state.chains.keys());(n?[n]:s).forEach(o=>V.addDisconnectedConnectorId(X.getConnectorId(o)||"",o)),X.removeConnectorId(n),it.resetChain(n),this.setUser(void 0,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(void 0,n),r!==!1&&Ae.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(t=>{const n=this.getCaipAddress(t),r=this.getCaipNetwork(t);return this.chainAdapters?.[t].syncConnections({connectToFirstConnector:!n,caipNetwork:r,getConnectorStorageInfo(s){const o=V.getConnections()[t]??[];return{hasDisconnected:V.isConnectorDisconnected(s,t),hasConnected:o.some(a=>In.isLowerCaseMatch(a.connectorId,s))}}})}))}async syncAdapterConnection(t){const n=this.getAdapter(t),r=X.getConnectorId(t),s=this.getCaipNetwork(t),o=X.getConnectors(t).find(a=>a.id===r);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${t}`);if(!s?.id)throw new Error("CaipNetwork not found");const a=await n?.syncConnection({namespace:t,id:o.id,chainId:s.id,rpcUrl:s?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:t}),await this.syncAccount({...a,chainNamespace:t}),this.setStatus("connected",t)):this.setStatus("disconnected",t)}catch{this.onDisconnectNamespace({chainNamespace:t,closeModal:!1})}}async syncWalletConnectAccount(){const t=Object.keys(this.universalProvider?.session?.namespaces||{}),n=this.chainNamespaces.map(async r=>{const s=this.getAdapter(r);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=T.state.activeCaipNetwork?.id,a=i.find(c=>{const{chainId:l}=An.parseCaipAddress(c);return l===o?.toString()})||i[0];if(a){const c=An.validateCaipAddress(a),{chainId:l,address:u}=An.parseCaipAddress(c);if(it.setProviderId(r,fi.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&T.state.activeCaipNetwork&&s.namespace!==q.CHAIN.EVM){const d=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:T.state.activeCaipNetwork});it.setProvider(r,d)}else it.setProvider(r,this.universalProvider);X.setConnectorId(q.CONNECTOR_ID.WALLET_CONNECT,r),V.addConnectedNamespace(r),await this.syncAccount({address:u,chainId:l,chainNamespace:r})}else t.includes(r)&&this.setStatus("disconnected",r);this.syncConnectedWalletInfo(r),await T.setApprovedCaipNetworksData(r)});await Promise.all(n)}syncProvider({type:t,provider:n,id:r,chainNamespace:s}){it.setProviderId(s,t),it.setProvider(s,n),X.setConnectorId(r,s)}async syncAccount(t){const n=t.chainNamespace===T.state.activeChain,r=T.getCaipNetworkByNamespace(t.chainNamespace,t.chainId),{address:s,chainId:i,chainNamespace:o}=t,{chainId:a}=V.getActiveNetworkProps(),c=i||a,l=T.state.activeCaipNetwork?.name===q.UNSUPPORTED_NETWORK_NAME,u=T.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(f=>f.id.toString()===c.toString()),h=this.getCaipNetworks().find(f=>f.chainNamespace===o);if(!u&&!d&&!h){const f=this.getApprovedCaipNetworkIds()||[],g=f.find(b=>An.parseCaipNetworkId(b)?.chainId===c.toString()),w=f.find(b=>An.parseCaipNetworkId(b)?.chainNamespace===o);d=this.getCaipNetworks().find(b=>b.caipNetworkId===g),h=this.getCaipNetworks().find(b=>b.caipNetworkId===w||"deprecatedCaipNetworkId"in b&&b.deprecatedCaipNetworkId===w)}const p=d||h;p?.chainNamespace===T.state.activeChain?z.state.enableNetworkSwitch&&!z.state.allowUnsupportedChain&&T.state.activeCaipNetwork?.name===q.UNSUPPORTED_NETWORK_NAME?T.showUnsupportedChainUI():this.setCaipNetwork(p):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o),In.isLowerCaseMatch(s,ae.state.address)||this.syncAccountInfo(s,p?.id,o),n?await this.syncBalance({address:s,chainId:p?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r?.id,chainNamespace:o})}}async syncAccountInfo(t,n,r){const s=this.getCaipAddress(r),i=n||s?.split(":")[1];if(!i)return;const o=`${r}:${i}:${t}`;this.setCaipAddress(o,r),await this.syncIdentity({address:t,chainId:i,chainNamespace:r})}async syncReownName(t,n){try{const r=await this.getReownName(t);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(t){const n=X.getConnectorId(t),r=it.getProviderId(t);if(r===fi.CONNECTOR_TYPE_ANNOUNCED||r===fi.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{const a=o.id===n,c=o.info?.rdns===n,l=o.connectors?.some(u=>u.id===n||u.info?.rdns===n);return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},t)}}}else if(r===fi.CONNECTOR_TYPE_WALLET_CONNECT){const s=it.getProvider(t);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},t)}else if(n&&(n===q.CONNECTOR_ID.COINBASE_SDK||n===q.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===n),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},t)}}async syncBalance(t){!VA.getNetworksByNamespace(this.getCaipNetworks(),t.chainNamespace).find(r=>r.id.toString()===t.chainId?.toString())||!t.chainId||await this.updateNativeBalance(t.address,t.chainId,t.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(t,n,r){const s=this.getAdapter(r),i=T.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:t,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){const t=zH.createLogger((r,...s)=>{r&&this.handleAlertError(r),console.error(...s)}),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:t};z.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await qA.init(n),z.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(t=>{ns.listenWcProvider({universalProvider:this.universalProvider,namespace:t,onDisplayUri:n=>{Q.setUri(n)},onConnect:()=>{Q.finalizeWcConnection()},onDisconnect:()=>{T.state.noAdapters&&this.resetAccount(t),Q.resetWcConnection()},onChainChanged:n=>{const r=T.state.activeChain,s=r&&X.state.activeConnectorIds[r]===q.CONNECTOR_ID.WALLET_CONNECT;if(r===t&&(T.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=T.state.activeChain,s=r&&X.state.activeConnectorIds[r]===q.CONNECTOR_ID.WALLET_CONNECT;if(r===t&&(T.state.noAdapters||s)&&n.length>0){const i=n[0];this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&ce.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(t){He.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:t instanceof Error?t.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",t)}return this.universalProvider}handleAlertError(t){const n=Object.entries(Bn.UniversalProviderErrors).find(([,{message:a}])=>t.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=Bn.ALERT_ERRORS[o];a&&(Ft.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(t){if(t)return this.chainAdapters?.[t]}createAdapter(t){if(!t)return;const n=t.namespace;if(!n)return;this.createClients();const r=t;r.namespace=n,r.construct({namespace:n,projectId:this.options?.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(t){if(await this.injectModalUi(),t?.uri&&Q.setUri(t.uri),t?.arguments)switch(t?.view){case"Swap":return Ae.open({...t,data:{swap:t.arguments}})}return Ae.open(t)}async close(){await this.injectModalUi(),Ae.close()}setLoading(t,n){Ae.setLoading(t,n)}async disconnect(t){await Q.disconnect({namespace:t})}getSIWX(){return z.state.siwx}getError(){return""}getChainId(){return T.state.activeCaipNetwork?.id}async switchNetwork(t){const n=this.getCaipNetworks().find(r=>r.id===t.id);if(!n){Ft.open(Bn.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await T.switchActiveNetwork(n)}getWalletProvider(){return T.state.activeChain?it.state.providers[T.state.activeChain]:null}getWalletProviderType(){return it.getProviderId(T.state.activeChain)}subscribeProviders(t){return it.subscribeProviders(t)}getThemeMode(){return vn.state.themeMode}getThemeVariables(){return vn.state.themeVariables}setThemeMode(t){vn.setThemeMode(t),b2(vn.state.themeMode)}setTermsConditionsUrl(t){z.setTermsConditionsUrl(t)}setPrivacyPolicyUrl(t){z.setPrivacyPolicyUrl(t)}setThemeVariables(t){vn.setThemeVariables(t),hz(vn.state.themeVariables)}subscribeTheme(t){return vn.subscribe(t)}subscribeConnections(t){return this.remoteFeatures.multiWallet?Q.subscribe(t):(Ft.open(q.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(t){return t?T.state.chains.get(t)?.accountState?.connectedWalletInfo:ae.state.connectedWalletInfo}getAccount(t){const n=t||T.state.activeChain,r=X.getAuthConnector(n),s=T.getAccountData(n),i=V.getConnectedConnectorId(T.state.activeChain),o=Q.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u})=>ce.createAccount(n,l,u||"eoa")));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:ce.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===q.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:V.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:kr(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(t,n){const r=()=>{const s=this.getAccount(n);s&&t(s)};n?T.subscribeChainProp("accountState",r,n):T.subscribe(r),X.subscribe(r)}subscribeNetwork(t){return T.subscribe(({activeCaipNetwork:n})=>{t({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})})}subscribeWalletInfo(t,n){return n?ae.subscribeKey("connectedWalletInfo",t,n):ae.subscribeKey("connectedWalletInfo",t)}subscribeShouldUpdateToAddress(t){ae.subscribeKey("shouldUpdateToAddress",t)}subscribeCaipNetworkChange(t){T.subscribeKey("activeCaipNetwork",t)}getState(){return Qr.state}getRemoteFeatures(){return z.state.remoteFeatures}subscribeState(t){return Qr.subscribe(t)}subscribeRemoteFeatures(t){return z.subscribeKey("remoteFeatures",t)}showErrorMessage(t){_r.showError(t)}showSuccessMessage(t){_r.showSuccess(t)}getEvent(){return{...He.state}}subscribeEvents(t){return He.subscribe(t)}replace(t){pe.replace(t)}redirect(t){pe.push(t)}popTransactionStack(t){pe.popTransactionStack(t)}isOpen(){return Ae.state.open}isTransactionStackEmpty(){return pe.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(t){z.setFeatures(t)}updateRemoteFeatures(t){z.setRemoteFeatures(t)}updateOptions(t){const r={...z.state||{},...t};z.setOptions(r)}setConnectMethodsOrder(t){z.setConnectMethodsOrder(t)}setWalletFeaturesOrder(t){z.setWalletFeaturesOrder(t)}setCollapseWallets(t){z.setCollapseWallets(t)}setSocialsOrder(t){z.setSocialsOrder(t)}getConnectMethodsOrder(){return Wp.getConnectOrderMethod(z.state.features,X.getConnectors())}addNetwork(t,n){if(this.chainAdapters&&!this.chainAdapters[t])throw new Error(`Adapter for namespace ${t} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||T.addNetwork(r)}removeNetwork(t,n){if(this.chainAdapters&&!this.chainAdapters[t])throw new Error(`Adapter for namespace ${t} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&T.removeNetwork(t,n)}}let Sv=!1;class Iz extends Az{async open(t){X.isConnected()||await super.open(t)}async close(){await super.close(),this.options.manualWCControl&&Q.finalizeWcConnection()}async syncIdentity(t){return Promise.resolve()}async syncBalance(t){return Promise.resolve()}async injectModalUi(){if(!Sv&&ce.isClient()){if(await pc(()=>import("./basic-BmnceGGO.js"),__vite__mapDeps([0,1])),await pc(()=>import("./w3m-modal-DnaL-6Xa.js"),__vite__mapDeps([2,1])),!document.querySelector("w3m-modal")){const n=document.createElement("w3m-modal");!z.state.disableAppend&&!z.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",n)}Sv=!0}}}const Sz="1.7.17";function xz(e){return new Iz({...e,basic:!0,sdkVersion:`html-core-${Sz}`})}class ww{constructor({appKit:t,provider:n,config:r}){this.appKit=t,this.provider=n,this.config=r}static async init(t){const n=await cF.init({projectId:t.projectId,metadata:t.metadata}),r={networks:t.networks.flatMap(i=>i.chains),projectId:t.projectId,metadata:t.metadata,universalProvider:n,manualWCControl:!0},s=xz(r);return new ww({appKit:s,provider:n,config:t})}async connect(){const t=this.config?.networks.reduce((n,r)=>(n[r.namespace]={...r||{},methods:r?.methods||[],events:r?.events||[],chains:r?.chains?.map(s=>s.caipNetworkId)||[]},n),{});try{await this.appKit.open();const n=await this.provider.connect({optionalNamespaces:t});if(!n)throw new Error("Error connecting to wallet: No session found");return await this.appKit.close(),{session:n}}catch(n){throw await this.appKit.close(),new Error(`Error connecting to wallet: ${n instanceof Error?n.message:"Unknown error"}`)}}async disconnect(){await this.appKit.disconnect(),await this.provider.disconnect()}async request(t,n){return await this.provider.request(t,n)}}var E2=Object.defineProperty,Nz=Object.defineProperties,_z=Object.getOwnPropertyDescriptors,id=Object.getOwnPropertySymbols,C2=Object.prototype.hasOwnProperty,A2=Object.prototype.propertyIsEnumerable,xv=(e,t,n)=>t in e?E2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ct=(e,t)=>{for(var n in t||(t={}))C2.call(t,n)&&xv(e,n,t[n]);if(id)for(var n of id(t))A2.call(t,n)&&xv(e,n,t[n]);return e},lr=(e,t)=>Nz(e,_z(t)),Tz=(e,t)=>{var n={};for(var r in e)C2.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&id)for(var r of id(e))t.indexOf(r)<0&&A2.call(e,r)&&(n[r]=e[r]);return n},Oz=(e,t)=>{for(var n in t)E2(e,n,{get:t[n],enumerable:!0})},yi=class I2 extends Error{constructor(t,n,r,s){super(t),this.message=t,this.code=n,this.data=r,this.cause=s,this.name="JsonRpcError",this.message=t,this.code=n,this.data=r,this.cause=s}static fromResponse(t){return new I2(t.message,t.code,t.data)}toString(){return`${this.name} (${this.code}): ${this.message}${this.data?`: ${JSON.stringify(this.data)}`:""}`}},Dz=(e=>(e[e.ParseError=-32700]="ParseError",e[e.InvalidRequest=-32600]="InvalidRequest",e[e.MethodNotFound=-32601]="MethodNotFound",e[e.InvalidParams=-32602]="InvalidParams",e[e.InternalError=-32603]="InternalError",e[e.UserRejection=-32e3]="UserRejection",e[e.MethodAddressMismatch=-32001]="MethodAddressMismatch",e[e.MethodAccessDenied=-32002]="MethodAccessDenied",e[e.UnknownError=-31e3]="UnknownError",e[e.UserCanceled=-31001]="UserCanceled",e))(Dz||{}),S2="asigna-stx",wf=(e,t)=>new Promise(n=>{function r(s){s.data.source===S2&&s.data[t]&&(n(s.data[t]),window.removeEventListener("message",r))}window.addEventListener("message",r),window.top.postMessage(Pz(e,t),"*")}),$z={authenticationRequest:async e=>wf(e,"authenticationRequest"),transactionRequest:async e=>wf(e,"transactionRequest"),request:async(e,t)=>wf(t,e)},Pz=(e,t)=>({source:S2,[t]:e}),kz=()=>{typeof window>"u"||window.top!==window.self&&(window.AsignaProvider=$z)};kz();var Uz=[{id:"LeatherProvider",name:"Leather",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iMjYuODM4NyIgZmlsbD0iIzEyMTAwRiIvPgo8cGF0aCBkPSJNNzQuOTE3MSA1Mi43MTE0QzgyLjQ3NjYgNTEuNTQwOCA5My40MDg3IDQzLjU4MDQgOTMuNDA4NyAzNy4zNzYxQzkzLjQwODcgMzUuNTAzMSA5MS44OTY4IDM0LjIxNTQgODkuNjg3MSAzNC4yMTU0Qzg1LjUwMDQgMzQuMjE1NCA3OC40MDYxIDQwLjUzNjggNzQuOTE3MSA1Mi43MTE0Wk0zOS45MTEgODMuNDk5MUMzMC4wMjU2IDgzLjQ5OTEgMjkuMjExNSA5My4zMzI0IDM5LjA5NjkgOTMuMzMyNEM0My41MTYzIDkzLjMzMjQgNDguODY2MSA5MS41NzY0IDUxLjY1NzMgODguNDE1N0M0Ny41ODY4IDg0LjkwMzggNDQuMjE0MSA4My40OTkxIDM5LjkxMSA4My40OTkxWk0xMDIuODI5IDc5LjI4NDhDMTAzLjQxIDk1Ljc5MDcgOTUuMDM2OSAxMDUuMDM5IDgwLjg0ODQgMTA1LjAzOUM3Mi40NzQ4IDEwNS4wMzkgNjguMjg4MSAxMDEuODc4IDU5LjMzMyA5Ni4wMjQ5QzU0LjY4MSAxMDEuMTc2IDQ1Ljg0MjMgMTA1LjAzOSAzOC41MTU0IDEwNS4wMzlDMTMuMjc4NSAxMDUuMDM5IDE0LjMyNTIgNzIuODQ2MyA0MC4wMjczIDcyLjg0NjNDNDUuMzc3MSA3Mi44NDYzIDQ5LjkxMjggNzQuMjUxMSA1NS43Mjc3IDc3Ljg4TDU5LjU2NTYgNjQuNDE3N0M0My43NDg5IDYwLjA4NjQgMzUuODQwNSA0Ny45MTE4IDQzLjYzMjYgMzAuNDY5M0g1Ni4xOTI5QzQ5LjIxNSA0Mi4wNTg2IDUzLjk4MzIgNTEuNjU3OCA2Mi44MjIgNTIuNzExNEM2Ny41OTAzIDM1LjczNzIgNzcuODI0NiAyMi41MDkgOTEuNDMxNiAyMi41MDlDOTkuMTA3NCAyMi41MDkgMTA1LjE1NSAyNy41NDI4IDEwNS4xNTUgMzYuNjczN0MxMDUuMTU1IDUxLjMwNjYgODYuMDgxOSA2My4yNDcxIDcxLjY2MDcgNjQuNDE3N0w2NS43Mjk1IDg1LjM3MjFDNzIuNDc0OCA5My4yMTUzIDkxLjE5OSAxMDAuODI0IDkxLjE5OSA3OS4yODQ4SDEwMi44MjlaIiBmaWxsPSIjRjVGMUVEIi8+Cjwvc3ZnPgo=",webUrl:"https://leather.io",chromeWebStoreUrl:"https://chrome.google.com/webstore/detail/hiro-wallet/ldinpeekobnhjjdofggfgjlcehhmanlj",mozillaAddOnsUrl:"https://leather.io/install-extension"},{id:"XverseProviders.BitcoinProvider",name:"Xverse Wallet",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MDAiIGhlaWdodD0iNjAwIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGZpbGw9IiMxNzE3MTciIGQ9Ik0wIDBoNjAwdjYwMEgweiIvPjxwYXRoIGZpbGw9IiNGRkYiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTQ0MCA0MzUuNHYtNTFjMC0yLS44LTMuOS0yLjItNS4zTDIyMCAxNjIuMmE3LjYgNy42IDAgMCAwLTUuNC0yLjJoLTUxLjFjLTIuNSAwLTQuNiAyLTQuNiA0LjZ2NDcuM2MwIDIgLjggNCAyLjIgNS40bDc4LjIgNzcuOGE0LjYgNC42IDAgMCAxIDAgNi41bC03OSA3OC43Yy0xIC45LTEuNCAyLTEuNCAzLjJ2NTJjMCAyLjQgMiA0LjUgNC42IDQuNUgyNDljMi42IDAgNC42LTIgNC42LTQuNlY0MDVjMC0xLjIuNS0yLjQgMS40LTMuM2w0Mi40LTQyLjJhNC42IDQuNiAwIDAgMSA2LjQgMGw3OC43IDc4LjRhNy42IDcuNiAwIDAgMCA1LjQgMi4yaDQ3LjVjMi41IDAgNC42LTIgNC42LTQuNloiLz48cGF0aCBmaWxsPSIjRUU3QTMwIiBmaWxsLXJ1bGU9Im5vbnplcm8iIGQ9Ik0zMjUuNiAyMjcuMmg0Mi44YzIuNiAwIDQuNiAyLjEgNC42IDQuNnY0Mi42YzAgNCA1IDYuMSA4IDMuMmw1OC43LTU4LjVjLjgtLjggMS4zLTIgMS4zLTMuMnYtNTEuMmMwLTIuNi0yLTQuNi00LjYtNC42TDM4NCAxNjBjLTEuMiAwLTIuNC41LTMuMyAxLjNsLTU4LjQgNTguMWE0LjYgNC42IDAgMCAwIDMuMiA3LjhaIi8+PC9nPjwvc3ZnPg==",webUrl:"https://xverse.app",chromeWebStoreUrl:"https://chrome.google.com/webstore/detail/xverse-wallet/idnnbdplmphpflfnlkomgpfbpcgelopg",googlePlayStoreUrl:"https://play.google.com/store/apps/details?id=com.secretkeylabs.xverse",iOSAppStoreUrl:"https://apps.apple.com/app/xverse-bitcoin-web3-wallet/id1552272513",mozillaAddOnsUrl:"https://www.xverse.app/download"},{id:"AsignaProvider",name:"Asigna Multisig",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iIzAwMDEwMCIgZD0iTTAgMGgzMnYzMkgweiIvPjxwYXRoIGZpbGw9InVybCgjYSkiIGQ9Ik0xNS4xMSA1LjU1YTMgMyAwIDAgMC0xLjgyIDEuM2wtLjA1LjA4LS40My43Mi0uMDcuMTEtLjUuODUtLjA1LjA5LTEuMjkgMi4xOC0uMDQuMDctLjQ3LjgtLjA2LjEtLjQ2Ljc4LS4wNy4xMS0xLjYzIDIuNzYtLjA3LjExLS4zOC42Ni0uMDUuMDgtLjczIDEuMjQtLjM1LjYtLjQuNjctLjA1LjA5TDUuMSAyMC43bC0uMTEuMTgtLjE0LjIzLS4wNy4xMy0uMzMuNTUtLjA0LjA3di4wMWExLjI2IDEuMjYgMCAwIDAtLjE0LjQ3IDEuMzEgMS4zMSAwIDAgMCAxLjI0IDEuNGgxLjVsLjA1LS4wNi4wNC0uMDYuODctMS4yMS4wNS0uMDguNzctMS4wNy4wNS0uMDcuNC0uNTcuMDUtLjA2LjI0LS4zNGExLjUyIDEuNTIgMCAwIDEgMS4zOS0uNjIgMS41IDEuNSAwIDAgMSAuNjQuMiAxLjQ3IDEuNDcgMCAwIDEgLjczIDEuMjcgMS40NCAxLjQ0IDAgMCAxLS4yNy44NGwtLjYzLjg4LS4wNS4wNy0uMzIuNDUtLjA2LjA4LS4wOC4xMi0uMTIuMTYtLjA1LjA4aDIuMTNhMi4zMiAyLjMyIDAgMCAwIDEuNzctLjk2bDEuMTgtMS42My43Ny0xLjA4IDEuMy0xLjhhMS4yNCAxLjI0IDAgMCAxIC41NS0uNDNsLjA4LS4wM2ExLjMgMS4zIDAgMCAxIC4zLS4wNiAxLjI4IDEuMjggMCAwIDEgMS4xNS41NGwuMTEuMmExLjEzIDEuMTMgMCAwIDEgLjEuNDEgMS4xOSAxLjE5IDAgMCAxLS4yMy43N2wtLjAzLjA1LS41Ny44LS43Ljk4LS4yNy4zN2ExLjIyIDEuMjIgMCAwIDAtLjIuNSAxLjA1IDEuMDUgMCAwIDAtLjAyLjIzdi4wNmExLjE3IDEuMTcgMCAwIDAgLjE0LjQzbC4wMi4wNS4wNy4xYTEuNDQgMS40NCAwIDAgMCAuMS4xMWwuMDUuMDYuMDEuMDFhMS44IDEuOCAwIDAgMCAuMTQuMWMwIC4wMi4wMi4wMy4wNC4wM2ExIDEgMCAwIDAgLjA4LjA1bC4wNy4wNGExLjI1IDEuMjUgMCAwIDAgLjUuMWg2LjljLjEgMCAuMi0uMDEuMjktLjAzbC4wNi0uMDJhMS4yNyAxLjI3IDAgMCAwIC4yNy0uMS41Ny41NyAwIDAgMCAuMDctLjAzIDEuMjEgMS4yMSAwIDAgMCAuMjYtLjE5bC4wOC0uMDdhLjkyLjkyIDAgMCAwIC4xNS0uMTkgMS41NSAxLjU1IDAgMCAwIC4wOS0uMTdsLjAyLS4wNWExLjIyIDEuMjIgMCAwIDAgLjA4LS4yNnYtLjA0bC4wMi0uMDh2LS4wOGExLjMyIDEuMzIgMCAwIDAtLjItLjc0bC0xLjYtMi42NC0uMDYtLjEtLjItLjMyLS4zMy0uNTR2LS4wMWwtLjA1LS4wOC0xLjMtMi4xNS0uMDctLjEtLjA0LS4wNi0uOC0xLjMyLS4wNC0uMDctLjItLjM0LS4xLS4xNC0uMS0uMTYtLjUzLS45LS4xMy0uMi0uMDktLjE0LTIuMTctMy41Ny0uMDQtLjA3LS43Mi0xLjE5LS4wNS0uMDctLjQtLjY1YTIuNjUgMi42NSAwIDAgMC0uMy0uNCAyLjk2IDIuOTYgMCAwIDAtLjk3LS43NCAzLjA0IDMuMDQgMCAwIDAtMS4zLS4zYy0uMjUgMC0uNS4wNC0uNzQuMVoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMTkgMTYuM2E1LjQ1IDUuNDUgMCAwIDAtLjgzIDEuNTZsLS4wNC4xNWExLjM2IDEuMzYgMCAwIDEgLjI4LS4xNiAxLjI0IDEuMjQgMCAwIDEgLjM4LS4wOGguMWExLjI4IDEuMjggMCAwIDEgMS4wNS41NGMuMDQuMDYuMDguMTMuMS4yYTEuMjQgMS4yNCAwIDAgMSAuMDkuMjcgMS4xOSAxLjE5IDAgMCAxLS4yLjkxbC0uMDQuMDUtLjU3Ljc5LS43Ljk5LS4yNy4zN2ExLjIzIDEuMjMgMCAwIDAtLjIuNDIgMS4wNiAxLjA2IDAgMCAwLS4wMi4zMXYuMDZhMS4xNyAxLjE3IDAgMCAwIC4xNi40Ny45My45MyAwIDAgMCAuMDcuMSAxLjUgMS41IDAgMCAwIC4xLjEybC4wNS4wNmguMDFhMS45NCAxLjk0IDAgMCAwIC4wOS4wOCAxIDEgMCAwIDAgLjE3LjFsLjA3LjA0YTEuMjUgMS4yNSAwIDAgMCAuNS4xaDYuOWMuMSAwIC4yIDAgLjI4LS4wMmwuMDctLjAyYTEuMzIgMS4zMiAwIDAgMCAuMzQtLjEzbC4xNi0uMS4wMy0uMDNhMS4yOSAxLjI5IDAgMCAwIC4yLS4yIDIuNDMgMi40MyAwIDAgMCAuMTItLjE3Yy4wMy0uMDMuMDUtLjA4LjA3LS4xMmwuMDItLjA1YTEuMjEgMS4yMSAwIDAgMCAuMDktLjN2LS4wOGwuMDEtLjA5YTEuMzIgMS4zMiAwIDAgMC0uMi0uNzNsLTEuNi0yLjY0LS4wNi0uMS0uMi0uMzItLjMzLS41NHYtLjAybC0uMDUtLjA3LTEuMy0yLjE1LS4xMi0uMDctLjA3LS4wNGE0Ljk0IDQuOTQgMCAwIDAtMi40Ni0uNjdjLTEuMDMgMC0xLjc2LjU3LTIuMjYgMS4yWiIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi4yOSAyMS4wOGMwIC4yOS0uMDkuNTgtLjI3Ljg0bC0xLjMxIDEuODRIN2wyLjUyLTMuNTNhMS41NCAxLjU0IDAgMCAxIDIuMS0uMzZjLjQzLjI4LjY2Ljc0LjY2IDEuMloiLz48cGF0aCBmaWxsPSIjMDAwIiBkPSJNMTEuMTYgMjEuMjVhLjU2LjU2IDAgMCAxLS41Ny41NS41Ni41NiAwIDAgMS0uNTctLjU2LjU2LjU2IDAgMCAxIC41Ny0uNTUuNTYuNTYgMCAwIDEgLjU3LjU2WiIvPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9IjE1LjIzIiB4Mj0iMTkuMyIgeTE9IjI1Ljc4IiB5Mj0iNi4xMSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiM2NTIyRjQiLz48c3RvcCBvZmZzZXQ9Ii41NSIgc3RvcC1jb2xvcj0iIzlCNkJGRiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iI0E1ODVGRiIvPjwvbGluZWFyR3JhZGllbnQ+PGxpbmVhckdyYWRpZW50IGlkPSJiIiB4MT0iMjIuNTkiIHgyPSIyNC44IiB5MT0iMjQuNzEiIHkyPSIxNS41MyIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiM0MjFGOEIiLz48c3RvcCBvZmZzZXQ9Ii41NSIgc3RvcC1jb2xvcj0iIzcyMzBGRiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzk3NzNGRiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjwvc3ZnPg==",webUrl:"https://asigna.io",chromeWebStoreUrl:"https://stx.asigna.io/"},{id:"FordefiProviders.UtxoProvider",name:"Fordefi",icon:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDIiIGhlaWdodD0iNDIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZmlsbD0iIzEwMTExNCIgZD0iTTAgMGg0MnY0MkgweiIvPgogIDxwYXRoIGQ9Ik0xOS40NyAyNi44OUg1djMuNTdhNC41NyA0LjU3IDAgMCAwIDQuNTggNC41N2g1LjgzbDQuMDYtOC4xNFoiIGZpbGw9IiM3OTk0RkYiLz4KICA8cGF0aCBkPSJNNSAxNy40aDI3LjU4bC0zLjIgNi43OEg1VjE3LjRaIiBmaWxsPSIjNDg2REZGIi8+CiAgPHBhdGggZD0iTTE0LjY3IDdINXY3LjY4aDMzVjdoLTkuNjd2NS43NGgtMlY3aC05LjY3djUuNzRoLTEuOTlWN1oiIGZpbGw9IiM1Q0QxRkEiLz4KPC9zdmc+Cg==",webUrl:"https://www.fordefi.com/",chromeWebStoreUrl:"https://chromewebstore.google.com/detail/fordefi/hcmehenccjdmfbojapcbcofkgdpbnlle"}],Nv={id:"WalletConnectProvider",name:"WalletConnect",icon:"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MDAiIGhlaWdodD0iNDAwIiBmaWxsPSJub25lIj48bWFzayBpZD0iYSIgd2lkdGg9IjQwMCIgaGVpZ2h0PSI0MDAiIHg9IjAiIHk9IjAiIG1hc2tVbml0cz0idXNlclNwYWNlT25Vc2UiIHN0eWxlPSJtYXNrLXR5cGU6bHVtaW5hbmNlIj48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMCAwaDQwMHY0MDBIMFYwWiIvPjwvbWFzaz48ZyBtYXNrPSJ1cmwoI2EpIj48cGF0aCBmaWxsPSIjMzM5NkZGIiBkPSJNNDAwIDQwMEgwVjBoNDAwdjQwMFoiLz48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTIyLjUyIDE0OC45N2M0Mi43OS00MS43MyAxMTIuMTctNDEuNzMgMTU0Ljk2IDBsNS4xNSA1LjAyYTUuMjUgNS4yNSAwIDAgMSAwIDcuNTVsLTE3LjYyIDE3LjE4YTIuNzkgMi43OSAwIDAgMS0zLjg3IDBsLTcuMDktNi45Yy0yOS44NS0yOS4xMi03OC4yNS0yOS4xMi0xMDguMSAwbC03LjYgNy40YTIuNzkgMi43OSAwIDAgMS0zLjg3IDBsLTE3LjYxLTE3LjE5YTUuMjUgNS4yNSAwIDAgMSAwLTcuNTVsNS42NS01LjUxWm0xOTEuNCAzNS41MiAxNS42OCAxNS4zYTUuMjUgNS4yNSAwIDAgMSAwIDcuNTVsLTcwLjcgNjguOTRhNS41OCA1LjU4IDAgMCAxLTcuNzUgMGwtNTAuMTgtNDguOTNhMS40IDEuNCAwIDAgMC0xLjk0IDBsLTUwLjE4IDQ4LjkzYTUuNTggNS41OCAwIDAgMS03Ljc0IDBsLTcwLjctNjguOTRhNS4yNSA1LjI1IDAgMCAxIDAtNy41NmwxNS42Ny0xNS4yOWE1LjU4IDUuNTggMCAwIDEgNy43NSAwbDUwLjE4IDQ4Ljk0Yy41NC41MiAxLjQuNTIgMS45NCAwbDUwLjE4LTQ4Ljk0YTUuNTggNS41OCAwIDAgMSA3Ljc0IDBsNTAuMTggNDguOTRjLjU0LjUyIDEuNC41MiAxLjk0IDBsNTAuMTgtNDguOTRhNS41OCA1LjU4IDAgMCAxIDcuNzUgMFoiLz48L2c+PC9zdmc+",webUrl:"https://walletconnect.com/",chromeWebStoreUrl:""};function Rz(){return ld(Wv())||window.StacksProvider||window.BlockstackProvider}function gu(e,t){var n,r;return e instanceof t||((r=(n=e?.constructor)==null?void 0:n.name)==null?void 0:r.toLowerCase())===t.name}function Bz(e){return e?typeof e=="string"?e:gu(e,J1)?"mainnet":gu(e,X1)?"testnet":gu(e,Q1)||gu(e,Ig)?"devnet":"coreApiUrl"in e?e.coreApiUrl:"url"in e?e.url:"transactionVersion"in e?e.transactionVersion===Ui.Mainnet?"mainnet":"testnet":"mainnet":"mainnet"}function $o(e){if(typeof e.type=="string")return e;switch(e.type){case xe.BoolFalse:return _0(!1);case xe.BoolTrue:return _0(!0);case xe.Int:return t3(e.value);case xe.UInt:return n3(e.value);case xe.Buffer:return c3(e.buffer);case xe.StringASCII:return o3(e.data);case xe.StringUTF8:return a3(e.data);case xe.List:return i3(e.list.map($o));case xe.Tuple:return f3(Object.fromEntries(Object.entries(e.data).map(([n,r])=>[n,$o(r)])));case xe.OptionalNone:return l3();case xe.OptionalSome:return u3($o(e.value));case xe.ResponseErr:return h3($o(e.value));case xe.ResponseOk:return d3($o(e.value));case xe.PrincipalContract:return r3(N0(e.address),e.contractName.content);case xe.PrincipalStandard:return s3(N0(e.address));default:let t=e;throw new Error(`Unknown clarity type: ${t}`)}}var Mz="stx_callContract",Lz=e=>{var t;let n=(t=e.functionArgs)==null?void 0:t.map(r=>typeof r=="string"?p3(r):$o(r)).map(r=>zf(r));return lr(Ct({},e),{contract:`${e.contractAddress}.${e.contractName}`,functionArgs:n,network:Bz(e.network),postConditionMode:Hz(e.postConditionMode),postConditions:Fz(e.postConditions),address:e.stxAddress})},jz=e=>({txId:e.txid,txRaw:e.transaction,stacksTransaction:X_(e.transaction)});function x2(e,t=Rz()){Xz(Mz,Lz,jz)(e,t)}function Fz(e){if(typeof e<"u")return e.map(t=>typeof t=="string"?t:typeof t.type=="string"?lr(Ct({},t),{amount:"amount"in t?t.amount.toString():void 0}):we(R3(t)))}function Hz(e){if(typeof e<"u"){if(typeof e=="string")return e;switch(e){case qs.Allow:return"allow";case qs.Deny:return"deny";default:let t=e;throw new Error(`Unknown post condition mode: ${t}. Should be one of: 'allow', 'deny'`)}}}var mw="@stacks/connect",zz={addresses:{stx:[],btc:[]},version:"0.0.1"},_v=e=>[...new Map(e.map(t=>[t.address,t])).values()].map(t=>{var n=Tz(t,[]);return"publicKey"in n&&delete n.publicKey,"derivationPath"in n&&delete n.derivationPath,"tweakedPublicKey"in n&&delete n.tweakedPublicKey,n});function qz(e){try{let t=Bd()||zz,n=lr(Ct({},t),{updatedAt:Date.now(),addresses:Ct(Ct({},t.addresses),e.addresses&&{stx:e.addresses.stx&&_v([...t.addresses.stx,...e.addresses.stx]),btc:e.addresses.btc&&_v([...t.addresses.btc,...e.addresses.btc])})});localStorage.setItem(mw,we(ia(JSON.stringify(n))))}catch(t){console.warn("Failed to store data in localStorage:",t)}}function Wz(){try{localStorage.removeItem(mw)}catch(e){console.warn("Failed to clear localStorage:",e)}}function Bd(){try{let e=localStorage.getItem(mw);return e?JSON.parse(ad(Ve(e))):null}catch(e){return console.warn("Failed to get data from localStorage:",e),null}}function N2(){let e=Vv();e&&"disconnect"in e&&e.disconnect(),hS(),Wz(),new oq().store.deleteSessionData()}function ls(){let e=Bd();return e?.addresses.stx.length>0||e?.addresses.btc.length>0}var Vz={};Oz(Vz,{Chains:()=>or,Default:()=>_2,Networks:()=>el});var Kz=["stx_signMessage","stx_signTransaction","stx_signStructuredMessage","stx_getAccounts","stx_getAddresses","stx_updateProfile","stx_transferStx","stx_transferSip10Ft","stx_transferSip9Nft","stx_callContract","stx_deployContract","sendTransfer","signPsbt","getAddresses"],or;(e=>{(t=>(t.Mainnet={id:1,chainNamespace:"stacks",caipNetworkId:"stacks:1",name:"Stacks",nativeCurrency:{name:"STX",symbol:"STX",decimals:6},rpcUrls:{default:{http:["https://api.mainnet.hiro.so"]}}},t.Testnet={id:2,chainNamespace:"stacks",caipNetworkId:"stacks:2147483648",name:"Stacks Testnet",nativeCurrency:{name:"STX",symbol:"STX",decimals:6},rpcUrls:{default:{http:["https://api.testnet.hiro.so"]}}}))(e.Stacks||(e.Stacks={})),(t=>(t.Mainnet=fz,t.Testnet=pz))(e.Bitcoin||(e.Bitcoin={}))})(or||(or={}));var el;(e=>(e.Stacks={namespace:"stacks",chains:[or.Stacks.Mainnet,or.Stacks.Testnet],methods:Kz,events:["stx_chainChanged","stx_accountsChanged"]},e.Bitcoin={namespace:"bip122",chains:[or.Bitcoin.Mainnet],methods:["signMessage","sendTransfer","signPsbt","getAccountAddresses"],events:["bip122_addressesChanged"]}))(el||(el={}));var _2={metadata:{name:"Universal Connector",description:"Universal Connector",url:"https://appkit.reown.com",icons:["https://appkit.reown.com/icon.png"]},networks:[el.Stacks,el.Bitcoin]};function Tv(e){return{jsonrpc:"2.0",id:1,result:e}}var Gz=class{constructor(e){this.connector=e}async connect(){try{let{session:e}=await this.connector.connect();return e}catch(e){throw console.error(">> WalletConnectProvider connect error",e),e}}get stacksAddresses(){var e,t,n,r;let s=(e=this.connector.provider)==null?void 0:e.session;if(!((n=(t=s?.namespaces)==null?void 0:t.stacks)!=null&&n.accounts))return[];let i=(r=s?.sessionProperties)==null?void 0:r.stacks_getAddresses,o=JSON.parse(i||"[]"),a=[...s.namespaces.stacks.accounts.map(c=>({address:c.split(":")[2],publicKey:""}))||[],...o||[]].sort(c=>c.publicKey?1:-1);return Array.from(new Map(a.map(c=>[c.address,c])).values())}get btcAddresses(){var e,t,n;let r=(e=this.connector.provider)==null?void 0:e.session;if(!((n=(t=r?.namespaces)==null?void 0:t.bip122)!=null&&n.accounts))return[];let s=r?.sessionProperties.bip122_getAccountAddresses,i=JSON.parse(s||"{}"),o=r.namespaces.bip122.accounts.map(c=>({address:c.split(":")[2],publicKey:""})),a=[...i?.payment.map(c=>lr(Ct({},c),{purpose:"payment"}))||[],...i?.ordinal.map(c=>lr(Ct({},c),{purpose:"ordinal"}))||[],...o||[]].sort(c=>c.publicKey?1:-1).sort((c,l)=>c?.address.length-l?.address.length);return Array.from(new Map(a.map(c=>[c.address,c])).values())}async getAddresses(){var e;let t=(e=this.connector.provider)==null?void 0:e.session;t||(t=await this.connect());let n=this.stacksAddresses,r=this.btcAddresses;return{addresses:[...n,...r]}}validateRpcMethod(e){var t,n,r,s;if(["getAddresses","stx_getAccounts","stx_getAddresses"].includes(e))return;if(!((t=this.connector.provider)!=null&&t.session))throw new Error("WalletConnectProvider not connected. Please connect first.");let i=(n=this.connector.provider)==null?void 0:n.session.namespaces,o=((r=i.stacks)==null?void 0:r.methods)||[],a=((s=i.bip122)==null?void 0:s.methods)||[];if(![...o,...a].includes(e))throw new Error(`WalletConnectProvider does not support method ${e}. Please use a supported method.`)}getTargetCaipNetworkId(e,t){var n,r,s,i,o,a,c,l;let u=["getAddresses","stx_getAccounts","stx_getAddresses"],d="network"in t?t.network:void 0;if(d)return{mainnet:or.Stacks.Mainnet.caipNetworkId,testnet:or.Stacks.Testnet.caipNetworkId}[d];if(u.includes(e)||(i=(s=(r=(n=this.connector.provider)==null?void 0:n.session)==null?void 0:r.namespaces)==null?void 0:s.stacks)!=null&&i.methods.includes(e))return or.Stacks.Mainnet.caipNetworkId;if((l=(c=(a=(o=this.connector.provider)==null?void 0:o.session)==null?void 0:a.namespaces)==null?void 0:c.bip122)!=null&&l.methods.includes(e))return or.Bitcoin.Mainnet.caipNetworkId;throw new Error(`WalletConnectProvider does not support method ${e}. Please use a supported method.`)}async request(e,t){var n,r,s,i;try{this.validateRpcMethod(e);let o=this.getTargetCaipNetworkId(e,t);switch(e){case"getAddresses":case"stx_getAddresses":case"stx_getAccounts":let a=await this.getAddresses();return Tv(a);case"stx_signMessage":let c=((i=(s=(r=(n=this.connector.provider)==null?void 0:n.session)==null?void 0:r.namespaces)==null?void 0:s.stacks)==null?void 0:i.accounts[0]).split(":")[2],l=await this.connector.request({method:e,params:Ct({address:c},t)},o);return Tv(l);default:return await this.connector.request({method:e,params:t},o)}}catch(o){throw console.error(">> WalletConnectProvider request error",o),o}}async disconnect(){await this.connector.disconnect()}};async function Ov(e){if(window.WalletConnectProvider)return;let{projectId:t,config:n}=typeof e=="string"?{projectId:e,config:void 0}:{projectId:e.projectId,config:e},r=await ww.init(lr(Ct(Ct({},_2),n),{projectId:t})),s=new Gz(r);window.WalletConnectProvider=s}async function Gp(e,t,n){var r;try{let s=await e.request(t,n);if(!s)throw new yi("Provider did not return a response",-31e3);if("error"in s)throw yi.fromResponse(s.error);return s.result}catch(s){if(s instanceof yi)throw s;if("jsonrpc"in s)throw yi.fromResponse(s.error);let i=(r=s.code)!=null?r:-31e3;throw new yi(s.message,i,s.data,s)}}function Yz(e){return e?async function(t,n,r){let s=await Gp(t,n,r);if((n==="getAddresses"||n==="wallet_connect")&&"addresses"in s){let{stx:i,btc:o}=sq(s.addresses).reduce((a,c)=>(a[c.address.startsWith("S")?"stx":"btc"].push(c),a),{stx:[],btc:[]});qz({addresses:{stx:i,btc:o}})}return s}:Gp}async function Zz(...e){var t;let{options:n,method:r,params:s}=Jz(e),i=Object.assign({provider:null,defaultProviders:Uz,forceWalletSelect:!1,persistWalletSelect:!0,enableOverrides:!0,enableLocalStorage:!0},tq(n));i!=null&&i.walletConnect?(await Ov(i.walletConnect).catch(console.error),i.defaultProviders=[...i.defaultProviders,Nv]):i!=null&&i.walletConnectProjectId&&(await Ov(i.walletConnectProjectId).catch(console.error),i.defaultProviders=[...i.defaultProviders,Nv]),i.provider=(t=i.provider)!=null?t:Vv();let o=nq(i.enableOverrides,Yz(i.enableLocalStorage));if(i.provider&&!i.forceWalletSelect){let{method:a,params:c}=Yp(i.provider,r,s,i.enableOverrides);return await o(i.provider,a,Zp(c))}if(typeof window<"u")return sx(),new Promise((a,c)=>{let l=document.createElement("connect-modal");l.defaultProviders=Dv(i.approvedProviderIds,i.defaultProviders),l.installedProviders=Dv(i.approvedProviderIds,pS(i.defaultProviders));let u=document.body.style.overflow;document.body.style.overflow="hidden";let d=()=>{l.remove(),document.body.style.overflow=u};l.callback=p=>{d();let f=ld(p),{method:g,params:w}=Yp(f,r,s,i.enableOverrides),b=rq(i.persistWalletSelect,p);a(o(f,g,Zp(w)).then(b))},l.cancelCallback=()=>{d(),c(new yi("User canceled the request",-31001))},document.body.appendChild(l);let h=p=>{p.key==="Escape"&&(document.removeEventListener("keydown",h),l.remove(),c(new yi("User canceled the request",-31001)))};document.addEventListener("keydown",h)})}function Jz(e){return typeof e[0]=="string"?{method:e[0],params:e[1]}:{options:e[0],method:e[1],params:e[2]}}function Dv(e,t){return e?t.filter(n=>e.includes(n.id)):t}function T2(e){let t=e&&"network"in e?{network:e.network}:void 0;return Zz(lr(Ct({},e),{forceWalletSelect:!0}),"getAddresses",t)}function Xz(e,t,n){return(r,s)=>{if(!s)throw new Error("[Connect] No installed Stacks wallet found");let i=t(r),o=r,{method:a,params:c}=Yp(s,e,i);Gp(s,a,Zp(c)).then(l=>{var u;let d=n(l);(u=o.onFinish)==null||u.call(o,d)}).catch(o.onCancel)}}function wu(e){return Qz(e)||eq(e)}function Qz(e){return"signMultipleTransactions"in e&&"createRepeatInscriptions"in e&&!(e!=null&&e.isLeather)&&!(e!=null&&e.isFordefi)}function eq(e){return"isFordefi"in e&&!!e.isFordefi}function $v(e){return"isLeather"in e&&!!e.isLeather}function tq(e){if(e===void 0)return{};let t={};for(let[n,r]of Object.entries(e))r!==void 0&&(t[n]=r);return t}function nq(e,t){return e?async(n,r,s)=>{let i=await t(n,r,s),o=Ct({},i);return i!==null&&"txId"in i&&i.txId&&!("txid"in o)&&(o.txid=i.txId),i!==null&&"hex"in i&&i.hex&&typeof i.hex=="string"&&!("psbt"in o)&&(o.psbt=qv.encode(Ve(i.hex))),o}:t}function Yp(e,t,n,r=!0){if(!r)return{method:t,params:n};if(wu(e)&&["getAddresses","stx_getAddresses"].includes(t))return{method:"wallet_connect",params:n};if(wu(e)&&t==="sendTransfer"){let s=lr(Ct({},n),{recipients:n.recipients.map(i=>lr(Ct({},i),{amount:Number(i.amount)})),network:void 0});return{method:t,params:s}}if(wu(e)&&t==="signPsbt"){let s=n.signInputs;if(!s)return{method:t,params:n};let i={};for(let a of s)typeof a!="number"&&a.address&&(i[a.address]||(i[a.address]=[]),i[a.address].push(a.index));let o={psbt:n.psbt,signInputs:i,broadcast:n.broadcast};return{method:t,params:o}}if(!wu(e)&&t==="stx_signMessage"){let s=Ct({},n);return delete s.publicKey,{method:t,params:s}}if($v(e)&&t==="sendTransfer"){let s=lr(Ct({},n),{recipients:n.recipients.map(i=>lr(Ct({},i),{amount:i.amount.toString()}))});return{method:t,params:s}}if($v(e)&&t==="signPsbt"){let s={hex:we(qv.decode(n.psbt)),signAtIndex:n.signInputs.map(i=>typeof i=="number"?i:i.index),allowedSighash:n.allowedSighash,broadcast:n.broadcast,network:n.network};return{method:t,params:s}}return{method:t,params:n}}var Pv=["stx-postcondition","ft-postcondition","nft-postcondition"];function Zp(e){if(!e||typeof e!="object")return e;let t=Ct({},e);for(let[n,r]of Object.entries(e)){if(typeof r=="bigint"){t[n]=r.toString();continue}if(r){if(Array.isArray(r)){t[n]=r.map(s=>typeof s=="bigint"?s.toString():!s||typeof s!="object"||!("type"in s)?s:Pv.includes(s.type)?x0(s):zf(s));continue}typeof r=="object"&&"type"in r&&(t[n]=Pv.includes(r.type)?x0(r):zf(r))}}return JSON.parse(JSON.stringify(t))}function rq(e,t){return function(n){if(e)try{dS(t)}catch{}return n}}function sq(e){return e.slice().sort((t,n)=>{let r="purpose"in t&&t.purpose==="payment",s="purpose"in n&&n.purpose==="payment";return r&&!s?-1:!r&&s?1:0})}typeof window<"u"&&(window.__CONNECT_VERSION__="__VERSION__");var iq="blockstack-session",oq=class{constructor(e){e!=null&&e.appConfig&&(this.appConfig=e.appConfig),typeof window>"u"&&typeof self>"u"?this.store=new aq:this.store=new cq}makeAuthRequestToken(){}generateAndStoreTransitKey(){}getAuthResponseToken(){}isSignInPending(){return!1}isUserSignedIn(){return!!this.store.getSessionData().userData}async handlePendingSignIn(){return Promise.resolve(this.loadUserData())}loadUserData(){let e=this.store.getSessionData().userData;if(!e)throw new Jp("No user data found. Did the user sign in?");return e}encryptContent(){}decryptContent(){}signUserOut(e){this.store.deleteSessionData(),e&&typeof location<"u"&&location.href&&(location.href=e)}},O2=class{constructor(e){e&&this.setSessionData(e)}getSessionData(){throw new Error("Abstract class")}setSessionData(e){throw new Error("Abstract class")}deleteSessionData(){throw new Error("Abstract class")}},aq=class extends O2{constructor(e){super(e),this.sessionData||this.setSessionData({})}getSessionData(){if(!this.sessionData)throw new Jp("No session data was found.");return this.sessionData}setSessionData(e){return this.sessionData=e,!0}deleteSessionData(){return this.setSessionData({}),!0}},cq=class extends O2{constructor(e){var t;super(e),this.key=typeof((t=e?.storeOptions)==null?void 0:t.localStorageKey)=="string"?e.storeOptions.localStorageKey:iq,localStorage.getItem(this.key)||this.setSessionData({})}getSessionData(){let e=localStorage.getItem(this.key);if(!e)throw new Jp("No session data was found in localStorage");return JSON.parse(e)}setSessionData(e){return localStorage.setItem(this.key,JSON.stringify(e)),!0}deleteSessionData(){return localStorage.removeItem(this.key),this.setSessionData({}),!0}},lq=(e=>(e.ContractCall="contract_call",e.ContractDeploy="smart_contract",e.STXTransfer="token_transfer",e))(lq||{}),uq=(e=>(e.BUFFER="buffer",e.UINT="uint",e.INT="int",e.PRINCIPAL="principal",e.BOOL="bool",e))(uq||{}),dq=(e=>(e[e.DEFAULT=0]="DEFAULT",e[e.ALL=1]="ALL",e[e.NONE=2]="NONE",e[e.SINGLE=3]="SINGLE",e[e.ANYONECANPAY=128]="ANYONECANPAY",e))(dq||{});class hq{constructor(t=null){const n=window.location.hostname.includes("vercel.app")||window.location.hostname.includes("netlify.app")||window.location.hostname.includes("pages.dev");if(this.isAvailable=!n,!this.isAvailable){console.log("[Realtime] WebSocket disabled in production (serverless environment)"),this.serverUrl=null;return}if(!t){const r=window.location.protocol==="https:"?"wss:":"ws:",s=window.location.hostname,i=window.location.port==="3000"?"4000":window.location.port;t=`${r}//${s}:${i}/ws`}this.serverUrl=t,this.ws=null,this.sessionId=null,this.connected=!1,this.reconnectAttempts=0,this.maxReconnectAttempts=5,this.reconnectDelay=2e3,this.onConnect=null,this.onDisconnect=null,this.onBtcTransaction=null,this.onAuraChanged=null,this.onNftMinted=null,this.onNftTransferred=null,this.onStats=null,this.onError=null,this._handleOpen=this._handleOpen.bind(this),this._handleMessage=this._handleMessage.bind(this),this._handleClose=this._handleClose.bind(this),this._handleError=this._handleError.bind(this)}connect(){if(this.isAvailable){if(this.ws&&this.ws.readyState===WebSocket.OPEN){console.log("[Realtime] Already connected");return}console.log(`[Realtime] Connecting to ${this.serverUrl}...`);try{this.ws=new WebSocket(this.serverUrl),this.ws.onopen=this._handleOpen,this.ws.onmessage=this._handleMessage,this.ws.onclose=this._handleClose,this.ws.onerror=this._handleError}catch(t){console.error("[Realtime] Connection error:",t),this._scheduleReconnect()}}}disconnect(){this.reconnectAttempts=this.maxReconnectAttempts,this.ws&&(this.ws.close(),this.ws=null),this.connected=!1,this.sessionId=null}subscribeBitcoin(t){this._send({type:"subscribe_btc",btcAddress:t})}unsubscribe(){this._send({type:"unsubscribe"})}requestStats(){this._send({type:"get_stats"})}ping(){this._send({type:"ping"})}_handleOpen(){console.log("[Realtime] Connected to server"),this.connected=!0,this.reconnectAttempts=0}_handleMessage(t){try{const n=JSON.parse(t.data);switch(console.log("[Realtime] Message:",n.type),n.type){case"connected":this.sessionId=n.sessionId,console.log(`[Realtime] Session ID: ${this.sessionId}`),this.onConnect&&this.onConnect(this.sessionId);break;case"subscribed":console.log(`[Realtime] Subscribed to ${n.btcAddress}`);break;case"unsubscribed":console.log("[Realtime] Unsubscribed");break;case"btc_transaction":console.log("[Realtime] Bitcoin transaction detected"),this.onBtcTransaction&&this.onBtcTransaction(n.data),this._showNotification(" New Bitcoin Transaction",`Transaction detected: ${n.data.txId?.slice(0,16)}...`);break;case"aura_changed":console.log("[Realtime] Aura changed!",n.data),this.onAuraChanged&&this.onAuraChanged(n.data),this._showNotification(" Aura Changed!",`Your aura evolved from ${n.data.previousAura} to ${n.data.newAura}!`);break;case"nft_minted":console.log("[Realtime] NFT minted",n.data),this.onNftMinted&&this.onNftMinted(n.data),this._showNotification(" NFT Minted!",`Token #${n.data.tokenId} minted with ${n.data.auraType} aura`);break;case"nft_transferred":console.log("[Realtime] NFT transferred",n.data),this.onNftTransferred&&this.onNftTransferred(n.data);break;case"stats":console.log("[Realtime] Stats:",n.data),this.onStats&&this.onStats(n.data);break;case"pong":break}}catch(n){console.error("[Realtime] Parse error:",n)}}_handleClose(t){console.log("[Realtime] Disconnected",t.code,t.reason),this.connected=!1,this.sessionId=null,this.onDisconnect&&this.onDisconnect(),this._scheduleReconnect()}_handleError(t){console.error("[Realtime] WebSocket error:",t),this.onError&&this.onError(t)}_send(t){this.ws&&this.ws.readyState===WebSocket.OPEN?this.ws.send(JSON.stringify(t)):console.warn("[Realtime] Not connected, cannot send message")}_scheduleReconnect(){if(this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const t=this.reconnectDelay*this.reconnectAttempts;console.log(`[Realtime] Reconnecting in ${t}ms (attempt ${this.reconnectAttempts})`),setTimeout(()=>this.connect(),t)}else console.log("[Realtime] Max reconnect attempts reached")}_showNotification(t,n){"Notification"in window&&Notification.permission==="granted"&&new Notification(t,{body:n,icon:"/img/collection2.png"}),this._showToast(t,n)}_showToast(t,n){let r=document.getElementById("toast-container");r||(r=document.createElement("div"),r.id="toast-container",r.style.cssText=`
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 9999;
                display: flex;
                flex-direction: column;
                gap: 10px;
            `,document.body.appendChild(r));const s=document.createElement("div");s.style.cssText=`
            background: linear-gradient(145deg, #242432, #1b1b24);
            border: 1px solid #5546ff;
            border-radius: 10px;
            padding: 12px 16px;
            color: white;
            font-family: 'Courier New', monospace;
            box-shadow: 0 4px 20px rgba(85, 70, 255, 0.3);
            animation: slideIn 0.3s ease-out;
            max-width: 300px;
        `,s.innerHTML=`
            <div style="font-weight: bold; margin-bottom: 4px; color: #f7931a;">${t}</div>
            <div style="font-size: 12px; color: #aaa;">${n}</div>
        `,r.appendChild(s),setTimeout(()=>{s.style.animation="slideOut 0.3s ease-in",setTimeout(()=>s.remove(),300)},5e3)}}const D2=document.createElement("style");D2.textContent=`
    @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
    }
`;document.head.appendChild(D2);const as=new hq;console.log(" System initializing...");const qi="SP1ZGGS886YCZHMFXJR1EK61ZP34FNWNSX32N685T",Cl="aura-nft-v3",mf={fire:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/images/fire.png",water:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/images/water.png",stone:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/images/stone.png"},mu={fire:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/metadata/fire.json",water:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/metadata/water.json",stone:"https://esolvhnpvfoavgycrwgy.supabase.co/storage/v1/object/public/bitcoin-aura/metadata/stone.json"},$2=o1;let ur=null,Rs=null,qt=null,ln=null,Sn=null;const j={connectBtn:document.getElementById("connectWalletBtn"),walletStatus:document.getElementById("walletStatus"),statusChip:document.querySelector(".status-chip"),heroImage:document.getElementById("heroImage"),heroCaption:document.getElementById("heroCaption"),scanSection:document.getElementById("scanSection"),btcAddress:document.getElementById("btcAddress"),scanButton:document.getElementById("scanButton"),loading:document.getElementById("loading"),resultArea:document.getElementById("result-area"),auraTitle:document.getElementById("auraTitle"),cardImage:document.getElementById("cardImage"),txData:document.getElementById("txData"),descData:document.getElementById("descData"),mintBtn:document.getElementById("mintBtn"),updateBtn:document.getElementById("updateBtn"),nftStatus:document.getElementById("nftStatus"),ownedTokenId:document.getElementById("ownedTokenId"),currentAuraLabel:document.getElementById("currentAuraLabel"),txStatus:document.getElementById("txStatus")};function fq(){j.scanSection&&(j.scanSection.style.display="block",j.scanSection.scrollIntoView({behavior:"smooth",block:"start"}))}function Pi(e=!1){if(ls()){const n=Bd().addresses.stx[0].address;console.log(" User Connected:",n),j.walletStatus&&(j.walletStatus.textContent="",j.walletStatus.style.color="#9ae6b4",j.walletStatus.style.display="none"),j.statusChip&&(j.statusChip.style.display="none"),j.connectBtn.textContent="Disconnect",j.connectBtn.classList.remove("btn-primary"),j.connectBtn.classList.add("btn-danger"),j.scanSection&&(j.scanSection.style.display="block"),e&&fq()}else console.log(" User Not Connected"),j.walletStatus&&(j.walletStatus.textContent="Wallet not connected.",j.walletStatus.style.color="#ff6b6b",j.walletStatus.style.display="block"),j.statusChip&&(j.statusChip.style.display="inline-block"),j.connectBtn.textContent="Connect Wallet",j.connectBtn.classList.remove("btn-danger"),j.connectBtn.classList.add("btn-primary"),j.mintBtn&&(j.mintBtn.disabled=!0),j.scanSection&&(j.scanSection.style.display="none"),j.resultArea&&(j.resultArea.style.display="none")}async function pq(){if(console.log(" Connect button clicked"),ls()){N2(),Pi();return}try{await T2({appDetails:{name:"Bitcoin Aura",icon:window.location.origin+"/img/collection2.png"},redirectTo:window.location.href,onFinish:()=>{Pi(!0)}}),Pi(!0)}catch(e){console.error("Connect failed",e)}}j.connectBtn&&j.connectBtn.addEventListener("click",pq);async function Md(){console.log(" Scan started...");const e=j.btcAddress.value.trim();if(!e){alert("Please enter a Bitcoin address first!");return}j.loading.style.display="block",j.resultArea.style.display="none",j.txStatus.textContent="";try{const t=await gq(e);let n="",r="",s="",i="";t===0?(n="BUY YOUR FIRST BTC",r="",s="You have no on-chain activity yet. Start with your first Bitcoin transaction.",i="#f7931a",Rs=mu.stone):t>=50?(n="FIRE TRADER",r=mf.fire,s=" You are hyperactive! Gas fees are not a problem for you.",i="#ff4500",Rs=mu.fire):t>=10?(n="WATER FLOW",r=mf.water,s=" Balanced. You know when to hold and when to spend.",i="#00bfff",Rs=mu.water):(n="STONE HODLER",r=mf.stone,s=" Stillness is gold. Your hands are diamond strong.",i="#808080",Rs=mu.stone),ur=n,j.auraTitle.innerText=n,j.auraTitle.style.color=i,r?(j.cardImage.src=r,j.cardImage.style.display="block",j.heroImage&&(j.heroImage.style.display="block")):(j.cardImage.style.display="none",j.heroImage&&(j.heroImage.style.display="none")),j.txData.innerText=`Total On-Chain Transactions: ${t}`,j.descData.innerText=s;const o=t!==0;j.txData&&(j.txData.style.display=o?"block":"none"),j.descData&&(j.descData.style.display=o?"block":"none"),j.loading.style.display="none",j.resultArea.style.display="flex",t>0?(console.log(" Checking if BTC address has minted NFT..."),await mq(),console.log(` Owned Token ID: ${qt}, Current NFT Aura: ${ln}, New Aura: ${ur}`),qt?(console.log(" BTC address already minted - hiding MINT button"),j.mintBtn&&(j.mintBtn.style.display="none"),P2()):(console.log(" BTC address not minted yet - showing MINT button"),j.mintBtn&&(j.mintBtn.style.display="block",j.mintBtn.disabled=!1,j.mintBtn.textContent=" MINT TO STACKS"),j.nftStatus&&(j.nftStatus.style.display="none"),j.updateBtn&&(j.updateBtn.style.display="none"))):(console.log(" Skipping NFT check - totalTx is 0"),j.mintBtn&&(j.mintBtn.style.display="none"))}catch(t){console.error(t),j.loading.style.display="none",alert("Error: "+t.message+". API might be unreachable; try again.")}}async function gq(e){const t=encodeURIComponent(e),n=location.hostname==="localhost"||location.hostname==="127.0.0.1";try{const s=new AbortController,i=setTimeout(()=>s.abort(),3e3),o=await fetch(`/api/txcount?address=${t}`,{signal:s.signal,headers:{Accept:"application/json"},cache:"no-store"});if(clearTimeout(i),o.ok){const a=await o.json();if(typeof a.totalTx=="number")return a.totalTx}}catch(s){console.warn("Proxy /api/txcount failed, falling back to client fetch",s)}const r=[{url:`https://blockstream.info/api/address/${t}`,parser:s=>(s.chain_stats?.tx_count||0)+(s.mempool_stats?.tx_count||0)},{url:`https://api.blockcypher.com/v1/btc/main/addrs/${t}`,parser:s=>(typeof s.n_tx=="number"?s.n_tx:0)+(typeof s.unconfirmed_n_tx=="number"?s.unconfirmed_n_tx:0)},{url:`https://blockchain.info/rawaddr/${t}?cors=true`,parser:s=>typeof s.n_tx=="number"?s.n_tx:0},...n?[{url:`https://mempool.space/api/address/${t}`,parser:s=>(s.chain_stats?.tx_count||0)+(s.mempool_stats?.tx_count||0)}]:[]];for(const s of r){const i=new AbortController,o=setTimeout(()=>i.abort(),6e3);try{const a=await fetch(s.url,{signal:i.signal,mode:"cors",headers:{Accept:"application/json"},cache:"no-store"});if(!a.ok)throw new Error(`HTTP ${a.status}`);const c=await a.json(),l=s.parser(c);if(clearTimeout(o),typeof l!="number"||Number.isNaN(l))throw new Error("Invalid response");return l}catch(a){clearTimeout(o),console.warn("Fetch failed on",s.url,a)}}throw new Error("Failed to fetch address data (all sources failed)")}j.scanButton&&j.scanButton.addEventListener("click",Md);async function wq(){if(!ur||!Rs){alert("Scan your aura first!");return}if(!ls()){alert("Connect your wallet first!");return}j.txStatus.textContent="Preparing transaction...",j.txStatus.style.color="yellow";const e=j.btcAddress?.value?.trim();if(!e){alert("No Bitcoin address scanned!");return}const t=[Ls(e),Ls(ur),Ls(Rs)];try{await x2({network:$2,contractAddress:qi,contractName:Cl,functionName:"mint",functionArgs:t,postConditionMode:qs.Deny,appDetails:{name:"Bitcoin Aura",icon:window.location.origin+"/img/collection2.png"},onFinish:n=>{const r=`https://explorer.hiro.so/txid/${n.txId}?chain=mainnet`;j.txStatus.innerHTML=` Mint Sent! <a href="${r}" target="_blank" style="color: #45b5ff;">View Transaction</a>`,j.txStatus.style.color="#9ae6b4",j.scanButton&&(j.scanButton.textContent="Scan Another Wallet Aura")},onCancel:()=>{j.txStatus.textContent="Mint cancelled.",j.txStatus.style.color="orange"}})}catch(n){j.txStatus.textContent=`Mint failed: ${n.message}`,j.txStatus.style.color="red"}}j.mintBtn&&j.mintBtn.addEventListener("click",wq);async function mq(){const e=j.btcAddress?.value?.trim();if(!e){qt=null,ln=null;return}try{console.log(`[NFT Check V3] Looking up token for BTC address: ${e}`);const t=`https://api.hiro.so/v2/contracts/call-read/${qi}/${Cl}/get-token-by-btc`,n=new TextEncoder().encode(e),r=n.length.toString(16).padStart(8,"0");let s="";for(const c of n)s+=c.toString(16).padStart(2,"0");const i=`0x0d${r}${s}`;console.log(`[NFT Check V3] Encoded arg: ${i}`);const o=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sender:qi,arguments:[i]})});if(!o.ok){console.warn("[NFT Check V3] API error:",o.status),qt=null,ln=null;return}const a=await o.json();if(a.okay&&a.result){const c=a.result;if(c.startsWith("0x070a01")){const l=c.slice(8,40);qt=parseInt(l,16),console.log(`[NFT Check V3] Found token #${qt} for this BTC address!`),await yq(qt),await bq(qt)}else console.log("[NFT Check V3] No NFT exists for this BTC address"),qt=null,ln=null,Sn=null}}catch(t){console.error("[NFT Check V3] Error:",t),qt=null,ln=null,Sn=null}}async function yq(e){try{const t=`https://api.hiro.so/v2/contracts/call-read/${qi}/${Cl}/get-aura`,r=`0x01${e.toString(16).padStart(32,"0")}`;console.log(`[Aura Fetch] Fetching aura for token #${e}`);const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sender:qi,arguments:[r]})});if(!s.ok){console.warn("[Aura Fetch] API error:",s.status);return}const i=await s.json();if(i.okay&&i.result){const o=i.result;if(o.startsWith("0x070a0d")){const a=o.slice(8,16),c=parseInt(a,16),l=o.slice(16,16+c*2);let u="";for(let d=0;d<l.length;d+=2)u+=String.fromCharCode(parseInt(l.substr(d,2),16));ln=u,console.log(`[Aura Fetch] Current aura: "${ln}"`)}else console.log("[Aura Fetch] No aura found (none)"),ln=null}}catch(t){console.error("[Aura Fetch] Error:",t)}}async function bq(e){try{const t=`0x01${e.toString(16).padStart(32,"0")}`,n=`https://api.hiro.so/extended/v1/tokens/nft/history?asset_identifier=${qi}.${Cl}::bitcoin-aura-v3&value=${encodeURIComponent(t)}`;console.log(`[Owner Fetch] Fetching owner for token #${e}`);const r=await fetch(n,{headers:{Accept:"application/json"}});if(!r.ok){console.warn("[Owner Fetch] API error:",r.status),Sn=null;return}const s=await r.json();s.results&&s.results.length>0?(Sn=s.results[0].recipient||null,console.log(`[Owner Fetch] Token #${e} owned by: ${Sn}`)):(console.log("[Owner Fetch] No history found"),Sn=null)}catch(t){console.error("[Owner Fetch] Error:",t),Sn=null}}function vq(){if(!ls()||!Sn)return!1;try{const t=Bd().addresses.stx[0].address,n=t===Sn;return console.log(`[Owner Check] Connected: ${t}, Owner: ${Sn}, Match: ${n}`),n}catch{return!1}}function P2(){if(!(!j.mintBtn||!j.updateBtn))if(console.log(" updateButtonVisibility called:"),console.log(`   - ownedTokenId: ${qt}`),console.log(`   - currentNftAura: "${ln}"`),console.log(`   - currentAuraType: "${ur}"`),console.log(`   - nftOwner: ${Sn?"exists":"null"}`),qt&&ur){j.nftStatus&&(j.nftStatus.style.display="block",j.ownedTokenId&&(j.ownedTokenId.textContent=qt),j.currentAuraLabel&&(j.currentAuraLabel.textContent=ln||"Unknown")),j.mintBtn.style.display="none";const e=vq();ls()?e?ln&&ln!==ur?(j.updateBtn.style.display="block",j.updateBtn.textContent=` UPDATE TO ${ur}`,j.txStatus&&(j.txStatus.innerHTML='<small style="color: #a1a1aa;">You own this NFT. Click to update your aura.</small>',j.txStatus.style.color="#a1a1aa")):(j.updateBtn.style.display="none",j.txStatus&&(j.txStatus.textContent=" Your NFT is already up to date!",j.txStatus.style.color="#10b981")):(j.updateBtn.style.display="none",j.txStatus&&(j.txStatus.innerHTML=` This Bitcoin address was minted by another wallet.<br><small style="color: #a1a1aa;">Owner: ${Sn?Sn.slice(0,12)+"...":"Unknown"}</small>`,j.txStatus.style.color="#ef4444")):(j.updateBtn.style.display="none",j.txStatus&&(j.txStatus.innerHTML=` This Bitcoin address already has an NFT.<br><small style="color: #a1a1aa;">Connect your wallet to update if you're the owner.</small>`,j.txStatus.style.color="#fbbf24"))}else qt?(j.nftStatus&&(j.nftStatus.style.display="block",j.ownedTokenId&&(j.ownedTokenId.textContent=qt),j.currentAuraLabel&&(j.currentAuraLabel.textContent=ln||"Unknown")),j.mintBtn.style.display="none",j.updateBtn.style.display="none"):(j.nftStatus&&(j.nftStatus.style.display="none"),j.updateBtn.style.display="none")}async function Eq(){const e=j.btcAddress?.value?.trim();if(!e){alert("No Bitcoin address to update!");return}if(!ur||!Rs){alert("Scan your aura first!");return}if(!ls()){alert("Connect your wallet first!");return}j.txStatus.textContent="Preparing update transaction...",j.txStatus.style.color="yellow";const t=[Ls(e),Ls(ur),Ls(Rs)];try{await x2({network:$2,contractAddress:qi,contractName:Cl,functionName:"update-aura",functionArgs:t,postConditionMode:qs.Deny,appDetails:{name:"Bitcoin Aura",icon:window.location.origin+"/img/collection2.png"},onFinish:n=>{const r=`https://explorer.hiro.so/txid/${n.txId}?chain=mainnet`;j.txStatus.innerHTML=` Aura Updated! <a href="${r}" target="_blank" style="color: #45b5ff;">View Transaction</a>`,j.txStatus.style.color="#9ae6b4",ln=ur,P2()},onCancel:()=>{j.txStatus.textContent="Update cancelled.",j.txStatus.style.color="orange"}})}catch(n){j.txStatus.textContent=`Update failed: ${n.message}`,j.txStatus.style.color="red"}}j.updateBtn&&j.updateBtn.addEventListener("click",Eq);j.connectBtn&&j.connectBtn.addEventListener("click",()=>{ls()?(N2(),Pi()):T2({appDetails:{name:"Bitcoin Aura",icon:window.location.origin+"/img/collection2.png"},onFinish:()=>Pi()})});const Cq=ls();Pi(Cq);window.addEventListener("focus",()=>{ls()&&Pi(!0)});as.onConnect=e=>{console.log(" Connected to real-time server:",e)};as.onDisconnect=()=>{console.log(" Disconnected from real-time server")};as.onAuraChanged=e=>{console.log(" Aura changed!",e);const t=j.btcAddress?.value?.trim();t&&e.btcAddress===t&&Md()};as.onNftMinted=e=>{if(console.log(" NFT minted!",e),j.txStatus){const t=`https://explorer.hiro.so/txid/${e.txId}?chain=mainnet`;j.txStatus.innerHTML=` Mint Confirmed! Token #${e.tokenId} <a href="${t}" target="_blank" style="color: #45b5ff;">View on Explorer</a>`,j.txStatus.style.color="#9ae6b4"}};as.onBtcTransaction=e=>{console.log(" Bitcoin transaction detected:",e)};as.onStats=e=>{console.log(" Collection stats:",e)};"Notification"in window&&Notification.permission==="default"&&Notification.requestPermission();typeof window<"u"&&setTimeout(()=>{try{as.connect()}catch(e){console.warn("Real-time connection failed:",e)}},1e3);const Aq=Md;async function Iq(){await Aq();const e=j.btcAddress?.value?.trim();e&&as.connected&&(as.subscribeBitcoin(e),console.log(" Subscribed to real-time updates for:",e))}j.scanButton&&(j.scanButton.removeEventListener("click",Md),j.scanButton.addEventListener("click",Iq));export{Sk as $,he as A,xr as B,X as C,Ft as D,He as E,WH as F,ae as G,In as H,qW as I,h2 as J,Vp as K,ra as L,Ae as M,Ik as N,z as O,An as P,dW as Q,pe as R,V as S,vn as T,Mm as U,GE as V,Wp as W,Ic as X,yk as Y,KE as Z,pc as _,WW as a,hW as a0,uW as a1,Ku as a2,pW as a3,fW as a4,Ou as b,ce as c,Q as d,VW as e,q as f,xq as g,MS as h,Ho as i,_u as j,XA as k,T as l,rr as m,_r as n,Me as o,hd as p,jW as q,Sq as r,Oo as s,Et as t,KW as u,Ze as v,Dn as w,LW as x,zt as y,$t as z};
